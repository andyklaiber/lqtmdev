import{_ as S,R as j,r as C,o as a,c as r,a as b,b as t,d as R,e as m,t as c,w as P,f as N,n as O,p as K,g as z,h as T,i as _,F as u,j as D,k as E,l as J,m as Q,q as X,s as Z,u as ee,v as te}from"./main-ba68b533.js";const se={components:{RouterView:j},data(){return{races:[]}},mounted:function(){},computed:{}},ae={class:"container"};function re(e,s,n,d,i,o){const y=C("RouterView");return a(),r("div",ae,[b(y)])}const ie=S(se,[["render",re]]),oe={props:["url"],created(){(function(e,s,n){var d,i=e.getElementsByTagName(s)[0];e.getElementById(n)||(d=e.createElement(s),d.id=n,d.src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v15.0",i.parentNode.insertBefore(d,i))})(document,"script","facebook-jssdk")},mounted(){window.FB&&FB.XFBML.parse()}},ne={id:"1"},le=t("div",{id:"fb-root"},null,-1),ce=["data-href"];function de(e,s,n,d,i,o){return a(),r("div",ne,[le,t("div",{class:"fb-share-button","data-href":this.url,"data-layout":"button","data-size":"large"},null,8,ce)])}const ue=S(oe,[["render",de]]),he={components:{FbShareComponent:ue},props:["details","raceid","compactMode","series","seriesData","seriesRaceCount"],data(){return{}},computed:{seriesDisplayText(){if(!this.seriesData)return"Part of a Series";const e=this.seriesData.displayName||this.seriesData.name||"Series",s=this.seriesData.year?` ${this.seriesData.year}`:"";return`${e}${s}`},isRosterPage(){return this.$route.path.includes("/roster/")},isRegPage(){return this.$route.name==="register"},regDisabled(){return R().isBefore(this.details.regOpenDate)},regEnded(){return R().isAfter(this.details.regCloseDate)},regTimeToOpen(){return R().to(this.details.regOpenDate)},regTimeToClose(){return R().to(this.details.regCloseDate)},imgWidth(){return this.compactMode?150:225}}},me={class:"container mb-4"},pe=["src"],_e={class:"row p-1 px-3 pb-0 pe-lg-0 pt-lg-3 align-items-center rounded-3 border shadow"},ye={key:0,class:"col-md-3 px-3"},ge={class:"d-flex justify-content-center"},fe=["href"],ve=["src","width"],be={class:"col-md-7 p-3 p-lg-3 pt-lg-3"},De={class:"row"},$e={class:"col col-md-auto"},ke={class:"display-7 fw-bold lh-3"},Ce={key:0,class:"lead mb-0 fw-bold"},Re={class:"display-9"},Se={key:0,class:"mb-2"},we=t("i",{class:"bi bi-collection"},null,-1),Te={key:1,class:"d-grid gap-2 d-md-flex justify-content-md mb-4 mb-lg-3"},xe={class:"col-md-auto"},Pe=["href"],Ne={class:"col col-lg-2"},Oe={key:0},Ee={key:2,class:"fw-bold"},Be={key:3,class:"row"},Me={key:0,class:"fw-bold"},Fe={key:0,class:"fw-bold"},Le={key:1,class:"fw-bold"},Ae={key:1,class:"col col-md-auto"},Ie={key:2,class:"col"};function Ve(e,s,n,d,i,o){var l;const y=C("RouterLink"),v=C("FbShareComponent");return a(),r("div",me,[o.isRegPage?(a(),r("img",{key:0,class:"img-fluid",src:n.details.headerPhoto,alt:""},null,8,pe)):m("",!0),t("div",_e,[n.details.logoUrl?(a(),r("div",ye,[t("div",ge,[t("a",{href:n.details.homepageUrl},[t("img",{class:"pb-1",src:n.details.logoUrl,alt:"",width:o.imgWidth},null,8,ve)],8,fe)])])):m("",!0),t("div",be,[t("div",De,[t("div",$e,[t("h3",ke,c(n.details.name),1),n.compactMode?m("",!0):(a(),r("p",Ce,c(n.details.tagline),1))])]),t("p",Re,c(n.details.formattedDates),1),n.series&&n.seriesRaceCount>1?(a(),r("div",Se,[b(y,{to:{name:"racesBySeries",params:{seriesid:n.series}},class:"badge bg-primary text-decoration-none"},{default:P(()=>[we,N(" "+c(o.seriesDisplayText),1)]),_:1},8,["to"])])):m("",!0),n.details.homepageUrl&&!n.compactMode?(a(),r("div",Te,[t("div",xe,[t("a",{class:"btn btn-sm btn-success",href:n.details.homepageUrl},"Event Homepage",8,Pe)]),t("div",Ne,[n.details.facebookShare?(a(),r("div",Oe,[b(v,{url:n.details.homepageUrl},null,8,["url"])])):m("",!0)])])):m("",!0),o.regDisabled?(a(),r("div",Ee," Registration will open "+c(o.regTimeToOpen),1)):(a(),r("div",Be,[(l=n.details)!=null&&l.regCloseDate?(a(),r("div",Me,[o.regEnded?(a(),r("div",Fe," Registration is closed ")):(a(),r("div",Le," Registration will close "+c(o.regTimeToClose),1))])):m("",!0),!o.isRegPage&&!o.regEnded?(a(),r("div",Ae,[b(y,{class:"btn btn-success",to:{name:"register",params:{raceid:n.raceid}}},{default:P(()=>[N("Register")]),_:1},8,["to"])])):m("",!0),o.isRosterPage?m("",!0):(a(),r("div",Ie,[b(y,{class:"btn btn-secondary",to:{name:"roster",params:{raceid:n.raceid}}},{default:P(()=>[N("See who is signed up ")]),_:1},8,["to"])]))]))])])])}const B=S(he,[["render",Ve]]);const Ue={props:["races"],data(){return{count:0,loggedIn:!1}},computed:{}},Y=e=>(K("data-v-2f3c77b1"),e=e(),z(),e),qe={class:"navbar navbar-expand-md navbar-dark bg-dark fixed-top"},je={class:"container-fluid"},Ye=Y(()=>t("a",{class:"navbar-brand",href:"/"},"Signup.bike",-1)),He=Y(()=>t("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarsExample04","aria-controls":"navbarsExample04","aria-expanded":"false","aria-label":"Toggle navigation"},[t("span",{class:"navbar-toggler-icon"})],-1)),Ge={class:"collapse navbar-collapse",id:"navbarsExample04"},We={class:"navbar-nav me-auto mb-4 mb-md-0 px-5"},Ke={class:"nav-item"};function ze(e,s,n,d,i,o){const y=C("RouterLink");return a(),r("nav",qe,[t("div",je,[Ye,He,t("div",Ge,[t("ul",We,[t("li",Ke,[b(y,{class:O(["nav-link",{active:e.$route.name=="home"}]),to:{name:"home"}},{default:P(()=>[N(" Upcoming Races ")]),_:1},8,["class"])])]),i.loggedIn?(a(),r("button",{key:0,type:"button",class:"btn btn-secondary",onClick:s[0]||(s[0]=v=>e.$emit("logout"))},"Logout")):m("",!0)])])])}const M=S(Ue,[["render",ze],["__scopeId","data-v-2f3c77b1"]]);const Je={emits:["logout"],components:{MainNav:M,RouterView:j,EventDetailsComponent:B},data(){return{count:0,races:[],loading:!0}},created(){this.$watch(()=>this.$route.query,()=>{this.fetchData()},{immediate:!0})},methods:{fetchData(){if(this.error=null,this.loading=!0,console.log("fetch plz"),this.$route)return T("/api/races/").then(e=>{this.races=e.data,this.loading=!1,console.log("fetched"),console.log(this.races)}).catch(e=>{this.loading=!1,this.error=e.toString(),console.error(e)})}},computed:{displayRaces(){let e={},s=_.filter(this.races,n=>{if(this.$route.params.seriesid){if(n.series!==this.$route.params.seriesid)return!1}else if(n.series&&e[n.series]&&!n.disableSeriesRedirect)return!1;let d=R().isBefore(R(n.eventDate));return console.log("isInFuture"+d+" "+n.displayName),n.isTestData&&!this.$route.query.test||!d&&!this.$route.query.past?!1:(typeof n.series=="string"&&n.series.length>1&&(console.log("set as shown "+n.raceid),e[n.series]=!0),!0)});return _.sortBy(s,[function(n){return R(n.eventDate)}])},seriesRaceCounts(){const e={};return this.displayRaces.forEach(s=>{s.series&&(e[s.series]=(e[s.series]||0)+1)}),e},loggedIn(){return!1}}},Qe={key:0},Xe={key:1};function Ze(e,s,n,d,i,o){const y=C("MainNav"),v=C("EventDetailsComponent");return a(),r(u,null,[b(y),i.loading?(a(),r("div",Qe," Plz wait, loading... ")):(a(),r("div",Xe,[(a(!0),r(u,null,D(o.displayRaces,(l,p)=>(a(),r("div",{key:p},[b(v,{details:l.eventDetails,raceid:l.raceid,series:l.series,"series-data":l.seriesData,"series-race-count":o.seriesRaceCounts[l.series],"compact-mode":"true"},null,8,["details","raceid","series","series-data","series-race-count"])]))),128))]))],64)}const F=S(Je,[["render",Ze],["__scopeId","data-v-62af94e2"]]);let L=(e,s=!1)=>{const n=new Date(Date.UTC(0,0,0,0,0,0,e));let i=[n.getUTCMinutes(),n.getUTCSeconds()].map(o=>String(o).padStart(2,"0")).join(":");return s&&(i=i.concat("."+`${n.getUTCMilliseconds()}`.padStart(3,"0"))),n.getUTCHours()&&(i=n.getUTCHours()+":"+i),i};const et={props:["data","Pos","totLaps","showMillis"],data(){return{count:0}},methods:{msToTimeString(e){return L(e,this.showMillis)}},computed:{incompleteLaps(){return new Array(this.totLaps-this.data.laps.length).fill("-")},formattedTime(){return L(this.data.duration,this.showMillis)},trailingTime(){return this.data.back?this.showMillis?L(this.data.backMs,!0):this.data.back:"-"}}};function tt(e,s,n,d,i,o){return a(),r(u,null,[t("td",null,c(n.Pos+1),1),t("td",null,c(n.data.Bib),1),t("td",null,c(n.data.Name),1),t("td",null,c(n.data.Sponsor),1),(a(!0),r(u,null,D(n.data.laps,(y,v)=>(a(),r("td",{key:v},c(o.msToTimeString(y.duration)),1))),128)),n.totLaps-n.data.laps.length>0?(a(!0),r(u,{key:0},D(o.incompleteLaps,y=>(a(),r("td",null,c(y),1))),256)):m("",!0),t("td",null,c(o.formattedTime),1),t("td",null,c(o.trailingTime),1)],64)}const H=S(et,[["render",tt]]),st={props:["series"],data(){return{count:0,seriesData:{}}},created(){this.$watch(()=>this.series,function(){if(!this.series)return;let e=`/api/series/${this.series}/races`;T(e).then(({data:s})=>{this.seriesData=s})})},computed:{isPcrs(){return this.series&&this.series.indexOf("pcrs")>-1}}},at={id:"top",class:"navbar navbar-light bg-light"},rt={class:"container-fluid"},it={class:"navbar-brand",href:"#"},ot={key:0,class:"nav-item"},nt=["href"],lt=t("p",{class:"mt-3"},"View Weekly lap times:",-1),ct={class:"nav nav-tabs mt-1 justify-content-center"},dt={key:0,class:"nav-item"},ut={key:1,class:"nav-item"},ht={key:2,class:"nav-item"};function mt(e,s,n,d,i,o){const y=C("RouterLink");return a(),r(u,null,[t("nav",at,[t("div",rt,[t("div",it,c(i.seriesData.displayName),1),i.seriesData.homepage?(a(),r("div",ot,[t("a",{class:"nav-link active","aria-current":"page",href:i.seriesData.homepage.url},c(i.seriesData.homepage.linkString),9,nt)])):m("",!0)])]),lt,t("ul",ct,[(a(!0),r(u,null,D(i.seriesData.races,v=>(a(),r("li",{key:v.raceid,class:"nav-item"},[b(y,{class:O(["nav-link",{active:e.$route.params.raceid===v.raceid}]),to:`/race/${v.raceid}`},{default:P(()=>[N(c(v.displayName+` - ${v.formattedStartDate}`),1)]),_:2},1032,["class","to"])]))),128)),o.isPcrs?(a(),r("li",dt,[b(y,{class:O(["nav-link",{active:e.$route.path=="/series/pcrs_2022"}]),to:"/series/pcrs_2022"},{default:P(()=>[N("Series Standings")]),_:1},8,["class"])])):m("",!0),o.isPcrs?(a(),r("li",ut,[b(y,{class:O(["nav-link",{active:e.$route.path=="/series/grom/pcrs_2022"}]),to:"/series/grom/pcrs_2022"},{default:P(()=>[N("Grom Series Standings")]),_:1},8,["class"])])):m("",!0),o.isPcrs?(a(),r("li",ht,[b(y,{class:O(["nav-link",{active:e.$route.path=="/teamcomp/pcrs_2022"}]),to:"/teamcomp/pcrs_2022"},{default:P(()=>[N("Team Competition")]),_:1},8,["class"])])):m("",!0)])],64)}const A=S(st,[["render",mt]]);const pt={components:{ResultRow:H,SeriesNavBar:A},data(){return{categories:{},loading:!1,error:null,formattedStartDate:"",series:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{scrollMeTo(e){var s=document.querySelector(`#${e}`);s.scrollIntoView({behavior:"smooth"})},fetchData(){if(this.error=null,this.loading=!0,this.$route.params.raceid){let e=`/api/races/results/${this.$route.params.raceid}`;T(e).then(({data:s})=>{this.formattedStartDate=s.raceMeta.formattedStartDate,this.series=s.series,this.loading=!1,this.categories=s.categories}).catch(s=>{console.error(s),this.categories={},this.error=s.toString()})}}},computed:{sortedCats(){return _.orderBy(this.categories,"disporder")},expertCats(){return _.filter(this.sortedCats,{laps:4})},sportCats(){return _.filter(this.sortedCats,{laps:3})},beginnerCats(){return _.filter(this.sortedCats,{laps:2})},gromCats(){return _.filter(this.categories,e=>e.id.indexOf("grom")>-1)},haveResults(){return this.categories?Object.keys(this.categories).length>0:!1}}},_t={key:0,class:"text-center"},yt={class:"mt-5"},gt={key:1,class:"loading"},ft={key:2},vt={key:0,class:"error"},bt={key:1},Dt={class:"container text-center mt-5"},$t={class:"list-inline"},kt=["onClick"],Ct={class:"list-inline"},Rt=["onClick"],St={class:"list-inline"},wt=["onClick"],Tt={class:"list-inline"},xt=["onClick"],Pt={class:"container-fluid"},Nt=["id"],Ot={class:"table table-striped table-hover"},Et={key:2},Bt=t("div",{class:"text-center"},[t("h2",{class:"mt-5"},"No results yet...")],-1),Mt=[Bt];function Ft(e,s,n,d,i,o){const y=C("SeriesNavBar"),v=C("ResultRow");return a(),r(u,null,[b(y,{series:i.series},null,8,["series"]),i.formattedStartDate?(a(),r("div",_t,[t("h2",yt,"Race Results - "+c(i.formattedStartDate),1)])):m("",!0),i.loading?(a(),r("div",gt,"Loading...")):(a(),r("div",ft,[i.error?(a(),r("div",vt,c(i.error),1)):m("",!0),o.haveResults?(a(),r("div",bt,[t("div",Dt,[t("ul",$t,[(a(!0),r(u,null,D(o.expertCats,(l,p)=>(a(),r("li",{key:l.id,class:"list-inline-item mx-2"},[t("a",{role:"button",onClick:h=>o.scrollMeTo(l.id),class:"link-primary"},c(l.catdispname),9,kt)]))),128))]),t("ul",Ct,[(a(!0),r(u,null,D(o.sportCats,(l,p)=>(a(),r("li",{key:l.id,class:"list-inline-item mx-2"},[t("a",{role:"button",onClick:h=>o.scrollMeTo(l.id),class:"link-primary"},c(l.catdispname),9,Rt)]))),128))]),t("ul",St,[(a(!0),r(u,null,D(o.beginnerCats,(l,p)=>(a(),r("li",{key:l.id,class:"list-inline-item mx-2"},[t("a",{role:"button",onClick:h=>o.scrollMeTo(l.id),class:"link-primary"},c(l.catdispname),9,wt)]))),128))]),t("ul",Tt,[(a(!0),r(u,null,D(o.gromCats,(l,p)=>(a(),r("li",{key:l.id,class:"list-inline-item mx-2"},[t("a",{role:"button",onClick:h=>o.scrollMeTo(l.id),class:"link-primary"},c(l.catdispname),9,xt)]))),128))])]),t("div",Pt,[(a(!0),r(u,null,D(o.sortedCats,(l,p)=>(a(),r("div",{key:l.id,class:"mt-5"},[t("h3",{id:l.id},c(l.catdispname),9,Nt),t("table",Ot,[t("thead",null,[t("tr",null,[(a(!0),r(u,null,D(l.columns,(h,g)=>(a(),r("th",{scope:"col",key:g},c(h),1))),128))])]),t("tbody",null,[(a(!0),r(u,null,D(l.results,(h,g)=>(a(),r("tr",{key:g},[b(v,{totLaps:l.laps,Pos:g,data:h},null,8,["totLaps","Pos","data"])]))),128))])]),t("a",{role:"button",onClick:s[0]||(s[0]=h=>o.scrollMeTo("top")),class:"link-primary"},"Back to Top")]))),128))])])):(a(),r("div",Et,Mt))]))],64)}const Lt=S(pt,[["render",Ft]]),At={props:["series","displayName"],data(){return{count:0,seriesData:{},races:[]}},created(){this.$watch(()=>this.series,function(){if(!this.series)return;let e=`/api/results/?series=${this.series}`;T(e).then(({data:s})=>(this.races=s,T(`api/results/series/?series=${this.series}`))).then(({data:s})=>{this.seriesData=s})})},computed:{isPcrs(){return this.series&&this.series.indexOf("pcrs")>-1},hasTeamComp(){var e,s;return((s=(e=this.seriesData)==null?void 0:e.teamCompDates)==null?void 0:s.length)>1},headerName(){var e;return this.displayName||((e=this.seriesData)==null?void 0:e.eventName)},isSeriesResultPage(){return this.$route.name=="seriesResults"}}},It={key:0,id:"top",class:"navbar navbar-light bg-light"},Vt={class:"container-fluid"},Ut={class:"navbar-brand h2",href:"#"},qt={key:1},jt=t("p",{class:"mt-3"},"View Individual Event Times:",-1),Yt={class:"nav nav-tabs mt-1 justify-content-center"},Ht={key:0},Gt={key:1};function Wt(e,s,n,d,i,o){const y=C("RouterLink");return a(),r(u,null,[o.headerName?(a(),r("nav",It,[t("div",Vt,[t("div",Ut,c(o.headerName),1)])])):m("",!0),i.races.length>1?(a(),r("div",qt,[jt,t("ul",Yt,[(a(!0),r(u,null,D(i.races,v=>(a(),r("li",{key:v.raceid,class:"nav-item"},[b(y,{class:O(["nav-link",{active:e.$route.params.id===v.raceid&&e.$route.name=="raceResult"}]),to:`/result/${v.raceid}`},{default:P(()=>[N(c(v.eventName+` - ${v.formattedStartDate}`),1)]),_:2},1032,["class","to"])]))),128)),o.isSeriesResultPage?m("",!0):(a(),r("li",Ht,[b(y,{class:O(["nav-link",{active:e.$route.name=="seriesResults"}]),to:{name:"seriesResults",params:{seriesid:n.series}}},{default:P(()=>[N("Overall Standings")]),_:1},8,["class","to"])])),o.hasTeamComp?(a(),r("li",Gt,[b(y,{class:O(["nav-link",{active:e.$route.name=="teamCompResults"}]),to:{name:"teamCompResults",params:{seriesid:n.series}}},{default:P(()=>[N("Team Competition Standings")]),_:1},8,["class","to"])])):m("",!0)])])):m("",!0)],64)}const I=S(At,[["render",Wt]]);const Kt={components:{ResultRow:H,SeriesNavBar:I},data(){return{resultData:{},categories:{},loading:!1,error:null,formattedStartDate:"",series:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{scrollMeTo(e){var s=document.querySelector(`#${e}`);s.scrollIntoView({behavior:"smooth"})},fetchData(){if(this.error=null,this.loading=!0,this.$route.params.id){let e=`/api/results/${this.$route.params.id}`;T(e).then(({data:s})=>{this.formattedStartDate=s.formattedStartDate,this.series=s.series,this.resultData=s,this.loading=!1,this.categories=s.categories}).catch(s=>{console.error(s),this.categories={},s.response.status==404?this.error="":this.error=s.toString(),this.loading=!1})}else this.$router.push("")},metaColumns(e){return e.slice(0,4)},lapColumns(e){let s=[];for(let n=1;n<=e.length;n++)s.push(`Lap ${n}`);return this.fastestLapScoring?s.push("Fastest Lap:"):s.push("Total"),s.push("Time Behind Leader"),s}},computed:{fastestLapScoring(){return this.resultData.scoringType=="fastestlap"},sortedCats(){return _.orderBy(this.categories,"disporder")},haveResults(){return this.categories?Object.keys(this.categories).length>0:!1}}},zt={key:0,class:"text-center"},Jt={class:"mt-5"},Qt={key:1,class:"text-center"},Xt={class:"mt-5"},Zt={key:2,class:"loading"},es={key:3},ts={key:0,class:"error"},ss={key:1},as={id:"top",class:"container text-center mt-5"},rs={class:"list-inline"},is=["onClick"],os={class:"container-fluid"},ns=["id"],ls={class:"table table-striped table-hover"},cs={key:2},ds=t("div",{class:"text-center"},[t("h2",{class:"mt-5"},"No results yet...")],-1),us=[ds];function hs(e,s,n,d,i,o){const y=C("SeriesNavBar"),v=C("ResultRow");return a(),r(u,null,[b(y,{series:i.series},null,8,["series"]),i.resultData.eventName?(a(),r("div",zt,[t("h2",Jt,"Race Results - "+c(i.resultData.eventName),1)])):m("",!0),i.formattedStartDate?(a(),r("div",Qt,[t("h2",Xt,c(i.formattedStartDate),1)])):m("",!0),i.loading?(a(),r("div",Zt,"Loading...")):(a(),r("div",es,[i.error?(a(),r("div",ts,c(i.error),1)):m("",!0),o.haveResults?(a(),r("div",ss,[t("div",as,[t("ul",rs,[(a(!0),r(u,null,D(o.sortedCats,(l,p)=>(a(),r("li",{key:l.id,class:"list-inline-item mx-2"},[t("a",{role:"button",onClick:h=>o.scrollMeTo(l.id),class:"link-primary"},c(l.catdispname),9,is)]))),128))])]),t("div",os,[(a(!0),r(u,null,D(o.sortedCats,(l,p)=>(a(),r("div",{key:l.id,class:"mt-5"},[t("h3",{id:l.id},c(l.catdispname),9,ns),t("table",ls,[t("thead",null,[t("tr",null,[(a(!0),r(u,null,D(o.metaColumns(l.columns),(h,g)=>(a(),r("th",{scope:"col",key:g},c(h),1))),128)),(a(!0),r(u,null,D(o.lapColumns(l.results[0].laps),(h,g)=>(a(),r("th",{scope:"col",key:g},c(h),1))),128))])]),t("tbody",null,[(a(!0),r(u,null,D(l.results,(h,g)=>(a(),r("tr",{key:g},[b(v,{totLaps:l.results[0].laps.length,Pos:g,data:h,showMillis:i.resultData.showMillis||o.fastestLapScoring},null,8,["totLaps","Pos","data","showMillis"])]))),128))])]),t("a",{role:"button",onClick:s[0]||(s[0]=h=>o.scrollMeTo("top")),class:"link-primary"},"Back to Top")]))),128))])])):(a(),r("div",cs,us))]))],64)}const ms=S(Kt,[["render",hs]]);const ps={props:["data","Pos"],data(){return{count:0}},computed:{}};function _s(e,s,n,d,i,o){return a(),r(u,null,[t("td",null,c(n.Pos+1),1),t("td",null,c(n.data.Bib),1),t("td",null,c(n.data.Name),1),t("td",null,c(n.data.Age),1),t("td",null,c(n.data.Sponsor),1),(a(!0),r(u,null,D(n.data.results,(y,v)=>(a(),r("td",{class:O({"text-danger":y.dropped}),key:v},c(y.resultString),3))),128)),t("td",null,c(n.data.seriesPoints),1)],64)}const G=S(ps,[["render",_s]]);const ys={components:{SeriesResultRow:G,SeriesNavBar:I},data(){return{categories:{},loading:!1,error:null,displayName:"",series:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{scrollMeTo(e){var s=document.querySelector(`#${e}`);s.scrollIntoView({behavior:"smooth"})},fetchData(){if(!this.$route.params.seriesid)return;this.error=null,this.loading=!0;let e=`/api/series/results/${this.$route.params.seriesid}`;T(e).then(({data:s})=>{this.loading=!1,this.categories=s.categories,this.displayName=s.eventName,this.series=this.$route.params.seriesid,_.map(s.categories,n=>_.omit(n,["results","columns"]))}).catch(s=>{console.error(s),this.categories={},this.error=s.toString()})}},computed:{sortedCats(){return _.orderBy(this.categories,"disporder")},haveResults(){return this.categories?Object.keys(this.categories).length>0:!1},isPCRS(){return _.isString(this.series)&&this.series.indexOf("pcrs")>-1}}},gs={key:0,class:"loading"},fs={key:1},vs={key:0,class:"error"},bs={class:"container-fluid text-center mt-5"},Ds=t("h3",null,"Series Standings",-1),$s=t("p",null,"Glossary of terms below:",-1),ks={key:0},Cs={key:1},Rs={key:1},Ss={class:"container-fluid text-center mt-5"},ws={class:"list-inline"},Ts=["onClick"],xs={class:"container-fluid"},Ps=["id"],Ns={class:"table table-striped table-hover"},Os={key:2},Es=t("div",{class:"text-center"},[t("h2",{class:"mt-5"},"No results yet...")],-1),Bs=[Es];function Ms(e,s,n,d,i,o){const y=C("SeriesNavBar"),v=C("SeriesResultRow");return a(),r(u,null,[b(y,{series:i.series,displayName:i.displayName},null,8,["series","displayName"]),i.loading?(a(),r("div",gs,"Loading...")):(a(),r("div",fs,[i.error?(a(),r("div",vs,c(i.error),1)):m("",!0),t("div",bs,[Ds,$s,o.isPCRS?(a(),r("p",ks,"1/50 = 1st Place/50 Points   -/- = Did not race")):(a(),r("p",Cs,"1/100 = 1st Place/100 Points   -/- = Did not race"))]),o.haveResults?(a(),r("div",Rs,[t("div",Ss,[t("ul",ws,[(a(!0),r(u,null,D(o.sortedCats,l=>(a(),r("li",{key:l.id,class:"list-inline-item mx-2"},[t("a",{role:"button",onClick:p=>o.scrollMeTo(l.id),class:"link-primary"},c(l.catdispname),9,Ts)]))),128))])]),t("div",xs,[(a(!0),r(u,null,D(o.sortedCats,l=>(a(),r("div",{key:l.id,class:"mt-5"},[t("h3",{id:l.id},c(l.catdispname),9,Ps),t("table",Ns,[t("thead",null,[t("tr",null,[(a(!0),r(u,null,D(l.columns,(p,h)=>(a(),r("th",{scope:"col",key:h},c(p),1))),128))])]),t("tbody",null,[(a(!0),r(u,null,D(l.results,(p,h)=>(a(),r("tr",{key:h},[b(v,{Pos:h,data:p},null,8,["Pos","data"])]))),128))])]),t("a",{role:"button",onClick:s[0]||(s[0]=p=>o.scrollMeTo("top")),class:"link-primary"},"Back to Top")]))),128))])])):(a(),r("div",Os,Bs))]))],64)}const Fs=S(ys,[["render",Ms]]),Ls={props:["categories","raceDate"],data(){return{}},methods:{formatStartTime(e){return R(`${R(this.raceDate).format("YYYY-MM-DD")} ${e}`).format("h:mm A")}},computed:{groupByStartTimes(){let e=this.categories.toSorted((s,n)=>R(s.startTime,"H:mm").diff(R(n.startTime,"H:mm")));return _.groupBy(e,"startTime")},hasStartTimes(){return!!_.some(this.categories,"startTime")}}},As={key:0},Is=t("h5",null,"Race Start Times:",-1),Vs={class:"row gap-5 mb-3"},Us={class:""},qs={class:"row g-2 px-4 gx-4 border bg-light"};function js(e,s,n,d,i,o){return n.categories.length&&o.hasStartTimes?(a(),r("div",As,[Is,t("div",Vs,[(a(!0),r(u,null,D(o.groupByStartTimes,(y,v)=>(a(),r("div",{key:v,class:"col-md-5"},[t("h6",Us,c(o.formatStartTime(v))+":",1),t("div",qs,[(a(!0),r(u,null,D(o.groupByStartTimes[v],l=>(a(),r("div",{key:l.id,class:"col-lg text-nowrap my-1"},c(l.catdispname),1))),128))])]))),128))])])):m("",!0)}const Ys=S(Ls,[["render",js]]);let Hs=_.debounce((e,s)=>{window.localStorage.setItem(`race-reg-form-data-${s}`,JSON.stringify(e))},3500),Gs=e=>{let s=window.localStorage.getItem(`race-reg-form-data-${e}`);if(s){let n={};try{n=JSON.parse(s)}catch{}return n}return null},Ws=e=>{window.localStorage.removeItem(`race-reg-form-data-${e}`)};function Ks(e){if(e===0)return 0;let s=e*100,n=s*.04;return n>600&&(n=600),Math.round((s+n+30)/(1-.029))-s}const zs={components:{MainNav:M,EventDetailsComponent:B,EventCategoryScheduleComponent:Ys},data(){return{categories:{},loading:!1,error:null,formError:[],formInputData:{},raceData:null,seriesData:null,payment:"",birthdate:"",submitted:!1,waiverAccepted:!1,couponError:[],prevBibError:[],seriesRaces:{},seriesRaceIdx:0,previousReg:!1,prevAge:null,originalPaymentOptions:null}},created(){this.$watch(()=>this.$route.params.raceid,()=>{this.fetchData()},{immediate:!0})},watch:{formInputData:{handler(e,s){this.previousReg==!1&&Hs(e,this.$route.params.raceid)},deep:!0}},methods:{dollas(e){return e.toLocaleString("en-US",{style:"currency",currency:"USD"})},fetchData(){this.error=null,this.loading=!0,this.$route.params.raceid&&T(`/api/races/${this.$route.params.raceid}`).then(async e=>{var n,d;this.raceData=e.data,console.log("=== Race Data Loaded ==="),console.log("seriesData:",this.raceData.seriesData),console.log("categoryGroups:",(n=this.raceData.seriesData)==null?void 0:n.categoryGroups),console.log("regCategories:",this.raceData.regCategories),console.log("paymentOptions:",this.raceData.paymentOptions);let s=Gs(this.$route.params.raceid);s&&(_.find((d=this.raceData)==null?void 0:d.regCategories,{id:s.category})||delete s.category,s.waiverAccepted=!1,this.formInputData=s),!this.raceData.disableSeriesRedirect&&this.raceData.series&&this.raceData.toString().length>1&&this.$route.name!=="register-test"&&await T(`/api/series/${this.raceData.series}/registration`).then(({data:i})=>{this.seriesRaces=i;let o=R();this.seriesRaceIdx=0,_.some(i,({eventDate:y,raceid:v},l)=>R(y).isBefore(o)?!1:(this.seriesRaceIdx=l,this.$route.params.raceid!==v&&this.$router.push(`/register/${v}`),!0))}),this.loading=!1,this.raceData.paymentOptions&&this.raceData.paymentOptions.length>0&&(this.payment=this.raceData.paymentOptions[0].type)}).catch(e=>{if(this.raceData=null,this.loading=!1,this.error=e.toString(),e.code=="ERR_BAD_REQUEST")return console.warn("tried to load raceid: "+this.$route.params.raceid),console.warn(e.message);console.error(e)})},findPrevBib(e){T.post("/api/racers/bib",{series:`${this.raceData.series}`,bibNumber:e}).then(({data:s})=>{if(console.log("prevbib"),s.paytype==="season"){this.prevBibError=["You are already registered for the whole season. You do not need to register every week."];return}s.prevPaymentId=s.paymentId,delete s.optionalPurchases,delete s.paymentId,this.formInputData=s,this.prevAge=s.racerAge}).catch(({response:s})=>{console.dir(s),s.status==404&&(this.prevBibError=[s.data.message])})},onPrevBibChange(e){e?this.findPrevBib(e):(this.prevBibError=[],this.prevAge=null)},getCouponPricing(e){this.originalPaymentOptions||(this.originalPaymentOptions=_.cloneDeep(this.raceData.paymentOptions)),T.post("/api/payments/pricing",{raceid:`${this.$route.params.raceid}`,couponCode:e}).then(({data:s})=>{if(this.raceData.paymentOptions=s.paymentOptions,s.validCoupon)this.couponError=[];else{if(s.reason)return this.couponError=[s.reason];this.couponError=["Invalid Coupon Code"]}})},onCouponChange(e){e?this.getCouponPricing(e):(this.couponError=[],this.originalPaymentOptions&&(this.raceData.paymentOptions=_.cloneDeep(this.originalPaymentOptions),this.originalPaymentOptions=null))},submitForm(e){e.preventDefault(),this.$formkit.submit("race-registration")},async submit(e){console.log(e),e.birthdate=void 0,e.racerAge=this.racerAge,e.paytype=this.payment,e.timestamp=R().format(),await T.post(`/api/payments/start-registration?race=${this.raceData.raceid}`,e).then(s=>{if(s.data){if(console.log("response data"),console.log(s.data),s.data.redirect)return this.submitted=!0,Ws(this.$route.params.raceid),new Promise(n=>setTimeout(()=>{window.location.href=s.data.redirect,n()},2e3));s.data.message&&(this.formError=[s.data.message])}}).catch(s=>{var n,d;if((d=(n=s.response)==null?void 0:n.data)!=null&&d.message)return this.formError=[s.response.data.message];this.formError=["Error submitting request"]})},getEventTimeObj(e){return R(`${R(this.raceData.eventDate).format("YYYY-MM-DD")} ${e}`)},isSeriesCategory(e){var s,n;return(n=(s=this.raceData)==null?void 0:s.seriesData)!=null&&n.regCategories?this.raceData.seriesData.regCategories.some(d=>d.id===e):!1},isRaceOverride(e){return e._isRaceOverride===!0},isPureSeriesCategory(e){return e._isSeriesCategory===!0},getSeriesPaymentGroup(e){var s,n;return(n=(s=this.raceData)==null?void 0:s.seriesData)!=null&&n.categoryGroups?this.raceData.seriesData.categoryGroups.find(d=>d.categories&&d.categories.includes(e)):null},getAvailablePaymentOptionsForCategory(e){var o,y,v,l,p,h;if(!e)return[];console.log("=== getAvailablePaymentOptionsForCategory (Hybrid Model) ==="),console.log("Category:",e.catdispname,e.id),console.log("seriesData:",(o=this.raceData)==null?void 0:o.seriesData);const s=new Map;(this.raceData.paymentOptions||[]).forEach(g=>{s.set(g.type,g)});const n=this.isSeriesCategory(e.id),d=this.isRaceOverride(e),i=this.isPureSeriesCategory(e);if(console.log(`Category ${e.catdispname}:`,{isSeriesCategory:n,isRaceOverride:d,isPureSeriesCategory:i,hasPaytype:!!e.paytype}),d&&e.paytype){const g=[],k=new Set,w=(y=this.raceData.paymentOptions)==null?void 0:y.find(f=>f.type===e.paytype);w&&(g.push({...w,source:"race-override-paytype"}),k.add(w.type),console.log(`Race override ${e.catdispname} with paytype ${e.paytype}, added matching race option:`,w));const $=this.getSeriesPaymentGroup(e.id);return $&&$.paymentOptions&&$.paymentOptions.length>0&&(console.log(`Race override ${e.catdispname} also has series group ${$.name}, checking group options:`,$.paymentOptions),$.paymentOptions.forEach(f=>{k.has(f.type)?console.log(`  Skipped series group option ${f.name} (${f.type}) - race override takes precedence`):(g.push({...f,source:"series-group"}),k.add(f.type),console.log(`  Added series group option: ${f.name} (${f.type})`))})),console.log(`Race override ${e.catdispname} final options with paytype:`,g),g}if(e._isRaceSpecific&&e.paytype){const g=(v=this.raceData.paymentOptions)==null?void 0:v.find(k=>k.type===e.paytype);return g?(console.log(`Race-specific category ${e.catdispname} with paytype ${e.paytype}:`,g),[{...g,source:"race-paytype"}]):(console.warn(`Race-specific category ${e.catdispname} has paytype ${e.paytype} but no matching race payment option found`),[])}if(d&&!e.paytype)return console.log(`Race override ${e.catdispname} without paytype, using all race payment options`),(this.raceData.paymentOptions||[]).map(g=>({...g,source:"race-override"}));if(i){const g=this.getSeriesPaymentGroup(e.id);if(console.log("Found payment group:",g),e.paytype){const k=[],w=new Set,$=(l=this.raceData.paymentOptions)==null?void 0:l.find(f=>f.type===e.paytype);if($)console.log(`Series category ${e.catdispname} with paytype ${e.paytype}, adding race option:`,$),k.push({...$,source:"race-paytype"}),w.add(e.paytype);else if((p=this.raceData.seriesData)!=null&&p.defaultPaymentOptions){const f=this.raceData.seriesData.defaultPaymentOptions.find(x=>x.type===e.paytype);f&&(console.log(`Series category ${e.catdispname} with paytype ${e.paytype}, adding series default:`,f),k.push({...f,source:"series-default-paytype"}),w.add(e.paytype))}return g&&g.paymentOptions&&g.paymentOptions.length>0&&(console.log(`Series category ${e.catdispname} with paytype also has group ${g.name}, adding group options`),g.paymentOptions.forEach(f=>{if(!w.has(f.type)){if(s.has(f.type)){const x=s.get(f.type);console.log(`  Race overrides group ${f.type}: ${f.name} -> ${x.name}`),k.push({...f,name:x.name,amount:x.amount,source:"race-override-group"})}else k.push({...f,source:"series-group"});w.add(f.type)}})),k.length>0?(console.log(`Series category ${e.catdispname} final options with paytype:`,k),k):(console.warn(`Series category ${e.catdispname} has paytype ${e.paytype} but no matching payment option found`),[])}if(g&&g.paymentOptions&&g.paymentOptions.length>0){console.log(`Category ${e.catdispname} is in series group ${g.name}`);const k=g.paymentOptions.map(f=>{if(s.has(f.type)){const x=s.get(f.type);return console.log(`Race overrides ${f.type}: ${f.name} ($${f.amount}) -> ${x.name} ($${x.amount})`),{...f,name:x.name,amount:x.amount,source:"race-override-group"}}return{...f,source:"series-group"}}),w=new Set(g.paymentOptions.map(f=>f.type)),$=(this.raceData.paymentOptions||[]).filter(f=>!w.has(f.type)).map(f=>({...f,source:"race-additional"}));return $.length>0&&(console.log("Adding race-specific payment options not in group:",$),k.push(...$)),console.log("Final merged payment options (group + race):",k),k}if((h=this.raceData.seriesData)!=null&&h.defaultPaymentOptions&&this.raceData.seriesData.defaultPaymentOptions.length>0){console.log(`Category ${e.catdispname} uses series default payment options`);const k=this.raceData.seriesData.defaultPaymentOptions.map(f=>{if(s.has(f.type)){const x=s.get(f.type);return console.log(`Race overrides ${f.type}: ${f.name} ($${f.amount}) -> ${x.name} ($${x.amount})`),{...f,name:x.name,amount:x.amount,source:"race-override-default"}}return{...f,source:"series-default"}}),w=new Set(this.raceData.seriesData.defaultPaymentOptions.map(f=>f.type)),$=(this.raceData.paymentOptions||[]).filter(f=>!w.has(f.type)).map(f=>({...f,source:"race-additional"}));return $.length>0&&(console.log("Adding race-specific payment options not in defaults:",$),k.push(...$)),console.log("Final merged payment options (defaults + race):",k),k}}return console.log(`Category ${e.catdispname} uses race payment options:`,this.raceData.paymentOptions),(this.raceData.paymentOptions||[]).map(g=>({...g,source:"race"}))}},computed:{startTimes(){return this.hasStartTimes?_.map(_.uniqBy(this.raceData.regCategories,"startTime"),"startTime"):null},hasStartTimes(){return!!_.some(this.raceData.regCategories,"startTime")},currentTime(){return R().local().format()},firstRaceTime(){return this.hasStartTimes?R.min(_.map(this.startTimes,e=>R(`${this.eventDateFormatted} ${e}`))):null},lastRaceTime(){return this.hasStartTimes?R.max(_.map(this.startTimes,e=>R(`${this.eventDateFormatted} ${e}`))):null},sortedCats(){const e=_.filter(this.raceData.regCategories,n=>!0);let s={};return _.forEach(_.orderBy(e,"disporder"),n=>{s[n.id]=n.catdispname}),s},loaded(){return!!this.raceData},submitLabel(){return this.payment=="cash"||this.sponsoredCategorySelected?"Sign Up!":"Go to Payment"},cashEnabled(){return!!this.raceData.cashPaymentsEnabled},eventDateFormatted(){return R(this.raceData.eventDate).format("YYYY-MM-DD")},regDisabled(){return this.$route.name=="register-test"?!1:this.eventFull||R().isBefore(this.raceData.eventDetails.regOpenDate)||this.raceData.eventDetails.regCloseDate&&R().isAfter(this.raceData.eventDetails.regCloseDate)?!0:this.lastRaceTime?R().isAfter(this.lastRaceTime.subtract(5,"minute")):!1},eventFull(){return!!(this.raceData.entryCountMax&&this.raceData.entryCountMax>1&&this.raceData.entryCount>=this.raceData.entryCountMax)},paymentOptions(){let e={};if(!this.selectedCategory)return console.log("No category selected, showing no payment options"),e;console.log("=== Building paymentOptions (Hybrid Model) ==="),console.log("Selected category:",this.selectedCategory.catdispname,this.selectedCategory.id);const s=this.getAvailablePaymentOptionsForCategory(this.selectedCategory);console.log("Available payment options for category:",s);const n=_.sortBy(s,d=>parseFloat(d.amount||0));return _.forEach(n,d=>{if(console.log("Processing payment option:",d.type,d.name,d),d.type==="season"&&d.categoryGroups&&this.formInputData.category){const i=d.categoryGroups.find(o=>o.categories.includes(this.formInputData.category));i?e[d.type]=i.name:d.defaultName?e[d.type]=d.defaultName:e[d.type]=d.name}else e[d.type]=d.name}),this.cashEnabled&&!this.selectedCategory.sponsored&&(e.cash="Cash Payment (This Race Only)"),console.log("Final payment options object:",e),console.log("Final payment options count:",Object.keys(e).length),e},paymentCostDets(){var y,v,l,p;if(!this.selectedCategory)return{};if(this.paymenttypeRequiredCategorySelected&&(this.payment=(y=this.selectedCategory)==null?void 0:y.paytype),this.sponsoredCategorySelected)return this.payment="season",{cost:this.dollas(0),regFee:this.dollas(0),tot:this.dollas(0)};let e;this.payment==="cash"?e="single":e=this.payment;const s=this.getAvailablePaymentOptionsForCategory(this.selectedCategory);let n=s.find(h=>h.type===e);if(n||(console.log("Selected payment type not found, selecting first available"),s.length>0?(n=s[0],this.payment=n.type):(n=(l=(v=this.raceData)==null?void 0:v.paymentOptions)==null?void 0:l[0],n&&(this.payment=n.type))),!n)return console.error("No payment option found"),{};if(n.categoryGroups&&this.formInputData.category){const h=n.categoryGroups.find(g=>g.categories.includes(this.formInputData.category));h?n={...n,amount:h.amount,name:h.name}:n.defaultAmount!==void 0&&(n={...n,amount:n.defaultAmount,name:n.defaultName||n.name})}const d=parseFloat(n.amount);let i=0;d>0&&this.payment!=="cash"&&(i=(n.regFee+n.stripeFee)/100);const o={};if(_.assign(o,n,{name:n.name,cost:this.dollas(d),regFee:this.dollas(i),tot:this.dollas(parseFloat(n.amount)+parseFloat(i))}),(p=this.raceData)!=null&&p.optionalPurchases&&this.formInputData.optionalPurchases){let h=d;this.raceData.optionalPurchases.forEach(({id:g,label:k,description:w,amount:$})=>{this.formInputData.optionalPurchases[g]&&(o.options||(o.options=[]),o.options.push({description:w,label:k,id:g,amount:this.dollas(parseFloat($))}),h+=parseFloat($))}),i=Ks(h)/100,o.regFee=this.dollas(i),o.tot=this.dollas(h+i)}return o},showPaymentOption(){console.log("=== showPaymentOption ==="),console.log("paymenttypeRequiredCategorySelected:",this.paymenttypeRequiredCategorySelected),console.log("sponsoredCategorySelected:",this.sponsoredCategorySelected),console.log("cashEnabled:",this.cashEnabled);const e=this.selectedCategory?this.getAvailablePaymentOptionsForCategory(this.selectedCategory):[];return console.log("Available payment options count:",e.length),this.paymenttypeRequiredCategorySelected?(console.log("Hiding because paymenttypeRequiredCategorySelected"),!1):this.sponsoredCategorySelected?(console.log("Hiding because sponsoredCategorySelected"),!1):this.cashEnabled?(console.log("Showing because cashEnabled"),!0):e.length<2?(console.log("Hiding because only 1 payment option available for this category"),!1):(console.log("Showing payment options"),!0)},paymenttypeRequiredCategorySelected(){if(console.log("=== paymenttypeRequiredCategorySelected (Hybrid Model) ==="),console.log("selectedCategory:",this.selectedCategory),!this.selectedCategory)return console.log("Returning true (no category selected)"),!0;const e=this.getAvailablePaymentOptionsForCategory(this.selectedCategory);return console.log("Available payment options:",e.length),e.length<=1&&!this.cashEnabled?(console.log("Returning true (only one payment option)"),!0):(console.log("Returning false (multiple payment options available)"),!1)},sponsoredCategorySelected(){var e;return!!((e=this.selectedCategory)!=null&&e.sponsored)},selectedCategory(){var e,s;return this.formInputData&&this.formInputData.category?_.find((e=this.raceData)==null?void 0:e.regCategories,{id:(s=this.formInputData)==null?void 0:s.category}):null},racerAge(){if(this.prevAge)return this.prevAge;if(this.birthdate){const e=R(),s=R(this.birthdate);return e.year()-s.year()}}}},Js={key:0,class:"loading"},Qs={key:1},Xs={key:0,class:"error"},Zs={key:1},ea={key:0,class:"h5"},ta={key:1},sa=t("h3",null,"Registration is closed.",-1),aa=[sa],ra={key:2,class:"mb-5"},ia=["innerHTML"],oa={key:1},na={class:"row"},la={class:"col-md-6 order-md-1 mb-3"},ca=t("h4",{class:"d-flex justify-content-between align-items-center mb-3"},[t("h5",null,"Registration Info"),t("span",{class:"badge badge-secondary badge-pill"},"3")],-1),da={class:"form-group pt-3"},ua={key:1,class:"fw-bolder"},ha={class:"form-group pt-3"},ma={key:0,class:"col-md-5 order-md-2 mb-4"},pa=t("h4",{class:"d-flex justify-content-between align-items-center mb-3"},[t("h5",null,"Payment Detail")],-1),_a={class:"list-group mb-3"},ya={class:"list-group mb-3"},ga={key:0},fa={class:"list-group mb-3"},va=["innerHTML"],ba={class:"list-group mb-3 formkit-fieldset"},Da={class:"list-group-item d-flex justify-content-between lh-condensed"},$a=t("h6",{class:"my-0"},"Event Entry:",-1),ka={class:"text-muted"},Ca={key:0,class:"mx-3 text-decoration-line-through text-danger"},Ra={class:"list-group-item d-flex justify-content-between lh-condensed"},Sa={class:"my-0"},wa={key:0,class:"text-muted"},Ta={class:"list-group-item d-flex justify-content-between lh-condensed"},xa=t("div",null,[t("h6",{class:"my-0"},"Online Processing Fee:"),t("small",{class:"text-muted"},"Credit Card Processing and Online Registration")],-1),Pa={class:"text-muted"},Na={class:"list-group-item d-flex justify-content-between"},Oa=t("span",null,"Total (USD)",-1),Ea={key:0},Ba={class:"mb-5"},Ma={key:1},Fa=t("h2",{class:"text-danger"},"Your registration will not be active until payment is received at the event",-1),La=[Fa],Aa={key:2},Ia=["innerHTML"],Va={key:1},Ua={key:2},qa=t("h2",null,"Submission successful, redirecting",-1),ja=[qa],Ya={key:2},Ha=t("div",{class:"text-center"},[t("h2",{class:"mt-5"},"Race not found...")],-1),Ga=[Ha];function Wa(e,s,n,d,i,o){var h,g;const y=C("MainNav"),v=C("EventDetailsComponent"),l=C("FormKit"),p=C("EventCategoryScheduleComponent");return a(),r(u,null,[b(y),i.loading?(a(),r("div",Js,"Loading...")):(a(),r("div",Qs,[i.error?(a(),r("div",Xs,c(i.error),1)):m("",!0),o.loaded?(a(),r("div",Zs,[b(v,{details:i.raceData.eventDetails,raceid:i.raceData.raceid},null,8,["details","raceid"]),o.eventFull?(a(),r("div",ea,"This event has reached the registration entry max of "+c(i.raceData.entryCountMax),1)):m("",!0),o.regDisabled?(a(),r("div",ta,aa)):(a(),r("div",ra,[(h=i.raceData)!=null&&h.headerContent?(a(),r("div",{key:0,class:"mb-3",innerHTML:i.raceData.headerContent},null,8,ia)):m("",!0),((g=i.raceData)==null?void 0:g.seriesRaceNumber)>1?(a(),r("div",oa,[b(l,{"label-class":"text-danger fw-bold fs-5",type:"checkbox",name:"prevBibLookup",label:"I have a bib number!",help:"Look up your information from a previous race in this series",modelValue:i.previousReg,"onUpdate:modelValue":s[0]||(s[0]=k=>i.previousReg=k)},null,8,["modelValue"]),i.previousReg?(a(),E(l,{key:0,type:"number",name:"bibNumber",label:"Bib Number:",help:"Enter your Bib Number from your previous race to pre-fill your info",delay:1500,onInput:o.onPrevBibChange,errors:i.prevBibError,validation:"required"},null,8,["onInput","errors"])):m("",!0)])):m("",!0),b(l,{type:"form",id:"race-registration",modelValue:i.formInputData,"onUpdate:modelValue":s[4]||(s[4]=k=>i.formInputData=k),"form-class":i.submitted?"hide":"show",errors:i.formError,actions:!1,onSubmit:o.submit},{default:P(()=>{var k,w;return[t("div",na,[t("div",la,[ca,b(l,{type:"text",name:"first_name",label:"First name",help:"What is your first name",validation:"required"}),b(l,{type:"text",name:"last_name",label:"Last name",help:"What is your last name",validation:"required"}),t("div",da,[i.previousReg?m("",!0):(a(),E(l,{key:0,type:"email",name:"email",label:"Your email",help:"Enter an email address",validation:"required|email"}))]),b(l,{type:"text",name:"sponsor",label:"Your Team or Sponsor",help:"Enter an optional Team or Sponsor name",maxlength:"25"}),!((k=i.raceData)!=null&&k.disableAge)&&!i.previousReg?(a(),E(l,{key:0,type:"date",name:"birthdate",label:"Birthday",modelValue:i.birthdate,"onUpdate:modelValue":s[1]||(s[1]=$=>i.birthdate=$),help:"Tap on the year at the top of the popup to change it",validation:"required|before:2020-01-01","validation-visibility":"live"},null,8,["modelValue"])):m("",!0),(w=i.raceData)!=null&&w.disableAge?m("",!0):(a(),r("p",ua,"Racing Age (as of Dec 31): "+c(o.racerAge),1)),t("div",ha,[b(l,{type:"select",id:"category",label:"Category:",placeholder:"Select a category",name:"category",options:o.sortedCats,validation:"required","validation-visibility":"dirty","validation-messages":{is:"You must select a category"}},null,8,["options"])]),i.previousReg?m("",!0):(a(),E(l,{key:2,type:"text",name:"contactNumber",label:"Phone Number",help:"If there is an issue on race day, we will try to contact you via this number"})),i.previousReg?m("",!0):(a(),E(l,{key:3,type:"text",name:"emergencyNumber",label:"Emergency Contact Name and Number",help:"In case of an emergency, we will contact this person"}))]),o.paymentCostDets?(a(),r("div",ma,[pa,t("fieldset",_a,[t("div",null,[i.raceData.couponsEnabled?(a(),E(l,{key:0,type:"text",name:"coupon",label:"Coupon Code",help:"",delay:1e3,onInput:o.onCouponChange,errors:i.couponError},null,8,["onInput","errors"])):m("",!0)])]),t("fieldset",ya,[t("div",null,[o.showPaymentOption?(a(),E(l,{key:0,type:"radio",name:"paytype",label:"Payment option",options:o.paymentOptions,validation:"required",modelValue:i.payment,"onUpdate:modelValue":s[2]||(s[2]=$=>i.payment=$)},null,8,["options","modelValue"])):m("",!0)])]),i.raceData.optionalPurchases&&(o.showPaymentOption||o.paymentCostDets.name)?(a(),r("div",ga,[b(l,{type:"group",name:"optionalPurchases"},{default:P(()=>[(a(!0),r(u,null,D(i.raceData.optionalPurchases,($,f)=>(a(),r("div",fa,[t("h6",{innerHTML:$.description},null,8,va),b(l,{type:"checkbox",label:`${$.label} - ${o.dollas(parseFloat($.amount))}`,name:$.id},null,8,["label","name"]),$.options&&i.formInputData.optionalPurchases[$.id]?(a(),E(l,{key:0,type:"select",options:$.options,label:$.optionsLabel,name:`${$.id}-option`},null,8,["options","label","name"])):m("",!0)]))),256))]),_:1})])):m("",!0),t("ul",ba,[t("li",Da,[t("div",null,[$a,t("small",ka,c(o.paymentCostDets.name),1)]),t("div",null,[o.paymentCostDets.discounted?(a(),r("span",Ca,c(o.dollas(o.paymentCostDets.orig)),1)):m("",!0),t("span",{class:O({"text-success":o.paymentCostDets.discounted})},c(o.paymentCostDets.cost),3)])]),o.paymentCostDets.options?(a(!0),r(u,{key:0},D(o.paymentCostDets.options,($,f)=>(a(),r("li",Ra,[t("div",null,[t("h6",Sa,c($.label),1),$.option?(a(),r("small",wa,c($.option),1)):m("",!0)]),t("div",null,[t("span",null,c($.amount),1)])]))),256)):m("",!0),t("li",Ta,[xa,t("span",Pa,c(o.paymentCostDets.regFee),1)]),t("li",Na,[Oa,t("strong",null,c(o.paymentCostDets.tot),1)])])])):m("",!0)]),o.sponsoredCategorySelected?(a(),r("div",Ea,[t("p",Ba,[t("h5",null,"Your "+c(o.selectedCategory.catdispname)+" race entry is sponsored by "+c(o.selectedCategory.sponsorName),1)])])):m("",!0),i.payment==="cash"?(a(),r("div",Ma,La)):m("",!0),i.raceData.waiver?(a(),r("div",Aa,[i.raceData.waiver.format=="html"?(a(),r("div",{key:0,innerHTML:i.raceData.waiver.text},null,8,Ia)):(a(),r("div",Va,[t("h5",null,c(i.raceData.waiver.header),1),t("p",null,c(i.raceData.waiver.text),1)])),b(l,{type:"checkbox",modelValue:i.waiverAccepted,"onUpdate:modelValue":s[3]||(s[3]=$=>i.waiverAccepted=$),label:"I HAVE READ AND UNDERSTAND THIS WAIVER",help:"I acknowledge that I have read, understand, and accepted the above release of liability.",name:"waiverAccepted",validation:"accepted","validation-messages":{accepted:"You must agree to the terms of the liability release above"},"validation-visibility":"live"},null,8,["modelValue"])])):m("",!0),b(l,{type:"submit",label:o.submitLabel,onClick:o.submitForm},null,8,["label","onClick"])]}),_:1},8,["modelValue","form-class","errors","onSubmit"]),i.submitted?(a(),r("div",Ua,ja)):m("",!0)])),b(p,{categories:i.raceData.regCategories,raceDate:i.raceData.eventDate},null,8,["categories","raceDate"])])):(a(),r("div",Ya,Ga))]))],64)}const U=S(zs,[["render",Wa]]);const Ka={components:{EventDetailsComponent:B,MainNav:M},data(){return{categories:{},loading:!1,error:null,raceData:{},regData:{},payment:"",payStatus:!1}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{fetchData(){this.error=null,this.loading=!0,this.$route.params.raceid&&this.$route.params.payment_id&&T(`/api/races/${this.$route.params.raceid}`).then(e=>(this.raceData=e.data,T(`/api/payments/status?payment_id=${this.$route.params.payment_id}`).then(s=>{var n;this.loading=!1,this.payStatus=s.data.status,this.paymentUrl=(n=s.data.stripePayment)==null?void 0:n.url,this.regData=s.data.regData,this.payment=s.data.regData.paytype}))).catch(e=>{this.error="Failed to load race "+this.$route.params.raceid,console.error(e)})}},computed:{sortedCats(){let e={};return _.forEach(_.orderBy(this.raceData.regCategories,"disporder"),s=>{e[s.id]=s.catdispname}),e},loaded(){return!!this.raceData},paymentOptions(){let e={};return _.forEach(this.raceData.paymentOptions,s=>{e[s.type]=s.name}),e},pendingPayment(){return!!(this.regData.raceid!=this.$route.params.raceid||this.payStatus&&this.payStatus!="paid")},sponsoredCategorySelected(){var e;return!!((e=this.selectedCategory)!=null&&e.sponsored)},selectedCategory(){return _.find(this.raceData.regCategories,{id:this.regData.category})}}},za={key:0,class:"loading"},Ja={key:1},Qa={key:0,class:"error"},Xa={key:1},Za={class:"row"},er={class:"col-md-6 order-md-1"},tr={key:0},sr=t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[t("h4",null,"Your Registration is Confirmed")],-1),ar=[sr],rr={key:1,class:"mb-5"},ir=t("div",{class:"d-flex justify-content-between align-items-center mb-3 text-danger"},[t("h4",null,"Your Registration is Incomplete")],-1),or={key:0},nr=t("p",{class:"text-danger h5"},"Please make your cash payment at the event to complete your registration.",-1),lr=t("p",null,'Your name will not show up on the "Who is signed up" list until payment is completed.',-1),cr=[nr,lr],dr={key:1},ur=["href"],hr={class:"col"},mr={class:"row"},pr={class:"form-group pt-3"},_r={class:"form-group pt-3"},yr={key:2},gr={key:0},fr=["href"],vr={key:1},br=t("a",{href:"mailto:support@signup.bike"},"support@signup.bike",-1),Dr=[br],$r={key:2},kr={class:"text-center"},Cr={class:"mt-5"};function Rr(e,s,n,d,i,o){const y=C("MainNav"),v=C("EventDetailsComponent"),l=C("FormKit");return a(),r(u,null,[b(y),i.loading?(a(),r("div",za,"Loading...")):(a(),r("div",Ja,[i.error?(a(),r("div",Qa,c(i.error),1)):m("",!0),o.loaded?(a(),r("div",Xa,[b(v,{details:i.raceData.eventDetails,raceid:i.raceData.raceid},null,8,["details","raceid"]),b(l,{type:"form",id:"race-registration",disabled:"",actions:!1,modelValue:i.regData,"onUpdate:modelValue":s[0]||(s[0]=p=>i.regData=p)},{default:P(()=>[t("div",Za,[t("div",er,[o.pendingPayment?m("",!0):(a(),r("div",tr,ar)),o.pendingPayment?(a(),r("div",rr,[ir,i.payment==="cash"?(a(),r("div",or,cr)):(a(),r("div",dr,[t("a",{href:e.paymentUrl},"Complete your payment",8,ur)]))])):m("",!0),t("div",hr,[t("div",mr,[b(l,{type:"text",name:"first_name",label:"First name"}),b(l,{type:"text",name:"last_name",label:"Last name"})])]),t("div",pr,[b(l,{type:"email",name:"email",label:"Email"})]),t("div",_r,[b(l,{type:"text",name:"sponsor",label:"Your Team or Sponsor"}),b(l,{type:"select",label:"Race Category:",name:"category",options:o.sortedCats},null,8,["options"])]),o.sponsoredCategorySelected?(a(),r("div",yr,[t("h5",null," Your "+c(o.selectedCategory.catdispname)+" race entry is sponsored by "+c(o.selectedCategory.sponsorName),1)])):m("",!0)])])]),_:1},8,["modelValue"]),N(" Please send any corrections or questions to "),i.raceData.contactEmail?(a(),r("div",gr,[t("a",{href:`mailto:${i.raceData.contactEmail}`},c(i.raceData.contactEmail),9,fr)])):(a(),r("div",vr,Dr))])):(a(),r("div",$r,[t("div",kr,[t("h2",Cr," Unable to load requested information "+c(e.$route.params.raceid)+" payment: "+c(e.$route.params.payment_id),1)])]))]))],64)}const Sr=S(Ka,[["render",Rr]]);const wr={components:{SeriesResultRow:G,SeriesNavBar:A},data(){return{categories:{},loading:!1,error:null,displayName:"",series:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{scrollMeTo(e){var s=document.querySelector(`#${e}`);s.scrollIntoView({behavior:"smooth"})},fetchData(){if(!this.$route.params.seriesid)return;this.error=null,this.loading=!0;let e=`/api/series/results/${this.$route.params.seriesid}`;T(e).then(({data:s})=>{this.loading=!1,this.categories=s.categories,this.displayName=s.displayName,this.series=this.$route.params.seriesid;let n=_.map(s.categories,d=>_.omit(d,["results","columns"]));console.log("temp:",_.orderBy(n,"disporder"))}).catch(s=>{console.error(s),this.categories={},this.error=s.toString()})}},computed:{sortedCats(){let e;return this.$route.path.indexOf("grom")>-1?e=_.filter(this.categories,s=>s.id.indexOf("grom")>-1):e=_.filter(this.categories,s=>s.id.indexOf("grom")==-1),_.orderBy(e,"disporder")},expertCats(){return _.filter(this.sortedCats,{laps:4})},sportCats(){return _.filter(this.sortedCats,{laps:3})},beginnerCats(){return _.filter(this.sortedCats,{laps:2})},gromCats(){return this.$route.path.indexOf("grom")>-1?_.filter(this.categories,e=>e.id.indexOf("grom")>-1):[]},haveResults(){return this.categories?Object.keys(this.categories).length>0:!1}}},Tr={key:0,class:"loading"},xr={key:1},Pr={key:0,class:"error"},Nr={class:"container-fluid text-center mt-5"},Or=t("h3",null,"Series Standings",-1),Er=t("p",null,[N("Glossary of terms below:"),t("br"),N(" 1/50 = 1st Place/50 Points -/- = Did not race")],-1),Br={key:1},Mr={class:"container-fluid text-center mt-5"},Fr={class:"list-inline"},Lr=["onClick"],Ar={class:"list-inline"},Ir=["onClick"],Vr={class:"list-inline"},Ur=["onClick"],qr={class:"list-inline"},jr=["onClick"],Yr={class:"container-fluid"},Hr=["id"],Gr={class:"table table-striped table-hover"},Wr={key:2},Kr=t("div",{class:"text-center"},[t("h2",{class:"mt-5"},"No results yet...")],-1),zr=[Kr];function Jr(e,s,n,d,i,o){const y=C("SeriesNavBar"),v=C("SeriesResultRow");return a(),r(u,null,[b(y,{series:i.series},null,8,["series"]),i.loading?(a(),r("div",Tr,"Loading...")):(a(),r("div",xr,[i.error?(a(),r("div",Pr,c(i.error),1)):m("",!0),t("div",Nr,[t("h2",null,c(i.displayName),1),Or,Er]),o.haveResults?(a(),r("div",Br,[t("div",Mr,[t("ul",Fr,[(a(!0),r(u,null,D(o.expertCats,l=>(a(),r("li",{key:l.id,class:"list-inline-item mx-2"},[t("a",{role:"button",onClick:p=>o.scrollMeTo(l.id),class:"link-primary"},c(l.catdispname),9,Lr)]))),128))]),t("ul",Ar,[(a(!0),r(u,null,D(o.sportCats,l=>(a(),r("li",{key:l.id,class:"list-inline-item mx-2"},[t("a",{role:"button",onClick:p=>o.scrollMeTo(l.id),class:"link-primary"},c(l.catdispname),9,Ir)]))),128))]),t("ul",Vr,[(a(!0),r(u,null,D(o.beginnerCats,l=>(a(),r("li",{key:l.id,class:"list-inline-item mx-2"},[t("a",{role:"button",onClick:p=>o.scrollMeTo(l.id),class:"link-primary"},c(l.catdispname),9,Ur)]))),128))]),t("ul",qr,[(a(!0),r(u,null,D(o.gromCats,l=>(a(),r("li",{key:l.id,class:"list-inline-item mx-2"},[t("a",{role:"button",onClick:p=>o.scrollMeTo(l.id),class:"link-primary"},c(l.catdispname),9,jr)]))),128))])]),t("div",Yr,[(a(!0),r(u,null,D(o.sortedCats,l=>(a(),r("div",{key:l.id,class:"mt-5"},[t("h3",{id:l.id},c(l.catdispname),9,Hr),t("table",Gr,[t("thead",null,[t("tr",null,[(a(!0),r(u,null,D(l.columns,(p,h)=>(a(),r("th",{scope:"col",key:h},c(p),1))),128))])]),t("tbody",null,[(a(!0),r(u,null,D(l.results,(p,h)=>(a(),r("tr",{key:h},[b(v,{Pos:h,data:p},null,8,["Pos","data"])]))),128))])]),t("a",{role:"button",onClick:s[0]||(s[0]=p=>o.scrollMeTo("top")),class:"link-primary"},"Back to Top")]))),128))])])):(a(),r("div",Wr,zr))]))],64)}const q=S(wr,[["render",Jr]]),Qr={props:["data","Pos","dates"],data(){return{count:0}},computed:{}};function Xr(e,s,n,d,i,o){return a(),r(u,null,[t("td",null,c(n.data.Name),1),t("td",null,c(n.data.Cat),1),(a(!0),r(u,null,D(n.dates,(y,v)=>(a(),r("td",{key:v},c(n.data[y]||"-"),1))),128))],64)}const W=S(Qr,[["render",Xr]]);const Zr={components:{ResultRow:W,SeriesNavBar:A},data(){return{teamResults:{},loading:!1,error:null,series:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{scrollMeTo(e){var s=document.querySelector(`#${e}`);s.scrollIntoView({behavior:"smooth"})},fetchData(){if(!this.$route.params.seriesid)return;this.error=null,this.loading=!0;let e=`/api/team-comp?series=${this.$route.params.seriesid}`;T(e).then(({data:s})=>{this.loading=!1,this.series=this.$route.params.seriesid,this.teamResults=s,this.teamDates=s.teamCompDates}).catch(s=>{console.error(s),this.teamResults={},this.error=s.toString()})}},computed:{dates:()=>{}}},ei={key:0,class:"loading"},ti={key:1},si={key:0,class:"error"},ai=t("h2",{class:"mt-5"},"Team Standings",-1),ri={class:"container-fluid mt-5"},ii={class:"table table-striped table-hover"},oi=t("thead",null,[t("tr",null,[t("th",null,"Position"),t("th",null,"Team"),t("th",null,"Total Score")])],-1),ni=t("h2",{class:"mt-5"},"Team Results",-1),li={class:"container-fluid"},ci={class:"table table-striped table-hover"},di=t("thead",null,[t("tr",null,[t("th",{style:{width:"25%"}},"Racer Name"),t("th",{style:{width:"25%"}},"Class"),t("th",{style:{width:"12.5%"}},"5/4"),t("th",{style:{width:"12.5%"}},"5/11"),t("th",{style:{width:"12.5%"}},"5/18"),t("th",{style:{width:"12.5%"}},"5/25")])],-1),ui={class:"table table-striped table-hover"},hi=t("th",{style:{width:"50%","text-align":"right"}},"Score (Avg of individual results):",-1),mi={style:{width:"12.5%"}},pi={style:{width:"12.5%"}},_i={style:{width:"12.5%"}},yi={style:{width:"12.5%"}};function gi(e,s,n,d,i,o){const y=C("SeriesNavBar"),v=C("ResultRow");return a(),r(u,null,[b(y,{series:i.series},null,8,["series"]),i.loading?(a(),r("div",ei,"Loading...")):(a(),r("div",ti,[i.error?(a(),r("div",si,c(i.error),1)):m("",!0),ai,t("div",ri,[t("table",ii,[oi,t("tbody",null,[(a(!0),r(u,null,D(i.teamResults.result,(l,p)=>(a(),r("tr",{key:p},[t("td",null,c(p+1),1),t("td",null,c(l.teamName),1),t("td",null,c(l.totalScore),1)]))),128))])])]),ni,(a(!0),r(u,null,D(i.teamResults.result,(l,p)=>(a(),r("div",{class:"mt-5",key:p},[t("h3",null,c(l.teamName),1),t("div",li,[t("table",ci,[di,t("tbody",null,[(a(!0),r(u,null,D(i.teamResults.teamDets[l.teamName],(h,g)=>(a(),r("tr",{key:g},[b(v,{data:h,dates:e.teamDates},null,8,["data","dates"])]))),128))])]),t("table",ui,[t("thead",null,[t("tr",null,[hi,t("th",mi,c(l.results["5/4"]?l.results["5/4"].avg:"-"),1),t("th",pi,c(l.results["5/11"]?l.results["5/11"].avg:"-"),1),t("th",_i,c(l.results["5/18"]?l.results["5/18"].avg:"-"),1),t("th",yi,c(l.results["5/25"]?l.results["5/25"].avg:"-"),1)])])])])]))),128))]))],64)}const fi=S(Zr,[["render",gi]]);const vi={components:{ResultRow:W,SeriesNavBar:I},data(){return{teamResults:{},teamDates:[],loading:!1,error:null,series:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{scrollMeTo(e){var s=document.querySelector(`#${e}`);s.scrollIntoView({behavior:"smooth"})},fetchData(){if(!this.$route.params.seriesid)return;this.error=null,this.loading=!0;let e=`/api/team-comp?series=${this.$route.params.seriesid}`;T(e).then(({data:s})=>{this.loading=!1,this.series=this.$route.params.seriesid,this.teamResults=s,this.teamDates=s.teamCompDates}).catch(s=>{console.error(s),this.teamResults={},this.error=s.toString()})}},computed:{dates:()=>{},fivePlusTeams(){var e;return _.filter((e=this.teamResults)==null?void 0:e.result,s=>s.count>4)},threeFourTeams(){var e;return _.filter((e=this.teamResults)==null?void 0:e.result,s=>s.count<5)},sortedResults(){return _.sortBy(this.teamResults.result,"teamName")}}},bi={key:0,class:"loading"},Di={key:1},$i={key:0,class:"error"},ki=t("h2",{class:"mt-5"}," 5+ Team Standings",-1),Ci={class:"container-fluid mt-5"},Ri={class:"table table-striped table-hover"},Si=t("thead",null,[t("tr",null,[t("th",null,"Position"),t("th",null,"Team"),t("th",null,"Total Score")])],-1),wi=t("h2",{class:"mt-5"}," 3 Person Team Standings",-1),Ti={class:"container-fluid mt-5"},xi={class:"table table-striped table-hover"},Pi=t("thead",null,[t("tr",null,[t("th",null,"Position"),t("th",null,"Team"),t("th",null,"Total Score")])],-1),Ni=t("h2",{class:"mt-5"},"Team Results",-1),Oi={class:"container-fluid"},Ei={class:"table table-striped table-hover"},Bi=t("th",{style:{width:"25%"}},"Racer Name",-1),Mi=t("th",{style:{width:"25%"}},"Class",-1),Fi=t("td",{colspan:"2",style:{"text-align":"right"}},"Score (Avg of individual results):",-1);function Li(e,s,n,d,i,o){const y=C("SeriesNavBar"),v=C("ResultRow");return a(),r(u,null,[b(y,{series:i.series},null,8,["series"]),i.loading?(a(),r("div",bi,"Loading...")):(a(),r("div",Di,[i.error?(a(),r("div",$i,c(i.error),1)):m("",!0),ki,t("div",Ci,[t("table",Ri,[Si,t("tbody",null,[(a(!0),r(u,null,D(o.fivePlusTeams,(l,p)=>(a(),r("tr",{key:p},[t("td",null,c(p+1),1),t("td",null,c(l.teamName),1),t("td",null,c(l.totalScore),1)]))),128))])])]),wi,t("div",Ti,[t("table",xi,[Pi,t("tbody",null,[(a(!0),r(u,null,D(o.threeFourTeams,(l,p)=>(a(),r("tr",{key:p},[t("td",null,c(p+1),1),t("td",null,c(l.teamName),1),t("td",null,c(l.totalScore),1)]))),128))])])]),Ni,(a(!0),r(u,null,D(o.sortedResults,(l,p)=>(a(),r("div",{class:"mt-5",key:p},[t("h3",null,c(l.teamName),1),t("div",Oi,[t("table",Ei,[t("thead",null,[t("tr",null,[Bi,Mi,(a(!0),r(u,null,D(i.teamDates,h=>(a(),r("th",null,c(h),1))),256))])]),t("tbody",null,[(a(!0),r(u,null,D(i.teamResults.teamDets[l.teamName],(h,g)=>(a(),r("tr",{key:g},[b(v,{data:h,dates:i.teamDates},null,8,["data","dates"])]))),128)),t("tr",null,[Fi,(a(!0),r(u,null,D(i.teamDates,h=>(a(),r("td",null,c(l.results[h]?l.results[h].avg:"-"),1))),256))])])])])]))),128))]))],64)}const Ai=S(vi,[["render",Li]]);const Ii={components:{EventDetailsComponent:B,MainNav:M},data(){return{categories:{},loading:!1,error:null,formattedStartDate:"",series:null,stageFilter:"all",racers:[],raceData:{}}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{scrollMeTo(e){var s=document.querySelector(`#${e}`);s.scrollIntoView({behavior:"smooth"})},fetchData(){this.error=null,this.loading=!0,this.$route.params.raceid&&T(`/api/races/roster/${this.$route.params.raceid}`).then(({data:e})=>{this.raceData=e,this.series=e.series,this.loading=!1,this.categories=e.regCategories,this.racers=e.registeredRacers}).catch(e=>{var s;if(this.loading=!1,((s=e.response)==null?void 0:s.status)===404){this.error="Race not found";return}console.error(e),this.categories={},this.error=e.toString()})},replacePlusSymbol(e){return e.replace("+","Plus")},payTypeToStage(e){const s=_.find(this.raceData.paymentOptions,{type:e});return s?s.name:""}},computed:{showPaytype(){var e;return!!((e=this.raceData)!=null&&e.showPaytypeOnRoster)},filterOptions(){let e={all:"All Stages"};return _.forEach(this.raceData.paymentOptions,s=>{e[s.type]=s.name}),e},filteredRacers(){return this.showPaytype&&this.stageFilter!=="all"?_.filter(this.racers,e=>e.paytype==this.stageFilter||e.paytype=="season"):this.racers},groupedRacers(){return _.groupBy(this.filteredRacers,"category")},sortedCats(){return _.filter(_.orderBy(this.categories,"disporder"),e=>_.includes(Object.keys(this.groupedRacers),e.id))},raceDate(){return R(this.raceData.eventDate).format("ddd, MMM D")}}},Vi={key:0,class:"loading"},Ui={key:1},qi={key:0,class:"error"},ji={key:1,id:"top"},Yi={key:0},Hi={class:"row"},Gi={key:0,class:"col-md-6"},Wi={class:"container text-center mt-5"},Ki={class:"list-inline"},zi=["onClick"],Ji={class:"container-fluid"},Qi=["id"],Xi={class:"table table-striped table-hover"},Zi=t("th",null," First Name ",-1),eo=t("th",null," Last Name ",-1),to=t("th",null," Team/Sponsor ",-1),so={key:0},ao={key:0},ro={key:1},io=t("div",{class:"text-center"},[t("h2",{class:"mt-5"},"No registrations yet...")],-1),oo=[io];function no(e,s,n,d,i,o){const y=C("MainNav"),v=C("EventDetailsComponent"),l=C("FormKit");return a(),r(u,null,[b(y),i.loading?(a(),r("div",Vi,"Loading...")):(a(),r("div",Ui,[i.error?(a(),r("div",qi,c(i.error),1)):(a(),r("div",ji,[b(v,{details:i.raceData.eventDetails,raceid:i.raceData.raceid},null,8,["details","raceid"]),Object.keys(i.racers).length?(a(),r("div",Yi,[t("div",Hi,[t("div",{class:O({"col-md-6":o.showPaytype})},[t("h4",null,c(o.filteredRacers.length)+" Registered for "+c(i.raceData.displayName)+" on "+c(o.raceDate),1)],2),o.showPaytype?(a(),r("div",Gi,[b(l,{type:"select",label:"Show registrations for:",name:"stageFilter",modelValue:i.stageFilter,"onUpdate:modelValue":s[0]||(s[0]=p=>i.stageFilter=p),default:"all",options:o.filterOptions},null,8,["modelValue","options"])])):m("",!0)]),t("div",Wi,[t("ul",Ki,[(a(!0),r(u,null,D(o.sortedCats,p=>(a(),r("li",{key:p.id,class:"list-inline-item mx-2"},[t("a",{role:"button",onClick:h=>o.scrollMeTo(o.replacePlusSymbol(p.id)),class:"link-primary"},c(p.catdispname),9,zi)]))),128))])]),t("div",Ji,[(a(!0),r(u,null,D(o.sortedCats,p=>(a(),r("div",{key:p.id,class:"mt-5"},[t("h3",{id:o.replacePlusSymbol(p.id)},c(p.catdispname),9,Qi),t("table",Xi,[t("thead",null,[t("tr",null,[Zi,eo,to,o.showPaytype?(a(),r("th",so," Stages ")):m("",!0)])]),t("tbody",null,[(a(!0),r(u,null,D(o.groupedRacers[p.id],(h,g)=>(a(),r("tr",{key:g},[t("td",null,c(h.first_name),1),t("td",null,c(h.last_name),1),t("td",null,c(h.sponsor),1),o.showPaytype?(a(),r("td",ao,c(o.payTypeToStage(h.paytype)),1)):m("",!0)]))),128))])]),t("a",{role:"button",onClick:s[1]||(s[1]=h=>o.scrollMeTo("top")),class:"link-primary"},"Back to Top")]))),128))])])):(a(),r("div",ro,oo))]))]))],64)}const lo=S(Ii,[["render",no]]),co=J({history:Q("/"),routes:[{path:"/",name:"home",component:F},{path:"/results/",name:"results",component:F},{path:"/races/series/:seriesid",name:"racesBySeries",component:F},{path:"/race/:raceid",component:Lt},{path:"/result/:id",name:"raceResult",component:ms},{path:"/result/series/:seriesid",name:"seriesResults",component:Fs},{path:"/result/series/:seriesid/team",name:"teamCompResults",component:Ai},{path:"/register/:raceid",name:"register",component:U},{path:"/register/test/:raceid",name:"register-test",component:U},{path:"/regconfirmation/:raceid/:payment_id",component:Sr},{path:"/roster/:raceid",name:"roster",component:lo},{path:"/series/:seriesid",component:q},{path:"/series/grom/:seriesid",component:q},{path:"/teamcomp/:seriesid",component:fi}]});X.init({clientToken:"pub5b9b0cfce30b3b609b588d9f3ac85ebb",site:"datadoghq.com",env:"production",service:"public-site",version:"1.0.1",forwardErrorsToLogs:!0,sampleRate:100});const V=Z(ie);V.use(ee,te);V.use(co);V.mount("#app");
//# sourceMappingURL=main-74d184a3.js.map
