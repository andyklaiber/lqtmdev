import{_ as $,R as L,o as s,c as a,a as y,r as k,b as e,d as D,t as c,e as _,w as S,f as R,n as w,p as A,g as j,h as C,i as m,F as u,j as f,k as x,l as q,m as Y,q as H,s as W,u as K,v as G}from"./main-d2ef9e6b.js";const z={components:{RouterView:L},data(){return{races:[]}},mounted:function(){},computed:{}},J={class:"container"};function X(r,t,l,p,i,o){const g=k("RouterView");return s(),a("div",J,[y(g)])}const Q=$(z,[["render",X]]),Z={props:["url"],created(){(function(r,t,l){var p,i=r.getElementsByTagName(t)[0];r.getElementById(l)||(p=r.createElement(t),p.id=l,p.src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v15.0",i.parentNode.insertBefore(p,i))})(document,"script","facebook-jssdk")},mounted(){window.FB&&FB.XFBML.parse()}},ee={id:"1"},te=e("div",{id:"fb-root"},null,-1),se=["data-href"];function re(r,t,l,p,i,o){return s(),a("div",ee,[te,e("div",{class:"fb-share-button","data-href":this.url,"data-layout":"button","data-size":"large"},null,8,se)])}const ae=$(Z,[["render",re]]),ie={components:{FbShareComponent:ae},props:["details","raceid","compactMode"],data(){return{}},computed:{isRosterPage(){return this.$route.path.includes("/roster/")},isRegPage(){return this.$route.name==="register"},regDisabled(){return D().isBefore(this.details.regOpenDate)},regEnded(){return D().isAfter(this.details.regCloseDate)},regTimeToOpen(){return D().to(this.details.regOpenDate)},regTimeToClose(){return D().to(this.details.regCloseDate)},imgWidth(){return this.compactMode?150:225}}},oe={class:"container mb-4"},ne={class:"row p-1 pb-0 pe-lg-0 pt-lg-3 align-items-center rounded-3 border shadow"},le={class:"col-sm-3 offset-sm-1 p-0"},ce=["href"],de=["src","width"],ue={class:"col-lg-7 p-3 p-lg-3 pt-lg-3"},he={class:"row"},me={class:"col col-md-auto"},_e={class:"display-7 fw-bold lh-3"},pe={key:0,class:"lead mb-0 fw-bold"},ge={class:"display-9"},ye={key:0,class:"d-grid gap-2 d-md-flex justify-content-md mb-4 mb-lg-3"},fe={class:"col-md-auto"},ve=["href"],be={class:"col col-lg-2"},ke={key:0},De={key:1,class:"fw-bold"},$e={key:2,class:"row"},Ce={key:0,class:"fw-bold"},Se={key:0,class:"fw-bold"},Re={key:1,class:"fw-bold"},we={key:1,class:"col col-md-auto"},xe={key:2,class:"col"};function Te(r,t,l,p,i,o){var n;const g=k("FbShareComponent"),d=k("RouterLink");return s(),a("div",oe,[e("div",ne,[e("div",le,[e("a",{href:l.details.homepageUrl},[e("img",{class:"pb-1",src:l.details.logoUrl,alt:"",width:o.imgWidth},null,8,de)],8,ce)]),e("div",ue,[e("div",he,[e("div",me,[e("h3",_e,c(l.details.name),1),l.compactMode?_("",!0):(s(),a("p",pe,c(l.details.tagline),1))])]),e("p",ge,c(l.details.formattedDates),1),l.details.homepageUrl&&!l.compactMode?(s(),a("div",ye,[e("div",fe,[e("a",{class:"btn btn-sm btn-success",href:l.details.homepageUrl},"Event Homepage",8,ve)]),e("div",be,[l.details.facebookShare?(s(),a("div",ke,[y(g,{url:l.details.homepageUrl},null,8,["url"])])):_("",!0)])])):_("",!0),o.regDisabled?(s(),a("div",De," Registration will open "+c(o.regTimeToOpen),1)):(s(),a("div",$e,[(n=l.details)!=null&&n.regCloseDate?(s(),a("div",Ce,[o.regEnded?(s(),a("div",Se," Registration is closed ")):(s(),a("div",Re," Registration will close "+c(o.regTimeToClose),1))])):_("",!0),!o.isRegPage&&!o.regEnded?(s(),a("div",we,[y(d,{class:"btn btn-success",to:{name:"register",params:{raceid:l.raceid}}},{default:S(()=>[R("Register")]),_:1},8,["to"])])):_("",!0),o.isRosterPage?_("",!0):(s(),a("div",xe,[y(d,{class:"btn btn-secondary",to:{name:"roster",params:{raceid:l.raceid}}},{default:S(()=>[R("See who is signed up ")]),_:1},8,["to"])]))]))])])])}const P=$(ie,[["render",Te]]);const Pe={props:["races"],data(){return{count:0,loggedIn:!1}},computed:{}},I=r=>(A("data-v-2f3c77b1"),r=r(),j(),r),Ne={class:"navbar navbar-expand-md navbar-dark bg-dark fixed-top"},Ee={class:"container-fluid"},Me=I(()=>e("a",{class:"navbar-brand",href:"/"},"Signup.bike",-1)),Be=I(()=>e("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarsExample04","aria-controls":"navbarsExample04","aria-expanded":"false","aria-label":"Toggle navigation"},[e("span",{class:"navbar-toggler-icon"})],-1)),Fe={class:"collapse navbar-collapse",id:"navbarsExample04"},Oe={class:"navbar-nav me-auto mb-4 mb-md-0 px-5"},Le={class:"nav-item"};function Ie(r,t,l,p,i,o){const g=k("RouterLink");return s(),a("nav",Ne,[e("div",Ee,[Me,Be,e("div",Fe,[e("ul",Oe,[e("li",Le,[y(g,{class:w(["nav-link",{active:r.$route.name=="home"}]),to:{name:"home"}},{default:S(()=>[R(" Upcoming Races ")]),_:1},8,["class"])])]),i.loggedIn?(s(),a("button",{key:0,type:"button",class:"btn btn-secondary",onClick:t[0]||(t[0]=d=>r.$emit("logout"))},"Logout")):_("",!0)])])])}const N=$(Pe,[["render",Ie],["__scopeId","data-v-2f3c77b1"]]);const Ve={emits:["logout"],components:{MainNav:N,RouterView:L,EventDetailsComponent:P},data(){return{count:0,races:[],loading:!0}},created(){this.$watch(()=>this.$route.query,()=>{this.fetchData()},{immediate:!0})},methods:{fetchData(){if(this.error=null,this.loading=!0,console.log("fetch plz"),this.$route)return C("/api/races/").then(r=>{this.races=r.data,this.loading=!1,console.log("fetched"),console.log(this.races)}).catch(r=>{this.loading=!1,this.error=r.toString(),console.error(r)})}},computed:{displayRaces(){let r={};return m.filter(this.races,l=>{if(l.series&&r[l.series])return!1;let p=D().isBefore(D(l.eventDate));return console.log("isInFuture"+p),l.isTestData&&!this.$route.query.test||!p&&!this.$route.query.past?!1:(typeof l.series=="string"&&l.series.length>1&&(console.log("set as shown "+l.raceid),r[l.series]=!0),!0)})},loggedIn(){return!1}}},Ue={key:0},Ae={key:1};function je(r,t,l,p,i,o){const g=k("MainNav"),d=k("EventDetailsComponent");return s(),a(u,null,[y(g),i.loading?(s(),a("div",Ue," Plz wait, loading... ")):(s(),a("div",Ae,[(s(!0),a(u,null,f(o.displayRaces,(n,h)=>(s(),a("div",{key:h},[y(d,{details:n.eventDetails,raceid:n.raceid,"compact-mode":"true"},null,8,["details","raceid"])]))),128))]))],64)}const B=$(Ve,[["render",je],["__scopeId","data-v-f2090c62"]]);let F=(r,t=!1)=>{const l=new Date(Date.UTC(0,0,0,0,0,0,r));let i=[l.getUTCMinutes(),l.getUTCSeconds()].map(o=>String(o).padStart(2,"0")).join(":");return t&&(i=i.concat("."+`${l.getUTCMilliseconds()}`.padStart(3,"0"))),l.getUTCHours()&&(i=l.getUTCHours()+":"+i),i};const qe={props:["data","Pos","totLaps","showMillis"],data(){return{count:0}},methods:{msToTimeString(r){return F(r,this.showMillis)}},computed:{incompleteLaps(){return new Array(this.totLaps-this.data.laps.length).fill("-")},formattedTime(){return F(this.data.duration,this.showMillis)}}};function Ye(r,t,l,p,i,o){return s(),a(u,null,[e("td",null,c(l.Pos+1),1),e("td",null,c(l.data.Bib),1),e("td",null,c(l.data.Name),1),e("td",null,c(l.data.Sponsor),1),(s(!0),a(u,null,f(l.data.laps,(g,d)=>(s(),a("td",{key:d},c(o.msToTimeString(g.duration)),1))),128)),l.totLaps-l.data.laps.length>0?(s(!0),a(u,{key:0},f(o.incompleteLaps,g=>(s(),a("td",null,c(g),1))),256)):_("",!0),e("td",null,c(o.formattedTime),1),e("td",null,c(l.data.back||"-"),1)],64)}const V=$(qe,[["render",Ye]]),He={props:["series"],data(){return{count:0,seriesData:{}}},created(){this.$watch(()=>this.series,function(){if(!this.series)return;let r=`/api/series/${this.series}/races`;C(r).then(({data:t})=>{this.seriesData=t})})},computed:{isPcrs(){return this.series&&this.series.indexOf("pcrs")>-1}}},We={id:"top",class:"navbar navbar-light bg-light"},Ke={class:"container-fluid"},Ge={class:"navbar-brand",href:"#"},ze={key:0,class:"nav-item"},Je=["href"],Xe=e("p",{class:"mt-3"},"View Weekly lap times:",-1),Qe={class:"nav nav-tabs mt-1 justify-content-center"},Ze={key:0,class:"nav-item"},et={key:1,class:"nav-item"},tt={key:2,class:"nav-item"};function st(r,t,l,p,i,o){const g=k("RouterLink");return s(),a(u,null,[e("nav",We,[e("div",Ke,[e("div",Ge,c(i.seriesData.displayName),1),i.seriesData.homepage?(s(),a("div",ze,[e("a",{class:"nav-link active","aria-current":"page",href:i.seriesData.homepage.url},c(i.seriesData.homepage.linkString),9,Je)])):_("",!0)])]),Xe,e("ul",Qe,[(s(!0),a(u,null,f(i.seriesData.races,d=>(s(),a("li",{key:d.raceid,class:"nav-item"},[y(g,{class:w(["nav-link",{active:r.$route.params.raceid===d.raceid}]),to:`/race/${d.raceid}`},{default:S(()=>[R(c(d.displayName+` - ${d.formattedStartDate}`),1)]),_:2},1032,["class","to"])]))),128)),o.isPcrs?(s(),a("li",Ze,[y(g,{class:w(["nav-link",{active:r.$route.path=="/series/pcrs_2022"}]),to:"/series/pcrs_2022"},{default:S(()=>[R("Series Standings")]),_:1},8,["class"])])):_("",!0),o.isPcrs?(s(),a("li",et,[y(g,{class:w(["nav-link",{active:r.$route.path=="/series/grom/pcrs_2022"}]),to:"/series/grom/pcrs_2022"},{default:S(()=>[R("Grom Series Standings")]),_:1},8,["class"])])):_("",!0),o.isPcrs?(s(),a("li",tt,[y(g,{class:w(["nav-link",{active:r.$route.path=="/teamcomp/pcrs_2022"}]),to:"/teamcomp/pcrs_2022"},{default:S(()=>[R("Team Competition")]),_:1},8,["class"])])):_("",!0)])],64)}const E=$(He,[["render",st]]);const rt={components:{ResultRow:V,SeriesNavBar:E},data(){return{categories:{},loading:!1,error:null,formattedStartDate:"",series:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{scrollMeTo(r){var t=document.querySelector(`#${r}`);t.scrollIntoView({behavior:"smooth"})},fetchData(){if(this.error=null,this.loading=!0,this.$route.params.raceid){let r=`/api/races/results/${this.$route.params.raceid}`;C(r).then(({data:t})=>{this.formattedStartDate=t.raceMeta.formattedStartDate,this.series=t.series,this.loading=!1,this.categories=t.categories}).catch(t=>{console.error(t),this.categories={},this.error=t.toString()})}}},computed:{sortedCats(){return m.orderBy(this.categories,"disporder")},expertCats(){return m.filter(this.sortedCats,{laps:4})},sportCats(){return m.filter(this.sortedCats,{laps:3})},beginnerCats(){return m.filter(this.sortedCats,{laps:2})},gromCats(){return m.filter(this.categories,r=>r.id.indexOf("grom")>-1)},haveResults(){return this.categories?Object.keys(this.categories).length>0:!1}}},at={key:0,class:"text-center"},it={class:"mt-5"},ot={key:1,class:"loading"},nt={key:2},lt={key:0,class:"error"},ct={key:1},dt={class:"container text-center mt-5"},ut={class:"list-inline"},ht=["onClick"],mt={class:"list-inline"},_t=["onClick"],pt={class:"list-inline"},gt=["onClick"],yt={class:"list-inline"},ft=["onClick"],vt={class:"container-fluid"},bt=["id"],kt={class:"table table-striped table-hover"},Dt={key:2},$t=e("div",{class:"text-center"},[e("h2",{class:"mt-5"},"No results yet...")],-1),Ct=[$t];function St(r,t,l,p,i,o){const g=k("SeriesNavBar"),d=k("ResultRow");return s(),a(u,null,[y(g,{series:i.series},null,8,["series"]),i.formattedStartDate?(s(),a("div",at,[e("h2",it,"Race Results - "+c(i.formattedStartDate),1)])):_("",!0),i.loading?(s(),a("div",ot,"Loading...")):(s(),a("div",nt,[i.error?(s(),a("div",lt,c(i.error),1)):_("",!0),o.haveResults?(s(),a("div",ct,[e("div",dt,[e("ul",ut,[(s(!0),a(u,null,f(o.expertCats,(n,h)=>(s(),a("li",{key:n.id,class:"list-inline-item mx-2"},[e("a",{role:"button",onClick:v=>o.scrollMeTo(n.id),class:"link-primary"},c(n.catdispname),9,ht)]))),128))]),e("ul",mt,[(s(!0),a(u,null,f(o.sportCats,(n,h)=>(s(),a("li",{key:n.id,class:"list-inline-item mx-2"},[e("a",{role:"button",onClick:v=>o.scrollMeTo(n.id),class:"link-primary"},c(n.catdispname),9,_t)]))),128))]),e("ul",pt,[(s(!0),a(u,null,f(o.beginnerCats,(n,h)=>(s(),a("li",{key:n.id,class:"list-inline-item mx-2"},[e("a",{role:"button",onClick:v=>o.scrollMeTo(n.id),class:"link-primary"},c(n.catdispname),9,gt)]))),128))]),e("ul",yt,[(s(!0),a(u,null,f(o.gromCats,(n,h)=>(s(),a("li",{key:n.id,class:"list-inline-item mx-2"},[e("a",{role:"button",onClick:v=>o.scrollMeTo(n.id),class:"link-primary"},c(n.catdispname),9,ft)]))),128))])]),e("div",vt,[(s(!0),a(u,null,f(o.sortedCats,(n,h)=>(s(),a("div",{key:n.id,class:"mt-5"},[e("h3",{id:n.id},c(n.catdispname),9,bt),e("table",kt,[e("thead",null,[e("tr",null,[(s(!0),a(u,null,f(n.columns,(v,b)=>(s(),a("th",{scope:"col",key:b},c(v),1))),128))])]),e("tbody",null,[(s(!0),a(u,null,f(n.results,(v,b)=>(s(),a("tr",{key:b},[y(d,{totLaps:n.laps,Pos:b,data:v},null,8,["totLaps","Pos","data"])]))),128))])]),e("a",{role:"button",onClick:t[0]||(t[0]=v=>o.scrollMeTo("top")),class:"link-primary"},"Back to Top")]))),128))])])):(s(),a("div",Dt,Ct))]))],64)}const Rt=$(rt,[["render",St]]);const wt={components:{ResultRow:V,SeriesNavBar:E},data(){return{resultData:{},categories:{},loading:!1,error:null,formattedStartDate:"",series:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{scrollMeTo(r){var t=document.querySelector(`#${r}`);t.scrollIntoView({behavior:"smooth"})},fetchData(){if(this.error=null,this.loading=!0,this.$route.params.id){let r=`/api/results/${this.$route.params.id}`;C(r).then(({data:t})=>{this.formattedStartDate=t.formattedStartDate,this.series=t.series,this.resultData=t,this.loading=!1,this.categories=t.categories}).catch(t=>{console.error(t),this.categories={},t.response.status==404?this.error="":this.error=t.toString(),this.loading=!1})}else this.$router.push("")},metaColumns(r){return r.slice(0,4)},lapColumns(r){let t=[];for(let l=1;l<=r.length;l++)t.push(`Lap ${l}`);return t.push("Total"),t.push("Time Behind Leader"),t}},computed:{sortedCats(){return m.orderBy(this.categories,"disporder")},haveResults(){return this.categories?Object.keys(this.categories).length>0:!1}}},xt={key:0,class:"text-center"},Tt={class:"mt-5"},Pt={key:1,class:"text-center"},Nt={class:"mt-5"},Et={key:2,class:"loading"},Mt={key:3},Bt={key:0,class:"error"},Ft={key:1},Ot={id:"top",class:"container text-center mt-5"},Lt={class:"list-inline"},It=["onClick"],Vt={class:"container-fluid"},Ut=["id"],At={class:"table table-striped table-hover"},jt={key:2},qt=e("div",{class:"text-center"},[e("h2",{class:"mt-5"},"No results yet...")],-1),Yt=[qt];function Ht(r,t,l,p,i,o){const g=k("ResultRow");return s(),a(u,null,[i.resultData.eventName?(s(),a("div",xt,[e("h2",Tt,"Race Results - "+c(i.resultData.eventName),1)])):_("",!0),i.formattedStartDate?(s(),a("div",Pt,[e("h2",Nt,c(i.formattedStartDate),1)])):_("",!0),i.loading?(s(),a("div",Et,"Loading...")):(s(),a("div",Mt,[i.error?(s(),a("div",Bt,c(i.error),1)):_("",!0),o.haveResults?(s(),a("div",Ft,[e("div",Ot,[e("ul",Lt,[(s(!0),a(u,null,f(o.sortedCats,(d,n)=>(s(),a("li",{key:d.id,class:"list-inline-item mx-2"},[e("a",{role:"button",onClick:h=>o.scrollMeTo(d.id),class:"link-primary"},c(d.catdispname),9,It)]))),128))])]),e("div",Vt,[(s(!0),a(u,null,f(o.sortedCats,(d,n)=>(s(),a("div",{key:d.id,class:"mt-5"},[e("h3",{id:d.id},c(d.catdispname),9,Ut),e("table",At,[e("thead",null,[e("tr",null,[(s(!0),a(u,null,f(o.metaColumns(d.columns),(h,v)=>(s(),a("th",{scope:"col",key:v},c(h),1))),128)),(s(!0),a(u,null,f(o.lapColumns(d.results[0].laps),(h,v)=>(s(),a("th",{scope:"col",key:v},c(h),1))),128))])]),e("tbody",null,[(s(!0),a(u,null,f(d.results,(h,v)=>(s(),a("tr",{key:v},[y(g,{totLaps:d.results[0].laps.length,Pos:v,data:h,showMillis:i.resultData.showMillis},null,8,["totLaps","Pos","data","showMillis"])]))),128))])]),e("a",{role:"button",onClick:t[0]||(t[0]=h=>o.scrollMeTo("top")),class:"link-primary"},"Back to Top")]))),128))])])):(s(),a("div",jt,Yt))]))],64)}const Wt=$(wt,[["render",Ht]]);const Kt={props:["data","Pos"],data(){return{count:0}},computed:{}};function Gt(r,t,l,p,i,o){return s(),a(u,null,[e("td",null,c(l.Pos+1),1),e("td",null,c(l.data.Bib),1),e("td",null,c(l.data.Name),1),e("td",null,c(l.data.Age),1),e("td",null,c(l.data.Sponsor),1),(s(!0),a(u,null,f(l.data.results,(g,d)=>(s(),a("td",{class:w({"text-danger":g.dropped}),key:d},c(g.resultString),3))),128)),e("td",null,c(l.data.seriesPoints),1)],64)}const U=$(Kt,[["render",Gt]]),zt={props:["series","displayName"],data(){return{count:0,seriesData:{},races:[]}},created(){this.$watch(()=>this.series,function(){if(!this.series)return;let r=`/api/results/?series=${this.series}`;C(r).then(({data:t})=>{this.races=t})})},computed:{isPcrs(){return this.series&&this.series.indexOf("pcrs")>-1}}},Jt={id:"top",class:"navbar navbar-light bg-light"},Xt={class:"container-fluid"},Qt={class:"navbar-brand h2",href:"#"},Zt={key:0,class:"nav-item"},es=["href"],ts=e("p",{class:"mt-3"},"View Individual Event Times:",-1),ss={class:"nav nav-tabs mt-1 justify-content-center"};function rs(r,t,l,p,i,o){const g=k("RouterLink");return s(),a(u,null,[e("nav",Jt,[e("div",Xt,[e("div",Qt,c(l.displayName),1),i.seriesData.homepage?(s(),a("div",Zt,[e("a",{class:"nav-link active","aria-current":"page",href:i.seriesData.homepage.url},c(i.seriesData.homepage.linkString),9,es)])):_("",!0)])]),ts,e("ul",ss,[(s(!0),a(u,null,f(i.races,d=>(s(),a("li",{key:d.raceid,class:"nav-item"},[y(g,{class:w(["nav-link",{active:r.$route.params.raceid===d.raceid}]),to:`/result/${d.raceid}`},{default:S(()=>[R(c(d.eventName+` - ${d.formattedStartDate}`),1)]),_:2},1032,["class","to"])]))),128))])],64)}const as=$(zt,[["render",rs]]);const is={components:{SeriesResultRow:U,SeriesNavBar:as},data(){return{categories:{},loading:!1,error:null,displayName:"",series:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{scrollMeTo(r){var t=document.querySelector(`#${r}`);t.scrollIntoView({behavior:"smooth"})},fetchData(){if(!this.$route.params.seriesid)return;this.error=null,this.loading=!0;let r=`/api/series/results/${this.$route.params.seriesid}`;C(r).then(({data:t})=>{this.loading=!1,this.categories=t.categories,this.displayName=t.eventName,this.series=this.$route.params.seriesid,m.map(t.categories,l=>m.omit(l,["results","columns"]))}).catch(t=>{console.error(t),this.categories={},this.error=t.toString()})}},computed:{sortedCats(){return m.orderBy(this.categories,"disporder")},haveResults(){return this.categories?Object.keys(this.categories).length>0:!1},isPCRS(){return m.isString(this.series)&&this.series.indexOf("pcrs")>-1}}},os={key:0,class:"loading"},ns={key:1},ls={key:0,class:"error"},cs={class:"container-fluid text-center mt-5"},ds=e("h3",null,"Series Standings",-1),us=e("p",null,"Glossary of terms below:",-1),hs={key:0},ms={key:1},_s={key:1},ps={class:"container-fluid text-center mt-5"},gs={class:"list-inline"},ys=["onClick"],fs={class:"container-fluid"},vs=["id"],bs={class:"table table-striped table-hover"},ks={key:2},Ds=e("div",{class:"text-center"},[e("h2",{class:"mt-5"},"No results yet...")],-1),$s=[Ds];function Cs(r,t,l,p,i,o){const g=k("SeriesNavBar"),d=k("SeriesResultRow");return s(),a(u,null,[y(g,{series:i.series,displayName:i.displayName},null,8,["series","displayName"]),i.loading?(s(),a("div",os,"Loading...")):(s(),a("div",ns,[i.error?(s(),a("div",ls,c(i.error),1)):_("",!0),e("div",cs,[ds,us,o.isPCRS?(s(),a("p",hs,"1/50 = 1st Place/50 Points   -/- = Did not race")):(s(),a("p",ms,"1/100 = 1st Place/100 Points   -/- = Did not race"))]),o.haveResults?(s(),a("div",_s,[e("div",ps,[e("ul",gs,[(s(!0),a(u,null,f(o.sortedCats,n=>(s(),a("li",{key:n.id,class:"list-inline-item mx-2"},[e("a",{role:"button",onClick:h=>o.scrollMeTo(n.id),class:"link-primary"},c(n.catdispname),9,ys)]))),128))])]),e("div",fs,[(s(!0),a(u,null,f(o.sortedCats,n=>(s(),a("div",{key:n.id,class:"mt-5"},[e("h3",{id:n.id},c(n.catdispname),9,vs),e("table",bs,[e("thead",null,[e("tr",null,[(s(!0),a(u,null,f(n.columns,(h,v)=>(s(),a("th",{scope:"col",key:v},c(h),1))),128))])]),e("tbody",null,[(s(!0),a(u,null,f(n.results,(h,v)=>(s(),a("tr",{key:v},[y(d,{Pos:v,data:h},null,8,["Pos","data"])]))),128))])]),e("a",{role:"button",onClick:t[0]||(t[0]=h=>o.scrollMeTo("top")),class:"link-primary"},"Back to Top")]))),128))])])):(s(),a("div",ks,$s))]))],64)}const Ss=$(is,[["render",Cs]]),Rs={props:["categories","raceDate"],data(){return{}},methods:{formatStartTime(r){return D(`${D(this.raceDate).format("YYYY-MM-DD")} ${r}`).format("h:mm A")}},computed:{groupByStartTimes(){return m.groupBy(m.orderBy(this.categories,["startTime","disporder"]),"startTime")},hasStartTimes(){return!!m.some(this.categories,"startTime")}}},ws={key:0},xs=e("h5",null,"Race Start Times:",-1),Ts={class:"row gap-5 mb-3"},Ps={class:""},Ns={class:"row g-2 px-4 gx-4 border bg-light"};function Es(r,t,l,p,i,o){return l.categories.length&&o.hasStartTimes?(s(),a("div",ws,[xs,e("div",Ts,[(s(!0),a(u,null,f(o.groupByStartTimes,(g,d)=>(s(),a("div",{key:d,class:"col-md-5"},[e("h6",Ps,c(o.formatStartTime(d))+":",1),e("div",Ns,[(s(!0),a(u,null,f(o.groupByStartTimes[d],n=>(s(),a("div",{key:n.id,class:"col-lg text-nowrap my-1"},c(n.catdispname),1))),128))])]))),128))])])):_("",!0)}const Ms=$(Rs,[["render",Es]]);let Bs=m.debounce((r,t)=>{window.localStorage.setItem(`race-reg-form-data-${t}`,JSON.stringify(r))},3500),Fs=r=>{let t=window.localStorage.getItem(`race-reg-form-data-${r}`);if(t){let l={};try{l=JSON.parse(t)}catch{}return l}return null},Os=r=>{window.localStorage.removeItem(`race-reg-form-data-${r}`)};function Ls(r){if(r===0)return 0;let t=r*100,l=t*.04;return l>600&&(l=600),Math.round((t+l+30)/(1-.029))-t}const Is={components:{MainNav:N,EventDetailsComponent:P,EventCategoryScheduleComponent:Ms},data(){return{categories:{},loading:!1,error:null,formError:[],formInputData:{},raceData:{},payment:"",birthdate:"",submitted:!1,waiverAccepted:!1,couponError:[],prevBibError:[],seriesRaces:{},seriesRaceIdx:0,previousReg:!1,prevAge:null}},created(){this.$watch(()=>this.$route.params.raceid,()=>{this.fetchData()},{immediate:!0})},watch:{formInputData:{handler(r,t){this.previousReg==!1&&Bs(r,this.$route.params.raceid)},deep:!0}},methods:{dollas(r){return r.toLocaleString("en-US",{style:"currency",currency:"USD"})},fetchData(){this.error=null,this.loading=!0,this.$route.params.raceid&&C(`/api/races/${this.$route.params.raceid}`).then(async r=>{var l;this.raceData=r.data;let t=Fs(this.$route.params.raceid);t&&(m.find((l=this.raceData)==null?void 0:l.regCategories,{id:t.category})||delete t.category,t.waiverAccepted=!1,this.formInputData=t),this.raceData.series&&this.raceData.toString().length>1&&await C(`/api/series/${this.raceData.series}/registration`).then(({data:p})=>{this.seriesRaces=p;let i=D();this.seriesRaceIdx=0,m.some(p,({eventDate:o,raceid:g},d)=>D(o).isBefore(i)?!1:(this.seriesRaceIdx=d,this.$router.push(`/register/${g}`),!0))}),this.loading=!1,this.payment=this.raceData.paymentOptions[0].type}).catch(r=>{this.loading=!1,this.error=r.toString(),console.error(r)})},findPrevBib(r){C.post("/api/racers/bib",{series:`${this.raceData.series}`,bibNumber:r}).then(({data:t})=>{if(console.log("prevbib"),console.log(t),t.paytype==="season"){this.prevBibError=["You are already registered for the whole season"];return}t.prevPaymentId=t.paymentId,delete t.paymentId,this.formInputData=t,this.prevAge=t.racerAge}).catch(({response:t})=>{console.dir(t),t.status==404&&(this.prevBibError=[t.data.message])})},onPrevBibChange(r){r?this.findPrevBib(r):(this.prevBibError=[],this.prevAge=null)},getCouponPricing(r){C.post("/api/payments/pricing",{raceid:`${this.$route.params.raceid}`,couponCode:r}).then(({data:t})=>{if(this.raceData.paymentOptions=t.paymentOptions,t.validCoupon)this.couponError=[];else{if(t.reason)return this.couponError=[t.reason];this.couponError=["Invalid Coupon Code"]}})},onCouponChange(r){r?this.getCouponPricing(r):this.couponError=[]},submitForm(r){r.preventDefault(),this.$formkit.submit("race-registration")},async submit(r){console.log(r),r.birthdate=void 0,r.racerAge=this.racerAge,r.paytype=this.payment,r.timestamp=D().format(),await C.post(`/api/payments/start-registration?race=${this.raceData.raceid}`,r).then(t=>{if(t.data){if(console.log("response data"),console.log(t.data),t.data.redirect)return this.submitted=!0,Os(this.$route.params.raceid),new Promise(l=>setTimeout(()=>{window.location.href=t.data.redirect,l()},2e3));t.data.message&&(this.formError=[t.data.message])}}).catch(t=>{var l,p;if((p=(l=t.response)==null?void 0:l.data)!=null&&p.message)return this.formError=[t.response.data.message];this.formError=["Error submitting request"]})},getEventTimeObj(r){return D(`${D(this.raceData.eventDate).format("YYYY-MM-DD")} ${r}`)}},computed:{startTimes(){return this.hasStartTimes?m.map(m.uniqBy(this.raceData.regCategories,"startTime"),"startTime"):null},hasStartTimes(){return!!m.some(this.raceData.regCategories,"startTime")},currentTime(){return D().local().format()},firstRaceTime(){return this.hasStartTimes?D.min(m.map(this.startTimes,r=>D(`${this.eventDateFormatted} ${r}`))):null},lastRaceTime(){return this.hasStartTimes?D.max(m.map(this.startTimes,r=>D(`${this.eventDateFormatted} ${r}`))):null},sortedCats(){const r=m.filter(this.raceData.regCategories,l=>!0);let t={};return m.forEach(m.orderBy(r,"disporder"),l=>{t[l.id]=l.catdispname}),t},loaded(){return!!this.raceData},submitLabel(){return this.payment=="cash"||this.sponsoredCategorySelected?"Sign Up!":"Go to Payment"},cashEnabled(){return!!this.raceData.cashPaymentsEnabled},eventDateFormatted(){return D(this.raceData.eventDate).format("YYYY-MM-DD")},regDisabled(){return this.$route.query.test!==void 0?!1:this.eventFull||D().isBefore(this.raceData.eventDetails.regOpenDate)||this.raceData.eventDetails.regCloseDate&&D().isAfter(this.raceData.eventDetails.regCloseDate)?!0:this.lastRaceTime?D().isAfter(this.lastRaceTime.subtract(5,"minute")):!1},eventFull(){return!!(this.raceData.entryCountMax&&this.raceData.entryCountMax>1&&this.raceData.entryCount>=this.raceData.entryCountMax)},paymentOptions(){let r={};return m.forEach(this.raceData.paymentOptions,t=>{r[t.type]=t.name}),this.cashEnabled&&(r.cash="Cash Payment (Today's Race Only)"),r},paymentCostDets(){var o,g,d;if(this.sponsoredCategorySelected)return this.payment="season",{cost:this.dollas(0),regFee:this.dollas(0),tot:this.dollas(0)};let r;this.payment==="cash"?r="single":r=this.payment;let t=m.find((o=this.raceData)==null?void 0:o.paymentOptions,n=>n.type===r);t||(this.payment="single",t=m.find((g=this.raceData)==null?void 0:g.paymentOptions,n=>n.type===this.payment));const l=parseFloat(t.amount);let p=0;l>0&&this.payment!=="cash"&&(p=(t.regFee+t.stripeFee)/100);const i={};if(m.assign(i,t,{name:t.name,cost:this.dollas(l),regFee:this.dollas(p),tot:this.dollas(parseFloat(t.amount)+parseFloat(p))}),(d=this.raceData)!=null&&d.optionalPurchases&&this.formInputData.optionalPurchases){let n=l;this.raceData.optionalPurchases.forEach(({id:h,label:v,description:b,amount:T})=>{this.formInputData.optionalPurchases[h]&&(i.options||(i.options=[]),i.options.push({description:b,label:v,id:h,amount:this.dollas(parseFloat(T))}),n+=parseFloat(T))}),p=Ls(n)/100,i.regFee=this.dollas(p),i.tot=this.dollas(n+p)}return i},showPaymentOption(){return this.sponsoredCategorySelected?!1:this.cashEnabled?!0:!(this.raceData.paymentOptions&&this.raceData.paymentOptions.length<2)},sponsoredCategorySelected(){var r;return!!((r=this.selectedCategory)!=null&&r.sponsored)},selectedCategory(){var r,t;return this.formInputData&&this.formInputData.category?m.find((r=this.raceData)==null?void 0:r.regCategories,{id:(t=this.formInputData)==null?void 0:t.category}):null},racerAge(){if(this.prevAge)return this.prevAge;if(this.birthdate){const r=D(),t=D(this.birthdate);return r.year()-t.year()}}}},Vs={key:0,class:"loading"},Us={key:1},As={key:0,class:"error"},js={key:1},qs={key:0,class:"h5"},Ys={key:1},Hs=e("h3",null,"Registration is closed.",-1),Ws=[Hs],Ks={key:2,class:"mb-5"},Gs=["innerHTML"],zs={key:1},Js={class:"row"},Xs={class:"col-md-6 order-md-1 mb-3"},Qs=e("h4",{class:"d-flex justify-content-between align-items-center mb-3"},[e("h5",null,"Registration Info"),e("span",{class:"badge badge-secondary badge-pill"},"3")],-1),Zs={class:"form-group pt-3"},er={class:"form-group pt-3"},tr={key:0,class:"col-md-5 order-md-2 mb-4"},sr=e("h4",{class:"d-flex justify-content-between align-items-center mb-3"},[e("h5",null,"Payment Detail")],-1),rr={class:"list-group mb-3"},ar={class:"list-group mb-3"},ir={key:0},or={class:"list-group mb-3"},nr=["innerHTML"],lr={class:"list-group mb-3 formkit-fieldset"},cr={class:"list-group-item d-flex justify-content-between lh-condensed"},dr=e("h6",{class:"my-0"},"Event Entry:",-1),ur={class:"text-muted"},hr={key:0,class:"mx-3 text-decoration-line-through text-danger"},mr={class:"list-group-item d-flex justify-content-between lh-condensed"},_r={class:"my-0"},pr={key:0,class:"text-muted"},gr={class:"list-group-item d-flex justify-content-between lh-condensed"},yr=e("div",null,[e("h6",{class:"my-0"},"Online Processing Fee:"),e("small",{class:"text-muted"},"Credit Card Processing and Online Registration")],-1),fr={class:"text-muted"},vr={class:"list-group-item d-flex justify-content-between"},br=e("span",null,"Total (USD)",-1),kr={key:0},Dr={class:"mb-5"},$r={key:1},Cr=e("h2",{class:"text-danger"},"Your registration will not be active until payment is received at the event",-1),Sr=[Cr],Rr={key:2},wr={key:2},xr=e("h2",null,"Submission successful, redirecting",-1),Tr=[xr],Pr={key:2},Nr=e("div",{class:"text-center"},[e("h2",{class:"mt-5"},"Race not available for registration...")],-1),Er=[Nr];function Mr(r,t,l,p,i,o){var v;const g=k("MainNav"),d=k("EventDetailsComponent"),n=k("FormKit"),h=k("EventCategoryScheduleComponent");return s(),a(u,null,[y(g),i.loading?(s(),a("div",Vs,"Loading...")):(s(),a("div",Us,[i.error?(s(),a("div",As,c(i.error),1)):_("",!0),o.loaded?(s(),a("div",js,[y(d,{details:i.raceData.eventDetails,raceid:i.raceData.raceid},null,8,["details","raceid"]),o.eventFull?(s(),a("div",qs,"This event has reached the registration entry max of "+c(i.raceData.entryCountMax),1)):_("",!0),o.regDisabled?(s(),a("div",Ys,Ws)):(s(),a("div",Ks,[(v=i.raceData)!=null&&v.headerContent?(s(),a("div",{key:0,class:"mb-3",innerHTML:i.raceData.headerContent},null,8,Gs)):_("",!0),i.seriesRaceIdx>0?(s(),a("div",zs,[y(n,{"label-class":"text-danger fw-bold fs-5",type:"checkbox",name:"prevBibLookup",label:"I have a bib number!",help:"Look up your information from a previous race",modelValue:i.previousReg,"onUpdate:modelValue":t[0]||(t[0]=b=>i.previousReg=b)},null,8,["modelValue"]),i.previousReg?(s(),x(n,{key:0,type:"number",name:"bibNumber",label:"Bib Number:",help:"Enter your Bib Number from your previous race to pre-fill your info",delay:1500,onInput:o.onPrevBibChange,errors:i.prevBibError,validation:"required"},null,8,["onInput","errors"])):_("",!0)])):_("",!0),y(n,{type:"form",id:"race-registration",modelValue:i.formInputData,"onUpdate:modelValue":t[4]||(t[4]=b=>i.formInputData=b),"form-class":i.submitted?"hide":"show",errors:i.formError,actions:!1,onSubmit:o.submit},{default:S(()=>[e("div",Js,[e("div",Xs,[Qs,y(n,{type:"text",name:"first_name",label:"First name",help:"What is your first name",validation:"required"}),y(n,{type:"text",name:"last_name",label:"Last name",help:"What is your last name",validation:"required"}),e("div",Zs,[i.previousReg?_("",!0):(s(),x(n,{key:0,type:"email",name:"email",label:"Your email",help:"Enter an email address",validation:"required|email"}))]),y(n,{type:"text",name:"sponsor",label:"Your Team or Sponsor",help:"Enter an optional Team or Sponsor name"}),i.previousReg?_("",!0):(s(),x(n,{key:0,type:"date",value:"2001-01-01",name:"birthdate",label:"Birthday",modelValue:i.birthdate,"onUpdate:modelValue":t[1]||(t[1]=b=>i.birthdate=b),help:"Enter your birthdate",validation:"required|before:2020-01-01","validation-visibility":"live"},null,8,["modelValue"])),e("div",null,"Age: "+c(o.racerAge),1),e("div",er,[y(n,{type:"select",id:"category",label:"Category:",placeholder:"Select a category",name:"category",options:o.sortedCats,validation:"required","validation-visibility":"dirty","validation-messages":{is:"You must select a category"}},null,8,["options"])])]),o.paymentCostDets?(s(),a("div",tr,[sr,e("fieldset",rr,[e("div",null,[i.raceData.couponsEnabled?(s(),x(n,{key:0,type:"text",name:"coupon",label:"Coupon Code",help:"",delay:1e3,onInput:o.onCouponChange,errors:i.couponError},null,8,["onInput","errors"])):_("",!0)])]),e("fieldset",ar,[e("div",null,[o.showPaymentOption?(s(),x(n,{key:0,type:"radio",name:"paytype",label:"Payment option",options:o.paymentOptions,validation:"required",modelValue:i.payment,"onUpdate:modelValue":t[2]||(t[2]=b=>i.payment=b)},null,8,["options","modelValue"])):_("",!0)])]),i.raceData.optionalPurchases&&o.showPaymentOption?(s(),a("div",ir,[y(n,{type:"group",name:"optionalPurchases"},{default:S(()=>[(s(!0),a(u,null,f(i.raceData.optionalPurchases,(b,T)=>(s(),a("div",or,[e("h6",{innerHTML:b.description},null,8,nr),y(n,{type:"checkbox",label:`${b.label} - ${o.dollas(parseFloat(b.amount))}`,name:b.id},null,8,["label","name"]),b.options&&i.formInputData.optionalPurchases[b.id]?(s(),x(n,{key:0,type:"select",options:b.options,label:b.optionsLabel,name:`${b.id}-option`},null,8,["options","label","name"])):_("",!0)]))),256))]),_:1})])):_("",!0),e("ul",lr,[e("li",cr,[e("div",null,[dr,e("small",ur,c(o.paymentCostDets.name),1)]),e("div",null,[o.paymentCostDets.discounted?(s(),a("span",hr,c(o.dollas(o.paymentCostDets.orig)),1)):_("",!0),e("span",{class:w({"text-success":o.paymentCostDets.discounted})},c(o.paymentCostDets.cost),3)])]),o.paymentCostDets.options?(s(!0),a(u,{key:0},f(o.paymentCostDets.options,(b,T)=>(s(),a("li",mr,[e("div",null,[e("h6",_r,c(b.label),1),b.option?(s(),a("small",pr,c(b.option),1)):_("",!0)]),e("div",null,[e("span",null,c(b.amount),1)])]))),256)):_("",!0),e("li",gr,[yr,e("span",fr,c(o.paymentCostDets.regFee),1)]),e("li",vr,[br,e("strong",null,c(o.paymentCostDets.tot),1)])])])):_("",!0)]),o.sponsoredCategorySelected?(s(),a("div",kr,[e("p",Dr,[e("h5",null,"Your "+c(o.selectedCategory.catdispname)+" race entry is sponsored by "+c(o.selectedCategory.sponsorName),1)])])):_("",!0),i.payment==="cash"?(s(),a("div",$r,Sr)):_("",!0),i.raceData.waiver?(s(),a("div",Rr,[e("h5",null,c(i.raceData.waiver.header),1),e("p",null,c(i.raceData.waiver.text),1),y(n,{type:"checkbox",modelValue:i.waiverAccepted,"onUpdate:modelValue":t[3]||(t[3]=b=>i.waiverAccepted=b),label:"I HAVE READ AND UNDERSTAND THIS WAIVER",help:"I acknowledge that I have read, understand, and accepted the above release of liability.",name:"waiverAccepted",validation:"accepted","validation-messages":{accepted:"You must agree to the terms of the liability release above"},"validation-visibility":"live"},null,8,["modelValue"])])):_("",!0),y(n,{type:"submit",label:o.submitLabel,onClick:o.submitForm},null,8,["label","onClick"])]),_:1},8,["modelValue","form-class","errors","onSubmit"]),i.submitted?(s(),a("div",wr,Tr)):_("",!0)])),y(h,{categories:i.raceData.regCategories,raceDate:i.raceData.eventDate},null,8,["categories","raceDate"])])):(s(),a("div",Pr,Er))]))],64)}const Br=$(Is,[["render",Mr]]);const Fr={components:{EventDetailsComponent:P,MainNav:N},data(){return{categories:{},loading:!1,error:null,raceData:{},regData:{},payment:"",payStatus:!1}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{fetchData(){this.error=null,this.loading=!0,this.$route.params.raceid&&this.$route.params.payment_id&&C(`/api/races/${this.$route.params.raceid}`).then(r=>(this.raceData=r.data,C(`/api/payments/status?payment_id=${this.$route.params.payment_id}`).then(t=>{var l;this.loading=!1,this.payStatus=t.data.status,this.paymentUrl=(l=t.data.stripePayment)==null?void 0:l.url,this.regData=t.data.regData,this.payment=t.data.regData.paytype}))).catch(r=>{this.error="Failed to load race "+this.$route.params.raceid,console.error(r)})}},computed:{sortedCats(){let r={};return m.forEach(m.orderBy(this.raceData.regCategories,"disporder"),t=>{r[t.id]=t.catdispname}),r},loaded(){return!!this.raceData},paymentOptions(){let r={};return m.forEach(this.raceData.paymentOptions,t=>{r[t.type]=t.name}),r},pendingPayment(){return!!(this.regData.raceid!=this.$route.params.raceid||this.payStatus&&this.payStatus!="paid")},sponsoredCategorySelected(){var r;return!!((r=this.selectedCategory)!=null&&r.sponsored)},selectedCategory(){return m.find(this.raceData.regCategories,{id:this.regData.category})}}},Or={key:0,class:"loading"},Lr={key:1},Ir={key:0,class:"error"},Vr={key:1},Ur={class:"row"},Ar={class:"col-md-6 order-md-1"},jr={key:0},qr=e("div",{class:"d-flex justify-content-between align-items-center mb-3"},[e("h4",null,"Your Registration is Confirmed")],-1),Yr=[qr],Hr={key:1,class:"mb-5"},Wr=e("div",{class:"d-flex justify-content-between align-items-center mb-3"},[e("h4",null,"Your Registration is Incomplete")],-1),Kr={key:0},Gr=e("p",{class:"text-danger h5"},"Please make your cash payment at the event to complete your registration.",-1),zr=e("p",null,'Your name will not show up on the "Who is signed up" list until payment is completed.',-1),Jr=[Gr,zr],Xr={key:1},Qr=["href"],Zr={class:"col"},ea={class:"row"},ta={class:"form-group pt-3"},sa={class:"form-group pt-3"},ra={key:2},aa=e("a",{href:"mailto:support@signup.bike"},"support@signup.bike",-1),ia={key:2},oa={class:"text-center"},na={class:"mt-5"};function la(r,t,l,p,i,o){const g=k("MainNav"),d=k("EventDetailsComponent"),n=k("FormKit");return s(),a(u,null,[y(g),i.loading?(s(),a("div",Or,"Loading...")):(s(),a("div",Lr,[i.error?(s(),a("div",Ir,c(i.error),1)):_("",!0),o.loaded?(s(),a("div",Vr,[y(d,{details:i.raceData.eventDetails,raceid:i.raceData.raceid},null,8,["details","raceid"]),y(n,{type:"form",id:"race-registration",disabled:"",actions:!1,modelValue:i.regData,"onUpdate:modelValue":t[0]||(t[0]=h=>i.regData=h)},{default:S(()=>[e("div",Ur,[e("div",Ar,[o.pendingPayment?_("",!0):(s(),a("div",jr,Yr)),o.pendingPayment?(s(),a("div",Hr,[Wr,i.payment==="cash"?(s(),a("div",Kr,Jr)):(s(),a("div",Xr,[e("a",{href:r.paymentUrl},"Complete your payment",8,Qr)]))])):_("",!0),e("div",Zr,[e("div",ea,[y(n,{type:"text",name:"first_name",label:"First name"}),y(n,{type:"text",name:"last_name",label:"Last name"})])]),e("div",ta,[y(n,{type:"email",name:"email",label:"Email"})]),e("div",sa,[y(n,{type:"text",name:"sponsor",label:"Your Team or Sponsor"}),y(n,{type:"select",label:"Race Category:",name:"category",options:o.sortedCats},null,8,["options"])]),o.sponsoredCategorySelected?(s(),a("div",ra,[e("h5",null," Your "+c(o.selectedCategory.catdispname)+" race entry is sponsored by "+c(o.selectedCategory.sponsorName),1)])):_("",!0)])])]),_:1},8,["modelValue"]),R(" Please send any corrections or questions to "),aa])):(s(),a("div",ia,[e("div",oa,[e("h2",na," Unable to load requested information "+c(r.$route.params.raceid)+" payment: "+c(r.$route.params.payment_id),1)])]))]))],64)}const ca=$(Fr,[["render",la]]);const da={components:{SeriesResultRow:U,SeriesNavBar:E},data(){return{categories:{},loading:!1,error:null,displayName:"",series:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{scrollMeTo(r){var t=document.querySelector(`#${r}`);t.scrollIntoView({behavior:"smooth"})},fetchData(){if(!this.$route.params.seriesid)return;this.error=null,this.loading=!0;let r=`/api/series/results/${this.$route.params.seriesid}`;C(r).then(({data:t})=>{this.loading=!1,this.categories=t.categories,this.displayName=t.displayName,this.series=this.$route.params.seriesid;let l=m.map(t.categories,p=>m.omit(p,["results","columns"]));console.log("temp:",m.orderBy(l,"disporder"))}).catch(t=>{console.error(t),this.categories={},this.error=t.toString()})}},computed:{sortedCats(){let r;return this.$route.path.indexOf("grom")>-1?r=m.filter(this.categories,t=>t.id.indexOf("grom")>-1):r=m.filter(this.categories,t=>t.id.indexOf("grom")==-1),m.orderBy(r,"disporder")},expertCats(){return m.filter(this.sortedCats,{laps:4})},sportCats(){return m.filter(this.sortedCats,{laps:3})},beginnerCats(){return m.filter(this.sortedCats,{laps:2})},gromCats(){return this.$route.path.indexOf("grom")>-1?m.filter(this.categories,r=>r.id.indexOf("grom")>-1):[]},haveResults(){return this.categories?Object.keys(this.categories).length>0:!1}}},ua={key:0,class:"loading"},ha={key:1},ma={key:0,class:"error"},_a={class:"container-fluid text-center mt-5"},pa=e("h3",null,"Series Standings",-1),ga=e("p",null,[R("Glossary of terms below:"),e("br"),R(" 1/50 = 1st Place/50 Points -/- = Did not race")],-1),ya={key:1},fa={class:"container-fluid text-center mt-5"},va={class:"list-inline"},ba=["onClick"],ka={class:"list-inline"},Da=["onClick"],$a={class:"list-inline"},Ca=["onClick"],Sa={class:"list-inline"},Ra=["onClick"],wa={class:"container-fluid"},xa=["id"],Ta={class:"table table-striped table-hover"},Pa={key:2},Na=e("div",{class:"text-center"},[e("h2",{class:"mt-5"},"No results yet...")],-1),Ea=[Na];function Ma(r,t,l,p,i,o){const g=k("SeriesNavBar"),d=k("SeriesResultRow");return s(),a(u,null,[y(g,{series:i.series},null,8,["series"]),i.loading?(s(),a("div",ua,"Loading...")):(s(),a("div",ha,[i.error?(s(),a("div",ma,c(i.error),1)):_("",!0),e("div",_a,[e("h2",null,c(i.displayName),1),pa,ga]),o.haveResults?(s(),a("div",ya,[e("div",fa,[e("ul",va,[(s(!0),a(u,null,f(o.expertCats,n=>(s(),a("li",{key:n.id,class:"list-inline-item mx-2"},[e("a",{role:"button",onClick:h=>o.scrollMeTo(n.id),class:"link-primary"},c(n.catdispname),9,ba)]))),128))]),e("ul",ka,[(s(!0),a(u,null,f(o.sportCats,n=>(s(),a("li",{key:n.id,class:"list-inline-item mx-2"},[e("a",{role:"button",onClick:h=>o.scrollMeTo(n.id),class:"link-primary"},c(n.catdispname),9,Da)]))),128))]),e("ul",$a,[(s(!0),a(u,null,f(o.beginnerCats,n=>(s(),a("li",{key:n.id,class:"list-inline-item mx-2"},[e("a",{role:"button",onClick:h=>o.scrollMeTo(n.id),class:"link-primary"},c(n.catdispname),9,Ca)]))),128))]),e("ul",Sa,[(s(!0),a(u,null,f(o.gromCats,n=>(s(),a("li",{key:n.id,class:"list-inline-item mx-2"},[e("a",{role:"button",onClick:h=>o.scrollMeTo(n.id),class:"link-primary"},c(n.catdispname),9,Ra)]))),128))])]),e("div",wa,[(s(!0),a(u,null,f(o.sortedCats,n=>(s(),a("div",{key:n.id,class:"mt-5"},[e("h3",{id:n.id},c(n.catdispname),9,xa),e("table",Ta,[e("thead",null,[e("tr",null,[(s(!0),a(u,null,f(n.columns,(h,v)=>(s(),a("th",{scope:"col",key:v},c(h),1))),128))])]),e("tbody",null,[(s(!0),a(u,null,f(n.results,(h,v)=>(s(),a("tr",{key:v},[y(d,{Pos:v,data:h},null,8,["Pos","data"])]))),128))])]),e("a",{role:"button",onClick:t[0]||(t[0]=h=>o.scrollMeTo("top")),class:"link-primary"},"Back to Top")]))),128))])])):(s(),a("div",Pa,Ea))]))],64)}const O=$(da,[["render",Ma]]),Ba={props:["data","Pos"],data(){return{count:0,dates:["5/4","5/11","5/18","5/25"]}},computed:{}};function Fa(r,t,l,p,i,o){return s(),a(u,null,[e("td",null,c(l.data.Name),1),e("td",null,c(l.data.Cat),1),(s(!0),a(u,null,f(i.dates,(g,d)=>(s(),a("td",{key:d},c(l.data[g]||"-"),1))),128))],64)}const Oa=$(Ba,[["render",Fa]]);const La={components:{ResultRow:Oa,SeriesNavBar:E},data(){return{teamResults:{},loading:!1,error:null,series:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{scrollMeTo(r){var t=document.querySelector(`#${r}`);t.scrollIntoView({behavior:"smooth"})},fetchData(){if(!this.$route.params.seriesid)return;this.error=null,this.loading=!0;let r=`/api/team-comp?series=${this.$route.params.seriesid}`;C(r).then(({data:t})=>{this.loading=!1,this.series=this.$route.params.seriesid,this.teamResults=t}).catch(t=>{console.error(t),this.teamResults={},this.error=t.toString()})}},computed:{dates:()=>{}}},Ia={key:0,class:"loading"},Va={key:1},Ua={key:0,class:"error"},Aa=e("h2",{class:"mt-5"},"Team Standings",-1),ja={class:"container-fluid mt-5"},qa={class:"table table-striped table-hover"},Ya=e("thead",null,[e("tr",null,[e("th",null,"Position"),e("th",null,"Team"),e("th",null,"Total Score")])],-1),Ha=e("h2",{class:"mt-5"},"Team Results",-1),Wa={class:"container-fluid"},Ka={class:"table table-striped table-hover"},Ga=e("thead",null,[e("tr",null,[e("th",{style:{width:"25%"}},"Racer Name"),e("th",{style:{width:"25%"}},"Class"),e("th",{style:{width:"12.5%"}},"5/4"),e("th",{style:{width:"12.5%"}},"5/11"),e("th",{style:{width:"12.5%"}},"5/18"),e("th",{style:{width:"12.5%"}},"5/25")])],-1),za={class:"table table-striped table-hover"},Ja=e("th",{style:{width:"50%","text-align":"right"}},"Score (Avg of individual results):",-1),Xa={style:{width:"12.5%"}},Qa={style:{width:"12.5%"}},Za={style:{width:"12.5%"}},ei={style:{width:"12.5%"}};function ti(r,t,l,p,i,o){const g=k("SeriesNavBar"),d=k("ResultRow");return s(),a(u,null,[y(g,{series:i.series},null,8,["series"]),i.loading?(s(),a("div",Ia,"Loading...")):(s(),a("div",Va,[i.error?(s(),a("div",Ua,c(i.error),1)):_("",!0),Aa,e("div",ja,[e("table",qa,[Ya,e("tbody",null,[(s(!0),a(u,null,f(i.teamResults.result,(n,h)=>(s(),a("tr",{key:h},[e("td",null,c(h+1),1),e("td",null,c(n.teamName),1),e("td",null,c(n.totalScore),1)]))),128))])])]),Ha,(s(!0),a(u,null,f(i.teamResults.result,(n,h)=>(s(),a("div",{class:"mt-5",key:h},[e("h3",null,c(n.teamName),1),e("div",Wa,[e("table",Ka,[Ga,e("tbody",null,[(s(!0),a(u,null,f(i.teamResults.teamDets[n.teamName],(v,b)=>(s(),a("tr",{key:b},[y(d,{data:v},null,8,["data"])]))),128))])]),e("table",za,[e("thead",null,[e("tr",null,[Ja,e("th",Xa,c(n.results["5/4"]?n.results["5/4"].avg:"-"),1),e("th",Qa,c(n.results["5/11"]?n.results["5/11"].avg:"-"),1),e("th",Za,c(n.results["5/18"]?n.results["5/18"].avg:"-"),1),e("th",ei,c(n.results["5/25"]?n.results["5/25"].avg:"-"),1)])])])])]))),128))]))],64)}const si=$(La,[["render",ti]]);const ri={components:{EventDetailsComponent:P,MainNav:N},data(){return{categories:{},loading:!1,error:null,formattedStartDate:"",series:null,stageFilter:"all",racers:[],raceData:{}}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{scrollMeTo(r){var t=document.querySelector(`#${r}`);t.scrollIntoView({behavior:"smooth"})},fetchData(){this.error=null,this.loading=!0,this.$route.params.raceid&&C(`/api/races/roster/${this.$route.params.raceid}`).then(({data:r})=>{this.raceData=r,this.series=r.series,this.loading=!1,this.categories=r.regCategories,this.racers=r.registeredRacers}).catch(r=>{var t;if(this.loading=!1,((t=r.response)==null?void 0:t.status)===404){this.error="Race not found";return}console.error(r),this.categories={},this.error=r.toString()})},replacePlusSymbol(r){return r.replace("+","Plus")},payTypeToStage(r){const t=m.find(this.raceData.paymentOptions,{type:r});return t?t.name:""}},computed:{showPaytype(){var r;return!!((r=this.raceData)!=null&&r.showPaytypeOnRoster)},filterOptions(){let r={all:"All Stages"};return m.forEach(this.raceData.paymentOptions,t=>{r[t.type]=t.name}),r},filteredRacers(){return this.showPaytype&&this.stageFilter!=="all"?m.filter(this.racers,r=>r.paytype==this.stageFilter||r.paytype=="season"):this.racers},groupedRacers(){return m.groupBy(this.filteredRacers,"category")},sortedCats(){return m.filter(m.orderBy(this.categories,"disporder"),r=>m.includes(Object.keys(this.groupedRacers),r.id))},raceDate(){return D(this.raceData.eventDate).format("ddd, MMM D")}}},ai={key:0,class:"loading"},ii={key:1},oi={key:0,class:"error"},ni={key:1,id:"top"},li={key:0},ci={class:"row"},di={key:0,class:"col-md-6"},ui={class:"container text-center mt-5"},hi={class:"list-inline"},mi=["onClick"],_i={class:"container-fluid"},pi=["id"],gi={class:"table table-striped table-hover"},yi=e("th",null," First Name ",-1),fi=e("th",null," Last Name ",-1),vi=e("th",null," Team/Sponsor ",-1),bi={key:0},ki={key:0},Di={key:1},$i=e("div",{class:"text-center"},[e("h2",{class:"mt-5"},"No registrations yet...")],-1),Ci=[$i];function Si(r,t,l,p,i,o){const g=k("MainNav"),d=k("EventDetailsComponent"),n=k("FormKit");return s(),a(u,null,[y(g),i.loading?(s(),a("div",ai,"Loading...")):(s(),a("div",ii,[i.error?(s(),a("div",oi,c(i.error),1)):(s(),a("div",ni,[y(d,{details:i.raceData.eventDetails,raceid:i.raceData.raceid},null,8,["details","raceid"]),Object.keys(i.racers).length?(s(),a("div",li,[e("div",ci,[e("div",{class:w({"col-md-6":o.showPaytype})},[e("h4",null,c(o.filteredRacers.length)+" Registered for "+c(i.raceData.displayName)+" on "+c(o.raceDate),1)],2),o.showPaytype?(s(),a("div",di,[y(n,{type:"select",label:"Show registrations for:",name:"stageFilter",modelValue:i.stageFilter,"onUpdate:modelValue":t[0]||(t[0]=h=>i.stageFilter=h),default:"all",options:o.filterOptions},null,8,["modelValue","options"])])):_("",!0)]),e("div",ui,[e("ul",hi,[(s(!0),a(u,null,f(o.sortedCats,h=>(s(),a("li",{key:h.id,class:"list-inline-item mx-2"},[e("a",{role:"button",onClick:v=>o.scrollMeTo(o.replacePlusSymbol(h.id)),class:"link-primary"},c(h.catdispname),9,mi)]))),128))])]),e("div",_i,[(s(!0),a(u,null,f(o.sortedCats,h=>(s(),a("div",{key:h.id,class:"mt-5"},[e("h3",{id:o.replacePlusSymbol(h.id)},c(h.catdispname),9,pi),e("table",gi,[e("thead",null,[e("tr",null,[yi,fi,vi,o.showPaytype?(s(),a("th",bi," Stages ")):_("",!0)])]),e("tbody",null,[(s(!0),a(u,null,f(o.groupedRacers[h.id],(v,b)=>(s(),a("tr",{key:b},[e("td",null,c(v.first_name),1),e("td",null,c(v.last_name),1),e("td",null,c(v.sponsor),1),o.showPaytype?(s(),a("td",ki,c(o.payTypeToStage(v.paytype)),1)):_("",!0)]))),128))])]),e("a",{role:"button",onClick:t[1]||(t[1]=v=>o.scrollMeTo("top")),class:"link-primary"},"Back to Top")]))),128))])])):(s(),a("div",Di,Ci))]))]))],64)}const Ri=$(ri,[["render",Si]]),wi=q({history:Y("/"),routes:[{path:"/",name:"home",component:B},{path:"/results/",name:"results",component:B},{path:"/race/:raceid",component:Rt},{path:"/result/:id",component:Wt},{path:"/result/series/:seriesid",component:Ss},{path:"/register/:raceid",name:"register",component:Br},{path:"/regconfirmation/:raceid/:payment_id",component:ca},{path:"/roster/:raceid",name:"roster",component:Ri},{path:"/series/:seriesid",component:O},{path:"/series/grom/:seriesid",component:O},{path:"/teamcomp/:seriesid",component:si}]});H.init({clientToken:"pub5b9b0cfce30b3b609b588d9f3ac85ebb",site:"datadoghq.com",env:"production",service:"public-site",version:"1.0.1",forwardErrorsToLogs:!0,sampleRate:100});const M=W(Q);M.use(K,G);M.use(wi);M.mount("#app");
//# sourceMappingURL=main-4e702397.js.map
