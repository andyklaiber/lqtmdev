import{R as X,_ as C,o as s,c as a,a as y,r as k,b as e,t as l,F as p,d as v,e as g,f as S,w,g as R,n as O,h as _,i as E,j as $,k as q,l as Z,m as J,p as Q,q as ee,s as te}from"./theme.7660216d.js";const se={components:{RouterView:X},data(){return{races:[]}},mounted:function(){window.location.hash=="#/"&&this.$router.push("/series/pcrs_2022")},computed:{}},re={class:"container"};function ae(t,r,c,f,n,o){const u=k("RouterView");return s(),a("div",re,[y(u)])}const ie=C(se,[["render",ae]]);let oe=t=>{const r=new Date(Date.UTC(0,0,0,0,0,0,t));let f=[r.getUTCMinutes(),r.getUTCSeconds()].map(n=>String(n).padStart(2,"0")).join(":");return r.getUTCHours()&&(f=r.getUTCHours()+":"+f),f};const ne={props:["data","Pos","totLaps"],data(){return{count:0}},computed:{incompleteLaps(){return new Array(this.totLaps-this.data.laps.length).fill("-")},formattedTime(){return oe(this.data.duration)}}};function le(t,r,c,f,n,o){return s(),a(p,null,[e("td",null,l(c.Pos+1),1),e("td",null,l(c.data.Bib),1),e("td",null,l(c.data.Name),1),e("td",null,l(c.data.Sponsor),1),(s(!0),a(p,null,v(c.data.laps,(u,d)=>(s(),a("td",{key:d},l(u.timeString),1))),128)),c.totLaps-c.data.laps.length>0?(s(!0),a(p,{key:0},v(o.incompleteLaps,u=>(s(),a("td",null,l(u),1))),256)):g("",!0),e("td",null,l(o.formattedTime),1),e("td",null,l(c.data.back||"-"),1)],64)}const ce=C(ne,[["render",le]]),de={props:["series"],data(){return{count:0,seriesData:{}}},created(){this.$watch(()=>this.series,function(){if(!this.series)return;let t=`/api/series/${this.series}/races`;S(t).then(({data:r})=>{this.seriesData=r})})},computed:{isPcrs(){return this.series&&this.series.indexOf("pcrs")>-1}}},ue={id:"top",class:"navbar navbar-light bg-light"},he={class:"container-fluid"},me={class:"navbar-brand",href:"#"},_e={key:0,class:"nav-item"},pe=["href"],fe=e("p",{class:"mt-3"},"View Weekly lap times:",-1),ye={class:"nav nav-tabs mt-1 justify-content-center"},ge={key:0,class:"nav-item"},ve=R("Series Standings"),be={key:1,class:"nav-item"},$e=R("Grom Series Standings"),ke={key:2,class:"nav-item"},Ce=R("Team Competition");function De(t,r,c,f,n,o){const u=k("RouterLink");return s(),a(p,null,[e("nav",ue,[e("div",he,[e("div",me,l(n.seriesData.displayName),1),n.seriesData.homepage?(s(),a("div",_e,[e("a",{class:"nav-link active","aria-current":"page",href:n.seriesData.homepage.url},l(n.seriesData.homepage.linkString),9,pe)])):g("",!0)])]),fe,e("ul",ye,[(s(!0),a(p,null,v(n.seriesData.races,d=>(s(),a("li",{key:d.raceid,class:"nav-item"},[y(u,{class:O(["nav-link",{active:t.$route.params.raceid===d.raceid}]),to:`/race/${d.raceid}`},{default:w(()=>[R(l(d.displayName+` - ${d.formattedStartDate}`),1)]),_:2},1032,["class","to"])]))),128)),o.isPcrs?(s(),a("li",ge,[y(u,{class:O(["nav-link",{active:t.$route.path=="/series/pcrs_2022"}]),to:"/series/pcrs_2022"},{default:w(()=>[ve]),_:1},8,["class"])])):g("",!0),o.isPcrs?(s(),a("li",be,[y(u,{class:O(["nav-link",{active:t.$route.path=="/series/grom/pcrs_2022"}]),to:"/series/grom/pcrs_2022"},{default:w(()=>[$e]),_:1},8,["class"])])):g("",!0),o.isPcrs?(s(),a("li",ke,[y(u,{class:O(["nav-link",{active:t.$route.path=="/teamcomp/pcrs_2022"}]),to:"/teamcomp/pcrs_2022"},{default:w(()=>[Ce]),_:1},8,["class"])])):g("",!0)])],64)}const N=C(de,[["render",De]]);const Se={components:{ResultRow:ce,SeriesNavBar:N},data(){return{categories:{},loading:!1,error:null,formattedStartDate:"",series:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{scrollMeTo(t){var r=document.querySelector(`#${t}`);r.scrollIntoView({behavior:"smooth"})},fetchData(){if(this.error=null,this.loading=!0,this.$route.params.raceid){let t=`/api/races/results/${this.$route.params.raceid}`;S(t).then(({data:r})=>{this.formattedStartDate=r.raceMeta.formattedStartDate,this.series=r.series,this.loading=!1,this.categories=r.categories}).catch(r=>{console.error(r),this.categories={},this.error=r.toString()})}}},computed:{sortedCats(){return _.orderBy(this.categories,"disporder")},expertCats(){return _.filter(this.sortedCats,{laps:4})},sportCats(){return _.filter(this.sortedCats,{laps:3})},beginnerCats(){return _.filter(this.sortedCats,{laps:2})},gromCats(){return _.filter(this.categories,t=>t.id.indexOf("grom")>-1)},haveResults(){return this.categories?Object.keys(this.categories).length>0:!1}}},xe={key:0,class:"text-center"},Te={class:"mt-5"},Re={key:1,class:"loading"},we={key:2},Oe={key:0,class:"error"},Pe={key:1},Me={class:"container text-center mt-5"},Ee={class:"list-inline"},Fe=["onClick"],Ue={class:"list-inline"},Be=["onClick"],Ne={class:"list-inline"},Ye=["onClick"],Ve={class:"list-inline"},Le=["onClick"],je={class:"container-fluid"},Ae=["id"],Ie={class:"table table-striped table-hover"},qe={key:2},He=e("div",{class:"text-center"},[e("h2",{class:"mt-5"},"No results yet...")],-1),Ke=[He];function We(t,r,c,f,n,o){const u=k("SeriesNavBar"),d=k("ResultRow");return s(),a(p,null,[y(u,{series:n.series},null,8,["series"]),n.formattedStartDate?(s(),a("div",xe,[e("h2",Te,"Race Results - "+l(n.formattedStartDate),1)])):g("",!0),n.loading?(s(),a("div",Re,"Loading...")):(s(),a("div",we,[n.error?(s(),a("div",Oe,l(n.error),1)):g("",!0),o.haveResults?(s(),a("div",Pe,[e("div",Me,[e("ul",Ee,[(s(!0),a(p,null,v(o.expertCats,(i,h)=>(s(),a("li",{key:i.id,class:"list-inline-item mx-2"},[e("a",{role:"button",onClick:b=>o.scrollMeTo(i.id),class:"link-primary"},l(i.catdispname),9,Fe)]))),128))]),e("ul",Ue,[(s(!0),a(p,null,v(o.sportCats,(i,h)=>(s(),a("li",{key:i.id,class:"list-inline-item mx-2"},[e("a",{role:"button",onClick:b=>o.scrollMeTo(i.id),class:"link-primary"},l(i.catdispname),9,Be)]))),128))]),e("ul",Ne,[(s(!0),a(p,null,v(o.beginnerCats,(i,h)=>(s(),a("li",{key:i.id,class:"list-inline-item mx-2"},[e("a",{role:"button",onClick:b=>o.scrollMeTo(i.id),class:"link-primary"},l(i.catdispname),9,Ye)]))),128))]),e("ul",Ve,[(s(!0),a(p,null,v(o.gromCats,(i,h)=>(s(),a("li",{key:i.id,class:"list-inline-item mx-2"},[e("a",{role:"button",onClick:b=>o.scrollMeTo(i.id),class:"link-primary"},l(i.catdispname),9,Le)]))),128))])]),e("div",je,[(s(!0),a(p,null,v(o.sortedCats,(i,h)=>(s(),a("div",{key:i.id,class:"mt-5"},[e("h3",{id:i.id},l(i.catdispname),9,Ae),e("table",Ie,[e("thead",null,[e("tr",null,[(s(!0),a(p,null,v(i.columns,(b,T)=>(s(),a("th",{scope:"col",key:T},l(b),1))),128))])]),e("tbody",null,[(s(!0),a(p,null,v(i.results,(b,T)=>(s(),a("tr",{key:T},[y(d,{totLaps:i.laps,Pos:T,data:b},null,8,["totLaps","Pos","data"])]))),128))])]),e("a",{role:"button",onClick:r[0]||(r[0]=b=>o.scrollMeTo("top")),class:"link-primary"},"Back to Top")]))),128))])])):(s(),a("div",qe,Ke))]))],64)}const Ge=C(Se,[["render",We]]),ze={props:["url"],created(){(function(t,r,c){var f,n=t.getElementsByTagName(r)[0];t.getElementById(c)||(f=t.createElement(r),f.id=c,f.src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0",n.parentNode.insertBefore(f,n))})(document,"script","facebook-jssdk")},mounted(){FB.XFBML.parse()}},Xe={id:"1"},Ze=e("div",{id:"fb-root"},null,-1),Je=["data-href"];function Qe(t,r,c,f,n,o){return s(),a("div",Xe,[Ze,e("div",{class:"fb-share-button","data-href":this.url,"data-layout":"button","data-size":"large"},null,8,Je)])}const et=C(ze,[["render",Qe]]),tt={components:{FbShareComponent:et},props:["details"],data(){return{}},computed:{isRosterPage(){return this.$route.path.includes("/roster/")}}},st={class:"container mb-4"},rt={class:"row p-4 pb-0 pe-lg-0 pt-lg-3 align-items-center rounded-3 border shadow"},at={class:"col-lg-3 offset-lg-1 p-0"},it=["src"],ot={class:"col-lg-7 p-3 p-lg-3 pt-lg-3"},nt={class:"display-5 fw-bold lh-3"},lt={class:"lead"},ct={key:0,class:"d-grid gap-2 d-md-flex justify-content-md-between mb-4 mb-lg-3"},dt=["href"],ut={key:0},ht=R("See who is signed up");function mt(t,r,c,f,n,o){const u=k("FbShareComponent"),d=k("RouterLink");return s(),a("div",st,[e("div",rt,[e("div",at,[e("img",{class:"pb-3",src:c.details.logoUrl,alt:"",width:"200"},null,8,it)]),e("div",ot,[e("h3",nt,l(c.details.name),1),e("p",lt,l(c.details.tagline),1),c.details.homepageUrl?(s(),a("div",ct,[e("a",{href:c.details.homepageUrl},"Event Homepage",8,dt),c.details.facebookShare?(s(),a("div",ut,[y(u,{url:c.details.homepageUrl},null,8,["url"])])):g("",!0)])):g("",!0),o.isRosterPage?g("",!0):(s(),E(d,{key:1,to:`/roster/${t.$route.params.raceid}`},{default:w(()=>[ht]),_:1},8,["to"]))])])])}const Y=C(tt,[["render",mt]]),_t={props:["categories","raceDate"],data(){return{}},methods:{formatStartTime(t){return $(`${$(this.raceDate).format("YYYY-MM-DD")} ${t}`).format("h:mm A")}},computed:{groupByStartTimes(){return _.groupBy(_.orderBy(this.categories,["startTime","disporder"]),"startTime")},hasStartTimes(){return!!_.some(this.categories,"startTime")}}},pt={key:0},ft=e("h5",null,"Race Start Times:",-1),yt={class:"row gap-5 mb-3"},gt={class:""},vt={class:"row g-2 px-4 gx-4 border bg-light"};function bt(t,r,c,f,n,o){return c.categories.length&&o.hasStartTimes?(s(),a("div",pt,[ft,e("div",yt,[(s(!0),a(p,null,v(o.groupByStartTimes,(u,d)=>(s(),a("div",{key:d,class:"col-md-5"},[e("h6",gt,l(o.formatStartTime(d))+":",1),e("div",vt,[(s(!0),a(p,null,v(o.groupByStartTimes[d],i=>(s(),a("div",{key:i.id,class:"col-lg text-nowrap my-1"},l(i.catdispname),1))),128))])]))),128))])])):g("",!0)}const $t=C(_t,[["render",bt]]);var H={exports:{}};(function(t,r){(function(c,f){t.exports=f()})(q,function(){var c="minute",f=/[+-]\d\d(?::?\d\d)?/g,n=/([+-]|\d\d)/g;return function(o,u,d){var i=u.prototype;d.utc=function(m){var D={date:m,utc:!0,args:arguments};return new u(D)},i.utc=function(m){var D=d(this.toDate(),{locale:this.$L,utc:!0});return m?D.add(this.utcOffset(),c):D},i.local=function(){return d(this.toDate(),{locale:this.$L,utc:!1})};var h=i.parse;i.parse=function(m){m.utc&&(this.$u=!0),this.$utils().u(m.$offset)||(this.$offset=m.$offset),h.call(this,m)};var b=i.init;i.init=function(){if(this.$u){var m=this.$d;this.$y=m.getUTCFullYear(),this.$M=m.getUTCMonth(),this.$D=m.getUTCDate(),this.$W=m.getUTCDay(),this.$H=m.getUTCHours(),this.$m=m.getUTCMinutes(),this.$s=m.getUTCSeconds(),this.$ms=m.getUTCMilliseconds()}else b.call(this)};var T=i.utcOffset;i.utcOffset=function(m,D){var P=this.$utils().u;if(P(m))return this.$u?0:P(this.$offset)?T.call(this):this.$offset;if(typeof m=="string"&&(m=function(F){F===void 0&&(F="");var A=F.match(f);if(!A)return null;var U=(""+A[0]).match(n)||["-",0,0],z=U[0],B=60*+U[1]+ +U[2];return B===0?0:z==="+"?B:-B}(m),m===null))return this;var M=Math.abs(m)<=16?60*m:m,x=this;if(D)return x.$offset=M,x.$u=m===0,x;if(m!==0){var j=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(x=this.local().add(M+j,c)).$offset=M,x.$x.$localOffset=j}else x=this.utc();return x};var W=i.format;i.format=function(m){var D=m||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return W.call(this,D)},i.valueOf=function(){var m=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*m},i.isUTC=function(){return!!this.$u},i.toISOString=function(){return this.toDate().toISOString()},i.toString=function(){return this.toDate().toUTCString()};var G=i.toDate;i.toDate=function(m){return m==="s"&&this.$offset?d(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():G.call(this)};var L=i.diff;i.diff=function(m,D,P){if(m&&this.$u===m.$u)return L.call(this,m,D,P);var M=this.local(),x=d(m).local();return L.call(M,x,D,P)}}})})(H);const kt=H.exports;var K={exports:{}};(function(t,r){(function(c,f){t.exports=f()})(q,function(){return function(c,f,n){var o=function(u,d){if(!d||!d.length||!d[0]||d.length===1&&!d[0].length)return null;var i;d.length===1&&d[0].length>0&&(d=d[0]),i=d[0];for(var h=1;h<d.length;h+=1)d[h].isValid()&&!d[h][u](i)||(i=d[h]);return i};n.max=function(){var u=[].slice.call(arguments,0);return o("isAfter",u)},n.min=function(){var u=[].slice.call(arguments,0);return o("isBefore",u)}}})})(K);const Ct=K.exports;$.extend(Ct);$.extend(kt);const Dt={components:{EventDetailsComponent:Y,EventCategoryScheduleComponent:$t},data(){return{categories:{},loading:!1,error:null,formError:[],formInputData:{},raceData:{},payment:"",birthdate:"1990-03-05",submitted:!1,couponError:[]}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{dollas(t){return t.toLocaleString("en-US",{style:"currency",currency:"USD"})},fetchData(){this.error=null,this.loading=!0,this.$route.params.raceid&&S(`/api/races/${this.$route.params.raceid}`).then(t=>{this.raceData=t.data,this.loading=!1,this.payment=this.raceData.paymentOptions[0].type}).catch(t=>{this.loading=!1,this.error=t.toString(),console.error(t)})},getCouponPricing(t){S.post("/api/payments/pricing",{raceid:`${this.$route.params.raceid}`,couponCode:t}).then(({data:r})=>{this.raceData.paymentOptions=r.paymentOptions,r.validCoupon?this.couponError=[]:this.couponError=["Invalid Coupon Code"]})},onCouponChange(t){t?this.getCouponPricing(t):this.couponError=[]},submitForm(t){t.preventDefault(),this.$formkit.submit("race-registration")},async submit(t){console.log(t),t.birthdate=void 0,t.racerAge=this.racerAge,t.paytype=this.payment,await S.post(`/api/payments/start-registration?race=${this.raceData.raceid}`,t).then(r=>{if(r.data)return this.submitted=!0,console.log(r.data),new Promise(c=>setTimeout(()=>{window.location.href=r.data,c()},2e3))}).catch(r=>{this.formError=["Error submitting request"],console.log(r)})},getEventTimeObj(t){return $(`${$(this.raceData.eventDate).format("YYYY-MM-DD")} ${t}`)}},computed:{startTimes(){return this.hasStartTimes?_.map(_.uniqBy(this.raceData.regCategories,"startTime"),"startTime"):null},hasStartTimes(){return!!_.some(this.raceData.regCategories,"startTime")},currentTime(){return $().local().format()},firstRaceTime(){if(this.hasStartTimes)return $.min(_.map(this.startTimes,t=>$(`${this.eventDateFormatted} ${t}`)))},lastRaceTime(){if(this.hasStartTimes)return $.max(_.map(this.startTimes,t=>$(`${this.eventDateFormatted} ${t}`)))},sortedCats(){if(!this.racerAge&&this.formInputData.category==null)return[];const t=_.filter(this.raceData.regCategories,c=>!(c.startTime&&$().isAfter(this.getEventTimeObj(c.startTime).subtract(20,"minute"))||c.minAge&&this.racerAge<c.minAge||c.maxAge&&this.racerAge>c.maxAge));let r={};return _.forEach(_.orderBy(t,"disporder"),c=>{r[c.id]=c.catdispname}),r},loaded(){return!!this.raceData},submitLabel(){return this.payment=="cash"?"Sign Up!":"Go to Payment"},cashEnabled(){return $().isAfter(this.lastRaceTime.subtract(3,"hour"))},eventDateFormatted(){return $(this.raceData.eventDate).format("YYYY-MM-DD")},regDisabled(){return $().isAfter(this.lastRaceTime.subtract(20,"minute"))},paymentOptions(){let t={};return _.forEach(this.raceData.paymentOptions,r=>{t[r.type]=r.name}),this.cashEnabled&&(t.cash="Cash Payment (Today's Race)"),t},paymentCostDets(){var o;if(this.sponsoredCategorySelected)return this.payment="season",{cost:this.dollas(0),regFee:this.dollas(0),tot:this.dollas(0)};let t;this.payment==="cash"?t="single":t=this.payment;const r=_.find((o=this.raceData)==null?void 0:o.paymentOptions,u=>u.type===t);if(!r)return null;const c=parseFloat(r.amount);let f=0;c>0&&this.payment!=="cash"&&(f=(r.regFee+r.stripeFee)/100);const n={};return _.assign(n,r,{name:r.name,cost:this.dollas(c),regFee:this.dollas(f),tot:this.dollas(parseFloat(r.amount)+parseFloat(f))}),n},showPaymentOption(){return!(this.sponsoredCategorySelected||this.raceData.paymentOptions&&this.raceData.paymentOptions.length<2)},sponsoredCategorySelected(){var t;return!!((t=this.selectedCategory)!=null&&t.sponsored)},selectedCategory(){var t,r;return this.formInputData&&this.formInputData.category?_.find((t=this.raceData)==null?void 0:t.regCategories,{id:(r=this.formInputData)==null?void 0:r.category}):null},racerAge(){if(this.birthdate){const t=$(),r=$(this.birthdate);return t.year()-r.year()}}}},St={key:0,class:"loading"},xt={key:1},Tt={key:0,class:"error"},Rt={key:1},wt={key:0},Ot=e("h3",null,"Registration is closed",-1),Pt=[Ot],Mt={key:1},Et={class:"row"},Ft={class:"col-md-6 order-md-1 mb-3"},Ut=e("h4",{class:"d-flex justify-content-between align-items-center mb-3"},[e("h5",null,"Registration Info"),e("span",{class:"badge badge-secondary badge-pill"},"3")],-1),Bt={class:"col"},Nt={class:"form-group pt-3"},Yt={class:"form-group pt-3"},Vt={key:0,class:"col-md-5 order-md-2 mb-4"},Lt=e("h4",{class:"d-flex justify-content-between align-items-center mb-3"},[e("h5",null,"Payment Detail"),e("span",{class:"badge badge-secondary badge-pill"},"3")],-1),jt={class:"list-group mb-3"},At={class:"list-group mb-3"},It={class:"list-group mb-3 formkit-fieldset"},qt={class:"list-group-item d-flex justify-content-between lh-condensed"},Ht=e("h6",{class:"my-0"},"Race Entry:",-1),Kt={class:"text-muted"},Wt={key:0,class:"mx-3 text-decoration-line-through text-danger"},Gt={class:"list-group-item d-flex justify-content-between lh-condensed"},zt=e("div",null,[e("h6",{class:"my-0"},"Online Processing Fee:"),e("small",{class:"text-muted"},"Credit Card and Online Registration")],-1),Xt={class:"text-muted"},Zt={class:"list-group-item d-flex justify-content-between"},Jt=e("span",null,"Total (USD)",-1),Qt={key:0},es=e("h2",{class:"text-danger"},"Your registration will not be active until payment is received at the event",-1),ts=[es],ss={key:1},rs={key:0},as=e("h2",null,"Submission successful, redirecting",-1),is=[as],os={key:2},ns=e("div",{class:"text-center"},[e("h2",{class:"mt-5"},"Race not available for registration...")],-1),ls=[ns];function cs(t,r,c,f,n,o){const u=k("EventDetailsComponent"),d=k("FormKit"),i=k("EventCategoryScheduleComponent");return n.loading?(s(),a("div",St,"Loading...")):(s(),a("div",xt,[n.error?(s(),a("div",Tt,l(n.error),1)):g("",!0),o.loaded?(s(),a("div",Rt,[y(u,{details:n.raceData.eventDetails},null,8,["details"]),o.regDisabled?(s(),a("div",wt,Pt)):(s(),a("div",Mt,[y(d,{type:"form",id:"race-registration",modelValue:n.formInputData,"onUpdate:modelValue":r[2]||(r[2]=h=>n.formInputData=h),"form-class":n.submitted?"hide":"show",errors:n.formError,actions:!1,onSubmit:o.submit},{default:w(()=>[e("div",Et,[e("div",Ft,[Ut,e("div",Bt,[y(d,{type:"text",name:"first_name",label:"First name",help:"What is your first name",validation:"required"}),y(d,{type:"text",name:"last_name",label:"Last name",help:"What is your last name",validation:"required"})]),e("div",Nt,[y(d,{type:"email",name:"email",label:"Your email",help:"Enter an email address",validation:"required|email"})]),y(d,{type:"text",name:"sponsor",label:"Your Team or Sponsor",help:"Enter an optional Team or Sponsor name"}),y(d,{type:"date",value:"2001-01-01",name:"birthdate",label:"Birthday",modelValue:n.birthdate,"onUpdate:modelValue":r[0]||(r[0]=h=>n.birthdate=h),help:"Enter your birthday to see Race Categories",validation:"required|before:2020-01-01","validation-visibility":"live"},null,8,["modelValue"]),e("div",Yt,[y(d,{type:"select",id:"category",label:"Race Category:",placeholder:"Select a category",name:"category",options:o.sortedCats,validation:"required","validation-visibility":"dirty","validation-messages":{is:"You must select a race category"}},null,8,["options"])])]),o.paymentCostDets?(s(),a("div",Vt,[Lt,e("fieldset",jt,[e("div",null,[n.raceData.couponsEnabled?(s(),E(d,{key:0,type:"text",name:"coupon",label:"Coupon Code",help:"",delay:1500,onInput:o.onCouponChange,errors:n.couponError},null,8,["onInput","errors"])):g("",!0)])]),e("fieldset",At,[e("div",null,[o.showPaymentOption?(s(),E(d,{key:0,type:"radio",name:"paytype",label:"Payment option",options:o.paymentOptions,validation:"required",modelValue:n.payment,"onUpdate:modelValue":r[1]||(r[1]=h=>n.payment=h)},null,8,["options","modelValue"])):g("",!0)])]),e("ul",It,[e("li",qt,[e("div",null,[Ht,e("small",Kt,l(o.paymentCostDets.name),1)]),e("div",null,[o.paymentCostDets.discounted?(s(),a("span",Wt,l(o.dollas(o.paymentCostDets.orig)),1)):g("",!0),e("span",{class:O({"text-success":o.paymentCostDets.discounted})},l(o.paymentCostDets.cost),3)])]),e("li",Gt,[zt,e("span",Xt,l(o.paymentCostDets.regFee),1)]),e("li",Zt,[Jt,e("strong",null,l(o.paymentCostDets.tot),1)])])])):g("",!0)]),n.payment==="cash"?(s(),a("div",Qt,ts)):g("",!0),o.sponsoredCategorySelected?(s(),a("div",ss,[e("h5",null,"Your "+l(o.selectedCategory.catdispname)+" race entry is sponsored by "+l(o.selectedCategory.sponsorName),1),y(d,{type:"submit",label:"Sign Up!",onClick:o.submitForm},null,8,["onClick"])])):g("",!0),o.sponsoredCategorySelected?g("",!0):(s(),E(d,{key:2,type:"submit",label:o.submitLabel,onClick:o.submitForm},null,8,["label","onClick"]))]),_:1},8,["modelValue","form-class","errors","onSubmit"]),n.submitted?(s(),a("div",rs,is)):g("",!0),y(i,{categories:n.raceData.regCategories,raceDate:n.raceData.eventDate},null,8,["categories","raceDate"])]))])):(s(),a("div",os,ls))]))}const ds=C(Dt,[["render",cs]]);const us={components:{EventDetailsComponent:Y},data(){return{categories:{},loading:!1,error:null,raceData:{},regData:{},payment:"",payStatus:!1}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{fetchData(){this.error=null,this.loading=!0,this.$route.params.raceid&&this.$route.params.payment_id&&S(`/api/races/${this.$route.params.raceid}`).then(t=>(this.raceData=t.data,S(`/api/payments/status?payment_id=${this.$route.params.payment_id}`).then(r=>{var c;this.loading=!1,this.payStatus=r.data.status,this.paymentUrl=(c=r.data.stripePayment)==null?void 0:c.url,this.regData=r.data.regData,this.payment=r.data.regData.paytype}))).catch(t=>{this.error="Failed to load race "+this.$route.params.raceid,console.error(t)})}},computed:{sortedCats(){let t={};return _.forEach(_.orderBy(this.raceData.regCategories,"disporder"),r=>{t[r.id]=r.catdispname}),t},loaded(){return!!this.raceData},paymentOptions(){let t={};return _.forEach(this.raceData.paymentOptions,r=>{t[r.type]=r.name}),t},pendingPayment(){return!!(this.regData.raceid!=this.$route.params.raceid||this.payStatus&&this.payStatus!="paid")},sponsoredCategorySelected(){var t;return!!((t=this.selectedCategory)!=null&&t.sponsored)},selectedCategory(){return _.find(this.raceData.regCategories,{id:this.regData.category})}}},hs={key:0,class:"loading"},ms={key:1},_s={key:0,class:"error"},ps={key:1},fs={class:"row"},ys={class:"col-md-6 order-md-1"},gs={key:0},vs=e("div",{class:"d-flex justify-content-between align-items-center mb-3"},[e("h4",null,"Your Registration is Confirmed")],-1),bs=[vs],$s={key:1,class:"mb-5"},ks=e("div",{class:"d-flex justify-content-between align-items-center mb-3"},[e("h4",null,"Your Registration is Incomplete")],-1),Cs={key:0},Ds=e("p",{class:"text-danger h5"},"Please make your cash payment at the event to complete your registration.",-1),Ss=e("p",null,'Your name will not show up on the "Who is signed up" list until payment is completed.',-1),xs=[Ds,Ss],Ts={key:1},Rs=["href"],ws={class:"col"},Os={class:"row"},Ps={class:"form-group pt-3"},Ms={class:"form-group pt-3"},Es={key:2},Fs=R(" Please send any corrections or questions to "),Us=e("a",{href:"mailto:support@signup.bike"},"support@signup.bike",-1),Bs={key:2},Ns={class:"text-center"},Ys={class:"mt-5"};function Vs(t,r,c,f,n,o){const u=k("EventDetailsComponent"),d=k("FormKit");return n.loading?(s(),a("div",hs,"Loading...")):(s(),a("div",ms,[n.error?(s(),a("div",_s,l(n.error),1)):g("",!0),o.loaded?(s(),a("div",ps,[y(u,{details:n.raceData.eventDetails},null,8,["details"]),y(d,{type:"form",id:"race-registration",disabled:"",actions:!1,modelValue:n.regData,"onUpdate:modelValue":r[0]||(r[0]=i=>n.regData=i)},{default:w(()=>[e("div",fs,[e("div",ys,[o.pendingPayment?g("",!0):(s(),a("div",gs,bs)),o.pendingPayment?(s(),a("div",$s,[ks,n.payment==="cash"?(s(),a("div",Cs,xs)):(s(),a("div",Ts,[e("a",{href:t.paymentUrl},"Complete your payment",8,Rs)]))])):g("",!0),e("div",ws,[e("div",Os,[y(d,{type:"text",name:"first_name",label:"First name"}),y(d,{type:"text",name:"last_name",label:"Last name"})])]),e("div",Ps,[y(d,{type:"email",name:"email",label:"Email"})]),e("div",Ms,[y(d,{type:"text",name:"sponsor",label:"Your Team or Sponsor"}),y(d,{type:"select",label:"Race Category:",name:"category",options:o.sortedCats},null,8,["options"])]),o.sponsoredCategorySelected?(s(),a("div",Es,[e("h5",null," Your "+l(o.selectedCategory.catdispname)+" race entry is sponsored by "+l(o.selectedCategory.sponsorName),1)])):g("",!0)])])]),_:1},8,["modelValue"]),Fs,Us])):(s(),a("div",Bs,[e("div",Ns,[e("h2",Ys," Unable to load requested information "+l(t.$route.params.raceid)+" payment: "+l(t.$route.params.payment_id),1)])]))]))}const Ls=C(us,[["render",Vs]]);const js={props:["data","Pos"],data(){return{count:0}},computed:{}};function As(t,r,c,f,n,o){return s(),a(p,null,[e("td",null,l(c.Pos+1),1),e("td",null,l(c.data.Bib),1),e("td",null,l(c.data.Name),1),e("td",null,l(c.data.Age),1),e("td",null,l(c.data.Sponsor),1),(s(!0),a(p,null,v(c.data.results,(u,d)=>(s(),a("td",{class:O({"text-danger":u.dropped}),key:d},l(u.resultString),3))),128)),e("td",null,l(c.data.seriesPoints),1)],64)}const Is=C(js,[["render",As]]);const qs={components:{SeriesResultRow:Is,SeriesNavBar:N},data(){return{categories:{},loading:!1,error:null,displayName:"",series:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{scrollMeTo(t){var r=document.querySelector(`#${t}`);r.scrollIntoView({behavior:"smooth"})},fetchData(){if(!this.$route.params.seriesid)return;this.error=null,this.loading=!0;let t=`/api/series/results/${this.$route.params.seriesid}`;S(t).then(({data:r})=>{this.loading=!1,this.categories=r.categories,this.displayName=r.displayName,this.series=this.$route.params.seriesid}).catch(r=>{console.error(r),this.categories={},this.error=r.toString()})}},computed:{sortedCats(){let t;return this.$route.path.indexOf("grom")>-1?t=_.filter(this.categories,r=>r.id.indexOf("grom")>-1):t=_.filter(this.categories,r=>r.id.indexOf("grom")==-1),_.orderBy(t,"disporder")},expertCats(){return _.filter(this.sortedCats,{laps:4})},sportCats(){return _.filter(this.sortedCats,{laps:3})},beginnerCats(){return _.filter(this.sortedCats,{laps:2})},gromCats(){return this.$route.path.indexOf("grom")>-1?_.filter(this.categories,t=>t.id.indexOf("grom")>-1):[]},haveResults(){return this.categories?Object.keys(this.categories).length>0:!1}}},Hs={key:0,class:"loading"},Ks={key:1},Ws={key:0,class:"error"},Gs={class:"container-fluid text-center mt-5"},zs=e("h3",null,"Series Standings",-1),Xs=e("p",null,[R("Glossary of terms below:"),e("br"),R(" 1/50 = 1st Place/50 Points -/- = Did not race")],-1),Zs={key:1},Js={class:"container-fluid text-center mt-5"},Qs={class:"list-inline"},er=["onClick"],tr={class:"list-inline"},sr=["onClick"],rr={class:"list-inline"},ar=["onClick"],ir={class:"list-inline"},or=["onClick"],nr={class:"container-fluid"},lr=["id"],cr={class:"table table-striped table-hover"},dr={key:2},ur=e("div",{class:"text-center"},[e("h2",{class:"mt-5"},"No results yet...")],-1),hr=[ur];function mr(t,r,c,f,n,o){const u=k("SeriesNavBar"),d=k("SeriesResultRow");return s(),a(p,null,[y(u,{series:n.series},null,8,["series"]),n.loading?(s(),a("div",Hs,"Loading...")):(s(),a("div",Ks,[n.error?(s(),a("div",Ws,l(n.error),1)):g("",!0),e("div",Gs,[e("h2",null,l(n.displayName),1),zs,Xs]),o.haveResults?(s(),a("div",Zs,[e("div",Js,[e("ul",Qs,[(s(!0),a(p,null,v(o.expertCats,i=>(s(),a("li",{key:i.id,class:"list-inline-item mx-2"},[e("a",{role:"button",onClick:h=>o.scrollMeTo(i.id),class:"link-primary"},l(i.catdispname),9,er)]))),128))]),e("ul",tr,[(s(!0),a(p,null,v(o.sportCats,i=>(s(),a("li",{key:i.id,class:"list-inline-item mx-2"},[e("a",{role:"button",onClick:h=>o.scrollMeTo(i.id),class:"link-primary"},l(i.catdispname),9,sr)]))),128))]),e("ul",rr,[(s(!0),a(p,null,v(o.beginnerCats,i=>(s(),a("li",{key:i.id,class:"list-inline-item mx-2"},[e("a",{role:"button",onClick:h=>o.scrollMeTo(i.id),class:"link-primary"},l(i.catdispname),9,ar)]))),128))]),e("ul",ir,[(s(!0),a(p,null,v(o.gromCats,i=>(s(),a("li",{key:i.id,class:"list-inline-item mx-2"},[e("a",{role:"button",onClick:h=>o.scrollMeTo(i.id),class:"link-primary"},l(i.catdispname),9,or)]))),128))])]),e("div",nr,[(s(!0),a(p,null,v(o.sortedCats,i=>(s(),a("div",{key:i.id,class:"mt-5"},[e("h3",{id:i.id},l(i.catdispname),9,lr),e("table",cr,[e("thead",null,[e("tr",null,[(s(!0),a(p,null,v(i.columns,(h,b)=>(s(),a("th",{scope:"col",key:b},l(h),1))),128))])]),e("tbody",null,[(s(!0),a(p,null,v(i.results,(h,b)=>(s(),a("tr",{key:b},[y(d,{Pos:b,data:h},null,8,["Pos","data"])]))),128))])]),e("a",{role:"button",onClick:r[0]||(r[0]=h=>o.scrollMeTo("top")),class:"link-primary"},"Back to Top")]))),128))])])):(s(),a("div",dr,hr))]))],64)}const I=C(qs,[["render",mr]]),_r={props:["data","Pos"],data(){return{count:0,dates:["5/4","5/11","5/18","5/25"]}},computed:{}};function pr(t,r,c,f,n,o){return s(),a(p,null,[e("td",null,l(c.data.Name),1),e("td",null,l(c.data.Cat),1),(s(!0),a(p,null,v(n.dates,(u,d)=>(s(),a("td",{key:d},l(c.data[u]||"-"),1))),128))],64)}const fr=C(_r,[["render",pr]]);const yr={components:{ResultRow:fr,SeriesNavBar:N},data(){return{teamResults:{},loading:!1,error:null,series:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{scrollMeTo(t){var r=document.querySelector(`#${t}`);r.scrollIntoView({behavior:"smooth"})},fetchData(){if(!this.$route.params.seriesid)return;this.error=null,this.loading=!0;let t=`/api/team-comp?series=${this.$route.params.seriesid}`;S(t).then(({data:r})=>{this.loading=!1,this.series=this.$route.params.seriesid,this.teamResults=r}).catch(r=>{console.error(r),this.teamResults={},this.error=r.toString()})}},computed:{dates:()=>{}}},gr={key:0,class:"loading"},vr={key:1},br={key:0,class:"error"},$r=e("h2",{class:"mt-5"},"Team Standings",-1),kr={class:"container-fluid mt-5"},Cr={class:"table table-striped table-hover"},Dr=e("thead",null,[e("tr",null,[e("th",null,"Position"),e("th",null,"Team"),e("th",null,"Total Score")])],-1),Sr=e("h2",{class:"mt-5"},"Team Results",-1),xr={class:"container-fluid"},Tr={class:"table table-striped table-hover"},Rr=e("thead",null,[e("tr",null,[e("th",{style:{width:"25%"}},"Racer Name"),e("th",{style:{width:"25%"}},"Class"),e("th",{style:{width:"12.5%"}},"5/4"),e("th",{style:{width:"12.5%"}},"5/11"),e("th",{style:{width:"12.5%"}},"5/18"),e("th",{style:{width:"12.5%"}},"5/25")])],-1),wr={class:"table table-striped table-hover"},Or=e("th",{style:{width:"50%","text-align":"right"}},"Score (Avg of individual results):",-1),Pr={style:{width:"12.5%"}},Mr={style:{width:"12.5%"}},Er={style:{width:"12.5%"}},Fr={style:{width:"12.5%"}};function Ur(t,r,c,f,n,o){const u=k("SeriesNavBar"),d=k("ResultRow");return s(),a(p,null,[y(u,{series:n.series},null,8,["series"]),n.loading?(s(),a("div",gr,"Loading...")):(s(),a("div",vr,[n.error?(s(),a("div",br,l(n.error),1)):g("",!0),$r,e("div",kr,[e("table",Cr,[Dr,e("tbody",null,[(s(!0),a(p,null,v(n.teamResults.result,(i,h)=>(s(),a("tr",{key:h},[e("td",null,l(h+1),1),e("td",null,l(i.teamName),1),e("td",null,l(i.totalScore),1)]))),128))])])]),Sr,(s(!0),a(p,null,v(n.teamResults.result,(i,h)=>(s(),a("div",{class:"mt-5",key:h},[e("h3",null,l(i.teamName),1),e("div",xr,[e("table",Tr,[Rr,e("tbody",null,[(s(!0),a(p,null,v(n.teamResults.teamDets[i.teamName],(b,T)=>(s(),a("tr",{key:T},[y(d,{data:b},null,8,["data"])]))),128))])]),e("table",wr,[e("thead",null,[e("tr",null,[Or,e("th",Pr,l(i.results["5/4"]?i.results["5/4"].avg:"-"),1),e("th",Mr,l(i.results["5/11"]?i.results["5/11"].avg:"-"),1),e("th",Er,l(i.results["5/18"]?i.results["5/18"].avg:"-"),1),e("th",Fr,l(i.results["5/25"]?i.results["5/25"].avg:"-"),1)])])])])]))),128))]))],64)}const Br=C(yr,[["render",Ur]]);const Nr={components:{EventDetailsComponent:Y},data(){return{categories:{},loading:!1,error:null,formattedStartDate:"",series:null,stageFilter:"all",racers:[],raceData:{}}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{scrollMeTo(t){var r=document.querySelector(`#${t}`);r.scrollIntoView({behavior:"smooth"})},fetchData(){this.error=null,this.loading=!0,this.$route.params.raceid&&S(`/api/races/roster/${this.$route.params.raceid}`).then(({data:t})=>{this.raceData=t,this.series=t.series,this.loading=!1,this.categories=t.regCategories,this.racers=t.registeredRacers}).catch(t=>{var r;if(this.loading=!1,((r=t.response)==null?void 0:r.status)===404){this.error="Race not found";return}console.error(t),this.categories={},this.error=t.toString()})},replacePlusSymbol(t){return t.replace("+","Plus")},payTypeToStage(t){const r=_.find(this.raceData.paymentOptions,{type:t});return r?r.name:""}},computed:{showPaytype(){var t;return!!((t=this.raceData)!=null&&t.showPaytypeOnRoster)},filterOptions(){let t={all:"All Stages"};return _.forEach(this.raceData.paymentOptions,r=>{t[r.type]=r.name}),t},filteredRacers(){return this.showPaytype&&this.stageFilter!=="all"?_.filter(this.racers,{paytype:this.stageFilter}):this.racers},groupedRacers(){return _.groupBy(this.filteredRacers,"category")},sortedCats(){return _.filter(_.orderBy(this.categories,"disporder"),t=>_.includes(Object.keys(this.groupedRacers),t.id))},raceDate(){return $(this.raceData.eventDate).format("ddd, MMM D")}}},Yr={key:0,class:"loading"},Vr={key:1},Lr={key:0,class:"error"},jr={key:1,id:"top"},Ar={key:0},Ir={class:"row"},qr={key:0,class:"col-md-6"},Hr={class:"container text-center mt-5"},Kr={class:"list-inline"},Wr=["onClick"],Gr={class:"container-fluid"},zr=["id"],Xr={class:"table table-striped table-hover"},Zr=e("th",null," First Name ",-1),Jr=e("th",null," Last Name ",-1),Qr=e("th",null," Team/Sponsor ",-1),ea={key:0},ta={key:0},sa={key:1},ra=e("div",{class:"text-center"},[e("h2",{class:"mt-5"},"No registrations yet...")],-1),aa=[ra];function ia(t,r,c,f,n,o){const u=k("EventDetailsComponent"),d=k("FormKit");return n.loading?(s(),a("div",Yr,"Loading...")):(s(),a("div",Vr,[n.error?(s(),a("div",Lr,l(n.error),1)):(s(),a("div",jr,[y(u,{details:n.raceData.eventDetails},null,8,["details"]),Object.keys(n.racers).length?(s(),a("div",Ar,[e("div",Ir,[e("div",{class:O({"col-md-6":o.showPaytype})},[e("h4",null,l(n.raceData.count)+" Registered for "+l(n.raceData.displayName)+" on "+l(o.raceDate),1)],2),o.showPaytype?(s(),a("div",qr,[y(d,{type:"select",label:"Show registrations for:",name:"stageFilter",modelValue:n.stageFilter,"onUpdate:modelValue":r[0]||(r[0]=i=>n.stageFilter=i),default:"all",options:o.filterOptions},null,8,["modelValue","options"])])):g("",!0)]),e("div",Hr,[e("ul",Kr,[(s(!0),a(p,null,v(o.sortedCats,i=>(s(),a("li",{key:i.id,class:"list-inline-item mx-2"},[e("a",{role:"button",onClick:h=>o.scrollMeTo(o.replacePlusSymbol(i.id)),class:"link-primary"},l(i.catdispname),9,Wr)]))),128))])]),e("div",Gr,[(s(!0),a(p,null,v(o.sortedCats,i=>(s(),a("div",{key:i.id,class:"mt-5"},[e("h3",{id:o.replacePlusSymbol(i.id)},l(i.catdispname),9,zr),e("table",Xr,[e("thead",null,[e("tr",null,[Zr,Jr,Qr,o.showPaytype?(s(),a("th",ea," Stages ")):g("",!0)])]),e("tbody",null,[(s(!0),a(p,null,v(o.groupedRacers[i.id],(h,b)=>(s(),a("tr",{key:b},[e("td",null,l(h.first_name),1),e("td",null,l(h.last_name),1),e("td",null,l(h.sponsor),1),o.showPaytype?(s(),a("td",ta,l(o.payTypeToStage(h.paytype)),1)):g("",!0)]))),128))])]),e("a",{role:"button",onClick:r[1]||(r[1]=h=>o.scrollMeTo("top")),class:"link-primary"},"Back to Top")]))),128))])])):(s(),a("div",sa,aa))]))]))}const oa=C(Nr,[["render",ia]]),na=Z({history:J("/"),routes:[{path:"/race/:raceid",component:Ge},{path:"/register/:raceid",component:ds},{path:"/regconfirmation/:raceid/:payment_id",component:Ls},{path:"/roster/:raceid",component:oa},{path:"/series/:seriesid",component:I},{path:"/series/grom/:seriesid",component:I},{path:"/teamcomp/:seriesid",component:Br}]});const V=Q(ie);V.use(ee,te);V.use(na);V.mount("#app");
