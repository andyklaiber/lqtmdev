import{B as Qo,x as Zo,C as qo,E as er,F as te,K as tr,y as sr,S as or,z as rr,T as _t,A as nr,D as oo,G as ar,V as ir,H as lr,I as cr,J as dr,L as ur,M as mr,N as hr,O as fr,P as pr,s as Ro,k as q,e as T,c as p,b as o,Q as vr,U as gr,W as yr,X as br,Y as Cr,Z as Oo,f as M,a as D,$ as Sr,a0 as Dr,a1 as xr,a2 as _r,a3 as Er,a4 as wr,a5 as Pr,a6 as Tr,a7 as Rr,a8 as Or,a9 as Ir,aa as kr,ab as $r,ac as Ar,ad as Mr,ae as Fr,af as Nr,ag as Lr,ah as Js,ai as Ur,aj as jr,ak as Vr,al as Hr,am as Gr,an as Br,ao as Kr,ap as zr,aq as Wr,ar as Yr,as as Xr,at as Jr,au as Qr,av as Zr,aw as qr,ax as en,ay as tn,az as sn,aA as on,n as le,aB as rn,aC as es,aD as nn,aE as an,aF as ln,aG as cn,aH as dn,aI as un,aJ as mn,aK as hn,aL as fn,aM as pn,aN as vn,aO as gn,aP as yn,o as f,g as rt,aQ as bn,aR as Cn,p as nt,aS as Sn,aT as Dn,aU as xn,aV as _n,aW as En,aX as wn,j as de,aY as _s,r as $,aZ as Pn,a_ as Tn,a$ as Rn,b0 as On,b1 as In,b2 as kn,b3 as $n,b4 as An,b5 as Mn,b6 as Fn,b7 as Nn,b8 as Ln,b9 as Un,t as S,ba as jn,bb as Vn,bc as Hn,bd as Gn,be as Bn,bf as Kn,bg as zn,bh as Wn,bi as Yn,bj as Xn,bk as Jn,bl as Qn,bm as Zn,bn as qn,bo as ea,bp as ta,bq as ds,br as sa,bs as oa,bt as Io,bu as ve,bv as jt,bw as ra,bx as na,by as aa,bz as ia,bA as la,bB as ca,bC as da,w as G,bD as ua,bE as ae,bF as ko,bG as ma,bH as st,bI as ha,_ as ge,h as Z,R as ro,i as X,d as dt,bJ as $o,bK as fa,bL as pa,bM as us,l as va,m as ga,q as ya,u as ba,v as Ca}from"./main-ba68b533.js";const Sa=()=>{},Da=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition:Qo,BaseTransitionPropsValidators:Zo,Comment:qo,EffectScope:er,Fragment:te,KeepAlive:tr,ReactiveEffect:sr,Static:or,Suspense:rr,Teleport:_t,Text:nr,Transition:oo,TransitionGroup:ar,VueElement:ir,assertNumber:lr,callWithAsyncErrorHandling:cr,callWithErrorHandling:dr,camelize:ur,capitalize:mr,cloneVNode:hr,compatUtils:fr,compile:Sa,computed:pr,createApp:Ro,createBlock:q,createCommentVNode:T,createElementBlock:p,createElementVNode:o,createHydrationRenderer:vr,createPropsRestProxy:gr,createRenderer:yr,createSSRApp:br,createSlots:Cr,createStaticVNode:Oo,createTextVNode:M,createVNode:D,customRef:Sr,defineAsyncComponent:Dr,defineComponent:xr,defineCustomElement:_r,defineEmits:Er,defineExpose:wr,defineModel:Pr,defineOptions:Tr,defineProps:Rr,defineSSRCustomElement:Or,defineSlots:Ir,get devtools(){return kr},effect:$r,effectScope:Ar,getCurrentInstance:Mr,getCurrentScope:Fr,getTransitionRawChildren:Nr,guardReactiveProps:Lr,h:Js,handleError:Ur,hasInjectionContext:jr,hydrate:Vr,initCustomFormatter:Hr,initDirectivesForSSR:Gr,inject:Br,isMemoSame:Kr,isProxy:zr,isReactive:Wr,isReadonly:Yr,isRef:Xr,isRuntimeOnly:Jr,isShallow:Qr,isVNode:Zr,markRaw:qr,mergeDefaults:en,mergeModels:tn,mergeProps:sn,nextTick:on,normalizeClass:le,normalizeProps:rn,normalizeStyle:es,onActivated:nn,onBeforeMount:an,onBeforeUnmount:ln,onBeforeUpdate:cn,onDeactivated:dn,onErrorCaptured:un,onMounted:mn,onRenderTracked:hn,onRenderTriggered:fn,onScopeDispose:pn,onServerPrefetch:vn,onUnmounted:gn,onUpdated:yn,openBlock:f,popScopeId:rt,provide:bn,proxyRefs:Cn,pushScopeId:nt,queuePostFlushCb:Sn,reactive:Dn,readonly:xn,ref:_n,registerRuntimeCompiler:En,render:wn,renderList:de,renderSlot:_s,resolveComponent:$,resolveDirective:Pn,resolveDynamicComponent:Tn,resolveFilter:Rn,resolveTransitionHooks:On,setBlockTracking:In,setDevtoolsHook:kn,setTransitionHooks:$n,shallowReactive:An,shallowReadonly:Mn,shallowRef:Fn,ssrContextKey:Nn,ssrUtils:Ln,stop:Un,toDisplayString:S,toHandlerKey:jn,toHandlers:Vn,toRaw:Hn,toRef:Gn,toRefs:Bn,toValue:Kn,transformVNodeArgs:zn,triggerRef:Wn,unref:Yn,useAttrs:Xn,useCssModule:Jn,useCssVars:Qn,useModel:Zn,useSSRContext:qn,useSlots:ea,useTransitionState:ta,vModelCheckbox:ds,vModelDynamic:sa,vModelRadio:oa,vModelSelect:Io,vModelText:ve,vShow:jt,version:ra,warn:na,watch:aa,watchEffect:ia,watchPostEffect:la,watchSyncEffect:ca,withAsyncContext:da,withCtx:G,withDefaults:ua,withDirectives:ae,withKeys:ko,withMemo:ma,withModifiers:st,withScopeId:ha},Symbol.toStringTag,{value:"Module"}));const xa={props:["message"],data(){return{errorMsg:[""]}},methods:{login(t){const{email:e,password:n}=t;return Z.post("/api/auth/login",{email:e,password:n}).then(l=>{console.log(l),this.$emit("login"),this.$router.push({name:"races"})}).catch(l=>{l.response.status===401&&(this.errorMsg=["Invalid credentials, please try again"]),console.error(l)})}}},_a={class:"form-signin w-100 m-auto"},Ea={key:0},wa=o("h1",{class:"h3 mb-3 fw-normal"},"Sign in:",-1);function Pa(t,e,n,l,s,a){const r=$("FormKit");return f(),p("main",_a,[n.message?(f(),p("h3",Ea,S(n.message),1)):T("",!0),wa,D(r,{type:"form",onSubmit:a.login,errors:s.errorMsg},{default:G(()=>[D(r,{type:"email",name:"email",label:"Email address",validation:"","validation-visibility":"live"}),D(r,{type:"password",name:"password",label:"Password",validation:"required"})]),_:1},8,["onSubmit","errors"])])}const Ta=ge(xa,[["render",Pa]]);const Ra={emits:["logout"],components:{RouterView:ro},data(){return{count:0}},computed:{}},Ao=t=>(nt("data-v-bb2a66e9"),t=t(),rt(),t),Oa={class:"navbar navbar-expand-md navbar-dark bg-dark fixed-top"},Ia={class:"container-fluid"},ka=Ao(()=>o("a",{class:"navbar-brand",href:"/"},"Signup.bike Admin",-1)),$a=Ao(()=>o("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarsExample04","aria-controls":"navbarsExample04","aria-expanded":"false","aria-label":"Toggle navigation"},[o("span",{class:"navbar-toggler-icon"})],-1)),Aa={class:"collapse navbar-collapse",id:"navbarsExample04"},Ma={class:"navbar-nav me-auto mb-2 mb-md-0"},Fa={class:"nav-item"},Na={class:"nav-item"},La={class:"nav-item"},Ua={class:"nav-item"},ja={class:"nav-item"},Va={class:"container-fluid"};function Ha(t,e,n,l,s,a){const r=$("RouterLink"),d=$("RouterView");return f(),p(te,null,[o("nav",Oa,[o("div",Ia,[ka,$a,o("div",Aa,[o("ul",Ma,[o("li",Fa,[D(r,{class:le(["nav-link",{active:t.$route.name=="races"}]),to:{name:"races"}},{default:G(()=>[M(" Races ")]),_:1},8,["class"])]),o("li",Na,[D(r,{class:le(["nav-link",{active:t.$route.name=="series"||t.$route.name=="edit-series"}]),to:{name:"series"}},{default:G(()=>[M(" Series ")]),_:1},8,["class"])]),o("li",La,[D(r,{class:le(["nav-link",{active:t.$route.name=="payments"}]),to:{name:"payments"}},{default:G(()=>[M(" Payments ")]),_:1},8,["class"])]),o("li",Ua,[D(r,{class:le(["nav-link",{active:t.$route.name=="results"}]),to:{name:"results"}},{default:G(()=>[M(" Results ")]),_:1},8,["class"])]),o("li",ja,[D(r,{class:le(["nav-link",{active:t.$route.name=="series-results"}]),to:{name:"series-results"}},{default:G(()=>[M(" Series Points ")]),_:1},8,["class"])])]),o("button",{type:"button",class:"btn btn-secondary",onClick:e[0]||(e[0]=i=>t.$emit("logout"))},"Logout")])])]),o("body",null,[o("div",Va,[D(d)])])],64)}const Ga=ge(Ra,[["render",Ha],["__scopeId","data-v-bb2a66e9"]]);const Ba={components:{LoginComponent:Ta,Manage:Ga},data(){return{showLogin:!1,loginText:""}},created(){this.checkAuth()},methods:{hideLogin(){this.showLogin=!1},checkAuth(){if(console.log(this.$route.path),this.$route.path=="/login/")this.showLogin=!0;else return Z.post("/api/auth/login",{}).then(t=>{console.log(t),this.showLogin=!1,!this.$route.path&&this.$router.push({name:"races"})}).catch(t=>{if(t.response.status===401)return this.showLogin=!0;console.error(t)})},logout(){return Z.get("/api/auth/logout").then(t=>{console.log(t),this.showLogin=!0,this.loginText="You are logged out."})}}},Ka={key:0},za={class:"container"},Wa={key:1};function Ya(t,e,n,l,s,a){const r=$("LoginComponent"),d=$("Manage");return s.showLogin?(f(),p("div",Ka,[o("div",za,[D(r,{onLogin:a.hideLogin,message:s.loginText},null,8,["onLogin","message"])])])):(f(),p("div",Wa,[D(d,{onLogout:a.logout},null,8,["onLogout"])]))}const Xa=ge(Ba,[["render",Ya]]);const Ja={props:{show:Boolean,size:{type:String,default:"md",validator:t=>["sm","md","lg","xl"].includes(t)}},computed:{containerClass(){return`modal-container modal-${this.size}`}}},Qa={key:0,class:"modal-mask"},Za={class:"modal-wrapper"},qa={class:"modal-header"},ei={class:"modal-body"},ti={class:"modal-footer"};function si(t,e,n,l,s,a){return f(),q(oo,{name:"modal"},{default:G(()=>[n.show?(f(),p("div",Qa,[o("div",Za,[o("div",{class:le(a.containerClass),onKeydown:e[1]||(e[1]=ko(r=>t.$emit("close"),["esc"])),tabIndex:"0"},[o("div",qa,[_s(t.$slots,"header")]),o("div",ei,[_s(t.$slots,"body",{},()=>[M("default body")])]),o("div",ti,[_s(t.$slots,"footer",{},()=>[o("button",{class:"btn btn-sm btn-danger modal-default-button",onClick:e[0]||(e[0]=r=>t.$emit("close"))},"Cancel")])])],34)])])):T("",!0)]),_:3})}const Xe=ge(Ja,[["render",si]]),oi={props:["paymentData","races","formMode"],data(){return{formError:[],formInputData:{},target:"",successMessage:""}},mounted(){console.log(this.races),this.target=Object.keys(this.races)[0],console.log(this.target)},computed:{raceOptions(){let t=this.races;return delete t[this.paymentData.regData.raceid],t}},methods:{async moveReg(t){return console.log(t),console.log(this.target),Z.put("/api/payments/move-reg",{},{params:{paymentId:this.paymentData._id,raceId:this.target}}).then(e=>{this.successMessage="Registration moved"}).catch(e=>{this.formError=["Error submitting request"],console.log(e)})},async deleteReg(t){return console.log(t),Z.delete(`/api/racers/race/${this.target}`,{params:{paymentId:this.paymentData._id}}).then(e=>{this.successMessage="Registration deleted"}).catch(e=>{this.formError=["Error submitting request"],console.log(e)})}}},ri=o("div",{class:"modal-header"},[o("h5",null," Edit Payment ")],-1),ni={key:0};function ai(t,e,n,l,s,a){const r=$("FormKit");return f(),p(te,null,[ri,o("div",null,[M(" Move This reg to Event: "),D(r,{type:"select",label:"Select an Event:",placeHolder:"Select race to transfer to",name:"selectedRace",options:a.raceOptions},null,8,["options"]),o("div",{class:"btn btn-sm btn-primary",onClick:e[0]||(e[0]=d=>a.moveReg())},"Transfer")]),o("div",null,[M(" Delete registration "),o("div",{class:"btn btn-sm btn-primary",onClick:e[1]||(e[1]=d=>a.deleteReg())},"Delete!")]),s.successMessage?(f(),p("div",ni,S(s.successMessage),1)):T("",!0)],64)}const ii=ge(oi,[["render",ai]]);const li={components:{ModalComponent:Xe,EditPaymentComponent:ii},data(){return{loading:!1,error:null,races:[],filterKey:"",filterPayStatus:"all",filterEvent:!1,filterPaytype:"all",filterOptionalPurchases:"all",payments:[],selectedRaceId:"",showModal:!1}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},watch:{selectedRaceId:{handler(t){this.getPaymentsForRace(this.selectedRaceId)},immediate:!0}},methods:{dollas(t){return X.isNumber(t)?parseFloat(t/100).toLocaleString("en-US",{style:"currency",currency:"USD"}):""},async getReceipt(t){try{const e=await Z(`/api/payments/receipt?payment_id=${t}`);e.data&&e.data.receipt_url&&window.open(e.data.receipt_url,"_blank")}catch(e){console.error("Error fetching receipt:",e),alert("Unable to retrieve receipt. This payment may not have a Stripe receipt available.")}},hasStripeReceipt(t){return t.stripePayment&&t.stripePayment.payment_intent&&t.status==="paid"&&t.stripePayment.amount_total>0},fetchData(){if(this.error=null,this.loading=!0,this.$route)return Z("/api/races/").then(t=>{this.races=t.data,this.races.length>0&&(this.selectedRaceId=this.races[0].raceid),this.loading=!1}).catch(t=>{this.loading=!1,this.error=t.toString(),console.error(t)})},getPaymentsForRace(t){t&&Z(`/api/payments/${t}`).then(e=>{this.payments=e.data,this.loading=!1}).catch(e=>{this.loading=!1,this.error=e.toString(),console.error(e)})},editPayment(t){let e=X.clone(X.find(this.payments,{_id:t}));e?(console.log("payment Data:"),console.log(e),this.paymentToEdit=e,this.paymentFormMode="edit",this.showModal=!0):alert("no payment id found for racer")},closeModal(){this.showModal=!1},isSponsoredCategory(t){var n;if(!this.selectedRaceData||!this.selectedRaceData.regCategories||!((n=t.regData)!=null&&n.category))return!1;const e=X.find(this.selectedRaceData.regCategories,{id:t.regData.category});return(e==null?void 0:e.sponsored)===!0}},computed:{loaded(){return!!this.payments},raceSelectOptions(){let t={};return X.each(this.races,({raceid:e,displayName:n})=>t[e]=n),t},selectedRaceData(){return X.find(this.races,{raceid:this.selectedRaceId})},seriesRaces(){let t=X.find(this.races,{raceid:this.selectedRaceId});if(console.log("race data"),console.log(t),!t||!t.series)return[];console.log("series races"),console.log();let e={};return X.each(X.filter(this.races,{series:t.series}),({raceid:n,displayName:l})=>e[n]=l),e},filterOptionalOptions(){let t={all:"All"};return this.payments.forEach(({regData:e})=>{e&&e.optionalPurchases&&Object.keys(e.optionalPurchases).forEach(n=>{e.optionalPurchases[n]===!0&&(t[n]=n)})}),t},filterPayStatusOptions(){return{all:"All",unpaid:"unpaid",paid:"paid",free:"free"}},filterPayTypeOptions(){return{all:"All",season:"Season",single:"Single",cash:"cash"}},filteredPayments(){const t=this.filterKey&&this.filterKey.toLowerCase();return this.payments&&(t.length||this.filterPayStatus!=="all"||this.filterPaytype!=="all"||this.filterOptionalPurchases!=="all")?X.filter(this.payments,e=>{var n,l,s;if(this.filterOptionalPurchases!=="all"&&(!e.regData.optionalPurchases||e.regData.optionalPurchases[this.filterOptionalPurchases]!==!0))return!1;if(this.filterPayStatus!=="all"){if(this.filterPayStatus==="free"){const a=((n=e.regData)==null?void 0:n.paytype)==="volunteer",r=this.isSponsoredCategory(e);if(!a&&!r)return!1}else if(this.filterPayStatus!==e.status||this.filterPayStatus==="paid"&&(!((l=e.stripePayment)!=null&&l.amount_total)||e.stripePayment.amount_total===0))return!1}return this.filterPaytype!=="all"&&((s=e.regData)==null?void 0:s.paytype)!==this.filterPaytype?!1:parseInt(t)?parseInt(t)===parseInt(e.regData.bibNumber):["first_name","last_name"].some(a=>String(e.regData[a]).toLowerCase().indexOf(t)>-1)}):this.payments}}},ci={key:0,class:"loading"},di={key:1},ui={key:0,class:"error"},mi={key:1},hi={class:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom"},fi={class:"btn-toolbar mb-2 mb-md-0"},pi={class:"btn-toolbar mb-2 mb-md-0"},vi={class:"btn-toolbar mb-2 mb-md-0"},gi={class:"btn-toolbar mb-2 mb-md-0"},yi={class:"btn-toolbar mb-2 mb-md-0"},bi={class:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center"},Ci=o("h2",null,"Payments",-1),Si={class:"h5"},Di={class:"table-responsive"},xi={class:"table table-striped table-hover table-sm"},_i=o("thead",null,[o("tr",null,[o("th",{scope:"col"},"Status"),o("th",{scope:"col"},"name"),o("th",{scope:"col"},"Reg Email"),o("th",{scope:"col"},"Paytype"),o("th",{scope:"col"},"Sponsored"),o("th",{scope:"col"},"Amount"),o("th",{scope:"col"},"Bib"),o("th",{scope:"col"},"Confirmation"),o("th",{scope:"col"},"Receipt"),o("th",{scope:"col"},"Actions")])],-1),Ei=["href"],wi=["href"],Pi=["onClick"],Ti={key:1,class:"text-muted"},Ri=["onClick"],Oi={key:2},Ii=o("div",{class:"text-center"},[o("h2",{class:"mt-5"},"Error loading payments...")],-1),ki=[Ii];function $i(t,e,n,l,s,a){const r=$("FormKit"),d=$("EditPaymentComponent"),i=$("modal-component");return s.loading?(f(),p("div",ci,"Loading...")):(f(),p("div",di,[s.error?(f(),p("div",ui,S(s.error),1)):T("",!0),a.loaded?(f(),p("div",mi,[o("div",hi,[o("div",fi,[D(r,{type:"select",label:"Select an Event:",name:"selectedRace",modelValue:s.selectedRaceId,"onUpdate:modelValue":e[0]||(e[0]=c=>s.selectedRaceId=c),options:a.raceSelectOptions},null,8,["modelValue","options"])]),o("div",pi,[D(r,{id:"racerFilterTxtInput",type:"text",name:"search",label:"Search:",help:"search in first, last, bib number",delay:300,modelValue:s.filterKey,"onUpdate:modelValue":e[1]||(e[1]=c=>s.filterKey=c)},null,8,["modelValue"])]),o("div",vi,[D(r,{type:"select",label:"Filter by Status:",name:"filterPayStatus",modelValue:s.filterPayStatus,"onUpdate:modelValue":e[2]||(e[2]=c=>s.filterPayStatus=c),default:"all",options:a.filterPayStatusOptions},null,8,["modelValue","options"])]),o("div",gi,[D(r,{type:"select",label:"Filter by PayType:",name:"filterPaytype",modelValue:s.filterPaytype,"onUpdate:modelValue":e[3]||(e[3]=c=>s.filterPaytype=c),default:"all",options:a.filterPayTypeOptions},null,8,["modelValue","options"])]),o("div",yi,[D(r,{type:"select",label:"Filter by optional purchases:",name:"filterOptionalPurchases",modelValue:s.filterOptionalPurchases,"onUpdate:modelValue":e[4]||(e[4]=c=>s.filterOptionalPurchases=c),default:"All",options:a.filterOptionalOptions},null,8,["modelValue","options"])])]),o("div",bi,[Ci,o("div",Si,"Count: "+S(a.filteredPayments.length),1)]),o("div",Di,[o("table",xi,[_i,o("tbody",null,[(f(!0),p(te,null,de(a.filteredPayments,(c,h)=>{var m;return f(),p("tr",{key:h},[o("td",null,S(c.status),1),o("td",null,S(c.regData.first_name+" "+c.regData.last_name),1),o("td",null,[o("a",{href:`mailto:${c.regData.email}`},S(c.regData.email),9,Ei)]),o("td",null,S(c.regData.paytype),1),o("td",null,S(a.isSponsoredCategory(c)?"Yes":""),1),o("td",null,S(a.dollas((m=c.stripePayment)==null?void 0:m.amount_total)),1),o("td",null,S(c.regData.bibNumber),1),o("td",null,[o("a",{href:`/#/regconfirmation/${c.regData.raceid}/${c._id}`,target:"_blank"},"View",8,wi)]),o("td",null,[a.hasStripeReceipt(c)?(f(),p("button",{key:0,class:"btn btn-sm btn-primary",onClick:u=>a.getReceipt(c._id),title:"View Stripe Receipt"}," Receipt ",8,Pi)):(f(),p("span",Ti,"-"))]),o("td",null,[c.status!=="unpaid"&&c.regData.paytype!="season"?(f(),p("div",{key:0,class:"btn btn-sm btn-secondary",onClick:u=>a.editPayment(c._id)},"Edit",8,Ri)):T("",!0)])])}),128))])]),(f(),q(_t,{to:"body"},[s.payments.length>0?(f(),q(i,{key:0,show:s.showModal,onClose:a.closeModal},{body:G(()=>[D(d,{races:a.seriesRaces,paymentData:t.paymentToEdit,formMode:t.paymentFormMode},null,8,["races","paymentData","formMode"])]),_:1},8,["show","onClose"])):T("",!0)]))])])):(f(),p("div",Oi,ki))]))}const Ai=ge(li,[["render",$i]]);const Mi={props:{data:Array,columns:Array,filterKey:String,editIdColumn:String},emits:["edit"],data(){return{sortKey:"",sortOrders:this.columns.reduce((t,e)=>(t[e]=1,t),{})}},computed:{filteredData(){const t=this.sortKey,e=this.filterKey&&this.filterKey.toLowerCase(),n=this.sortOrders[t]||1;let l=this.data;return e&&(l=l.filter(s=>Object.keys(s).some(a=>String(s[a]).toLowerCase().indexOf(e)>-1))),t&&(l=l.slice().sort((s,a)=>(s=s[t],a=a[t],(s===a?0:s>a?1:-1)*n))),l}},methods:{sortBy(t){this.sortKey=t,this.sortOrders[t]=this.sortOrders[t]*-1},capitalize(t){return t.charAt(0).toUpperCase()+t.slice(1)}}},Fi={class:"table-responsive"},Ni={key:0,class:"table table-striped table-sm"},Li=["onClick"],Ui={key:0},ji=["onClick"],Vi={key:1};function Hi(t,e,n,l,s,a){return f(),p("div",Fi,[a.filteredData.length?(f(),p("table",Ni,[o("thead",null,[o("tr",null,[(f(!0),p(te,null,de(n.columns,r=>(f(),p("th",{onClick:d=>a.sortBy(r),class:le({active:s.sortKey==r})},[M(S(a.capitalize(r))+" ",1),o("span",{class:le(["arrow",s.sortOrders[r]>0?"asc":"dsc"])},null,2)],10,Li))),256))])]),o("tbody",null,[(f(!0),p(te,null,de(a.filteredData,r=>(f(),p("tr",null,[(f(!0),p(te,null,de(n.columns,d=>(f(),p("td",null,S(r[d]),1))),256)),n.editIdColumn?(f(),p("td",Ui,[o("div",{class:"btn btn-sm btn-outline-secondary",onClick:d=>t.$emit("edit",r[n.editIdColumn])},"edit",8,ji)])):T("",!0)]))),256))])])):(f(),p("p",Vi,"No data found."))])}const no=ge(Mi,[["render",Hi],["__scopeId","data-v-37b58472"]]);const Gi={props:["racerData","categories","payments","formMode","series","seriesData"],emits:["saved"],data(){return{birthdate:"",formError:[],submitted:!1,paymentType:"season",prevBibError:[],bibError:[],formInputData:{}}},mounted(){if(this.formMode==="create"){this.paymentType=this.racerData.paytype;return}(this.formMode==="edit"||this.formMode==="regcash")&&(this.formInputData=this.racerData),X.defer(()=>{document.querySelector("#bibNumber").focus()})},computed:{sortedCats(){let t={};return X.forEach(X.orderBy(this.categories,"disporder"),e=>{t[e.id]=e.catdispname}),t},paymentOptions(){var e;let t={};return X.forEach(this.payments,n=>{t[n.type]=n.name}),(e=this.seriesData)!=null&&e.categoryGroups&&this.seriesData.categoryGroups.forEach(n=>{n.paymentOptions&&n.paymentOptions.forEach(l=>{t[l.type]||(t[l.type]=`${l.name} (${n.name})`)})}),t.cash="Cash Single Entry",t.volunteer="Volunteer Single Entry",t.season="Season Comp",t},racerAge(){if(this.birthdate){const t=dt(),e=dt(this.birthdate);return t.year()-e.year()}},unpaidReg(){return this.formMode==="create"?this.paymentType=="cash":this.paymentType=="cash"&&this.racerData.status=="unpaid"},paymentAmount(){if(this.racerData.paytype==="cash"){let t=X.find(this.payments,{type:"single"});return t?t.amount:null}}},methods:{dollas(t){return typeof t=="string"&&(t=parseInt(t)),t!==0&&!t?"":t.toLocaleString("en-US",{style:"currency",currency:"USD"})},findPrevBib(t){Z.post(`/api/racers/bib/${t}`,{series:`${this.series}`}).then(({data:e})=>{if(console.log("prevbib"),console.log(e),e.paytype==="season"){this.prevBibError=["Racer is already registered for the whole season"];return}e.prevPaymentId=e.paymentId,delete e.paymentId,delete e.paymentReceived,delete e.raceid,this.formInputData=e,this.prevAge=e.racerAge}).catch(({response:e})=>{console.dir(e),e.status==404&&(this.prevBibError=[e.data.message])})},onPrevBibChange(t){t?this.findPrevBib(t):(this.prevBibError=[],this.prevAge=null)},onBibChange(t){if(!t){this.bibError=[];return}Z.post(`/api/racers/bib/${t}`,{series:`${this.series}`}).then(({data:e})=>{if(console.log("bib check:",e),this.formMode==="edit"&&e.paymentId&&this.racerData.paymentId&&e.paymentId.toString()===this.racerData.paymentId.toString()){this.bibError=[];return}const n=(this.formInputData.first_name||"").toLowerCase().trim(),l=(this.formInputData.last_name||"").toLowerCase().trim(),s=(e.first_name||"").toLowerCase().trim(),a=(e.last_name||"").toLowerCase().trim();if(n&&l&&n===s&&l===a){this.bibError=[];return}this.bibError=[`Bib number ${t} is already in use by ${e.first_name} ${e.last_name}`]}).catch(({response:e})=>{console.log("bib check response:",e),e&&e.status==404?this.bibError=[]:console.error("Error checking bib:",e)})},async submitHandler(t){if(console.log(t),this.bibError.length>0){this.formError=["Please fix the bib number error before submitting"];return}let e;if(this.formMode==="create"||this.formMode==="regcash"){let n=this.paymentAmount;(t.paytype=="season"||t.paytype=="volunteer")&&(n=0,t.compedEntry=!0),e=Z.post("/api/payments/register",{...t,paymentAmount:n},{params:{paymentId:t.paymentId,raceId:this.$route.params.raceid}})}else delete t.status,e=Z.patch(`/api/racers/race/${this.$route.params.raceid}`,t,{params:{paymentId:this.racerData.paymentId}});return await e.then(n=>{if(n.data)return this.submitted=!0,console.log("response data"),console.log(n.data),new Promise(l=>setTimeout(()=>{this.$emit("saved"),l()},100))}).catch(n=>{this.formError=["Error submitting request"],console.log(n)})}}},Bi={class:"modal-header"},Ki={class:"edit-racer-form"},zi={class:"double"},Wi={class:"double"},Yi={class:"double"},Xi={key:0},Ji=o("p",{class:"text-danger h4"},"Cash Payment Required",-1);function Qi(t,e,n,l,s,a){const r=$("FormKit");return f(),p(te,null,[o("div",Bi,[o("h5",null,S(n.racerData.status==="unpaid"?"Register Racer":"Edit Racer Data"),1)]),o("div",Ki,[n.formMode=="create"?(f(),q(r,{key:0,type:"number",name:"bibNumber",label:"Bib Number:",help:"Enter racer's bib number from a previous race",delay:1500,onInput:a.onPrevBibChange,errors:s.prevBibError},null,8,["onInput","errors"])):T("",!0),D(r,{type:"form",id:"admin-registration",modelValue:s.formInputData,"onUpdate:modelValue":e[1]||(e[1]=d=>s.formInputData=d),"form-class":s.submitted?"hide":"show",errors:s.formError,"submit-label":"Save",onSubmit:a.submitHandler},{default:G(()=>[o("div",zi,[D(r,{type:"text",name:"first_name",label:"First name",validation:"required"}),D(r,{type:"text",name:"last_name",label:"Last name",validation:"required"})]),o("div",Wi,[D(r,{type:"email",name:"email",label:"Email",validation:"email"}),D(r,{type:"text",name:"sponsor",label:"Team or Sponsor"})]),D(r,{type:"text",name:"contactNumber",label:"Phone Number",help:"If there is an issue on race day, we will try to contact you via this number"}),D(r,{type:"text",name:"emergencyNumber",label:"Emergency Contact Name and Number",help:"In case of an emergency, we will contact this person"}),D(r,{type:"text",name:"racerAge",label:"Racer Age",help:"age on dec 31"}),o("div",Yi,[D(r,{type:"select",id:"category",label:"Race Category:",placeholder:"Select a category",name:"category",options:a.sortedCats,validation:"required","validation-visibility":"dirty","validation-messages":{is:"You must select a race category"}},null,8,["options"]),D(r,{type:"select",id:"paytype",label:"Payment Type:",name:"paytype",options:a.paymentOptions,modelValue:s.paymentType,"onUpdate:modelValue":e[0]||(e[0]=d=>s.paymentType=d),validation:"required","validation-visibility":"dirty","validation-messages":{is:"You must select a Payment Type"}},null,8,["options","modelValue"])]),D(r,{id:"bibNumber",type:"text",name:"bibNumber",label:"Bib Number",delay:500,onInput:a.onBibChange,errors:s.bibError},null,8,["onInput","errors"]),a.unpaidReg?(f(),p("div",Xi,[Ji,D(r,{type:"checkbox",label:`I Collected ${a.dollas(a.paymentAmount)} from the racer`,name:"paymentReceived",validation:"required"},null,8,["label"])])):T("",!0)]),_:1},8,["modelValue","form-class","errors","onSubmit"])])],64)}const Mo=ge(Gi,[["render",Qi]]),gs={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var Zi=["size","color"];function Qs(){return Qs=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(t[l]=n[l])}return t},Qs.apply(this,arguments)}function qi(t,e){if(t==null)return{};var n={},l=Object.keys(t),s,a;for(a=0;a<l.length;a++)s=l[a],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var el=function(e){return e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()},tl=function(e,n){return function(l,s){var a=l.size,r=l.color,d=qi(l,Zi),i=s.attrs;s.emit;var c=s.slots;return Js("svg",Qs({},gs,{width:a||gs.width,height:a||gs.height,stroke:r||gs.stroke},i,{class:["lucide","lucide-"+el(e),(i==null?void 0:i.class)||""]},d),[].concat(n.map(function(h){return Js.apply(void 0,h)}),c.default?[c.default()]:[]))}};const Ve=tl;var sl=Ve("ArrowLeftIcon",[["line",{x1:"19",y1:"12",x2:"5",y2:"12",key:"17g05t"}],["polyline",{points:"12 19 5 12 12 5",key:"1ksm0z"}]]);const ol=sl;var rl=Ve("CheckIcon",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]);const ao=rl;var nl=Ve("ChevronDownIcon",[["polyline",{points:"6 9 12 15 18 9",key:"1do0m2"}]]);const al=nl;var il=Ve("ChevronUpIcon",[["polyline",{points:"18 15 12 9 6 15",key:"1uugdp"}]]);const ll=il;var cl=Ve("CodeIcon",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);const dl=cl;var ul=Ve("CopyIcon",[["rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2",key:"1ma1o8"}],["path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1",key:"pklvoz"}]]);const ms=ul;var ml=Ve("DownloadIcon",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",y1:"15",x2:"12",y2:"3",key:"nqo27w"}]]);const hl=ml;var fl=Ve("Edit3Icon",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z",key:"18w55b"}]]);const io=fl;var pl=Ve("EditIcon",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z",key:"1cs3r3"}]]);const Fo=pl;var vl=Ve("EyeIcon",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const gl=vl;var yl=Ve("FilePlusIcon",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"12",y1:"18",x2:"12",y2:"12",key:"16t3gy"}],["line",{x1:"9",y1:"15",x2:"15",y2:"15",key:"1hgpwl"}]]);const No=yl;var bl=Ve("LinkIcon",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);const lo=bl;var Cl=Ve("LockIcon",[["rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",key:"biyj2e"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);const Sl=Cl;var Dl=Ve("PencilIcon",[["line",{x1:"18",y1:"2",x2:"22",y2:"6",key:"1k5sg2"}],["path",{d:"M7.5 20.5 19 9l-4-4L3.5 16.5 2 22z",key:"12iwkt"}]]);const $t=Dl;var xl=Ve("PlusIcon",[["line",{x1:"12",y1:"5",x2:"12",y2:"19",key:"myz83a"}],["line",{x1:"5",y1:"12",x2:"19",y2:"12",key:"1smlys"}]]);const co=xl;var _l=Ve("SaveIcon",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);const El=_l;var wl=Ve("Trash2Icon",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",y1:"11",x2:"10",y2:"17",key:"m9v7hp"}],["line",{x1:"14",y1:"11",x2:"14",y2:"17",key:"23cpt9"}]]);const Gt=wl;const Pl={components:{ModalComponent:Xe,RacerFormComponent:Mo,Grid:no,Link:lo,Edit3:io},data(){return{categories:{},loading:!1,error:null,formError:[],formInputData:{},data:{},racerToEdit:null,racerFormMode:"edit",showModal:!1,filterKey:"",filterUnpaid:!1,filterNoBib:!1,filterCats:"all"}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{dollas(t){return t.toLocaleString("en-US",{style:"currency",currency:"USD"})},fetchData(){this.error=null,this.loading=!0,this.$route.params.raceid&&Z(`/api/racers/race/${this.$route.params.raceid}`).then(t=>{this.data=t.data,this.loading=!1}).catch(t=>{this.loading=!1,this.error=t.toString(),console.error(t)})},catName(t){let e=X.find(this.data.regCategories,{id:t});return e?e.catdispname:""},createReg(){this.racerToEdit={paytype:"cash",status:"unpaid",raceid:this.$route.params.raceid},this.racerFormMode="create",this.showModal=!0},regCash(t){let e=X.clone(X.find(this.data.registeredRacers,{paymentId:t}));e?(console.log("racerData:"),console.log(e),this.racerToEdit=e,this.racerFormMode="regcash",this.showModal=!0):alert("no payment id found for racer")},editRacer(t){let e=X.clone(X.find(this.data.registeredRacers,{paymentId:t}));e?(console.log("racerData:"),console.log(e),this.racerToEdit=e,this.racerFormMode="edit",this.showModal=!0):alert("no payment id found for racer")},racerUpdated(){this.racerToEdit=null,this.showModal=!1,this.fetchData()},capitalize(t){return X.capitalize(t)},closeModal(){this.showModal=!1,X.defer(()=>{document.querySelector("#racerFilterTxtInput").focus()})},resetFilters(){this.filterKey="",this.filterUnpaid=!1,this.filterNoBib=!1,this.filterCats="all"},optionalPurchases(t){if(!t)return"";let e="",n=[],l=Object.keys(t).filter(s=>s.split("-").length==1);return l.length&&l.forEach(s=>{if(t[s+"-option"])return n.push(`${this.capitalize(s)}: ${t[s+"-option"]}`);n.push(this.capitalize(s))}),e=n.join(", "),e},isSeriesCategory(t){var e,n;return(n=(e=this.data)==null?void 0:e.seriesData)!=null&&n.regCategories?this.data.seriesData.regCategories.some(l=>l.id===t):!1},isRaceOverride(t){return t._isRaceOverride===!0},isPureSeriesCategory(t){return t._isSeriesCategory===!0},getCategoryWithSource(t){const e=X.find(this.data.regCategories,{id:t});return e?{...e,isFromSeries:this.isPureSeriesCategory(e),isRaceOverride:this.isRaceOverride(e)}:null}},computed:{loaded(){return!!this.data},sortedCats(){let t={all:"All Categories"};return X.forEach(X.orderBy(this.data.regCategories,"disporder"),e=>{let n=e.catdispname;t[e.id]=n}),t},filteredRacers(){const t=this.filterKey&&this.filterKey.toLowerCase();let e=this.data.registeredRacers;return(t.length||this.filterUnpaid||this.filterCats!=="all"||this.filterNoBib)&&(e=e.filter(n=>this.filterUnpaid&&n.status!=="unpaid"||this.filterNoBib&&n.bibNumber||this.filterCats!="all"&&n.category!=this.filterCats?!1:["first_name","last_name","bibNumber"].some(l=>String(n[l]).toLowerCase().indexOf(t)>-1))),X.sortBy(e,[function(n){return n.last_name.toLowerCase()}])}}},Tl={key:0,class:"loading"},Rl={key:1},Ol={key:0,class:"error"},Il={key:1,class:"container-fluid"},kl={class:"d-flex flex-row justify-content-center"},$l={class:"p-2"},Al={class:"racer-controls d-flex flex-row justify-content-between flex-wrap align-items-top pb-2 mb-3 border-bottom"},Ml={class:"p-2"},Fl={class:"flex-grow-1 p-2"},Nl={class:"d-flex flex-row search-checks"},Ll={class:"d-flex flex-grow-1 justify-content-between p-2 pt-4"},Ul={class:"table-responsive"},jl={class:"table table-striped table-sm"},Vl=o("th",{scope:"col"},"First Name",-1),Hl=o("th",{scope:"col"},"Last Name",-1),Gl=o("th",{scope:"col"},"Category",-1),Bl=o("th",{scope:"col"},"Race Age",-1),Kl=o("th",{scope:"col"},"Bib Number",-1),zl=o("th",{scope:"col"},"Purchases",-1),Wl=o("th",{scope:"col"},"Paytype",-1),Yl=o("th",{scope:"col"},"Payment Status",-1),Xl={scope:"col"},Jl={key:0},Ql={key:1},Zl=["onClick"],ql=["onClick"],ec={key:2},tc=o("div",{class:"text-center"},[o("h2",{class:"mt-5"},"Race not available for registration...")],-1),sc=[tc];function oc(t,e,n,l,s,a){const r=$("FormKit"),d=$("RacerFormComponent"),i=$("modal-component");return s.loading?(f(),p("div",Tl,"Loading...")):(f(),p("div",Rl,[s.error?(f(),p("div",Ol,S(s.error),1)):T("",!0),a.loaded?(f(),p("div",Il,[o("div",kl,[o("div",$l,[o("h3",null,S(s.data.displayName),1)])]),o("div",Al,[o("div",Ml,[D(r,{id:"racerFilterTxtInput",type:"text",name:"search",label:"Search:",help:"search in first, last or bib number",delay:300,modelValue:s.filterKey,"onUpdate:modelValue":e[0]||(e[0]=c=>s.filterKey=c)},null,8,["modelValue"])]),o("div",Fl,[D(r,{type:"select",name:"categories",label:"Filter by Category",options:a.sortedCats,modelValue:s.filterCats,"onUpdate:modelValue":e[1]||(e[1]=c=>s.filterCats=c)},null,8,["options","modelValue"]),o("div",Nl,[D(r,{type:"checkbox",name:"unpaid",label:"Unpaid Only",modelValue:s.filterUnpaid,"onUpdate:modelValue":e[2]||(e[2]=c=>s.filterUnpaid=c)},null,8,["modelValue"]),D(r,{type:"checkbox",name:"noBib",label:"No Bib Only",modelValue:s.filterNoBib,"onUpdate:modelValue":e[3]||(e[3]=c=>s.filterNoBib=c)},null,8,["modelValue"])])]),o("div",Ll,[o("a",{class:"btn btn-primary align-self-start",onClick:e[4]||(e[4]=(...c)=>a.resetFilters&&a.resetFilters(...c))},"Reset Filters"),o("div",{class:"btn btn-md btn-success align-self-start",onClick:e[5]||(e[5]=c=>a.createReg())},"Add New Registration")])]),o("div",Ul,[o("table",jl,[o("thead",null,[o("tr",null,[Vl,Hl,Gl,Bl,Kl,zl,Wl,Yl,o("th",Xl,[o("strong",null,S(a.filteredRacers.length)+" Found",1)])])]),o("tbody",null,[(f(!0),p(te,null,de(a.filteredRacers,(c,h)=>(f(),p("tr",{key:h},[o("td",null,S(c.first_name),1),o("td",null,S(c.last_name),1),o("td",null,[a.getCategoryWithSource(c.category)?(f(),p("span",Jl,S(a.catName(c.category)),1)):(f(),p("span",Ql,S(a.catName(c.category)),1))]),o("td",null,S(c.racerAge),1),o("td",null,S(c.bibNumber),1),o("td",null,S(a.optionalPurchases(c.optionalPurchases)),1),o("td",null,S(c.paytype),1),o("td",{class:le({"text-success":c.status!=="unpaid","text-danger":c.status==="unpaid"})},S(a.capitalize(c.status)),3),o("td",null,[c.status!=="unpaid"?(f(),p("div",{key:0,class:"btn btn-sm btn-outline-secondary",onClick:m=>a.editRacer(c.paymentId)},S("edit"),8,Zl)):T("",!0),c.status==="unpaid"?(f(),p("div",{key:1,class:"btn btn-sm btn-outline-secondary",onClick:m=>a.regCash(c.paymentId)},S("Register"),8,ql)):T("",!0)])]))),128))])]),(f(),q(_t,{to:"body"},[D(i,{show:s.showModal,onClose:a.closeModal},{body:G(()=>[D(d,{onSaved:a.racerUpdated,racerData:s.racerToEdit,categories:s.data.regCategories,payments:s.data.paymentOptions,formMode:s.racerFormMode,series:s.data.series,seriesData:s.data.seriesData},null,8,["onSaved","racerData","categories","payments","formMode","series","seriesData"])]),_:1},8,["show","onClose"])]))])])):(f(),p("div",ec,sc))]))}const rc=ge(Pl,[["render",oc]]);var Lo={exports:{}};const nc=$o(Da);/**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function yo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,l)}return n}function ft(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?yo(Object(n),!0).forEach(function(l){ac(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yo(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function Es(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Es=function(e){return typeof e}:Es=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Es(t)}function ac(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ot(){return ot=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(t[l]=n[l])}return t},ot.apply(this,arguments)}function ic(t,e){if(t==null)return{};var n={},l=Object.keys(t),s,a;for(a=0;a<l.length;a++)s=l[a],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function lc(t,e){if(t==null)return{};var n=ic(t,e),l,s;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)l=a[s],!(e.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(t,l)&&(n[l]=t[l])}return n}function cc(t){return dc(t)||uc(t)||mc(t)||hc()}function dc(t){if(Array.isArray(t))return Zs(t)}function uc(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function mc(t,e){if(t){if(typeof t=="string")return Zs(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zs(t,e)}}function Zs(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=new Array(e);n<e;n++)l[n]=t[n];return l}function hc(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var fc="1.14.0";function gt(t){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(t)}var yt=gt(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),hs=gt(/Edge/i),bo=gt(/firefox/i),ns=gt(/safari/i)&&!gt(/chrome/i)&&!gt(/android/i),Uo=gt(/iP(ad|od|hone)/i),pc=gt(/chrome/i)&&gt(/android/i),jo={capture:!1,passive:!1};function he(t,e,n){t.addEventListener(e,n,!yt&&jo)}function ue(t,e,n){t.removeEventListener(e,n,!yt&&jo)}function Os(t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch{return!1}return!1}}function vc(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function ct(t,e,n,l){if(t){n=n||document;do{if(e!=null&&(e[0]===">"?t.parentNode===n&&Os(t,e):Os(t,e))||l&&t===n)return t;if(t===n)break}while(t=vc(t))}return null}var Co=/\s+/g;function we(t,e,n){if(t&&e)if(t.classList)t.classList[n?"add":"remove"](e);else{var l=(" "+t.className+" ").replace(Co," ").replace(" "+e+" "," ");t.className=(l+(n?" "+e:"")).replace(Co," ")}}function z(t,e,n){var l=t&&t.style;if(l){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),e===void 0?n:n[e];!(e in l)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),l[e]=n+(typeof n=="string"?"":"px")}}function kt(t,e){var n="";if(typeof t=="string")n=t;else do{var l=z(t,"transform");l&&l!=="none"&&(n=l+" "+n)}while(!e&&(t=t.parentNode));var s=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return s&&new s(n)}function Vo(t,e,n){if(t){var l=t.getElementsByTagName(e),s=0,a=l.length;if(n)for(;s<a;s++)n(l[s],s);return l}return[]}function ht(){var t=document.scrollingElement;return t||document.documentElement}function _e(t,e,n,l,s){if(!(!t.getBoundingClientRect&&t!==window)){var a,r,d,i,c,h,m;if(t!==window&&t.parentNode&&t!==ht()?(a=t.getBoundingClientRect(),r=a.top,d=a.left,i=a.bottom,c=a.right,h=a.height,m=a.width):(r=0,d=0,i=window.innerHeight,c=window.innerWidth,h=window.innerHeight,m=window.innerWidth),(e||n)&&t!==window&&(s=s||t.parentNode,!yt))do if(s&&s.getBoundingClientRect&&(z(s,"transform")!=="none"||n&&z(s,"position")!=="static")){var u=s.getBoundingClientRect();r-=u.top+parseInt(z(s,"border-top-width")),d-=u.left+parseInt(z(s,"border-left-width")),i=r+a.height,c=d+a.width;break}while(s=s.parentNode);if(l&&t!==window){var v=kt(s||t),g=v&&v.a,y=v&&v.d;v&&(r/=y,d/=g,m/=g,h/=y,i=r+h,c=d+m)}return{top:r,left:d,bottom:i,right:c,width:m,height:h}}}function So(t,e,n){for(var l=xt(t,!0),s=_e(t)[e];l;){var a=_e(l)[n],r=void 0;if(n==="top"||n==="left"?r=s>=a:r=s<=a,!r)return l;if(l===ht())break;l=xt(l,!1)}return!1}function Ht(t,e,n,l){for(var s=0,a=0,r=t.children;a<r.length;){if(r[a].style.display!=="none"&&r[a]!==Q.ghost&&(l||r[a]!==Q.dragged)&&ct(r[a],n.draggable,t,!1)){if(s===e)return r[a];s++}a++}return null}function uo(t,e){for(var n=t.lastElementChild;n&&(n===Q.ghost||z(n,"display")==="none"||e&&!Os(n,e));)n=n.previousElementSibling;return n||null}function Ie(t,e){var n=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)t.nodeName.toUpperCase()!=="TEMPLATE"&&t!==Q.clone&&(!e||Os(t,e))&&n++;return n}function Do(t){var e=0,n=0,l=ht();if(t)do{var s=kt(t),a=s.a,r=s.d;e+=t.scrollLeft*a,n+=t.scrollTop*r}while(t!==l&&(t=t.parentNode));return[e,n]}function gc(t,e){for(var n in t)if(t.hasOwnProperty(n)){for(var l in e)if(e.hasOwnProperty(l)&&e[l]===t[n][l])return Number(n)}return-1}function xt(t,e){if(!t||!t.getBoundingClientRect)return ht();var n=t,l=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var s=z(n);if(n.clientWidth<n.scrollWidth&&(s.overflowX=="auto"||s.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(s.overflowY=="auto"||s.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return ht();if(l||e)return n;l=!0}}while(n=n.parentNode);return ht()}function yc(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function js(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}var as;function Ho(t,e){return function(){if(!as){var n=arguments,l=this;n.length===1?t.call(l,n[0]):t.apply(l,n),as=setTimeout(function(){as=void 0},e)}}}function bc(){clearTimeout(as),as=void 0}function Go(t,e,n){t.scrollLeft+=e,t.scrollTop+=n}function mo(t){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):n?n(t).clone(!0)[0]:t.cloneNode(!0)}function xo(t,e){z(t,"position","absolute"),z(t,"top",e.top),z(t,"left",e.left),z(t,"width",e.width),z(t,"height",e.height)}function Vs(t){z(t,"position",""),z(t,"top",""),z(t,"left",""),z(t,"width",""),z(t,"height","")}var Ge="Sortable"+new Date().getTime();function Cc(){var t=[],e;return{captureAnimationState:function(){if(t=[],!!this.options.animation){var l=[].slice.call(this.el.children);l.forEach(function(s){if(!(z(s,"display")==="none"||s===Q.ghost)){t.push({target:s,rect:_e(s)});var a=ft({},t[t.length-1].rect);if(s.thisAnimationDuration){var r=kt(s,!0);r&&(a.top-=r.f,a.left-=r.e)}s.fromRect=a}})}},addAnimationState:function(l){t.push(l)},removeAnimationState:function(l){t.splice(gc(t,{target:l}),1)},animateAll:function(l){var s=this;if(!this.options.animation){clearTimeout(e),typeof l=="function"&&l();return}var a=!1,r=0;t.forEach(function(d){var i=0,c=d.target,h=c.fromRect,m=_e(c),u=c.prevFromRect,v=c.prevToRect,g=d.rect,y=kt(c,!0);y&&(m.top-=y.f,m.left-=y.e),c.toRect=m,c.thisAnimationDuration&&js(u,m)&&!js(h,m)&&(g.top-m.top)/(g.left-m.left)===(h.top-m.top)/(h.left-m.left)&&(i=Dc(g,u,v,s.options)),js(m,h)||(c.prevFromRect=h,c.prevToRect=m,i||(i=s.options.animation),s.animate(c,g,m,i)),i&&(a=!0,r=Math.max(r,i),clearTimeout(c.animationResetTimer),c.animationResetTimer=setTimeout(function(){c.animationTime=0,c.prevFromRect=null,c.fromRect=null,c.prevToRect=null,c.thisAnimationDuration=null},i),c.thisAnimationDuration=i)}),clearTimeout(e),a?e=setTimeout(function(){typeof l=="function"&&l()},r):typeof l=="function"&&l(),t=[]},animate:function(l,s,a,r){if(r){z(l,"transition",""),z(l,"transform","");var d=kt(this.el),i=d&&d.a,c=d&&d.d,h=(s.left-a.left)/(i||1),m=(s.top-a.top)/(c||1);l.animatingX=!!h,l.animatingY=!!m,z(l,"transform","translate3d("+h+"px,"+m+"px,0)"),this.forRepaintDummy=Sc(l),z(l,"transition","transform "+r+"ms"+(this.options.easing?" "+this.options.easing:"")),z(l,"transform","translate3d(0,0,0)"),typeof l.animated=="number"&&clearTimeout(l.animated),l.animated=setTimeout(function(){z(l,"transition",""),z(l,"transform",""),l.animated=!1,l.animatingX=!1,l.animatingY=!1},r)}}}}function Sc(t){return t.offsetWidth}function Dc(t,e,n,l){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))*l.animation}var Ft=[],Hs={initializeByDefault:!0},fs={mount:function(e){for(var n in Hs)Hs.hasOwnProperty(n)&&!(n in e)&&(e[n]=Hs[n]);Ft.forEach(function(l){if(l.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),Ft.push(e)},pluginEvent:function(e,n,l){var s=this;this.eventCanceled=!1,l.cancel=function(){s.eventCanceled=!0};var a=e+"Global";Ft.forEach(function(r){n[r.pluginName]&&(n[r.pluginName][a]&&n[r.pluginName][a](ft({sortable:n},l)),n.options[r.pluginName]&&n[r.pluginName][e]&&n[r.pluginName][e](ft({sortable:n},l)))})},initializePlugins:function(e,n,l,s){Ft.forEach(function(d){var i=d.pluginName;if(!(!e.options[i]&&!d.initializeByDefault)){var c=new d(e,n,e.options);c.sortable=e,c.options=e.options,e[i]=c,ot(l,c.defaults)}});for(var a in e.options)if(e.options.hasOwnProperty(a)){var r=this.modifyOption(e,a,e.options[a]);typeof r<"u"&&(e.options[a]=r)}},getEventProperties:function(e,n){var l={};return Ft.forEach(function(s){typeof s.eventProperties=="function"&&ot(l,s.eventProperties.call(n[s.pluginName],e))}),l},modifyOption:function(e,n,l){var s;return Ft.forEach(function(a){e[a.pluginName]&&a.optionListeners&&typeof a.optionListeners[n]=="function"&&(s=a.optionListeners[n].call(e[a.pluginName],l))}),s}};function ts(t){var e=t.sortable,n=t.rootEl,l=t.name,s=t.targetEl,a=t.cloneEl,r=t.toEl,d=t.fromEl,i=t.oldIndex,c=t.newIndex,h=t.oldDraggableIndex,m=t.newDraggableIndex,u=t.originalEvent,v=t.putSortable,g=t.extraEventProperties;if(e=e||n&&n[Ge],!!e){var y,b=e.options,x="on"+l.charAt(0).toUpperCase()+l.substr(1);window.CustomEvent&&!yt&&!hs?y=new CustomEvent(l,{bubbles:!0,cancelable:!0}):(y=document.createEvent("Event"),y.initEvent(l,!0,!0)),y.to=r||n,y.from=d||n,y.item=s||n,y.clone=a,y.oldIndex=i,y.newIndex=c,y.oldDraggableIndex=h,y.newDraggableIndex=m,y.originalEvent=u,y.pullMode=v?v.lastPutMode:void 0;var w=ft(ft({},g),fs.getEventProperties(l,e));for(var k in w)y[k]=w[k];n&&n.dispatchEvent(y),b[x]&&b[x].call(e,y)}}var xc=["evt"],We=function(e,n){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=l.evt,a=lc(l,xc);fs.pluginEvent.bind(Q)(e,n,ft({dragEl:N,parentEl:Re,ghostEl:ie,rootEl:xe,nextEl:It,lastDownEl:ws,cloneEl:Oe,cloneHidden:Dt,dragStarted:ss,putSortable:je,activeSortable:Q.active,originalEvent:s,oldIndex:Vt,oldDraggableIndex:is,newIndex:Ze,newDraggableIndex:St,hideGhostForTarget:Wo,unhideGhostForTarget:Yo,cloneNowHidden:function(){Dt=!0},cloneNowShown:function(){Dt=!1},dispatchSortableEvent:function(d){Ke({sortable:n,name:d,originalEvent:s})}},a))};function Ke(t){ts(ft({putSortable:je,cloneEl:Oe,targetEl:N,rootEl:xe,oldIndex:Vt,oldDraggableIndex:is,newIndex:Ze,newDraggableIndex:St},t))}var N,Re,ie,xe,It,ws,Oe,Dt,Vt,Ze,is,St,ys,je,Ut=!1,Is=!1,ks=[],Rt,it,Gs,Bs,_o,Eo,ss,Nt,ls,cs=!1,bs=!1,Ps,He,Ks=[],qs=!1,$s=[],Ms=typeof document<"u",Cs=Uo,wo=hs||yt?"cssFloat":"float",_c=Ms&&!pc&&!Uo&&"draggable"in document.createElement("div"),Bo=function(){if(Ms){if(yt)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto",t.style.pointerEvents==="auto"}}(),Ko=function(e,n){var l=z(e),s=parseInt(l.width)-parseInt(l.paddingLeft)-parseInt(l.paddingRight)-parseInt(l.borderLeftWidth)-parseInt(l.borderRightWidth),a=Ht(e,0,n),r=Ht(e,1,n),d=a&&z(a),i=r&&z(r),c=d&&parseInt(d.marginLeft)+parseInt(d.marginRight)+_e(a).width,h=i&&parseInt(i.marginLeft)+parseInt(i.marginRight)+_e(r).width;if(l.display==="flex")return l.flexDirection==="column"||l.flexDirection==="column-reverse"?"vertical":"horizontal";if(l.display==="grid")return l.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(a&&d.float&&d.float!=="none"){var m=d.float==="left"?"left":"right";return r&&(i.clear==="both"||i.clear===m)?"vertical":"horizontal"}return a&&(d.display==="block"||d.display==="flex"||d.display==="table"||d.display==="grid"||c>=s&&l[wo]==="none"||r&&l[wo]==="none"&&c+h>s)?"vertical":"horizontal"},Ec=function(e,n,l){var s=l?e.left:e.top,a=l?e.right:e.bottom,r=l?e.width:e.height,d=l?n.left:n.top,i=l?n.right:n.bottom,c=l?n.width:n.height;return s===d||a===i||s+r/2===d+c/2},wc=function(e,n){var l;return ks.some(function(s){var a=s[Ge].options.emptyInsertThreshold;if(!(!a||uo(s))){var r=_e(s),d=e>=r.left-a&&e<=r.right+a,i=n>=r.top-a&&n<=r.bottom+a;if(d&&i)return l=s}}),l},zo=function(e){function n(a,r){return function(d,i,c,h){var m=d.options.group.name&&i.options.group.name&&d.options.group.name===i.options.group.name;if(a==null&&(r||m))return!0;if(a==null||a===!1)return!1;if(r&&a==="clone")return a;if(typeof a=="function")return n(a(d,i,c,h),r)(d,i,c,h);var u=(r?d:i).options.group.name;return a===!0||typeof a=="string"&&a===u||a.join&&a.indexOf(u)>-1}}var l={},s=e.group;(!s||Es(s)!="object")&&(s={name:s}),l.name=s.name,l.checkPull=n(s.pull,!0),l.checkPut=n(s.put),l.revertClone=s.revertClone,e.group=l},Wo=function(){!Bo&&ie&&z(ie,"display","none")},Yo=function(){!Bo&&ie&&z(ie,"display","")};Ms&&document.addEventListener("click",function(t){if(Is)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),Is=!1,!1},!0);var Ot=function(e){if(N){e=e.touches?e.touches[0]:e;var n=wc(e.clientX,e.clientY);if(n){var l={};for(var s in e)e.hasOwnProperty(s)&&(l[s]=e[s]);l.target=l.rootEl=n,l.preventDefault=void 0,l.stopPropagation=void 0,n[Ge]._onDragOver(l)}}},Pc=function(e){N&&N.parentNode[Ge]._isOutsideThisEl(e.target)};function Q(t,e){if(!(t&&t.nodeType&&t.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=ot({},e),t[Ge]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Ko(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(r,d){r.setData("Text",d.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Q.supportPointer!==!1&&"PointerEvent"in window&&!ns,emptyInsertThreshold:5};fs.initializePlugins(this,t,n);for(var l in n)!(l in e)&&(e[l]=n[l]);zo(e);for(var s in this)s.charAt(0)==="_"&&typeof this[s]=="function"&&(this[s]=this[s].bind(this));this.nativeDraggable=e.forceFallback?!1:_c,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?he(t,"pointerdown",this._onTapStart):(he(t,"mousedown",this._onTapStart),he(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(he(t,"dragover",this),he(t,"dragenter",this)),ks.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),ot(this,Cc())}Q.prototype={constructor:Q,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(Nt=null)},_getDirection:function(e,n){return typeof this.options.direction=="function"?this.options.direction.call(this,e,n,N):this.options.direction},_onTapStart:function(e){if(e.cancelable){var n=this,l=this.el,s=this.options,a=s.preventOnFilter,r=e.type,d=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,i=(d||e).target,c=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||i,h=s.filter;if(Mc(l),!N&&!(/mousedown|pointerdown/.test(r)&&e.button!==0||s.disabled)&&!c.isContentEditable&&!(!this.nativeDraggable&&ns&&i&&i.tagName.toUpperCase()==="SELECT")&&(i=ct(i,s.draggable,l,!1),!(i&&i.animated)&&ws!==i)){if(Vt=Ie(i),is=Ie(i,s.draggable),typeof h=="function"){if(h.call(this,e,i,this)){Ke({sortable:n,rootEl:c,name:"filter",targetEl:i,toEl:l,fromEl:l}),We("filter",n,{evt:e}),a&&e.cancelable&&e.preventDefault();return}}else if(h&&(h=h.split(",").some(function(m){if(m=ct(c,m.trim(),l,!1),m)return Ke({sortable:n,rootEl:m,name:"filter",targetEl:i,fromEl:l,toEl:l}),We("filter",n,{evt:e}),!0}),h)){a&&e.cancelable&&e.preventDefault();return}s.handle&&!ct(c,s.handle,l,!1)||this._prepareDragStart(e,d,i)}}},_prepareDragStart:function(e,n,l){var s=this,a=s.el,r=s.options,d=a.ownerDocument,i;if(l&&!N&&l.parentNode===a){var c=_e(l);if(xe=a,N=l,Re=N.parentNode,It=N.nextSibling,ws=l,ys=r.group,Q.dragged=N,Rt={target:N,clientX:(n||e).clientX,clientY:(n||e).clientY},_o=Rt.clientX-c.left,Eo=Rt.clientY-c.top,this._lastX=(n||e).clientX,this._lastY=(n||e).clientY,N.style["will-change"]="all",i=function(){if(We("delayEnded",s,{evt:e}),Q.eventCanceled){s._onDrop();return}s._disableDelayedDragEvents(),!bo&&s.nativeDraggable&&(N.draggable=!0),s._triggerDragStart(e,n),Ke({sortable:s,name:"choose",originalEvent:e}),we(N,r.chosenClass,!0)},r.ignore.split(",").forEach(function(h){Vo(N,h.trim(),zs)}),he(d,"dragover",Ot),he(d,"mousemove",Ot),he(d,"touchmove",Ot),he(d,"mouseup",s._onDrop),he(d,"touchend",s._onDrop),he(d,"touchcancel",s._onDrop),bo&&this.nativeDraggable&&(this.options.touchStartThreshold=4,N.draggable=!0),We("delayStart",this,{evt:e}),r.delay&&(!r.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(hs||yt))){if(Q.eventCanceled){this._onDrop();return}he(d,"mouseup",s._disableDelayedDrag),he(d,"touchend",s._disableDelayedDrag),he(d,"touchcancel",s._disableDelayedDrag),he(d,"mousemove",s._delayedDragTouchMoveHandler),he(d,"touchmove",s._delayedDragTouchMoveHandler),r.supportPointer&&he(d,"pointermove",s._delayedDragTouchMoveHandler),s._dragStartTimer=setTimeout(i,r.delay)}else i()}},_delayedDragTouchMoveHandler:function(e){var n=e.touches?e.touches[0]:e;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){N&&zs(N),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;ue(e,"mouseup",this._disableDelayedDrag),ue(e,"touchend",this._disableDelayedDrag),ue(e,"touchcancel",this._disableDelayedDrag),ue(e,"mousemove",this._delayedDragTouchMoveHandler),ue(e,"touchmove",this._delayedDragTouchMoveHandler),ue(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,n){n=n||e.pointerType=="touch"&&e,!this.nativeDraggable||n?this.options.supportPointer?he(document,"pointermove",this._onTouchMove):n?he(document,"touchmove",this._onTouchMove):he(document,"mousemove",this._onTouchMove):(he(N,"dragend",this),he(xe,"dragstart",this._onDragStart));try{document.selection?Ts(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,n){if(Ut=!1,xe&&N){We("dragStarted",this,{evt:n}),this.nativeDraggable&&he(document,"dragover",Pc);var l=this.options;!e&&we(N,l.dragClass,!1),we(N,l.ghostClass,!0),Q.active=this,e&&this._appendGhost(),Ke({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(it){this._lastX=it.clientX,this._lastY=it.clientY,Wo();for(var e=document.elementFromPoint(it.clientX,it.clientY),n=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(it.clientX,it.clientY),e!==n);)n=e;if(N.parentNode[Ge]._isOutsideThisEl(e),n)do{if(n[Ge]){var l=void 0;if(l=n[Ge]._onDragOver({clientX:it.clientX,clientY:it.clientY,target:e,rootEl:n}),l&&!this.options.dragoverBubble)break}e=n}while(n=n.parentNode);Yo()}},_onTouchMove:function(e){if(Rt){var n=this.options,l=n.fallbackTolerance,s=n.fallbackOffset,a=e.touches?e.touches[0]:e,r=ie&&kt(ie,!0),d=ie&&r&&r.a,i=ie&&r&&r.d,c=Cs&&He&&Do(He),h=(a.clientX-Rt.clientX+s.x)/(d||1)+(c?c[0]-Ks[0]:0)/(d||1),m=(a.clientY-Rt.clientY+s.y)/(i||1)+(c?c[1]-Ks[1]:0)/(i||1);if(!Q.active&&!Ut){if(l&&Math.max(Math.abs(a.clientX-this._lastX),Math.abs(a.clientY-this._lastY))<l)return;this._onDragStart(e,!0)}if(ie){r?(r.e+=h-(Gs||0),r.f+=m-(Bs||0)):r={a:1,b:0,c:0,d:1,e:h,f:m};var u="matrix(".concat(r.a,",").concat(r.b,",").concat(r.c,",").concat(r.d,",").concat(r.e,",").concat(r.f,")");z(ie,"webkitTransform",u),z(ie,"mozTransform",u),z(ie,"msTransform",u),z(ie,"transform",u),Gs=h,Bs=m,it=a}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!ie){var e=this.options.fallbackOnBody?document.body:xe,n=_e(N,!0,Cs,!0,e),l=this.options;if(Cs){for(He=e;z(He,"position")==="static"&&z(He,"transform")==="none"&&He!==document;)He=He.parentNode;He!==document.body&&He!==document.documentElement?(He===document&&(He=ht()),n.top+=He.scrollTop,n.left+=He.scrollLeft):He=ht(),Ks=Do(He)}ie=N.cloneNode(!0),we(ie,l.ghostClass,!1),we(ie,l.fallbackClass,!0),we(ie,l.dragClass,!0),z(ie,"transition",""),z(ie,"transform",""),z(ie,"box-sizing","border-box"),z(ie,"margin",0),z(ie,"top",n.top),z(ie,"left",n.left),z(ie,"width",n.width),z(ie,"height",n.height),z(ie,"opacity","0.8"),z(ie,"position",Cs?"absolute":"fixed"),z(ie,"zIndex","100000"),z(ie,"pointerEvents","none"),Q.ghost=ie,e.appendChild(ie),z(ie,"transform-origin",_o/parseInt(ie.style.width)*100+"% "+Eo/parseInt(ie.style.height)*100+"%")}},_onDragStart:function(e,n){var l=this,s=e.dataTransfer,a=l.options;if(We("dragStart",this,{evt:e}),Q.eventCanceled){this._onDrop();return}We("setupClone",this),Q.eventCanceled||(Oe=mo(N),Oe.draggable=!1,Oe.style["will-change"]="",this._hideClone(),we(Oe,this.options.chosenClass,!1),Q.clone=Oe),l.cloneId=Ts(function(){We("clone",l),!Q.eventCanceled&&(l.options.removeCloneOnHide||xe.insertBefore(Oe,N),l._hideClone(),Ke({sortable:l,name:"clone"}))}),!n&&we(N,a.dragClass,!0),n?(Is=!0,l._loopId=setInterval(l._emulateDragOver,50)):(ue(document,"mouseup",l._onDrop),ue(document,"touchend",l._onDrop),ue(document,"touchcancel",l._onDrop),s&&(s.effectAllowed="move",a.setData&&a.setData.call(l,s,N)),he(document,"drop",l),z(N,"transform","translateZ(0)")),Ut=!0,l._dragStartId=Ts(l._dragStarted.bind(l,n,e)),he(document,"selectstart",l),ss=!0,ns&&z(document.body,"user-select","none")},_onDragOver:function(e){var n=this.el,l=e.target,s,a,r,d=this.options,i=d.group,c=Q.active,h=ys===i,m=d.sort,u=je||c,v,g=this,y=!1;if(qs)return;function b(ye,Se){We(ye,g,ft({evt:e,isOwner:h,axis:v?"vertical":"horizontal",revert:r,dragRect:s,targetRect:a,canSort:m,fromSortable:u,target:l,completed:w,onMove:function(Pe,Te){return Ss(xe,n,N,s,Pe,_e(Pe),e,Te)},changed:k},Se))}function x(){b("dragOverAnimationCapture"),g.captureAnimationState(),g!==u&&u.captureAnimationState()}function w(ye){return b("dragOverCompleted",{insertion:ye}),ye&&(h?c._hideClone():c._showClone(g),g!==u&&(we(N,je?je.options.ghostClass:c.options.ghostClass,!1),we(N,d.ghostClass,!0)),je!==g&&g!==Q.active?je=g:g===Q.active&&je&&(je=null),u===g&&(g._ignoreWhileAnimating=l),g.animateAll(function(){b("dragOverAnimationComplete"),g._ignoreWhileAnimating=null}),g!==u&&(u.animateAll(),u._ignoreWhileAnimating=null)),(l===N&&!N.animated||l===n&&!l.animated)&&(Nt=null),!d.dragoverBubble&&!e.rootEl&&l!==document&&(N.parentNode[Ge]._isOutsideThisEl(e.target),!ye&&Ot(e)),!d.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),y=!0}function k(){Ze=Ie(N),St=Ie(N,d.draggable),Ke({sortable:g,name:"change",toEl:n,newIndex:Ze,newDraggableIndex:St,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),l=ct(l,d.draggable,n,!0),b("dragOver"),Q.eventCanceled)return y;if(N.contains(e.target)||l.animated&&l.animatingX&&l.animatingY||g._ignoreWhileAnimating===l)return w(!1);if(Is=!1,c&&!d.disabled&&(h?m||(r=Re!==xe):je===this||(this.lastPutMode=ys.checkPull(this,c,N,e))&&i.checkPut(this,c,N,e))){if(v=this._getDirection(e,l)==="vertical",s=_e(N),b("dragOverValid"),Q.eventCanceled)return y;if(r)return Re=xe,x(),this._hideClone(),b("revert"),Q.eventCanceled||(It?xe.insertBefore(N,It):xe.appendChild(N)),w(!0);var C=uo(n,d.draggable);if(!C||Ic(e,v,this)&&!C.animated){if(C===N)return w(!1);if(C&&n===e.target&&(l=C),l&&(a=_e(l)),Ss(xe,n,N,s,l,a,e,!!l)!==!1)return x(),n.appendChild(N),Re=n,k(),w(!0)}else if(C&&Oc(e,v,this)){var O=Ht(n,0,d,!0);if(O===N)return w(!1);if(l=O,a=_e(l),Ss(xe,n,N,s,l,a,e,!1)!==!1)return x(),n.insertBefore(N,O),Re=n,k(),w(!0)}else if(l.parentNode===n){a=_e(l);var R=0,V,B=N.parentNode!==n,I=!Ec(N.animated&&N.toRect||s,l.animated&&l.toRect||a,v),L=v?"top":"left",H=So(l,"top","top")||So(N,"top","top"),re=H?H.scrollTop:void 0;Nt!==l&&(V=a[L],cs=!1,bs=!I&&d.invertSwap||B),R=kc(e,l,a,v,I?1:d.swapThreshold,d.invertedSwapThreshold==null?d.swapThreshold:d.invertedSwapThreshold,bs,Nt===l);var F;if(R!==0){var U=Ie(N);do U-=R,F=Re.children[U];while(F&&(z(F,"display")==="none"||F===ie))}if(R===0||F===l)return w(!1);Nt=l,ls=R;var oe=l.nextElementSibling,j=!1;j=R===1;var Y=Ss(xe,n,N,s,l,a,e,j);if(Y!==!1)return(Y===1||Y===-1)&&(j=Y===1),qs=!0,setTimeout(Rc,30),x(),j&&!oe?n.appendChild(N):l.parentNode.insertBefore(N,j?oe:l),H&&Go(H,0,re-H.scrollTop),Re=N.parentNode,V!==void 0&&!bs&&(Ps=Math.abs(V-_e(l)[L])),k(),w(!0)}if(n.contains(N))return w(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){ue(document,"mousemove",this._onTouchMove),ue(document,"touchmove",this._onTouchMove),ue(document,"pointermove",this._onTouchMove),ue(document,"dragover",Ot),ue(document,"mousemove",Ot),ue(document,"touchmove",Ot)},_offUpEvents:function(){var e=this.el.ownerDocument;ue(e,"mouseup",this._onDrop),ue(e,"touchend",this._onDrop),ue(e,"pointerup",this._onDrop),ue(e,"touchcancel",this._onDrop),ue(document,"selectstart",this)},_onDrop:function(e){var n=this.el,l=this.options;if(Ze=Ie(N),St=Ie(N,l.draggable),We("drop",this,{evt:e}),Re=N&&N.parentNode,Ze=Ie(N),St=Ie(N,l.draggable),Q.eventCanceled){this._nulling();return}Ut=!1,bs=!1,cs=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),eo(this.cloneId),eo(this._dragStartId),this.nativeDraggable&&(ue(document,"drop",this),ue(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),ns&&z(document.body,"user-select",""),z(N,"transform",""),e&&(ss&&(e.cancelable&&e.preventDefault(),!l.dropBubble&&e.stopPropagation()),ie&&ie.parentNode&&ie.parentNode.removeChild(ie),(xe===Re||je&&je.lastPutMode!=="clone")&&Oe&&Oe.parentNode&&Oe.parentNode.removeChild(Oe),N&&(this.nativeDraggable&&ue(N,"dragend",this),zs(N),N.style["will-change"]="",ss&&!Ut&&we(N,je?je.options.ghostClass:this.options.ghostClass,!1),we(N,this.options.chosenClass,!1),Ke({sortable:this,name:"unchoose",toEl:Re,newIndex:null,newDraggableIndex:null,originalEvent:e}),xe!==Re?(Ze>=0&&(Ke({rootEl:Re,name:"add",toEl:Re,fromEl:xe,originalEvent:e}),Ke({sortable:this,name:"remove",toEl:Re,originalEvent:e}),Ke({rootEl:Re,name:"sort",toEl:Re,fromEl:xe,originalEvent:e}),Ke({sortable:this,name:"sort",toEl:Re,originalEvent:e})),je&&je.save()):Ze!==Vt&&Ze>=0&&(Ke({sortable:this,name:"update",toEl:Re,originalEvent:e}),Ke({sortable:this,name:"sort",toEl:Re,originalEvent:e})),Q.active&&((Ze==null||Ze===-1)&&(Ze=Vt,St=is),Ke({sortable:this,name:"end",toEl:Re,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){We("nulling",this),xe=N=Re=ie=It=Oe=ws=Dt=Rt=it=ss=Ze=St=Vt=is=Nt=ls=je=ys=Q.dragged=Q.ghost=Q.clone=Q.active=null,$s.forEach(function(e){e.checked=!0}),$s.length=Gs=Bs=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":N&&(this._onDragOver(e),Tc(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],n,l=this.el.children,s=0,a=l.length,r=this.options;s<a;s++)n=l[s],ct(n,r.draggable,this.el,!1)&&e.push(n.getAttribute(r.dataIdAttr)||Ac(n));return e},sort:function(e,n){var l={},s=this.el;this.toArray().forEach(function(a,r){var d=s.children[r];ct(d,this.options.draggable,s,!1)&&(l[a]=d)},this),n&&this.captureAnimationState(),e.forEach(function(a){l[a]&&(s.removeChild(l[a]),s.appendChild(l[a]))}),n&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,n){return ct(e,n||this.options.draggable,this.el,!1)},option:function(e,n){var l=this.options;if(n===void 0)return l[e];var s=fs.modifyOption(this,e,n);typeof s<"u"?l[e]=s:l[e]=n,e==="group"&&zo(l)},destroy:function(){We("destroy",this);var e=this.el;e[Ge]=null,ue(e,"mousedown",this._onTapStart),ue(e,"touchstart",this._onTapStart),ue(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(ue(e,"dragover",this),ue(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),ks.splice(ks.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Dt){if(We("hideClone",this),Q.eventCanceled)return;z(Oe,"display","none"),this.options.removeCloneOnHide&&Oe.parentNode&&Oe.parentNode.removeChild(Oe),Dt=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Dt){if(We("showClone",this),Q.eventCanceled)return;N.parentNode==xe&&!this.options.group.revertClone?xe.insertBefore(Oe,N):It?xe.insertBefore(Oe,It):xe.appendChild(Oe),this.options.group.revertClone&&this.animate(N,Oe),z(Oe,"display",""),Dt=!1}}};function Tc(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function Ss(t,e,n,l,s,a,r,d){var i,c=t[Ge],h=c.options.onMove,m;return window.CustomEvent&&!yt&&!hs?i=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(i=document.createEvent("Event"),i.initEvent("move",!0,!0)),i.to=e,i.from=t,i.dragged=n,i.draggedRect=l,i.related=s||e,i.relatedRect=a||_e(e),i.willInsertAfter=d,i.originalEvent=r,t.dispatchEvent(i),h&&(m=h.call(c,i,r)),m}function zs(t){t.draggable=!1}function Rc(){qs=!1}function Oc(t,e,n){var l=_e(Ht(n.el,0,n.options,!0)),s=10;return e?t.clientX<l.left-s||t.clientY<l.top&&t.clientX<l.right:t.clientY<l.top-s||t.clientY<l.bottom&&t.clientX<l.left}function Ic(t,e,n){var l=_e(uo(n.el,n.options.draggable)),s=10;return e?t.clientX>l.right+s||t.clientX<=l.right&&t.clientY>l.bottom&&t.clientX>=l.left:t.clientX>l.right&&t.clientY>l.top||t.clientX<=l.right&&t.clientY>l.bottom+s}function kc(t,e,n,l,s,a,r,d){var i=l?t.clientY:t.clientX,c=l?n.height:n.width,h=l?n.top:n.left,m=l?n.bottom:n.right,u=!1;if(!r){if(d&&Ps<c*s){if(!cs&&(ls===1?i>h+c*a/2:i<m-c*a/2)&&(cs=!0),cs)u=!0;else if(ls===1?i<h+Ps:i>m-Ps)return-ls}else if(i>h+c*(1-s)/2&&i<m-c*(1-s)/2)return $c(e)}return u=u||r,u&&(i<h+c*a/2||i>m-c*a/2)?i>h+c/2?1:-1:0}function $c(t){return Ie(N)<Ie(t)?1:-1}function Ac(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,l=0;n--;)l+=e.charCodeAt(n);return l.toString(36)}function Mc(t){$s.length=0;for(var e=t.getElementsByTagName("input"),n=e.length;n--;){var l=e[n];l.checked&&$s.push(l)}}function Ts(t){return setTimeout(t,0)}function eo(t){return clearTimeout(t)}Ms&&he(document,"touchmove",function(t){(Q.active||Ut)&&t.cancelable&&t.preventDefault()});Q.utils={on:he,off:ue,css:z,find:Vo,is:function(e,n){return!!ct(e,n,e,!1)},extend:yc,throttle:Ho,closest:ct,toggleClass:we,clone:mo,index:Ie,nextTick:Ts,cancelNextTick:eo,detectDirection:Ko,getChild:Ht};Q.get=function(t){return t[Ge]};Q.mount=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e[0].constructor===Array&&(e=e[0]),e.forEach(function(l){if(!l.prototype||!l.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(l));l.utils&&(Q.utils=ft(ft({},Q.utils),l.utils)),fs.mount(l)})};Q.create=function(t,e){return new Q(t,e)};Q.version=fc;var Ae=[],os,to,so=!1,Ws,Ys,As,rs;function Fc(){function t(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return t.prototype={dragStarted:function(n){var l=n.originalEvent;this.sortable.nativeDraggable?he(document,"dragover",this._handleAutoScroll):this.options.supportPointer?he(document,"pointermove",this._handleFallbackAutoScroll):l.touches?he(document,"touchmove",this._handleFallbackAutoScroll):he(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var l=n.originalEvent;!this.options.dragOverBubble&&!l.rootEl&&this._handleAutoScroll(l)},drop:function(){this.sortable.nativeDraggable?ue(document,"dragover",this._handleAutoScroll):(ue(document,"pointermove",this._handleFallbackAutoScroll),ue(document,"touchmove",this._handleFallbackAutoScroll),ue(document,"mousemove",this._handleFallbackAutoScroll)),Po(),Rs(),bc()},nulling:function(){As=to=os=so=rs=Ws=Ys=null,Ae.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,l){var s=this,a=(n.touches?n.touches[0]:n).clientX,r=(n.touches?n.touches[0]:n).clientY,d=document.elementFromPoint(a,r);if(As=n,l||this.options.forceAutoScrollFallback||hs||yt||ns){Xs(n,this.options,d,l);var i=xt(d,!0);so&&(!rs||a!==Ws||r!==Ys)&&(rs&&Po(),rs=setInterval(function(){var c=xt(document.elementFromPoint(a,r),!0);c!==i&&(i=c,Rs()),Xs(n,s.options,c,l)},10),Ws=a,Ys=r)}else{if(!this.options.bubbleScroll||xt(d,!0)===ht()){Rs();return}Xs(n,this.options,xt(d,!1),!1)}}},ot(t,{pluginName:"scroll",initializeByDefault:!0})}function Rs(){Ae.forEach(function(t){clearInterval(t.pid)}),Ae=[]}function Po(){clearInterval(rs)}var Xs=Ho(function(t,e,n,l){if(e.scroll){var s=(t.touches?t.touches[0]:t).clientX,a=(t.touches?t.touches[0]:t).clientY,r=e.scrollSensitivity,d=e.scrollSpeed,i=ht(),c=!1,h;to!==n&&(to=n,Rs(),os=e.scroll,h=e.scrollFn,os===!0&&(os=xt(n,!0)));var m=0,u=os;do{var v=u,g=_e(v),y=g.top,b=g.bottom,x=g.left,w=g.right,k=g.width,C=g.height,O=void 0,R=void 0,V=v.scrollWidth,B=v.scrollHeight,I=z(v),L=v.scrollLeft,H=v.scrollTop;v===i?(O=k<V&&(I.overflowX==="auto"||I.overflowX==="scroll"||I.overflowX==="visible"),R=C<B&&(I.overflowY==="auto"||I.overflowY==="scroll"||I.overflowY==="visible")):(O=k<V&&(I.overflowX==="auto"||I.overflowX==="scroll"),R=C<B&&(I.overflowY==="auto"||I.overflowY==="scroll"));var re=O&&(Math.abs(w-s)<=r&&L+k<V)-(Math.abs(x-s)<=r&&!!L),F=R&&(Math.abs(b-a)<=r&&H+C<B)-(Math.abs(y-a)<=r&&!!H);if(!Ae[m])for(var U=0;U<=m;U++)Ae[U]||(Ae[U]={});(Ae[m].vx!=re||Ae[m].vy!=F||Ae[m].el!==v)&&(Ae[m].el=v,Ae[m].vx=re,Ae[m].vy=F,clearInterval(Ae[m].pid),(re!=0||F!=0)&&(c=!0,Ae[m].pid=setInterval((function(){l&&this.layer===0&&Q.active._onTouchMove(As);var oe=Ae[this.layer].vy?Ae[this.layer].vy*d:0,j=Ae[this.layer].vx?Ae[this.layer].vx*d:0;typeof h=="function"&&h.call(Q.dragged.parentNode[Ge],j,oe,t,As,Ae[this.layer].el)!=="continue"||Go(Ae[this.layer].el,j,oe)}).bind({layer:m}),24))),m++}while(e.bubbleScroll&&u!==i&&(u=xt(u,!1)));so=c}},30),Xo=function(e){var n=e.originalEvent,l=e.putSortable,s=e.dragEl,a=e.activeSortable,r=e.dispatchSortableEvent,d=e.hideGhostForTarget,i=e.unhideGhostForTarget;if(n){var c=l||a;d();var h=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,m=document.elementFromPoint(h.clientX,h.clientY);i(),c&&!c.el.contains(m)&&(r("spill"),this.onSpill({dragEl:s,putSortable:l}))}};function ho(){}ho.prototype={startIndex:null,dragStart:function(e){var n=e.oldDraggableIndex;this.startIndex=n},onSpill:function(e){var n=e.dragEl,l=e.putSortable;this.sortable.captureAnimationState(),l&&l.captureAnimationState();var s=Ht(this.sortable.el,this.startIndex,this.options);s?this.sortable.el.insertBefore(n,s):this.sortable.el.appendChild(n),this.sortable.animateAll(),l&&l.animateAll()},drop:Xo};ot(ho,{pluginName:"revertOnSpill"});function fo(){}fo.prototype={onSpill:function(e){var n=e.dragEl,l=e.putSortable,s=l||this.sortable;s.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),s.animateAll()},drop:Xo};ot(fo,{pluginName:"removeOnSpill"});var tt;function Nc(){function t(){this.defaults={swapClass:"sortable-swap-highlight"}}return t.prototype={dragStart:function(n){var l=n.dragEl;tt=l},dragOverValid:function(n){var l=n.completed,s=n.target,a=n.onMove,r=n.activeSortable,d=n.changed,i=n.cancel;if(r.options.swap){var c=this.sortable.el,h=this.options;if(s&&s!==c){var m=tt;a(s)!==!1?(we(s,h.swapClass,!0),tt=s):tt=null,m&&m!==tt&&we(m,h.swapClass,!1)}d(),l(!0),i()}},drop:function(n){var l=n.activeSortable,s=n.putSortable,a=n.dragEl,r=s||this.sortable,d=this.options;tt&&we(tt,d.swapClass,!1),tt&&(d.swap||s&&s.options.swap)&&a!==tt&&(r.captureAnimationState(),r!==l&&l.captureAnimationState(),Lc(a,tt),r.animateAll(),r!==l&&l.animateAll())},nulling:function(){tt=null}},ot(t,{pluginName:"swap",eventProperties:function(){return{swapItem:tt}}})}function Lc(t,e){var n=t.parentNode,l=e.parentNode,s,a;!n||!l||n.isEqualNode(e)||l.isEqualNode(t)||(s=Ie(t),a=Ie(e),n.isEqualNode(l)&&s<a&&a++,n.insertBefore(e,n.children[s]),l.insertBefore(t,l.children[a]))}var ne=[],Qe=[],Qt,lt,Zt=!1,Ye=!1,Lt=!1,Ce,qt,Ds;function Uc(){function t(e){for(var n in this)n.charAt(0)==="_"&&typeof this[n]=="function"&&(this[n]=this[n].bind(this));e.options.supportPointer?he(document,"pointerup",this._deselectMultiDrag):(he(document,"mouseup",this._deselectMultiDrag),he(document,"touchend",this._deselectMultiDrag)),he(document,"keydown",this._checkKeyDown),he(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(s,a){var r="";ne.length&&lt===e?ne.forEach(function(d,i){r+=(i?", ":"")+d.textContent}):r=a.textContent,s.setData("Text",r)}}}return t.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(n){var l=n.dragEl;Ce=l},delayEnded:function(){this.isMultiDrag=~ne.indexOf(Ce)},setupClone:function(n){var l=n.sortable,s=n.cancel;if(this.isMultiDrag){for(var a=0;a<ne.length;a++)Qe.push(mo(ne[a])),Qe[a].sortableIndex=ne[a].sortableIndex,Qe[a].draggable=!1,Qe[a].style["will-change"]="",we(Qe[a],this.options.selectedClass,!1),ne[a]===Ce&&we(Qe[a],this.options.chosenClass,!1);l._hideClone(),s()}},clone:function(n){var l=n.sortable,s=n.rootEl,a=n.dispatchSortableEvent,r=n.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||ne.length&&lt===l&&(To(!0,s),a("clone"),r()))},showClone:function(n){var l=n.cloneNowShown,s=n.rootEl,a=n.cancel;this.isMultiDrag&&(To(!1,s),Qe.forEach(function(r){z(r,"display","")}),l(),Ds=!1,a())},hideClone:function(n){var l=this;n.sortable;var s=n.cloneNowHidden,a=n.cancel;this.isMultiDrag&&(Qe.forEach(function(r){z(r,"display","none"),l.options.removeCloneOnHide&&r.parentNode&&r.parentNode.removeChild(r)}),s(),Ds=!0,a())},dragStartGlobal:function(n){n.sortable,!this.isMultiDrag&&lt&&lt.multiDrag._deselectMultiDrag(),ne.forEach(function(l){l.sortableIndex=Ie(l)}),ne=ne.sort(function(l,s){return l.sortableIndex-s.sortableIndex}),Lt=!0},dragStarted:function(n){var l=this,s=n.sortable;if(this.isMultiDrag){if(this.options.sort&&(s.captureAnimationState(),this.options.animation)){ne.forEach(function(r){r!==Ce&&z(r,"position","absolute")});var a=_e(Ce,!1,!0,!0);ne.forEach(function(r){r!==Ce&&xo(r,a)}),Ye=!0,Zt=!0}s.animateAll(function(){Ye=!1,Zt=!1,l.options.animation&&ne.forEach(function(r){Vs(r)}),l.options.sort&&xs()})}},dragOver:function(n){var l=n.target,s=n.completed,a=n.cancel;Ye&&~ne.indexOf(l)&&(s(!1),a())},revert:function(n){var l=n.fromSortable,s=n.rootEl,a=n.sortable,r=n.dragRect;ne.length>1&&(ne.forEach(function(d){a.addAnimationState({target:d,rect:Ye?_e(d):r}),Vs(d),d.fromRect=r,l.removeAnimationState(d)}),Ye=!1,jc(!this.options.removeCloneOnHide,s))},dragOverCompleted:function(n){var l=n.sortable,s=n.isOwner,a=n.insertion,r=n.activeSortable,d=n.parentEl,i=n.putSortable,c=this.options;if(a){if(s&&r._hideClone(),Zt=!1,c.animation&&ne.length>1&&(Ye||!s&&!r.options.sort&&!i)){var h=_e(Ce,!1,!0,!0);ne.forEach(function(u){u!==Ce&&(xo(u,h),d.appendChild(u))}),Ye=!0}if(!s)if(Ye||xs(),ne.length>1){var m=Ds;r._showClone(l),r.options.animation&&!Ds&&m&&Qe.forEach(function(u){r.addAnimationState({target:u,rect:qt}),u.fromRect=qt,u.thisAnimationDuration=null})}else r._showClone(l)}},dragOverAnimationCapture:function(n){var l=n.dragRect,s=n.isOwner,a=n.activeSortable;if(ne.forEach(function(d){d.thisAnimationDuration=null}),a.options.animation&&!s&&a.multiDrag.isMultiDrag){qt=ot({},l);var r=kt(Ce,!0);qt.top-=r.f,qt.left-=r.e}},dragOverAnimationComplete:function(){Ye&&(Ye=!1,xs())},drop:function(n){var l=n.originalEvent,s=n.rootEl,a=n.parentEl,r=n.sortable,d=n.dispatchSortableEvent,i=n.oldIndex,c=n.putSortable,h=c||this.sortable;if(l){var m=this.options,u=a.children;if(!Lt)if(m.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),we(Ce,m.selectedClass,!~ne.indexOf(Ce)),~ne.indexOf(Ce))ne.splice(ne.indexOf(Ce),1),Qt=null,ts({sortable:r,rootEl:s,name:"deselect",targetEl:Ce,originalEvt:l});else{if(ne.push(Ce),ts({sortable:r,rootEl:s,name:"select",targetEl:Ce,originalEvt:l}),l.shiftKey&&Qt&&r.el.contains(Qt)){var v=Ie(Qt),g=Ie(Ce);if(~v&&~g&&v!==g){var y,b;for(g>v?(b=v,y=g):(b=g,y=v+1);b<y;b++)~ne.indexOf(u[b])||(we(u[b],m.selectedClass,!0),ne.push(u[b]),ts({sortable:r,rootEl:s,name:"select",targetEl:u[b],originalEvt:l}))}}else Qt=Ce;lt=h}if(Lt&&this.isMultiDrag){if(Ye=!1,(a[Ge].options.sort||a!==s)&&ne.length>1){var x=_e(Ce),w=Ie(Ce,":not(."+this.options.selectedClass+")");if(!Zt&&m.animation&&(Ce.thisAnimationDuration=null),h.captureAnimationState(),!Zt&&(m.animation&&(Ce.fromRect=x,ne.forEach(function(C){if(C.thisAnimationDuration=null,C!==Ce){var O=Ye?_e(C):x;C.fromRect=O,h.addAnimationState({target:C,rect:O})}})),xs(),ne.forEach(function(C){u[w]?a.insertBefore(C,u[w]):a.appendChild(C),w++}),i===Ie(Ce))){var k=!1;ne.forEach(function(C){if(C.sortableIndex!==Ie(C)){k=!0;return}}),k&&d("update")}ne.forEach(function(C){Vs(C)}),h.animateAll()}lt=h}(s===a||c&&c.lastPutMode!=="clone")&&Qe.forEach(function(C){C.parentNode&&C.parentNode.removeChild(C)})}},nullingGlobal:function(){this.isMultiDrag=Lt=!1,Qe.length=0},destroyGlobal:function(){this._deselectMultiDrag(),ue(document,"pointerup",this._deselectMultiDrag),ue(document,"mouseup",this._deselectMultiDrag),ue(document,"touchend",this._deselectMultiDrag),ue(document,"keydown",this._checkKeyDown),ue(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(n){if(!(typeof Lt<"u"&&Lt)&&lt===this.sortable&&!(n&&ct(n.target,this.options.draggable,this.sortable.el,!1))&&!(n&&n.button!==0))for(;ne.length;){var l=ne[0];we(l,this.options.selectedClass,!1),ne.shift(),ts({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:l,originalEvt:n})}},_checkKeyDown:function(n){n.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(n){n.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},ot(t,{pluginName:"multiDrag",utils:{select:function(n){var l=n.parentNode[Ge];!l||!l.options.multiDrag||~ne.indexOf(n)||(lt&&lt!==l&&(lt.multiDrag._deselectMultiDrag(),lt=l),we(n,l.options.selectedClass,!0),ne.push(n))},deselect:function(n){var l=n.parentNode[Ge],s=ne.indexOf(n);!l||!l.options.multiDrag||!~s||(we(n,l.options.selectedClass,!1),ne.splice(s,1))}},eventProperties:function(){var n=this,l=[],s=[];return ne.forEach(function(a){l.push({multiDragElement:a,index:a.sortableIndex});var r;Ye&&a!==Ce?r=-1:Ye?r=Ie(a,":not(."+n.options.selectedClass+")"):r=Ie(a),s.push({multiDragElement:a,index:r})}),{items:cc(ne),clones:[].concat(Qe),oldIndicies:l,newIndicies:s}},optionListeners:{multiDragKey:function(n){return n=n.toLowerCase(),n==="ctrl"?n="Control":n.length>1&&(n=n.charAt(0).toUpperCase()+n.substr(1)),n}}})}function jc(t,e){ne.forEach(function(n,l){var s=e.children[n.sortableIndex+(t?Number(l):0)];s?e.insertBefore(n,s):e.appendChild(n)})}function To(t,e){Qe.forEach(function(n,l){var s=e.children[n.sortableIndex+(t?Number(l):0)];s?e.insertBefore(n,s):e.appendChild(n)})}function xs(){ne.forEach(function(t){t!==Ce&&t.parentNode&&t.parentNode.removeChild(t)})}Q.mount(new Fc);Q.mount(fo,ho);const Vc=Object.freeze(Object.defineProperty({__proto__:null,MultiDrag:Uc,Sortable:Q,Swap:Nc,default:Q},Symbol.toStringTag,{value:"Module"})),Hc=$o(Vc);(function(t,e){(function(l,s){t.exports=s(nc,Hc)})(typeof self<"u"?self:fa,function(n,l){return function(s){var a={};function r(d){if(a[d])return a[d].exports;var i=a[d]={i:d,l:!1,exports:{}};return s[d].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=s,r.c=a,r.d=function(d,i,c){r.o(d,i)||Object.defineProperty(d,i,{enumerable:!0,get:c})},r.r=function(d){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(d,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(d,"__esModule",{value:!0})},r.t=function(d,i){if(i&1&&(d=r(d)),i&8||i&4&&typeof d=="object"&&d&&d.__esModule)return d;var c=Object.create(null);if(r.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:d}),i&2&&typeof d!="string")for(var h in d)r.d(c,h,(function(m){return d[m]}).bind(null,h));return c},r.n=function(d){var i=d&&d.__esModule?function(){return d.default}:function(){return d};return r.d(i,"a",i),i},r.o=function(d,i){return Object.prototype.hasOwnProperty.call(d,i)},r.p="",r(r.s="fb15")}({"00ee":function(s,a,r){var d=r("b622"),i=d("toStringTag"),c={};c[i]="z",s.exports=String(c)==="[object z]"},"0366":function(s,a,r){var d=r("1c0b");s.exports=function(i,c,h){if(d(i),c===void 0)return i;switch(h){case 0:return function(){return i.call(c)};case 1:return function(m){return i.call(c,m)};case 2:return function(m,u){return i.call(c,m,u)};case 3:return function(m,u,v){return i.call(c,m,u,v)}}return function(){return i.apply(c,arguments)}}},"057f":function(s,a,r){var d=r("fc6a"),i=r("241c").f,c={}.toString,h=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],m=function(u){try{return i(u)}catch{return h.slice()}};s.exports.f=function(v){return h&&c.call(v)=="[object Window]"?m(v):i(d(v))}},"06cf":function(s,a,r){var d=r("83ab"),i=r("d1e7"),c=r("5c6c"),h=r("fc6a"),m=r("c04e"),u=r("5135"),v=r("0cfb"),g=Object.getOwnPropertyDescriptor;a.f=d?g:function(b,x){if(b=h(b),x=m(x,!0),v)try{return g(b,x)}catch{}if(u(b,x))return c(!i.f.call(b,x),b[x])}},"0cfb":function(s,a,r){var d=r("83ab"),i=r("d039"),c=r("cc12");s.exports=!d&&!i(function(){return Object.defineProperty(c("div"),"a",{get:function(){return 7}}).a!=7})},"13d5":function(s,a,r){var d=r("23e7"),i=r("d58f").left,c=r("a640"),h=r("ae40"),m=c("reduce"),u=h("reduce",{1:0});d({target:"Array",proto:!0,forced:!m||!u},{reduce:function(g){return i(this,g,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"14c3":function(s,a,r){var d=r("c6b6"),i=r("9263");s.exports=function(c,h){var m=c.exec;if(typeof m=="function"){var u=m.call(c,h);if(typeof u!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return u}if(d(c)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return i.call(c,h)}},"159b":function(s,a,r){var d=r("da84"),i=r("fdbc"),c=r("17c2"),h=r("9112");for(var m in i){var u=d[m],v=u&&u.prototype;if(v&&v.forEach!==c)try{h(v,"forEach",c)}catch{v.forEach=c}}},"17c2":function(s,a,r){var d=r("b727").forEach,i=r("a640"),c=r("ae40"),h=i("forEach"),m=c("forEach");s.exports=!h||!m?function(v){return d(this,v,arguments.length>1?arguments[1]:void 0)}:[].forEach},"1be4":function(s,a,r){var d=r("d066");s.exports=d("document","documentElement")},"1c0b":function(s,a){s.exports=function(r){if(typeof r!="function")throw TypeError(String(r)+" is not a function");return r}},"1c7e":function(s,a,r){var d=r("b622"),i=d("iterator"),c=!1;try{var h=0,m={next:function(){return{done:!!h++}},return:function(){c=!0}};m[i]=function(){return this},Array.from(m,function(){throw 2})}catch{}s.exports=function(u,v){if(!v&&!c)return!1;var g=!1;try{var y={};y[i]=function(){return{next:function(){return{done:g=!0}}}},u(y)}catch{}return g}},"1d80":function(s,a){s.exports=function(r){if(r==null)throw TypeError("Can't call method on "+r);return r}},"1dde":function(s,a,r){var d=r("d039"),i=r("b622"),c=r("2d00"),h=i("species");s.exports=function(m){return c>=51||!d(function(){var u=[],v=u.constructor={};return v[h]=function(){return{foo:1}},u[m](Boolean).foo!==1})}},"23cb":function(s,a,r){var d=r("a691"),i=Math.max,c=Math.min;s.exports=function(h,m){var u=d(h);return u<0?i(u+m,0):c(u,m)}},"23e7":function(s,a,r){var d=r("da84"),i=r("06cf").f,c=r("9112"),h=r("6eeb"),m=r("ce4e"),u=r("e893"),v=r("94ca");s.exports=function(g,y){var b=g.target,x=g.global,w=g.stat,k,C,O,R,V,B;if(x?C=d:w?C=d[b]||m(b,{}):C=(d[b]||{}).prototype,C)for(O in y){if(V=y[O],g.noTargetGet?(B=i(C,O),R=B&&B.value):R=C[O],k=v(x?O:b+(w?".":"#")+O,g.forced),!k&&R!==void 0){if(typeof V==typeof R)continue;u(V,R)}(g.sham||R&&R.sham)&&c(V,"sham",!0),h(C,O,V,g)}}},"241c":function(s,a,r){var d=r("ca84"),i=r("7839"),c=i.concat("length","prototype");a.f=Object.getOwnPropertyNames||function(m){return d(m,c)}},"25f0":function(s,a,r){var d=r("6eeb"),i=r("825a"),c=r("d039"),h=r("ad6d"),m="toString",u=RegExp.prototype,v=u[m],g=c(function(){return v.call({source:"a",flags:"b"})!="/a/b"}),y=v.name!=m;(g||y)&&d(RegExp.prototype,m,function(){var x=i(this),w=String(x.source),k=x.flags,C=String(k===void 0&&x instanceof RegExp&&!("flags"in u)?h.call(x):k);return"/"+w+"/"+C},{unsafe:!0})},"2ca0":function(s,a,r){var d=r("23e7"),i=r("06cf").f,c=r("50c4"),h=r("5a34"),m=r("1d80"),u=r("ab13"),v=r("c430"),g="".startsWith,y=Math.min,b=u("startsWith"),x=!v&&!b&&!!function(){var w=i(String.prototype,"startsWith");return w&&!w.writable}();d({target:"String",proto:!0,forced:!x&&!b},{startsWith:function(k){var C=String(m(this));h(k);var O=c(y(arguments.length>1?arguments[1]:void 0,C.length)),R=String(k);return g?g.call(C,R,O):C.slice(O,O+R.length)===R}})},"2d00":function(s,a,r){var d=r("da84"),i=r("342f"),c=d.process,h=c&&c.versions,m=h&&h.v8,u,v;m?(u=m.split("."),v=u[0]+u[1]):i&&(u=i.match(/Edge\/(\d+)/),(!u||u[1]>=74)&&(u=i.match(/Chrome\/(\d+)/),u&&(v=u[1]))),s.exports=v&&+v},"342f":function(s,a,r){var d=r("d066");s.exports=d("navigator","userAgent")||""},"35a1":function(s,a,r){var d=r("f5df"),i=r("3f8c"),c=r("b622"),h=c("iterator");s.exports=function(m){if(m!=null)return m[h]||m["@@iterator"]||i[d(m)]}},"37e8":function(s,a,r){var d=r("83ab"),i=r("9bf2"),c=r("825a"),h=r("df75");s.exports=d?Object.defineProperties:function(u,v){c(u);for(var g=h(v),y=g.length,b=0,x;y>b;)i.f(u,x=g[b++],v[x]);return u}},"3bbe":function(s,a,r){var d=r("861d");s.exports=function(i){if(!d(i)&&i!==null)throw TypeError("Can't set "+String(i)+" as a prototype");return i}},"3ca3":function(s,a,r){var d=r("6547").charAt,i=r("69f3"),c=r("7dd0"),h="String Iterator",m=i.set,u=i.getterFor(h);c(String,"String",function(v){m(this,{type:h,string:String(v),index:0})},function(){var g=u(this),y=g.string,b=g.index,x;return b>=y.length?{value:void 0,done:!0}:(x=d(y,b),g.index+=x.length,{value:x,done:!1})})},"3f8c":function(s,a){s.exports={}},4160:function(s,a,r){var d=r("23e7"),i=r("17c2");d({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},"428f":function(s,a,r){var d=r("da84");s.exports=d},"44ad":function(s,a,r){var d=r("d039"),i=r("c6b6"),c="".split;s.exports=d(function(){return!Object("z").propertyIsEnumerable(0)})?function(h){return i(h)=="String"?c.call(h,""):Object(h)}:Object},"44d2":function(s,a,r){var d=r("b622"),i=r("7c73"),c=r("9bf2"),h=d("unscopables"),m=Array.prototype;m[h]==null&&c.f(m,h,{configurable:!0,value:i(null)}),s.exports=function(u){m[h][u]=!0}},"44e7":function(s,a,r){var d=r("861d"),i=r("c6b6"),c=r("b622"),h=c("match");s.exports=function(m){var u;return d(m)&&((u=m[h])!==void 0?!!u:i(m)=="RegExp")}},4930:function(s,a,r){var d=r("d039");s.exports=!!Object.getOwnPropertySymbols&&!d(function(){return!String(Symbol())})},"4d64":function(s,a,r){var d=r("fc6a"),i=r("50c4"),c=r("23cb"),h=function(m){return function(u,v,g){var y=d(u),b=i(y.length),x=c(g,b),w;if(m&&v!=v){for(;b>x;)if(w=y[x++],w!=w)return!0}else for(;b>x;x++)if((m||x in y)&&y[x]===v)return m||x||0;return!m&&-1}};s.exports={includes:h(!0),indexOf:h(!1)}},"4de4":function(s,a,r){var d=r("23e7"),i=r("b727").filter,c=r("1dde"),h=r("ae40"),m=c("filter"),u=h("filter");d({target:"Array",proto:!0,forced:!m||!u},{filter:function(g){return i(this,g,arguments.length>1?arguments[1]:void 0)}})},"4df4":function(s,a,r){var d=r("0366"),i=r("7b0b"),c=r("9bdd"),h=r("e95a"),m=r("50c4"),u=r("8418"),v=r("35a1");s.exports=function(y){var b=i(y),x=typeof this=="function"?this:Array,w=arguments.length,k=w>1?arguments[1]:void 0,C=k!==void 0,O=v(b),R=0,V,B,I,L,H,re;if(C&&(k=d(k,w>2?arguments[2]:void 0,2)),O!=null&&!(x==Array&&h(O)))for(L=O.call(b),H=L.next,B=new x;!(I=H.call(L)).done;R++)re=C?c(L,k,[I.value,R],!0):I.value,u(B,R,re);else for(V=m(b.length),B=new x(V);V>R;R++)re=C?k(b[R],R):b[R],u(B,R,re);return B.length=R,B}},"4fad":function(s,a,r){var d=r("23e7"),i=r("6f53").entries;d({target:"Object",stat:!0},{entries:function(h){return i(h)}})},"50c4":function(s,a,r){var d=r("a691"),i=Math.min;s.exports=function(c){return c>0?i(d(c),9007199254740991):0}},5135:function(s,a){var r={}.hasOwnProperty;s.exports=function(d,i){return r.call(d,i)}},5319:function(s,a,r){var d=r("d784"),i=r("825a"),c=r("7b0b"),h=r("50c4"),m=r("a691"),u=r("1d80"),v=r("8aa5"),g=r("14c3"),y=Math.max,b=Math.min,x=Math.floor,w=/\$([$&'`]|\d\d?|<[^>]*>)/g,k=/\$([$&'`]|\d\d?)/g,C=function(O){return O===void 0?O:String(O)};d("replace",2,function(O,R,V,B){var I=B.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,L=B.REPLACE_KEEPS_$0,H=I?"$":"$0";return[function(U,oe){var j=u(this),Y=U==null?void 0:U[O];return Y!==void 0?Y.call(U,j,oe):R.call(String(j),U,oe)},function(F,U){if(!I&&L||typeof U=="string"&&U.indexOf(H)===-1){var oe=V(R,F,this,U);if(oe.done)return oe.value}var j=i(F),Y=String(this),ye=typeof U=="function";ye||(U=String(U));var Se=j.global;if(Se){var Ne=j.unicode;j.lastIndex=0}for(var Pe=[];;){var Te=g(j,Y);if(Te===null||(Pe.push(Te),!Se))break;var Me=String(Te[0]);Me===""&&(j.lastIndex=v(Y,h(j.lastIndex),Ne))}for(var Fe="",$e=0,De=0;De<Pe.length;De++){Te=Pe[De];for(var Ee=String(Te[0]),Je=y(b(m(Te.index),Y.length),0),Be=[],vt=1;vt<Te.length;vt++)Be.push(C(Te[vt]));var Pt=Te.groups;if(ye){var bt=[Ee].concat(Be,Je,Y);Pt!==void 0&&bt.push(Pt);var Le=String(U.apply(void 0,bt))}else Le=re(Ee,Y,Je,Be,Pt,U);Je>=$e&&(Fe+=Y.slice($e,Je)+Le,$e=Je+Ee.length)}return Fe+Y.slice($e)}];function re(F,U,oe,j,Y,ye){var Se=oe+F.length,Ne=j.length,Pe=k;return Y!==void 0&&(Y=c(Y),Pe=w),R.call(ye,Pe,function(Te,Me){var Fe;switch(Me.charAt(0)){case"$":return"$";case"&":return F;case"`":return U.slice(0,oe);case"'":return U.slice(Se);case"<":Fe=Y[Me.slice(1,-1)];break;default:var $e=+Me;if($e===0)return Te;if($e>Ne){var De=x($e/10);return De===0?Te:De<=Ne?j[De-1]===void 0?Me.charAt(1):j[De-1]+Me.charAt(1):Te}Fe=j[$e-1]}return Fe===void 0?"":Fe})}})},5692:function(s,a,r){var d=r("c430"),i=r("c6cd");(s.exports=function(c,h){return i[c]||(i[c]=h!==void 0?h:{})})("versions",[]).push({version:"3.6.5",mode:d?"pure":"global",copyright:" 2020 Denis Pushkarev (zloirock.ru)"})},"56ef":function(s,a,r){var d=r("d066"),i=r("241c"),c=r("7418"),h=r("825a");s.exports=d("Reflect","ownKeys")||function(u){var v=i.f(h(u)),g=c.f;return g?v.concat(g(u)):v}},"5a34":function(s,a,r){var d=r("44e7");s.exports=function(i){if(d(i))throw TypeError("The method doesn't accept regular expressions");return i}},"5c6c":function(s,a){s.exports=function(r,d){return{enumerable:!(r&1),configurable:!(r&2),writable:!(r&4),value:d}}},"5db7":function(s,a,r){var d=r("23e7"),i=r("a2bf"),c=r("7b0b"),h=r("50c4"),m=r("1c0b"),u=r("65f0");d({target:"Array",proto:!0},{flatMap:function(g){var y=c(this),b=h(y.length),x;return m(g),x=u(y,0),x.length=i(x,y,y,b,0,1,g,arguments.length>1?arguments[1]:void 0),x}})},6547:function(s,a,r){var d=r("a691"),i=r("1d80"),c=function(h){return function(m,u){var v=String(i(m)),g=d(u),y=v.length,b,x;return g<0||g>=y?h?"":void 0:(b=v.charCodeAt(g),b<55296||b>56319||g+1===y||(x=v.charCodeAt(g+1))<56320||x>57343?h?v.charAt(g):b:h?v.slice(g,g+2):(b-55296<<10)+(x-56320)+65536)}};s.exports={codeAt:c(!1),charAt:c(!0)}},"65f0":function(s,a,r){var d=r("861d"),i=r("e8b5"),c=r("b622"),h=c("species");s.exports=function(m,u){var v;return i(m)&&(v=m.constructor,typeof v=="function"&&(v===Array||i(v.prototype))?v=void 0:d(v)&&(v=v[h],v===null&&(v=void 0))),new(v===void 0?Array:v)(u===0?0:u)}},"69f3":function(s,a,r){var d=r("7f9a"),i=r("da84"),c=r("861d"),h=r("9112"),m=r("5135"),u=r("f772"),v=r("d012"),g=i.WeakMap,y,b,x,w=function(I){return x(I)?b(I):y(I,{})},k=function(I){return function(L){var H;if(!c(L)||(H=b(L)).type!==I)throw TypeError("Incompatible receiver, "+I+" required");return H}};if(d){var C=new g,O=C.get,R=C.has,V=C.set;y=function(I,L){return V.call(C,I,L),L},b=function(I){return O.call(C,I)||{}},x=function(I){return R.call(C,I)}}else{var B=u("state");v[B]=!0,y=function(I,L){return h(I,B,L),L},b=function(I){return m(I,B)?I[B]:{}},x=function(I){return m(I,B)}}s.exports={set:y,get:b,has:x,enforce:w,getterFor:k}},"6eeb":function(s,a,r){var d=r("da84"),i=r("9112"),c=r("5135"),h=r("ce4e"),m=r("8925"),u=r("69f3"),v=u.get,g=u.enforce,y=String(String).split("String");(s.exports=function(b,x,w,k){var C=k?!!k.unsafe:!1,O=k?!!k.enumerable:!1,R=k?!!k.noTargetGet:!1;if(typeof w=="function"&&(typeof x=="string"&&!c(w,"name")&&i(w,"name",x),g(w).source=y.join(typeof x=="string"?x:"")),b===d){O?b[x]=w:h(x,w);return}else C?!R&&b[x]&&(O=!0):delete b[x];O?b[x]=w:i(b,x,w)})(Function.prototype,"toString",function(){return typeof this=="function"&&v(this).source||m(this)})},"6f53":function(s,a,r){var d=r("83ab"),i=r("df75"),c=r("fc6a"),h=r("d1e7").f,m=function(u){return function(v){for(var g=c(v),y=i(g),b=y.length,x=0,w=[],k;b>x;)k=y[x++],(!d||h.call(g,k))&&w.push(u?[k,g[k]]:g[k]);return w}};s.exports={entries:m(!0),values:m(!1)}},"73d9":function(s,a,r){var d=r("44d2");d("flatMap")},7418:function(s,a){a.f=Object.getOwnPropertySymbols},"746f":function(s,a,r){var d=r("428f"),i=r("5135"),c=r("e538"),h=r("9bf2").f;s.exports=function(m){var u=d.Symbol||(d.Symbol={});i(u,m)||h(u,m,{value:c.f(m)})}},7839:function(s,a){s.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"7b0b":function(s,a,r){var d=r("1d80");s.exports=function(i){return Object(d(i))}},"7c73":function(s,a,r){var d=r("825a"),i=r("37e8"),c=r("7839"),h=r("d012"),m=r("1be4"),u=r("cc12"),v=r("f772"),g=">",y="<",b="prototype",x="script",w=v("IE_PROTO"),k=function(){},C=function(I){return y+x+g+I+y+"/"+x+g},O=function(I){I.write(C("")),I.close();var L=I.parentWindow.Object;return I=null,L},R=function(){var I=u("iframe"),L="java"+x+":",H;return I.style.display="none",m.appendChild(I),I.src=String(L),H=I.contentWindow.document,H.open(),H.write(C("document.F=Object")),H.close(),H.F},V,B=function(){try{V=document.domain&&new ActiveXObject("htmlfile")}catch{}B=V?O(V):R();for(var I=c.length;I--;)delete B[b][c[I]];return B()};h[w]=!0,s.exports=Object.create||function(L,H){var re;return L!==null?(k[b]=d(L),re=new k,k[b]=null,re[w]=L):re=B(),H===void 0?re:i(re,H)}},"7dd0":function(s,a,r){var d=r("23e7"),i=r("9ed3"),c=r("e163"),h=r("d2bb"),m=r("d44e"),u=r("9112"),v=r("6eeb"),g=r("b622"),y=r("c430"),b=r("3f8c"),x=r("ae93"),w=x.IteratorPrototype,k=x.BUGGY_SAFARI_ITERATORS,C=g("iterator"),O="keys",R="values",V="entries",B=function(){return this};s.exports=function(I,L,H,re,F,U,oe){i(H,L,re);var j=function(De){if(De===F&&Pe)return Pe;if(!k&&De in Se)return Se[De];switch(De){case O:return function(){return new H(this,De)};case R:return function(){return new H(this,De)};case V:return function(){return new H(this,De)}}return function(){return new H(this)}},Y=L+" Iterator",ye=!1,Se=I.prototype,Ne=Se[C]||Se["@@iterator"]||F&&Se[F],Pe=!k&&Ne||j(F),Te=L=="Array"&&Se.entries||Ne,Me,Fe,$e;if(Te&&(Me=c(Te.call(new I)),w!==Object.prototype&&Me.next&&(!y&&c(Me)!==w&&(h?h(Me,w):typeof Me[C]!="function"&&u(Me,C,B)),m(Me,Y,!0,!0),y&&(b[Y]=B))),F==R&&Ne&&Ne.name!==R&&(ye=!0,Pe=function(){return Ne.call(this)}),(!y||oe)&&Se[C]!==Pe&&u(Se,C,Pe),b[L]=Pe,F)if(Fe={values:j(R),keys:U?Pe:j(O),entries:j(V)},oe)for($e in Fe)(k||ye||!($e in Se))&&v(Se,$e,Fe[$e]);else d({target:L,proto:!0,forced:k||ye},Fe);return Fe}},"7f9a":function(s,a,r){var d=r("da84"),i=r("8925"),c=d.WeakMap;s.exports=typeof c=="function"&&/native code/.test(i(c))},"825a":function(s,a,r){var d=r("861d");s.exports=function(i){if(!d(i))throw TypeError(String(i)+" is not an object");return i}},"83ab":function(s,a,r){var d=r("d039");s.exports=!d(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},8418:function(s,a,r){var d=r("c04e"),i=r("9bf2"),c=r("5c6c");s.exports=function(h,m,u){var v=d(m);v in h?i.f(h,v,c(0,u)):h[v]=u}},"861d":function(s,a){s.exports=function(r){return typeof r=="object"?r!==null:typeof r=="function"}},8875:function(s,a,r){var d,i,c;(function(h,m){i=[],d=m,c=typeof d=="function"?d.apply(a,i):d,c!==void 0&&(s.exports=c)})(typeof self<"u"?self:this,function(){function h(){var m=Object.getOwnPropertyDescriptor(document,"currentScript");if(!m&&"currentScript"in document&&document.currentScript||m&&m.get!==h&&document.currentScript)return document.currentScript;try{throw new Error}catch(V){var u=/.*at [^(]*\((.*):(.+):(.+)\)$/ig,v=/@([^@]*):(\d+):(\d+)\s*$/ig,g=u.exec(V.stack)||v.exec(V.stack),y=g&&g[1]||!1,b=g&&g[2]||!1,x=document.location.href.replace(document.location.hash,""),w,k,C,O=document.getElementsByTagName("script");y===x&&(w=document.documentElement.outerHTML,k=new RegExp("(?:[^\\n]+?\\n){0,"+(b-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),C=w.replace(k,"$1").trim());for(var R=0;R<O.length;R++)if(O[R].readyState==="interactive"||O[R].src===y||y===x&&O[R].innerHTML&&O[R].innerHTML.trim()===C)return O[R];return null}}return h})},8925:function(s,a,r){var d=r("c6cd"),i=Function.toString;typeof d.inspectSource!="function"&&(d.inspectSource=function(c){return i.call(c)}),s.exports=d.inspectSource},"8aa5":function(s,a,r){var d=r("6547").charAt;s.exports=function(i,c,h){return c+(h?d(i,c).length:1)}},"8bbf":function(s,a){s.exports=n},"90e3":function(s,a){var r=0,d=Math.random();s.exports=function(i){return"Symbol("+String(i===void 0?"":i)+")_"+(++r+d).toString(36)}},9112:function(s,a,r){var d=r("83ab"),i=r("9bf2"),c=r("5c6c");s.exports=d?function(h,m,u){return i.f(h,m,c(1,u))}:function(h,m,u){return h[m]=u,h}},9263:function(s,a,r){var d=r("ad6d"),i=r("9f7f"),c=RegExp.prototype.exec,h=String.prototype.replace,m=c,u=function(){var b=/a/,x=/b*/g;return c.call(b,"a"),c.call(x,"a"),b.lastIndex!==0||x.lastIndex!==0}(),v=i.UNSUPPORTED_Y||i.BROKEN_CARET,g=/()??/.exec("")[1]!==void 0,y=u||g||v;y&&(m=function(x){var w=this,k,C,O,R,V=v&&w.sticky,B=d.call(w),I=w.source,L=0,H=x;return V&&(B=B.replace("y",""),B.indexOf("g")===-1&&(B+="g"),H=String(x).slice(w.lastIndex),w.lastIndex>0&&(!w.multiline||w.multiline&&x[w.lastIndex-1]!==`
`)&&(I="(?: "+I+")",H=" "+H,L++),C=new RegExp("^(?:"+I+")",B)),g&&(C=new RegExp("^"+I+"$(?!\\s)",B)),u&&(k=w.lastIndex),O=c.call(V?C:w,H),V?O?(O.input=O.input.slice(L),O[0]=O[0].slice(L),O.index=w.lastIndex,w.lastIndex+=O[0].length):w.lastIndex=0:u&&O&&(w.lastIndex=w.global?O.index+O[0].length:k),g&&O&&O.length>1&&h.call(O[0],C,function(){for(R=1;R<arguments.length-2;R++)arguments[R]===void 0&&(O[R]=void 0)}),O}),s.exports=m},"94ca":function(s,a,r){var d=r("d039"),i=/#|\.prototype\./,c=function(g,y){var b=m[h(g)];return b==v?!0:b==u?!1:typeof y=="function"?d(y):!!y},h=c.normalize=function(g){return String(g).replace(i,".").toLowerCase()},m=c.data={},u=c.NATIVE="N",v=c.POLYFILL="P";s.exports=c},"99af":function(s,a,r){var d=r("23e7"),i=r("d039"),c=r("e8b5"),h=r("861d"),m=r("7b0b"),u=r("50c4"),v=r("8418"),g=r("65f0"),y=r("1dde"),b=r("b622"),x=r("2d00"),w=b("isConcatSpreadable"),k=9007199254740991,C="Maximum allowed index exceeded",O=x>=51||!i(function(){var I=[];return I[w]=!1,I.concat()[0]!==I}),R=y("concat"),V=function(I){if(!h(I))return!1;var L=I[w];return L!==void 0?!!L:c(I)},B=!O||!R;d({target:"Array",proto:!0,forced:B},{concat:function(L){var H=m(this),re=g(H,0),F=0,U,oe,j,Y,ye;for(U=-1,j=arguments.length;U<j;U++)if(ye=U===-1?H:arguments[U],V(ye)){if(Y=u(ye.length),F+Y>k)throw TypeError(C);for(oe=0;oe<Y;oe++,F++)oe in ye&&v(re,F,ye[oe])}else{if(F>=k)throw TypeError(C);v(re,F++,ye)}return re.length=F,re}})},"9bdd":function(s,a,r){var d=r("825a");s.exports=function(i,c,h,m){try{return m?c(d(h)[0],h[1]):c(h)}catch(v){var u=i.return;throw u!==void 0&&d(u.call(i)),v}}},"9bf2":function(s,a,r){var d=r("83ab"),i=r("0cfb"),c=r("825a"),h=r("c04e"),m=Object.defineProperty;a.f=d?m:function(v,g,y){if(c(v),g=h(g,!0),c(y),i)try{return m(v,g,y)}catch{}if("get"in y||"set"in y)throw TypeError("Accessors not supported");return"value"in y&&(v[g]=y.value),v}},"9ed3":function(s,a,r){var d=r("ae93").IteratorPrototype,i=r("7c73"),c=r("5c6c"),h=r("d44e"),m=r("3f8c"),u=function(){return this};s.exports=function(v,g,y){var b=g+" Iterator";return v.prototype=i(d,{next:c(1,y)}),h(v,b,!1,!0),m[b]=u,v}},"9f7f":function(s,a,r){var d=r("d039");function i(c,h){return RegExp(c,h)}a.UNSUPPORTED_Y=d(function(){var c=i("a","y");return c.lastIndex=2,c.exec("abcd")!=null}),a.BROKEN_CARET=d(function(){var c=i("^r","gy");return c.lastIndex=2,c.exec("str")!=null})},a2bf:function(s,a,r){var d=r("e8b5"),i=r("50c4"),c=r("0366"),h=function(m,u,v,g,y,b,x,w){for(var k=y,C=0,O=x?c(x,w,3):!1,R;C<g;){if(C in v){if(R=O?O(v[C],C,u):v[C],b>0&&d(R))k=h(m,u,R,i(R.length),k,b-1)-1;else{if(k>=9007199254740991)throw TypeError("Exceed the acceptable array length");m[k]=R}k++}C++}return k};s.exports=h},a352:function(s,a){s.exports=l},a434:function(s,a,r){var d=r("23e7"),i=r("23cb"),c=r("a691"),h=r("50c4"),m=r("7b0b"),u=r("65f0"),v=r("8418"),g=r("1dde"),y=r("ae40"),b=g("splice"),x=y("splice",{ACCESSORS:!0,0:0,1:2}),w=Math.max,k=Math.min,C=9007199254740991,O="Maximum allowed length exceeded";d({target:"Array",proto:!0,forced:!b||!x},{splice:function(V,B){var I=m(this),L=h(I.length),H=i(V,L),re=arguments.length,F,U,oe,j,Y,ye;if(re===0?F=U=0:re===1?(F=0,U=L-H):(F=re-2,U=k(w(c(B),0),L-H)),L+F-U>C)throw TypeError(O);for(oe=u(I,U),j=0;j<U;j++)Y=H+j,Y in I&&v(oe,j,I[Y]);if(oe.length=U,F<U){for(j=H;j<L-U;j++)Y=j+U,ye=j+F,Y in I?I[ye]=I[Y]:delete I[ye];for(j=L;j>L-U+F;j--)delete I[j-1]}else if(F>U)for(j=L-U;j>H;j--)Y=j+U-1,ye=j+F-1,Y in I?I[ye]=I[Y]:delete I[ye];for(j=0;j<F;j++)I[j+H]=arguments[j+2];return I.length=L-U+F,oe}})},a4d3:function(s,a,r){var d=r("23e7"),i=r("da84"),c=r("d066"),h=r("c430"),m=r("83ab"),u=r("4930"),v=r("fdbf"),g=r("d039"),y=r("5135"),b=r("e8b5"),x=r("861d"),w=r("825a"),k=r("7b0b"),C=r("fc6a"),O=r("c04e"),R=r("5c6c"),V=r("7c73"),B=r("df75"),I=r("241c"),L=r("057f"),H=r("7418"),re=r("06cf"),F=r("9bf2"),U=r("d1e7"),oe=r("9112"),j=r("6eeb"),Y=r("5692"),ye=r("f772"),Se=r("d012"),Ne=r("90e3"),Pe=r("b622"),Te=r("e538"),Me=r("746f"),Fe=r("d44e"),$e=r("69f3"),De=r("b727").forEach,Ee=ye("hidden"),Je="Symbol",Be="prototype",vt=Pe("toPrimitive"),Pt=$e.set,bt=$e.getterFor(Je),Le=Object[Be],Ue=i.Symbol,Tt=c("JSON","stringify"),ut=re.f,mt=F.f,ps=L.f,Ls=U.f,at=Y("symbols"),Ct=Y("op-symbols"),Mt=Y("string-to-symbol-registry"),Kt=Y("symbol-to-string-registry"),zt=Y("wks"),Wt=i.QObject,Yt=!Wt||!Wt[Be]||!Wt[Be].findChild,Xt=m&&g(function(){return V(mt({},"a",{get:function(){return mt(this,"a",{value:7}).a}})).a!=7})?function(se,W,J){var fe=ut(Le,W);fe&&delete Le[W],mt(se,W,J),fe&&se!==Le&&mt(Le,W,fe)}:mt,Jt=function(se,W){var J=at[se]=V(Ue[Be]);return Pt(J,{type:Je,tag:se,description:W}),m||(J.description=W),J},E=v?function(se){return typeof se=="symbol"}:function(se){return Object(se)instanceof Ue},_=function(W,J,fe){W===Le&&_(Ct,J,fe),w(W);var pe=O(J,!0);return w(fe),y(at,pe)?(fe.enumerable?(y(W,Ee)&&W[Ee][pe]&&(W[Ee][pe]=!1),fe=V(fe,{enumerable:R(0,!1)})):(y(W,Ee)||mt(W,Ee,R(1,{})),W[Ee][pe]=!0),Xt(W,pe,fe)):mt(W,pe,fe)},P=function(W,J){w(W);var fe=C(J),pe=B(fe).concat(be(fe));return De(pe,function(ze){(!m||K.call(fe,ze))&&_(W,ze,fe[ze])}),W},A=function(W,J){return J===void 0?V(W):P(V(W),J)},K=function(W){var J=O(W,!0),fe=Ls.call(this,J);return this===Le&&y(at,J)&&!y(Ct,J)?!1:fe||!y(this,J)||!y(at,J)||y(this,Ee)&&this[Ee][J]?fe:!0},ee=function(W,J){var fe=C(W),pe=O(J,!0);if(!(fe===Le&&y(at,pe)&&!y(Ct,pe))){var ze=ut(fe,pe);return ze&&y(at,pe)&&!(y(fe,Ee)&&fe[Ee][pe])&&(ze.enumerable=!0),ze}},ce=function(W){var J=ps(C(W)),fe=[];return De(J,function(pe){!y(at,pe)&&!y(Se,pe)&&fe.push(pe)}),fe},be=function(W){var J=W===Le,fe=ps(J?Ct:C(W)),pe=[];return De(fe,function(ze){y(at,ze)&&(!J||y(Le,ze))&&pe.push(at[ze])}),pe};if(u||(Ue=function(){if(this instanceof Ue)throw TypeError("Symbol is not a constructor");var W=!arguments.length||arguments[0]===void 0?void 0:String(arguments[0]),J=Ne(W),fe=function(pe){this===Le&&fe.call(Ct,pe),y(this,Ee)&&y(this[Ee],J)&&(this[Ee][J]=!1),Xt(this,J,R(1,pe))};return m&&Yt&&Xt(Le,J,{configurable:!0,set:fe}),Jt(J,W)},j(Ue[Be],"toString",function(){return bt(this).tag}),j(Ue,"withoutSetter",function(se){return Jt(Ne(se),se)}),U.f=K,F.f=_,re.f=ee,I.f=L.f=ce,H.f=be,Te.f=function(se){return Jt(Pe(se),se)},m&&(mt(Ue[Be],"description",{configurable:!0,get:function(){return bt(this).description}}),h||j(Le,"propertyIsEnumerable",K,{unsafe:!0}))),d({global:!0,wrap:!0,forced:!u,sham:!u},{Symbol:Ue}),De(B(zt),function(se){Me(se)}),d({target:Je,stat:!0,forced:!u},{for:function(se){var W=String(se);if(y(Mt,W))return Mt[W];var J=Ue(W);return Mt[W]=J,Kt[J]=W,J},keyFor:function(W){if(!E(W))throw TypeError(W+" is not a symbol");if(y(Kt,W))return Kt[W]},useSetter:function(){Yt=!0},useSimple:function(){Yt=!1}}),d({target:"Object",stat:!0,forced:!u,sham:!m},{create:A,defineProperty:_,defineProperties:P,getOwnPropertyDescriptor:ee}),d({target:"Object",stat:!0,forced:!u},{getOwnPropertyNames:ce,getOwnPropertySymbols:be}),d({target:"Object",stat:!0,forced:g(function(){H.f(1)})},{getOwnPropertySymbols:function(W){return H.f(k(W))}}),Tt){var ke=!u||g(function(){var se=Ue();return Tt([se])!="[null]"||Tt({a:se})!="{}"||Tt(Object(se))!="{}"});d({target:"JSON",stat:!0,forced:ke},{stringify:function(W,J,fe){for(var pe=[W],ze=1,Us;arguments.length>ze;)pe.push(arguments[ze++]);if(Us=J,!(!x(J)&&W===void 0||E(W)))return b(J)||(J=function(Jo,vs){if(typeof Us=="function"&&(vs=Us.call(this,Jo,vs)),!E(vs))return vs}),pe[1]=J,Tt.apply(null,pe)}})}Ue[Be][vt]||oe(Ue[Be],vt,Ue[Be].valueOf),Fe(Ue,Je),Se[Ee]=!0},a630:function(s,a,r){var d=r("23e7"),i=r("4df4"),c=r("1c7e"),h=!c(function(m){Array.from(m)});d({target:"Array",stat:!0,forced:h},{from:i})},a640:function(s,a,r){var d=r("d039");s.exports=function(i,c){var h=[][i];return!!h&&d(function(){h.call(null,c||function(){throw 1},1)})}},a691:function(s,a){var r=Math.ceil,d=Math.floor;s.exports=function(i){return isNaN(i=+i)?0:(i>0?d:r)(i)}},ab13:function(s,a,r){var d=r("b622"),i=d("match");s.exports=function(c){var h=/./;try{"/./"[c](h)}catch{try{return h[i]=!1,"/./"[c](h)}catch{}}return!1}},ac1f:function(s,a,r){var d=r("23e7"),i=r("9263");d({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},ad6d:function(s,a,r){var d=r("825a");s.exports=function(){var i=d(this),c="";return i.global&&(c+="g"),i.ignoreCase&&(c+="i"),i.multiline&&(c+="m"),i.dotAll&&(c+="s"),i.unicode&&(c+="u"),i.sticky&&(c+="y"),c}},ae40:function(s,a,r){var d=r("83ab"),i=r("d039"),c=r("5135"),h=Object.defineProperty,m={},u=function(v){throw v};s.exports=function(v,g){if(c(m,v))return m[v];g||(g={});var y=[][v],b=c(g,"ACCESSORS")?g.ACCESSORS:!1,x=c(g,0)?g[0]:u,w=c(g,1)?g[1]:void 0;return m[v]=!!y&&!i(function(){if(b&&!d)return!0;var k={length:-1};b?h(k,1,{enumerable:!0,get:u}):k[1]=1,y.call(k,x,w)})}},ae93:function(s,a,r){var d=r("e163"),i=r("9112"),c=r("5135"),h=r("b622"),m=r("c430"),u=h("iterator"),v=!1,g=function(){return this},y,b,x;[].keys&&(x=[].keys(),"next"in x?(b=d(d(x)),b!==Object.prototype&&(y=b)):v=!0),y==null&&(y={}),!m&&!c(y,u)&&i(y,u,g),s.exports={IteratorPrototype:y,BUGGY_SAFARI_ITERATORS:v}},b041:function(s,a,r){var d=r("00ee"),i=r("f5df");s.exports=d?{}.toString:function(){return"[object "+i(this)+"]"}},b0c0:function(s,a,r){var d=r("83ab"),i=r("9bf2").f,c=Function.prototype,h=c.toString,m=/^\s*function ([^ (]*)/,u="name";d&&!(u in c)&&i(c,u,{configurable:!0,get:function(){try{return h.call(this).match(m)[1]}catch{return""}}})},b622:function(s,a,r){var d=r("da84"),i=r("5692"),c=r("5135"),h=r("90e3"),m=r("4930"),u=r("fdbf"),v=i("wks"),g=d.Symbol,y=u?g:g&&g.withoutSetter||h;s.exports=function(b){return c(v,b)||(m&&c(g,b)?v[b]=g[b]:v[b]=y("Symbol."+b)),v[b]}},b64b:function(s,a,r){var d=r("23e7"),i=r("7b0b"),c=r("df75"),h=r("d039"),m=h(function(){c(1)});d({target:"Object",stat:!0,forced:m},{keys:function(v){return c(i(v))}})},b727:function(s,a,r){var d=r("0366"),i=r("44ad"),c=r("7b0b"),h=r("50c4"),m=r("65f0"),u=[].push,v=function(g){var y=g==1,b=g==2,x=g==3,w=g==4,k=g==6,C=g==5||k;return function(O,R,V,B){for(var I=c(O),L=i(I),H=d(R,V,3),re=h(L.length),F=0,U=B||m,oe=y?U(O,re):b?U(O,0):void 0,j,Y;re>F;F++)if((C||F in L)&&(j=L[F],Y=H(j,F,I),g)){if(y)oe[F]=Y;else if(Y)switch(g){case 3:return!0;case 5:return j;case 6:return F;case 2:u.call(oe,j)}else if(w)return!1}return k?-1:x||w?w:oe}};s.exports={forEach:v(0),map:v(1),filter:v(2),some:v(3),every:v(4),find:v(5),findIndex:v(6)}},c04e:function(s,a,r){var d=r("861d");s.exports=function(i,c){if(!d(i))return i;var h,m;if(c&&typeof(h=i.toString)=="function"&&!d(m=h.call(i))||typeof(h=i.valueOf)=="function"&&!d(m=h.call(i))||!c&&typeof(h=i.toString)=="function"&&!d(m=h.call(i)))return m;throw TypeError("Can't convert object to primitive value")}},c430:function(s,a){s.exports=!1},c6b6:function(s,a){var r={}.toString;s.exports=function(d){return r.call(d).slice(8,-1)}},c6cd:function(s,a,r){var d=r("da84"),i=r("ce4e"),c="__core-js_shared__",h=d[c]||i(c,{});s.exports=h},c740:function(s,a,r){var d=r("23e7"),i=r("b727").findIndex,c=r("44d2"),h=r("ae40"),m="findIndex",u=!0,v=h(m);m in[]&&Array(1)[m](function(){u=!1}),d({target:"Array",proto:!0,forced:u||!v},{findIndex:function(y){return i(this,y,arguments.length>1?arguments[1]:void 0)}}),c(m)},c8ba:function(s,a){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch{typeof window=="object"&&(r=window)}s.exports=r},c975:function(s,a,r){var d=r("23e7"),i=r("4d64").indexOf,c=r("a640"),h=r("ae40"),m=[].indexOf,u=!!m&&1/[1].indexOf(1,-0)<0,v=c("indexOf"),g=h("indexOf",{ACCESSORS:!0,1:0});d({target:"Array",proto:!0,forced:u||!v||!g},{indexOf:function(b){return u?m.apply(this,arguments)||0:i(this,b,arguments.length>1?arguments[1]:void 0)}})},ca84:function(s,a,r){var d=r("5135"),i=r("fc6a"),c=r("4d64").indexOf,h=r("d012");s.exports=function(m,u){var v=i(m),g=0,y=[],b;for(b in v)!d(h,b)&&d(v,b)&&y.push(b);for(;u.length>g;)d(v,b=u[g++])&&(~c(y,b)||y.push(b));return y}},caad:function(s,a,r){var d=r("23e7"),i=r("4d64").includes,c=r("44d2"),h=r("ae40"),m=h("indexOf",{ACCESSORS:!0,1:0});d({target:"Array",proto:!0,forced:!m},{includes:function(v){return i(this,v,arguments.length>1?arguments[1]:void 0)}}),c("includes")},cc12:function(s,a,r){var d=r("da84"),i=r("861d"),c=d.document,h=i(c)&&i(c.createElement);s.exports=function(m){return h?c.createElement(m):{}}},ce4e:function(s,a,r){var d=r("da84"),i=r("9112");s.exports=function(c,h){try{i(d,c,h)}catch{d[c]=h}return h}},d012:function(s,a){s.exports={}},d039:function(s,a){s.exports=function(r){try{return!!r()}catch{return!0}}},d066:function(s,a,r){var d=r("428f"),i=r("da84"),c=function(h){return typeof h=="function"?h:void 0};s.exports=function(h,m){return arguments.length<2?c(d[h])||c(i[h]):d[h]&&d[h][m]||i[h]&&i[h][m]}},d1e7:function(s,a,r){var d={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,c=i&&!d.call({1:2},1);a.f=c?function(m){var u=i(this,m);return!!u&&u.enumerable}:d},d28b:function(s,a,r){var d=r("746f");d("iterator")},d2bb:function(s,a,r){var d=r("825a"),i=r("3bbe");s.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var c=!1,h={},m;try{m=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,m.call(h,[]),c=h instanceof Array}catch{}return function(v,g){return d(v),i(g),c?m.call(v,g):v.__proto__=g,v}}():void 0)},d3b7:function(s,a,r){var d=r("00ee"),i=r("6eeb"),c=r("b041");d||i(Object.prototype,"toString",c,{unsafe:!0})},d44e:function(s,a,r){var d=r("9bf2").f,i=r("5135"),c=r("b622"),h=c("toStringTag");s.exports=function(m,u,v){m&&!i(m=v?m:m.prototype,h)&&d(m,h,{configurable:!0,value:u})}},d58f:function(s,a,r){var d=r("1c0b"),i=r("7b0b"),c=r("44ad"),h=r("50c4"),m=function(u){return function(v,g,y,b){d(g);var x=i(v),w=c(x),k=h(x.length),C=u?k-1:0,O=u?-1:1;if(y<2)for(;;){if(C in w){b=w[C],C+=O;break}if(C+=O,u?C<0:k<=C)throw TypeError("Reduce of empty array with no initial value")}for(;u?C>=0:k>C;C+=O)C in w&&(b=g(b,w[C],C,x));return b}};s.exports={left:m(!1),right:m(!0)}},d784:function(s,a,r){r("ac1f");var d=r("6eeb"),i=r("d039"),c=r("b622"),h=r("9263"),m=r("9112"),u=c("species"),v=!i(function(){var w=/./;return w.exec=function(){var k=[];return k.groups={a:"7"},k},"".replace(w,"$<a>")!=="7"}),g=function(){return"a".replace(/./,"$0")==="$0"}(),y=c("replace"),b=function(){return/./[y]?/./[y]("a","$0")==="":!1}(),x=!i(function(){var w=/(?:)/,k=w.exec;w.exec=function(){return k.apply(this,arguments)};var C="ab".split(w);return C.length!==2||C[0]!=="a"||C[1]!=="b"});s.exports=function(w,k,C,O){var R=c(w),V=!i(function(){var F={};return F[R]=function(){return 7},""[w](F)!=7}),B=V&&!i(function(){var F=!1,U=/a/;return w==="split"&&(U={},U.constructor={},U.constructor[u]=function(){return U},U.flags="",U[R]=/./[R]),U.exec=function(){return F=!0,null},U[R](""),!F});if(!V||!B||w==="replace"&&!(v&&g&&!b)||w==="split"&&!x){var I=/./[R],L=C(R,""[w],function(F,U,oe,j,Y){return U.exec===h?V&&!Y?{done:!0,value:I.call(U,oe,j)}:{done:!0,value:F.call(oe,U,j)}:{done:!1}},{REPLACE_KEEPS_$0:g,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:b}),H=L[0],re=L[1];d(String.prototype,w,H),d(RegExp.prototype,R,k==2?function(F,U){return re.call(F,this,U)}:function(F){return re.call(F,this)})}O&&m(RegExp.prototype[R],"sham",!0)}},d81d:function(s,a,r){var d=r("23e7"),i=r("b727").map,c=r("1dde"),h=r("ae40"),m=c("map"),u=h("map");d({target:"Array",proto:!0,forced:!m||!u},{map:function(g){return i(this,g,arguments.length>1?arguments[1]:void 0)}})},da84:function(s,a,r){(function(d){var i=function(c){return c&&c.Math==Math&&c};s.exports=i(typeof globalThis=="object"&&globalThis)||i(typeof window=="object"&&window)||i(typeof self=="object"&&self)||i(typeof d=="object"&&d)||Function("return this")()}).call(this,r("c8ba"))},dbb4:function(s,a,r){var d=r("23e7"),i=r("83ab"),c=r("56ef"),h=r("fc6a"),m=r("06cf"),u=r("8418");d({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(g){for(var y=h(g),b=m.f,x=c(y),w={},k=0,C,O;x.length>k;)O=b(y,C=x[k++]),O!==void 0&&u(w,C,O);return w}})},dbf1:function(s,a,r){(function(d){r.d(a,"a",function(){return c});function i(){return typeof window<"u"?window.console:d.console}var c=i()}).call(this,r("c8ba"))},ddb0:function(s,a,r){var d=r("da84"),i=r("fdbc"),c=r("e260"),h=r("9112"),m=r("b622"),u=m("iterator"),v=m("toStringTag"),g=c.values;for(var y in i){var b=d[y],x=b&&b.prototype;if(x){if(x[u]!==g)try{h(x,u,g)}catch{x[u]=g}if(x[v]||h(x,v,y),i[y]){for(var w in c)if(x[w]!==c[w])try{h(x,w,c[w])}catch{x[w]=c[w]}}}}},df75:function(s,a,r){var d=r("ca84"),i=r("7839");s.exports=Object.keys||function(h){return d(h,i)}},e01a:function(s,a,r){var d=r("23e7"),i=r("83ab"),c=r("da84"),h=r("5135"),m=r("861d"),u=r("9bf2").f,v=r("e893"),g=c.Symbol;if(i&&typeof g=="function"&&(!("description"in g.prototype)||g().description!==void 0)){var y={},b=function(){var R=arguments.length<1||arguments[0]===void 0?void 0:String(arguments[0]),V=this instanceof b?new g(R):R===void 0?g():g(R);return R===""&&(y[V]=!0),V};v(b,g);var x=b.prototype=g.prototype;x.constructor=b;var w=x.toString,k=String(g("test"))=="Symbol(test)",C=/^Symbol\((.*)\)[^)]+$/;u(x,"description",{configurable:!0,get:function(){var R=m(this)?this.valueOf():this,V=w.call(R);if(h(y,R))return"";var B=k?V.slice(7,-1):V.replace(C,"$1");return B===""?void 0:B}}),d({global:!0,forced:!0},{Symbol:b})}},e163:function(s,a,r){var d=r("5135"),i=r("7b0b"),c=r("f772"),h=r("e177"),m=c("IE_PROTO"),u=Object.prototype;s.exports=h?Object.getPrototypeOf:function(v){return v=i(v),d(v,m)?v[m]:typeof v.constructor=="function"&&v instanceof v.constructor?v.constructor.prototype:v instanceof Object?u:null}},e177:function(s,a,r){var d=r("d039");s.exports=!d(function(){function i(){}return i.prototype.constructor=null,Object.getPrototypeOf(new i)!==i.prototype})},e260:function(s,a,r){var d=r("fc6a"),i=r("44d2"),c=r("3f8c"),h=r("69f3"),m=r("7dd0"),u="Array Iterator",v=h.set,g=h.getterFor(u);s.exports=m(Array,"Array",function(y,b){v(this,{type:u,target:d(y),index:0,kind:b})},function(){var y=g(this),b=y.target,x=y.kind,w=y.index++;return!b||w>=b.length?(y.target=void 0,{value:void 0,done:!0}):x=="keys"?{value:w,done:!1}:x=="values"?{value:b[w],done:!1}:{value:[w,b[w]],done:!1}},"values"),c.Arguments=c.Array,i("keys"),i("values"),i("entries")},e439:function(s,a,r){var d=r("23e7"),i=r("d039"),c=r("fc6a"),h=r("06cf").f,m=r("83ab"),u=i(function(){h(1)}),v=!m||u;d({target:"Object",stat:!0,forced:v,sham:!m},{getOwnPropertyDescriptor:function(y,b){return h(c(y),b)}})},e538:function(s,a,r){var d=r("b622");a.f=d},e893:function(s,a,r){var d=r("5135"),i=r("56ef"),c=r("06cf"),h=r("9bf2");s.exports=function(m,u){for(var v=i(u),g=h.f,y=c.f,b=0;b<v.length;b++){var x=v[b];d(m,x)||g(m,x,y(u,x))}}},e8b5:function(s,a,r){var d=r("c6b6");s.exports=Array.isArray||function(c){return d(c)=="Array"}},e95a:function(s,a,r){var d=r("b622"),i=r("3f8c"),c=d("iterator"),h=Array.prototype;s.exports=function(m){return m!==void 0&&(i.Array===m||h[c]===m)}},f5df:function(s,a,r){var d=r("00ee"),i=r("c6b6"),c=r("b622"),h=c("toStringTag"),m=i(function(){return arguments}())=="Arguments",u=function(v,g){try{return v[g]}catch{}};s.exports=d?i:function(v){var g,y,b;return v===void 0?"Undefined":v===null?"Null":typeof(y=u(g=Object(v),h))=="string"?y:m?i(g):(b=i(g))=="Object"&&typeof g.callee=="function"?"Arguments":b}},f772:function(s,a,r){var d=r("5692"),i=r("90e3"),c=d("keys");s.exports=function(h){return c[h]||(c[h]=i(h))}},fb15:function(s,a,r){if(r.r(a),typeof window<"u"){var d=window.document.currentScript;{var i=r("8875");d=i(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:i})}var c=d&&d.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);c&&(r.p=c[1])}r("99af"),r("4de4"),r("4160"),r("c975"),r("d81d"),r("a434"),r("159b"),r("a4d3"),r("e439"),r("dbb4"),r("b64b");function h(E,_,P){return _ in E?Object.defineProperty(E,_,{value:P,enumerable:!0,configurable:!0,writable:!0}):E[_]=P,E}function m(E,_){var P=Object.keys(E);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(E);_&&(A=A.filter(function(K){return Object.getOwnPropertyDescriptor(E,K).enumerable})),P.push.apply(P,A)}return P}function u(E){for(var _=1;_<arguments.length;_++){var P=arguments[_]!=null?arguments[_]:{};_%2?m(Object(P),!0).forEach(function(A){h(E,A,P[A])}):Object.getOwnPropertyDescriptors?Object.defineProperties(E,Object.getOwnPropertyDescriptors(P)):m(Object(P)).forEach(function(A){Object.defineProperty(E,A,Object.getOwnPropertyDescriptor(P,A))})}return E}function v(E){if(Array.isArray(E))return E}r("e01a"),r("d28b"),r("e260"),r("d3b7"),r("3ca3"),r("ddb0");function g(E,_){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(E)))){var P=[],A=!0,K=!1,ee=void 0;try{for(var ce=E[Symbol.iterator](),be;!(A=(be=ce.next()).done)&&(P.push(be.value),!(_&&P.length===_));A=!0);}catch(ke){K=!0,ee=ke}finally{try{!A&&ce.return!=null&&ce.return()}finally{if(K)throw ee}}return P}}r("a630"),r("fb6a"),r("b0c0"),r("25f0");function y(E,_){(_==null||_>E.length)&&(_=E.length);for(var P=0,A=new Array(_);P<_;P++)A[P]=E[P];return A}function b(E,_){if(E){if(typeof E=="string")return y(E,_);var P=Object.prototype.toString.call(E).slice(8,-1);if(P==="Object"&&E.constructor&&(P=E.constructor.name),P==="Map"||P==="Set")return Array.from(E);if(P==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(P))return y(E,_)}}function x(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function w(E,_){return v(E)||g(E,_)||b(E,_)||x()}function k(E){if(Array.isArray(E))return y(E)}function C(E){if(typeof Symbol<"u"&&Symbol.iterator in Object(E))return Array.from(E)}function O(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function R(E){return k(E)||C(E)||b(E)||O()}var V=r("a352"),B=r.n(V);function I(E){E.parentElement!==null&&E.parentElement.removeChild(E)}function L(E,_,P){var A=P===0?E.children[0]:E.children[P-1].nextSibling;E.insertBefore(_,A)}var H=r("dbf1");r("13d5"),r("4fad"),r("ac1f"),r("5319");function re(E){var _=Object.create(null);return function(A){var K=_[A];return K||(_[A]=E(A))}}var F=/-(\w)/g,U=re(function(E){return E.replace(F,function(_,P){return P.toUpperCase()})});r("5db7"),r("73d9");var oe=["Start","Add","Remove","Update","End"],j=["Choose","Unchoose","Sort","Filter","Clone"],Y=["Move"],ye=[Y,oe,j].flatMap(function(E){return E}).map(function(E){return"on".concat(E)}),Se={manage:Y,manageAndEmit:oe,emit:j};function Ne(E){return ye.indexOf(E)!==-1}r("caad"),r("2ca0");var Pe=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"];function Te(E){return Pe.includes(E)}function Me(E){return["transition-group","TransitionGroup"].includes(E)}function Fe(E){return["id","class","role","style"].includes(E)||E.startsWith("data-")||E.startsWith("aria-")||E.startsWith("on")}function $e(E){return E.reduce(function(_,P){var A=w(P,2),K=A[0],ee=A[1];return _[K]=ee,_},{})}function De(E){var _=E.$attrs,P=E.componentData,A=P===void 0?{}:P,K=$e(Object.entries(_).filter(function(ee){var ce=w(ee,2),be=ce[0];return ce[1],Fe(be)}));return u(u({},K),A)}function Ee(E){var _=E.$attrs,P=E.callBackBuilder,A=$e(Je(_));Object.entries(P).forEach(function(ee){var ce=w(ee,2),be=ce[0],ke=ce[1];Se[be].forEach(function(se){A["on".concat(se)]=ke(se)})});var K="[data-draggable]".concat(A.draggable||"");return u(u({},A),{},{draggable:K})}function Je(E){return Object.entries(E).filter(function(_){var P=w(_,2),A=P[0];return P[1],!Fe(A)}).map(function(_){var P=w(_,2),A=P[0],K=P[1];return[U(A),K]}).filter(function(_){var P=w(_,2),A=P[0];return P[1],!Ne(A)})}r("c740");function Be(E,_){if(!(E instanceof _))throw new TypeError("Cannot call a class as a function")}function vt(E,_){for(var P=0;P<_.length;P++){var A=_[P];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(E,A.key,A)}}function Pt(E,_,P){return _&&vt(E.prototype,_),P&&vt(E,P),E}var bt=function(_){var P=_.el;return P},Le=function(_,P){return _.__draggable_context=P},Ue=function(_){return _.__draggable_context},Tt=function(){function E(_){var P=_.nodes,A=P.header,K=P.default,ee=P.footer,ce=_.root,be=_.realList;Be(this,E),this.defaultNodes=K,this.children=[].concat(R(A),R(K),R(ee)),this.externalComponent=ce.externalComponent,this.rootTransition=ce.transition,this.tag=ce.tag,this.realList=be}return Pt(E,[{key:"render",value:function(P,A){var K=this.tag,ee=this.children,ce=this._isRootComponent,be=ce?{default:function(){return ee}}:ee;return P(K,A,be)}},{key:"updated",value:function(){var P=this.defaultNodes,A=this.realList;P.forEach(function(K,ee){Le(bt(K),{element:A[ee],index:ee})})}},{key:"getUnderlyingVm",value:function(P){return Ue(P)}},{key:"getVmIndexFromDomIndex",value:function(P,A){var K=this.defaultNodes,ee=K.length,ce=A.children,be=ce.item(P);if(be===null)return ee;var ke=Ue(be);if(ke)return ke.index;if(ee===0)return 0;var se=bt(K[0]),W=R(ce).findIndex(function(J){return J===se});return P<W?0:ee}},{key:"_isRootComponent",get:function(){return this.externalComponent||this.rootTransition}}]),E}(),ut=r("8bbf");function mt(E,_){var P=E[_];return P?P():[]}function ps(E){var _=E.$slots,P=E.realList,A=E.getKey,K=P||[],ee=["header","footer"].map(function(J){return mt(_,J)}),ce=w(ee,2),be=ce[0],ke=ce[1],se=_.item;if(!se)throw new Error("draggable element must have an item slot");var W=K.flatMap(function(J,fe){return se({element:J,index:fe}).map(function(pe){return pe.key=A(J),pe.props=u(u({},pe.props||{}),{},{"data-draggable":!0}),pe})});if(W.length!==K.length)throw new Error("Item slot must have only one child");return{header:be,footer:ke,default:W}}function Ls(E){var _=Me(E),P=!Te(E)&&!_;return{transition:_,externalComponent:P,tag:P?Object(ut.resolveComponent)(E):_?ut.TransitionGroup:E}}function at(E){var _=E.$slots,P=E.tag,A=E.realList,K=E.getKey,ee=ps({$slots:_,realList:A,getKey:K}),ce=Ls(P);return new Tt({nodes:ee,root:ce,realList:A})}function Ct(E,_){var P=this;Object(ut.nextTick)(function(){return P.$emit(E.toLowerCase(),_)})}function Mt(E){var _=this;return function(P,A){if(_.realList!==null)return _["onDrag".concat(E)](P,A)}}function Kt(E){var _=this,P=Mt.call(this,E);return function(A,K){P.call(_,A,K),Ct.call(_,E,A)}}var zt=null,Wt={list:{type:Array,required:!1,default:null},modelValue:{type:Array,required:!1,default:null},itemKey:{type:[String,Function],required:!0},clone:{type:Function,default:function(_){return _}},tag:{type:String,default:"div"},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},Yt=["update:modelValue","change"].concat(R([].concat(R(Se.manageAndEmit),R(Se.emit)).map(function(E){return E.toLowerCase()}))),Xt=Object(ut.defineComponent)({name:"draggable",inheritAttrs:!1,props:Wt,emits:Yt,data:function(){return{error:!1}},render:function(){try{this.error=!1;var _=this.$slots,P=this.$attrs,A=this.tag,K=this.componentData,ee=this.realList,ce=this.getKey,be=at({$slots:_,tag:A,realList:ee,getKey:ce});this.componentStructure=be;var ke=De({$attrs:P,componentData:K});return be.render(ut.h,ke)}catch(se){return this.error=!0,Object(ut.h)("pre",{style:{color:"red"}},se.stack)}},created:function(){this.list!==null&&this.modelValue!==null&&H.a.error("modelValue and list props are mutually exclusive! Please set one or another.")},mounted:function(){var _=this;if(!this.error){var P=this.$attrs,A=this.$el,K=this.componentStructure;K.updated();var ee=Ee({$attrs:P,callBackBuilder:{manageAndEmit:function(ke){return Kt.call(_,ke)},emit:function(ke){return Ct.bind(_,ke)},manage:function(ke){return Mt.call(_,ke)}}}),ce=A.nodeType===1?A:A.parentElement;this._sortable=new B.a(ce,ee),this.targetDomElement=ce,ce.__draggable_component__=this}},updated:function(){this.componentStructure.updated()},beforeUnmount:function(){this._sortable!==void 0&&this._sortable.destroy()},computed:{realList:function(){var _=this.list;return _||this.modelValue},getKey:function(){var _=this.itemKey;return typeof _=="function"?_:function(P){return P[_]}}},watch:{$attrs:{handler:function(_){var P=this._sortable;P&&Je(_).forEach(function(A){var K=w(A,2),ee=K[0],ce=K[1];P.option(ee,ce)})},deep:!0}},methods:{getUnderlyingVm:function(_){return this.componentStructure.getUnderlyingVm(_)||null},getUnderlyingPotencialDraggableComponent:function(_){return _.__draggable_component__},emitChanges:function(_){var P=this;Object(ut.nextTick)(function(){return P.$emit("change",_)})},alterList:function(_){if(this.list){_(this.list);return}var P=R(this.modelValue);_(P),this.$emit("update:modelValue",P)},spliceList:function(){var _=arguments,P=function(K){return K.splice.apply(K,R(_))};this.alterList(P)},updatePosition:function(_,P){var A=function(ee){return ee.splice(P,0,ee.splice(_,1)[0])};this.alterList(A)},getRelatedContextFromMoveEvent:function(_){var P=_.to,A=_.related,K=this.getUnderlyingPotencialDraggableComponent(P);if(!K)return{component:K};var ee=K.realList,ce={list:ee,component:K};if(P!==A&&ee){var be=K.getUnderlyingVm(A)||{};return u(u({},be),ce)}return ce},getVmIndexFromDomIndex:function(_){return this.componentStructure.getVmIndexFromDomIndex(_,this.targetDomElement)},onDragStart:function(_){this.context=this.getUnderlyingVm(_.item),_.item._underlying_vm_=this.clone(this.context.element),zt=_.item},onDragAdd:function(_){var P=_.item._underlying_vm_;if(P!==void 0){I(_.item);var A=this.getVmIndexFromDomIndex(_.newIndex);this.spliceList(A,0,P);var K={element:P,newIndex:A};this.emitChanges({added:K})}},onDragRemove:function(_){if(L(this.$el,_.item,_.oldIndex),_.pullMode==="clone"){I(_.clone);return}var P=this.context,A=P.index,K=P.element;this.spliceList(A,1);var ee={element:K,oldIndex:A};this.emitChanges({removed:ee})},onDragUpdate:function(_){I(_.item),L(_.from,_.item,_.oldIndex);var P=this.context.index,A=this.getVmIndexFromDomIndex(_.newIndex);this.updatePosition(P,A);var K={element:this.context.element,oldIndex:P,newIndex:A};this.emitChanges({moved:K})},computeFutureIndex:function(_,P){if(!_.element)return 0;var A=R(P.to.children).filter(function(be){return be.style.display!=="none"}),K=A.indexOf(P.related),ee=_.component.getVmIndexFromDomIndex(K),ce=A.indexOf(zt)!==-1;return ce||!P.willInsertAfter?ee:ee+1},onDragMove:function(_,P){var A=this.move,K=this.realList;if(!A||!K)return!0;var ee=this.getRelatedContextFromMoveEvent(_),ce=this.computeFutureIndex(ee,_),be=u(u({},this.context),{},{futureIndex:ce}),ke=u(u({},_),{},{relatedContext:ee,draggedContext:be});return A(ke,P)},onDragEnd:function(){zt=null}}}),Jt=Xt;a.default=Jt},fb6a:function(s,a,r){var d=r("23e7"),i=r("861d"),c=r("e8b5"),h=r("23cb"),m=r("50c4"),u=r("fc6a"),v=r("8418"),g=r("b622"),y=r("1dde"),b=r("ae40"),x=y("slice"),w=b("slice",{ACCESSORS:!0,0:0,1:2}),k=g("species"),C=[].slice,O=Math.max;d({target:"Array",proto:!0,forced:!x||!w},{slice:function(V,B){var I=u(this),L=m(I.length),H=h(V,L),re=h(B===void 0?L:B,L),F,U,oe;if(c(I)&&(F=I.constructor,typeof F=="function"&&(F===Array||c(F.prototype))?F=void 0:i(F)&&(F=F[k],F===null&&(F=void 0)),F===Array||F===void 0))return C.call(I,H,re);for(U=new(F===void 0?Array:F)(O(re-H,0)),oe=0;H<re;H++,oe++)H in I&&v(U,oe,I[H]);return U.length=oe,U}})},fc6a:function(s,a,r){var d=r("44ad"),i=r("1d80");s.exports=function(c){return d(i(c))}},fdbc:function(s,a){s.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},fdbf:function(s,a,r){var d=r("4930");s.exports=d&&!Symbol.sham&&typeof Symbol.iterator=="symbol"}}).default})})(Lo);var Gc=Lo.exports;const Fs=pa(Gc);const Bc={components:{draggable:Fs,ModalComponent:Xe,Pencil:$t,Copy:ms,Trash2:Gt,Link:lo,Lock:Sl,Edit3:io},props:["categories","payTypes","seriesId"],emits:["save","show","close"],data(){return{formError:[],formInputData:{},formCats:[],editCatId:null,show:!1,editFormData:{},seriesCategories:[],seriesPaymentGroups:[],loadingSeriesData:!1}},async mounted(){this.formCats=this.categories.map(t=>Object.assign({},t,{isExisting:!0})),this.seriesId&&await this.fetchSeriesData()},watch:{categories:{handler(t){this.resetFormData()},deep:!0},async seriesId(t){t?await this.fetchSeriesData():(this.seriesCategories=[],this.seriesPaymentGroups=[])}},computed:{payTypeOptions(){const t={};for(const[e,n]of Object.entries(this.payTypes))e!=="season"&&e!=="cash"&&(t[e]=n);return{null:"Not required",...t}},categoriesBySource(){const t=new Set(this.seriesCategories.map(e=>e.id));return{series:this.formCats.filter(e=>t.has(e.id)&&!e.isRaceOverride),raceOverrides:this.formCats.filter(e=>e.isRaceOverride),raceSpecific:this.formCats.filter(e=>!t.has(e.id)&&!e.isRaceOverride)}}},methods:{async fetchSeriesData(){if(this.seriesId){this.loadingSeriesData=!0;try{const t=await Z(`/api/series/${this.seriesId}`);if(t.data){this.seriesCategories=t.data.regCategories||[],this.seriesPaymentGroups=t.data.categoryGroups||[];const e=new Set(this.seriesCategories.map(n=>n.id));this.formCats=this.formCats.map(n=>({...n,isFromSeries:e.has(n.id)&&!n._isRaceOverride,isRaceOverride:n._isRaceOverride===!0}))}}catch(t){console.error("Error fetching series data:",t)}finally{this.loadingSeriesData=!1}}},resetFormData(){this.formCats=this.categories.map(t=>{const e=this.seriesCategories.some(n=>n.id===t.id)&&!t._isRaceOverride;return Object.assign({},t,{isExisting:!0,isFromSeries:e,isRaceOverride:t._isRaceOverride===!0})}),this.editCatId=null},getCategoryPaymentInfo(t){var e;if(t.paytype)return{type:"forced",label:this.payTypeOptions[t.paytype]||t.paytype};if(t.isFromSeries&&this.seriesPaymentGroups.length>0){for(const n of this.seriesPaymentGroups)if(n.categories&&n.categories.includes(t.id)){const l=((e=n.paymentOptions)==null?void 0:e.map(s=>s.name).join(", "))||"No payments";return{type:"series-group",label:n.name,payments:l}}}return{type:"any",label:"Any payment type"}},async submitHandler(){let t=this.formCats.filter(e=>!e.isFromSeries).map((e,n)=>{let l=Object.assign({},e);return l.paytype=="null"&&delete l.paytype,l.disporder=n+1,delete l.isExisting,delete l.isFromSeries,delete l.isRaceOverride,l});console.log("Saving categories to database:",t),await Z.patch(`/api/races/${this.$route.params.raceid}`,{regCategories:t}).then(e=>{e.data&&this.$emit("save",t)}).catch(e=>{this.formError=["Error submitting request"],console.log(e)})},submitForm(t){t.stopPropagation(),this.$formkit.submit("editingCategoryForm")},saveCategory(t){let e=this.formCats[this.editCatId];!e.isExisting&&e.catdispname!==t.catdispname?e.id=this.formatNameToId(t.catdispname):e.id||(e.id=this.formatNameToId(t.catdispname)),Object.assign(e,t),e.paytype===null&&delete e.paytype,e.sponsored?delete e.paytype:delete e.sponsorName,console.log("update: ",e),this.formCats.splice(this.editCatId,1,e),this.editCatId=null,this.editFormData={}},formatNameToId(t){return t.replace(/\s+/g,"_").toLowerCase().replace("+","_plus_").replace("-","_minus_").replace(/\W/g,"")},onDragStart(t){},onDragEnd(){},editCategoryData(t){this.editCatId===null&&(this.editCatId=t,this.editFormData={...this.formCats[t]})},cancelEdit(t){t.stopPropagation(),this.editCatId=null,this.editFormData={}},addRaceSpecificCategory(){const t={id:"race_category_"+Date.now(),catdispname:"New Race Category",laps:1,isExisting:!1,isFromSeries:!1};this.formCats.push(t),this.editCatId=this.formCats.length-1,this.editFormData={...t}},removeAllRaceSpecificCategories(){const t=this.categoriesBySource.raceSpecific.length,e=`Remove all ${t} race-specific ${t===1?"category":"categories"}?

This will keep only the ${this.categoriesBySource.series.length} series-inherited ${this.categoriesBySource.series.length===1?"category":"categories"}.

This action cannot be undone.`;confirm(e)&&(this.formCats=this.formCats.filter(n=>n.isFromSeries),this.emitUpdate(),alert(`Removed ${t} race-specific ${t===1?"category":"categories"}.`))},overrideAllSeriesCategories(){const t=this.categoriesBySource.series.length;if(t===0){alert("No series categories to override.");return}const e=`Override all ${t} series ${t===1?"category":"categories"}?

This will create race-specific copies that you can customize (laps, age restrictions, payment types, etc.).

The categories will no longer automatically sync with series changes.`;confirm(e)&&(this.formCats=this.formCats.map(n=>n.isFromSeries?{...n,isFromSeries:!1,isRaceOverride:!0,isExisting:!1}:n),alert(`Overridden ${t} series ${t===1?"category":"categories"}.

You can now customize them for this race.`))},copyCategory(t,e){t.stopPropagation();const n=this.formCats[e];if(n.isFromSeries){const l={...n};l.catdispname=l.catdispname+" (override)",l.isFromSeries=!1,l.isRaceOverride=!0,l.isExisting=!1,this.formCats.splice(e,1,l)}else{const l={...n};l.catdispname=l.catdispname+" (copy)",l.id=this.formatNameToId(l.catdispname),l.isExisting=!1,l.isFromSeries=!1,l.isRaceOverride=!1,this.formCats.splice(e+1,0,l)}},deleteCategory(t,e){t.stopPropagation();const n=this.formCats[e];if(n.isFromSeries){alert(`Cannot delete series categories. They are inherited from the series and will reappear on reload.

To customize a series category for this race, use the "Override" button instead.`);return}if(n.isRaceOverride){if(!confirm(`Delete this race override?

This will remove the race-specific customization for "${n.catdispname}".
The original series category will be restored immediately.`))return;const l=this.seriesCategories.find(s=>s.id===n.id);if(l){const s={...l,disporder:n.disporder,isFromSeries:!0,isRaceOverride:!1,isExisting:!0};this.formCats.splice(e,1,s);return}}this.formCats.splice(e,1)},cancelModal(){this.resetFormData(),this.$emit("close")},checkMove:function(t){return this.editCatId===null}}},Kc=o("h5",null," Edit Race Categories ",-1),zc={class:"edit-categories-form"},Wc={key:0,class:"series-info-banner mb-3"},Yc={class:"series-info-text flex-grow-1"},Xc=o("strong",null,"Series Integration:",-1),Jc={key:0},Qc={key:1},Zc={class:"d-flex gap-2"},qc=["disabled","title"],ed=["disabled","title"],td=["onClick"],sd={key:0,class:"alert alert-info d-flex align-items-start gap-2 py-2 px-3 mb-3"},od=o("div",{class:"d-flex align-items-center gap-1"},[o("strong",null,"Series Category")],-1),rd={class:"d-block mt-1"},nd=o("strong",null,"Locked:",-1),ad=o("br",null,null,-1),id=o("strong",null,"Editable:",-1),ld={key:1,class:"alert alert-warning d-flex align-items-start gap-2 py-2 px-3 mb-3"},cd=o("div",null,[o("div",{class:"d-flex align-items-center gap-1"},[o("strong",null,"Race Override")]),o("small",{class:"d-block mt-1"}," This category overrides the series category with the same ID. All fields are editable for this race only. ")],-1),dd={class:"double"},ud={class:"formkit-outer",style:{width:"calc(50% - 0.5em)"}},md={class:"form-label small fw-bold d-flex align-items-center"},hd={key:0,class:"text-muted ms-2 d-flex align-items-center"},fd=["disabled"],pd={key:0,class:"text-muted"},vd={key:1,class:"text-muted"},gd={key:2,class:"text-muted"},yd={class:"formkit-outer",style:{width:"calc(50% - 0.5em)"}},bd={class:"form-label small fw-bold d-flex align-items-center"},Cd={key:0,class:"text-success ms-2 d-flex align-items-center"},Sd={key:0,class:"text-muted"},Dd={key:1,class:"text-muted"},xd={class:"double"},_d={class:"formkit-outer",style:{width:"calc(50% - 0.5em)"}},Ed={class:"form-label small fw-bold d-flex align-items-center"},wd={key:0,class:"text-success ms-2 d-flex align-items-center"},Pd={class:"text-muted"},Td={class:"formkit-outer",style:{width:"calc(50% - 0.5em)"}},Rd={class:"form-label small fw-bold d-flex align-items-center"},Od={key:0,class:"text-success ms-2 d-flex align-items-center"},Id={class:"text-muted"},kd={class:"double"},$d={key:1,class:"formkit-outer",style:{width:"calc(50% - 0.5em)"}},Ad={class:"form-label small fw-bold d-flex align-items-center"},Md={class:"text-muted ms-2 d-flex align-items-center"},Fd=["value"],Nd=o("small",{class:"text-muted"}," Payment options defined in series category groups ",-1),Ld={class:"cat-name"},Ud={class:"cat-badges"},jd={key:0,class:"sponsored-badge"},Vd=["title"],Hd={key:2,class:"paytype-badge"},Gd={class:"cat-actions"},Bd={class:"cat-position"},Kd={class:"modal-footer-buttons mt-3"},zd=o("div",null,null,-1);function Wd(t,e,n,l,s,a){const r=$("Link"),d=$("Lock"),i=$("Edit3"),c=$("FormKit"),h=$("Copy"),m=$("Trash2"),u=$("draggable"),v=$("modal-component");return f(),q(v,{show:s.show,onClose:a.cancelModal},{header:G(()=>[Kc,M(" Click to Edit, Drag to reorder categories ")]),body:G(()=>[o("div",zc,[n.seriesId&&s.seriesCategories.length>0?(f(),p("div",Wc,[D(r,{size:20,class:"series-icon"}),o("div",Yc,[Xc,M(" "+S(a.categoriesBySource.series.length)+" "+S(a.categoriesBySource.series.length===1?"category is":"categories are")+" inherited from the series. ",1),a.categoriesBySource.raceOverrides.length>0?(f(),p("span",Jc,S(a.categoriesBySource.raceOverrides.length)+" race "+S(a.categoriesBySource.raceOverrides.length===1?"override":"overrides")+". ",1)):T("",!0),a.categoriesBySource.raceSpecific.length>0?(f(),p("span",Qc,S(a.categoriesBySource.raceSpecific.length)+" race-specific "+S(a.categoriesBySource.raceSpecific.length===1?"category":"categories")+". ",1)):T("",!0)]),o("div",Zc,[o("button",{class:"btn btn-sm btn-outline-primary",onClick:e[0]||(e[0]=(...g)=>a.addRaceSpecificCategory&&a.addRaceSpecificCategory(...g)),type:"button"}," + Add Race Category "),o("button",{class:"btn btn-sm btn-outline-warning",onClick:e[1]||(e[1]=(...g)=>a.overrideAllSeriesCategories&&a.overrideAllSeriesCategories(...g)),type:"button",disabled:a.categoriesBySource.series.length===0,title:a.categoriesBySource.series.length===0?"No series categories to override":"Override all series categories for race-specific customization"}," Override All Series Categories ",8,qc),o("button",{class:"btn btn-sm btn-outline-danger",onClick:e[2]||(e[2]=(...g)=>a.removeAllRaceSpecificCategories&&a.removeAllRaceSpecificCategories(...g)),type:"button",disabled:a.categoriesBySource.raceSpecific.length===0,title:a.categoriesBySource.raceSpecific.length===0?"No race-specific categories to remove":"Remove Non-Series categories"}," Remove Non-Series Categories ",8,ed)])])):T("",!0),D(u,{modelValue:s.formCats,"onUpdate:modelValue":e[10]||(e[10]=g=>s.formCats=g),onEnd:a.onDragEnd,onStart:a.onDragStart,"item-key":"id",move:a.checkMove},{item:G(({element:g,index:y})=>[o("div",{class:"cat-group",onClick:b=>a.editCategoryData(y)},[s.editCatId===y?(f(),q(c,{key:0,type:"form",id:"editingCategoryForm",label:"Category Name",validation:"required",onSubmit:a.saveCategory,actions:!1,modelValue:s.editFormData,"onUpdate:modelValue":e[9]||(e[9]=b=>s.editFormData=b)},{default:G(()=>[s.editFormData.isFromSeries?(f(),p("div",sd,[D(r,{size:18,class:"mt-1 flex-shrink-0"}),o("div",null,[od,o("small",rd,[D(d,{size:14,class:"me-1",style:{display:"inline-block","vertical-align":"middle"}}),nd,M(" Category name & payment type (edit in series)"),ad,D(i,{size:14,class:"me-1",style:{display:"inline-block","vertical-align":"middle"}}),id,M(" Laps, start time, and age restrictions (race-specific overrides) ")])])])):s.editFormData.isRaceOverride?(f(),p("div",ld,[D(i,{size:18,class:"mt-1 flex-shrink-0"}),cd])):T("",!0),o("div",dd,[o("div",ud,[o("label",md,[M(" Category Name "),s.editFormData.isFromSeries?(f(),p("span",hd,[D(d,{size:14,class:"me-1"}),M(" Locked ")])):T("",!0)]),ae(o("input",{type:"text",class:le(["form-control form-control-sm",{"bg-light":s.editFormData.isFromSeries}]),"onUpdate:modelValue":e[3]||(e[3]=b=>s.editFormData.catdispname=b),disabled:s.editFormData.isFromSeries,required:""},null,10,fd),[[ve,s.editFormData.catdispname]]),s.editFormData.isFromSeries?(f(),p("small",pd," Edit in series settings ")):s.editFormData.isRaceOverride?(f(),p("small",vd," Race-specific override ")):(f(),p("small",gd," Display name for this category "))]),o("div",yd,[o("label",bd,[M(" Laps "),s.editFormData.isFromSeries?(f(),p("span",Cd,[D(i,{size:14,class:"me-1"}),M(" Race Override ")])):T("",!0)]),ae(o("input",{type:"number",class:"form-control form-control-sm","onUpdate:modelValue":e[4]||(e[4]=b=>s.editFormData.laps=b),min:"0"},null,512),[[ve,s.editFormData.laps,void 0,{number:!0}]]),s.editFormData.isFromSeries?(f(),p("small",Sd," Customize for this race ")):(f(),p("small",Dd," Number of laps "))])]),o("div",xd,[o("div",_d,[o("label",Ed,[M(" Minimum Age "),s.editFormData.isFromSeries?(f(),p("span",wd,[D(i,{size:14,class:"me-1"}),M(" Race Override ")])):T("",!0)]),ae(o("input",{type:"number",class:"form-control form-control-sm","onUpdate:modelValue":e[5]||(e[5]=b=>s.editFormData.minAge=b),min:"0",placeholder:"No minimum"},null,512),[[ve,s.editFormData.minAge,void 0,{number:!0}]]),o("small",Pd,S(s.editFormData.isFromSeries?"Override series age restriction":"Enforces age restrictions"),1)]),o("div",Td,[o("label",Rd,[M(" Maximum Age "),s.editFormData.isFromSeries?(f(),p("span",Od,[D(i,{size:14,class:"me-1"}),M(" Race Override ")])):T("",!0)]),ae(o("input",{type:"number",class:"form-control form-control-sm","onUpdate:modelValue":e[6]||(e[6]=b=>s.editFormData.maxAge=b),min:"0",placeholder:"No maximum"},null,512),[[ve,s.editFormData.maxAge,void 0,{number:!0}]]),o("small",Id,S(s.editFormData.isFromSeries?"Override series age restriction":"Category hidden if outside range"),1)])]),o("div",kd,[D(c,{type:"checkbox",name:"sponsored",label:"Sponsored",disabled:s.editFormData.isFromSeries,help:s.editFormData.isFromSeries?"Managed at series level":"If checked, no entry fee will be charged"},null,8,["disabled","help"]),!s.editFormData.sponsored&&(!s.editFormData.isFromSeries||s.editFormData.isRaceOverride)?(f(),q(c,{key:0,type:"select",name:"paytype",label:"Category Payment Type",help:s.editFormData.isRaceOverride?"Race-specific payment type override":"Force payment type when this category is selected",options:a.payTypeOptions},null,8,["help","options"])):s.editFormData.isFromSeries&&!s.editFormData.sponsored&&!s.editFormData.isRaceOverride?(f(),p("div",$d,[o("label",Ad,[M(" Payment Type "),o("span",Md,[D(d,{size:14,class:"me-1"}),M(" From Series ")])]),o("input",{type:"text",class:"form-control form-control-sm bg-light",value:a.getCategoryPaymentInfo(s.editFormData).label,disabled:""},null,8,Fd),Nd])):s.editFormData.sponsored?(f(),q(c,{key:2,type:"text",name:"sponsorName",label:"Sponsor Name",validation:"required"})):T("",!0)]),o("button",{class:"btn btn-primary my-3 mx-2",type:"button",onClick:e[7]||(e[7]=(...b)=>a.submitForm&&a.submitForm(...b))},"Save"),o("button",{class:"btn btn-danger my-3 mx-2",type:"button",onClick:e[8]||(e[8]=(...b)=>a.cancelEdit&&a.cancelEdit(...b))},"Cancel")]),_:1},8,["onSubmit","modelValue"])):(f(),p("div",{key:1,class:le(["cat-row",{"from-series":g.isFromSeries,"race-override":g.isRaceOverride}])},[o("div",Ld,[g.isFromSeries?(f(),q(r,{key:0,size:16,class:"series-icon me-1",title:"Inherited from series"})):g.isRaceOverride?(f(),q(i,{key:1,size:16,class:"override-icon me-1",title:"Race override of series category"})):T("",!0),M(" "+S(g.catdispname),1)]),o("div",Ud,[g.sponsored?(f(),p("strong",jd,"Sponsored")):g.isFromSeries&&a.getCategoryPaymentInfo(g).type==="series-group"?(f(),p("span",{key:1,class:"series-group-badge",title:a.getCategoryPaymentInfo(g).payments},S(a.getCategoryPaymentInfo(g).label),9,Vd)):g.paytype&&!g.sponsored?(f(),p("span",Hd,S(a.payTypeOptions[g.paytype]),1)):T("",!0)]),o("div",Gd,[o("label",Bd,S(y+1)+" of "+S(s.formCats.length),1),g.isFromSeries?(f(),q(i,{key:1,class:"action-icon override-icon",color:"#1565c0",onClick:b=>a.copyCategory(b,y),title:"Override series category - customize for this race"},null,8,["onClick"])):(f(),q(h,{key:0,class:"action-icon",color:"black",onClick:b=>a.copyCategory(b,y),title:"Duplicate this category"},null,8,["onClick"])),D(m,{class:le(["action-icon",{"disabled-icon":g.isFromSeries}]),color:g.isFromSeries?"#ccc":"black",onClick:b=>a.deleteCategory(b,y),title:g.isFromSeries?"Cannot delete series categories":"Delete this category"},null,8,["class","color","onClick","title"])])],2))],8,td)]),_:1},8,["modelValue","onEnd","onStart","move"])]),o("div",Kd,[o("button",{class:"btn btn-sm btn-primary px-5 mx-3",onClick:e[11]||(e[11]=(...g)=>a.submitHandler&&a.submitHandler(...g))},"Save"),o("button",{class:"btn btn-sm btn-danger px-3 mx-3",onClick:e[12]||(e[12]=(...g)=>a.cancelModal&&a.cancelModal(...g))},"Cancel")])]),footer:G(()=>[zd]),_:1},8,["show","onClose"])}const Yd=ge(Bc,[["render",Wd]]);const Xd={components:{draggable:Fs,ModalComponent:Xe,Pencil:$t,FilePlus:No,Trash2:Gt},props:["coupons","show"],emits:["save","close"],data(){return{formError:[],formCoupons:[]}},mounted(){this.loadCoupons()},watch:{coupons:{handler(){this.loadCoupons()},immediate:!0}},methods:{loadCoupons(){if(console.log("Loading coupons:",this.coupons),this.formCoupons=[],!this.coupons||typeof this.coupons!="object"){console.log("No coupons to load");return}Object.keys(this.coupons).forEach(t=>{let e=this.coupons[t],n=0;e.fractionDiscount!==void 0&&e.fractionDiscount!==null?n=e.fractionDiscount*100:e.percentDiscount!==void 0&&e.percentDiscount!==null&&(n=e.percentDiscount),this.formCoupons.push({code:t,percentDiscount:n,singleUse:e.singleUse||!1})}),console.log("Loaded formCoupons:",this.formCoupons)},async submitHandler(){let t={};this.formCoupons.forEach(e=>{if(!t[e.code]){let n=parseFloat(e.percentDiscount)||0;t[e.code]={fractionDiscount:n/100,singleUse:e.singleUse||!1}}}),console.log("Saving coupons:",t),await Z.patch(`/api/races/${this.$route.params.raceid}`,{couponCodes:t}).then(e=>{e.data&&(this.$emit("save",t),console.log(e.data))}).catch(e=>{this.formError=["Error submitting request"],console.log(e)})},createCoupon(){this.formCoupons.push({code:"NEWCODE",percentDiscount:10,singleUse:!1})},deleteCoupon(t){this.formCoupons.splice(t,1)}}},Ns=t=>(nt("data-v-2eb1f802"),t=t(),rt(),t),Jd={class:"d-flex justify-content-between align-items-center w-100"},Qd=Ns(()=>o("h5",{class:"mb-0"},"Edit Discount Coupons",-1)),Zd={class:"edit-coupons-form"},qd={key:0,class:"text-center text-muted py-4"},eu={class:"coupon-fields"},tu={class:"field-group"},su=Ns(()=>o("label",{class:"field-label"},"Code",-1)),ou=["onUpdate:modelValue"],ru={class:"field-group"},nu=Ns(()=>o("label",{class:"field-label"},"Discount %",-1)),au=["onUpdate:modelValue"],iu={class:"field-group checkbox-group"},lu={class:"form-check-label"},cu=["onUpdate:modelValue"],du={class:"field-group"},uu=["onClick"],mu={class:"modal-footer-buttons mt-3"},hu=Ns(()=>o("div",null,null,-1));function fu(t,e,n,l,s,a){const r=$("FilePlus"),d=$("Trash2"),i=$("modal-component");return f(),q(i,{show:n.show,onClose:e[3]||(e[3]=c=>t.$emit("close"))},{header:G(()=>[o("div",Jd,[Qd,o("button",{class:"btn btn-sm btn-success",onClick:e[0]||(e[0]=(...c)=>a.createCoupon&&a.createCoupon(...c))},[D(r,{size:16,class:"me-1"}),M(" Add Coupon ")])])]),body:G(()=>[o("div",Zd,[s.formCoupons.length===0?(f(),p("div",qd,' No coupons yet. Click "Add Coupon" to create one. ')):T("",!0),(f(!0),p(te,null,de(s.formCoupons,(c,h)=>(f(),p("div",{key:h,class:"coupon-row"},[o("div",eu,[o("div",tu,[su,ae(o("input",{type:"text","onUpdate:modelValue":m=>c.code=m,class:"form-control form-control-sm",placeholder:"COUPON10"},null,8,ou),[[ve,c.code]])]),o("div",ru,[nu,ae(o("input",{type:"number","onUpdate:modelValue":m=>c.percentDiscount=m,class:"form-control form-control-sm",min:"0",max:"100",step:"0.01"},null,8,au),[[ve,c.percentDiscount,void 0,{number:!0}]])]),o("div",iu,[o("label",lu,[ae(o("input",{type:"checkbox","onUpdate:modelValue":m=>c.singleUse=m,class:"form-check-input"},null,8,cu),[[ds,c.singleUse]]),M(" Single Use ")])]),o("div",du,[o("button",{class:"btn btn-sm btn-danger",onClick:m=>a.deleteCoupon(h),title:"Delete coupon"},[D(d,{size:16})],8,uu)])])]))),128))]),o("div",mu,[o("button",{class:"btn btn-sm btn-primary px-5 mx-3",onClick:e[1]||(e[1]=(...c)=>a.submitHandler&&a.submitHandler(...c))},"Save All"),o("button",{class:"btn btn-sm btn-secondary px-3 mx-3",onClick:e[2]||(e[2]=c=>t.$emit("close"))},"Cancel")])]),footer:G(()=>[hu]),_:1},8,["show"])}const pu=ge(Xd,[["render",fu],["__scopeId","data-v-2eb1f802"]]);const vu={components:{ModalComponent:Xe,Pencil:$t,Copy:ms,Trash2:Gt},props:["paymentOptions"],emits:["save","show","close"],data(){return{formError:[],formInputData:{},formPayTypes:[],show:!1}},mounted(){this.formPayTypes=this.paymentOptions.map(t=>Object.assign({},t))},computed:{paymentTypeOptions(){return{season:"Pays for all races in the series",single:"Pays for only the current race",custom:"create a custom paytype category, single race only"}}},methods:{async submitHandler(){const t=this.formPayTypes.map(e=>({name:e.name,type:e.type,amount:e.amount}));console.log("Submitting payment options:",t),await Z.patch(`/api/races/${this.$route.params.raceid}`,{paymentOptions:t}).then(e=>{e.data&&(this.$emit("save",t),this.$emit("close"))}).catch(e=>{this.formError=["Error submitting request"],console.log(e)})},addPaytype(){this.formPayTypes.push({name:"",type:"",amount:""})},addSpecialPaytype(t){if(this.formPayTypes.some(l=>l.type===t)){alert(`A ${t} payment type already exists`);return}const n={type:t,amount:t==="cash"?"0":""};t==="season"?n.name="Season Pass":t==="cash"&&(n.name="Cash Payment (at event)"),this.formPayTypes.push(n)},deletePaytype(t){confirm("Are you sure you want to delete this payment type?")&&this.formPayTypes.splice(t,1)},isSpecialType(t){return t==="season"||t==="cash"}}},gu=o("h5",null," Edit Payments ",-1),yu={class:"edit-categories-form"},bu={class:"cat-group"},Cu={class:"payment-header"},Su=["onClick"],Du={class:"triple"},xu={class:"add-buttons mt-3"},_u={class:"modal-footer-buttons mt-3"},Eu=o("div",null,null,-1);function wu(t,e,n,l,s,a){const r=$("Trash2"),d=$("FormKit"),i=$("modal-component");return f(),q(i,{show:s.show,onClose:e[5]||(e[5]=c=>t.emit("close"))},{header:G(()=>[gu]),body:G(()=>[o("div",yu,[(f(!0),p(te,null,de(s.formPayTypes,(c,h)=>(f(),p("div",{key:h,class:"cat-group-container"},[o("div",bu,[o("div",Cu,[o("h6",null,"Payment Type "+S(h+1),1),o("button",{class:"btn btn-sm btn-danger",onClick:m=>a.deletePaytype(h)},[D(r,{size:16})],8,Su)]),o("div",Du,[D(d,{type:"text",modelValue:c.name,"onUpdate:modelValue":m=>c.name=m,label:"Description",validation:"required"},null,8,["modelValue","onUpdate:modelValue"]),D(d,{type:"text",modelValue:c.type,"onUpdate:modelValue":m=>c.type=m,label:"Type ID",help:a.isSpecialType(c.type)?"Special type: "+c.type:"Maps to registration category",validation:"required",disabled:a.isSpecialType(c.type)},null,8,["modelValue","onUpdate:modelValue","help","disabled"]),D(d,{type:"number",modelValue:c.amount,"onUpdate:modelValue":m=>c.amount=m,label:"Amount ($)",number:"integer",validation:"required"},null,8,["modelValue","onUpdate:modelValue"])])])]))),128)),o("div",xu,[o("button",{class:"btn btn-sm btn-success mx-2",onClick:e[0]||(e[0]=(...c)=>a.addPaytype&&a.addPaytype(...c))}," + Add Custom Payment Type "),o("button",{class:"btn btn-sm btn-info mx-2",onClick:e[1]||(e[1]=c=>a.addSpecialPaytype("season"))}," + Add Season Pass "),o("button",{class:"btn btn-sm btn-info mx-2",onClick:e[2]||(e[2]=c=>a.addSpecialPaytype("cash"))}," + Add Cash Payment ")])]),o("div",_u,[o("button",{class:"btn btn-sm btn-primary px-5 mx-3",onClick:e[3]||(e[3]=(...c)=>a.submitHandler&&a.submitHandler(...c))},"Save"),o("button",{class:"btn btn-sm btn-danger px-3 mx-3",onClick:e[4]||(e[4]=c=>t.$emit("close"))},"Cancel")])]),footer:G(()=>[Eu]),_:1},8,["show"])}const Pu=ge(vu,[["render",wu]]);const Tu={components:{ModalComponent:Xe,Trash2:Gt,FilePlus:No},props:["optionalPurchases","show"],emits:["save","close"],data(){return{formError:[],formPurchases:[],showHtmlHelp:{}}},mounted(){this.loadPurchases()},watch:{optionalPurchases:{handler(){this.loadPurchases()},immediate:!0}},methods:{loadPurchases(){if(console.log("Loading optional purchases:",this.optionalPurchases),!this.optionalPurchases||!Array.isArray(this.optionalPurchases)){this.formPurchases=[];return}this.formPurchases=this.optionalPurchases.map(t=>({id:t.id||this.generateId(),label:t.label||"",description:t.description||"",amount:t.amount||"0",optionsLabel:t.optionsLabel||"",options:t.options?[...t.options]:[]})),console.log("Loaded formPurchases:",this.formPurchases)},generateId(){return"opt_"+Math.random().toString(36).substr(2,9)},async submitHandler(){const t=this.formPurchases.map(e=>{const n={id:e.id,label:e.label,description:e.description,amount:e.amount};if(e.optionsLabel&&e.optionsLabel.trim()&&(n.optionsLabel=e.optionsLabel),e.options&&e.options.length>0){const l=e.options.filter(s=>s&&s.trim());l.length>0&&(n.options=l)}return n});console.log("Saving optional purchases:",t),await Z.patch(`/api/races/${this.$route.params.raceid}`,{optionalPurchases:t}).then(e=>{e.data&&(this.$emit("save",t),console.log(e.data))}).catch(e=>{this.formError=["Error submitting request"],console.log(e)})},addPurchase(){this.formPurchases.push({id:this.generateId(),label:"",description:"",amount:"0",optionsLabel:"",options:[]})},deletePurchase(t){confirm("Are you sure you want to delete this optional purchase?")&&this.formPurchases.splice(t,1)},addOption(t){this.formPurchases[t].options||(this.formPurchases[t].options=[]),this.formPurchases[t].options.push("")},removeOption(t,e){this.formPurchases[t].options.splice(e,1)},toggleHtmlHelp(t){this.showHtmlHelp[t]=!this.showHtmlHelp[t]},insertHtmlTemplate(t,e){const n=this.formPurchases[t].description||"",l=n.trim()?" ":"";this.formPurchases[t].description=n+l+e}}},Et=t=>(nt("data-v-43f3ae8c"),t=t(),rt(),t),Ru={class:"d-flex justify-content-between align-items-center w-100"},Ou=Et(()=>o("h5",{class:"mb-0"},"Edit Optional Purchases",-1)),Iu={class:"edit-purchases-form"},ku={key:0,class:"text-center text-muted py-4"},$u={class:"purchase-header"},Au=["onClick"],Mu={class:"purchase-fields"},Fu={class:"description-field"},Nu={class:"d-flex justify-content-between align-items-center mb-2"},Lu=Et(()=>o("label",{class:"form-label mb-0"},"Description",-1)),Uu=["onClick"],ju={key:0,class:"html-help-panel mb-2"},Vu=Et(()=>o("div",{class:"help-title"},"Quick Insert:",-1)),Hu={class:"help-buttons"},Gu=["onClick"],Bu=["onClick"],Ku=["onClick"],zu=["onClick"],Wu=Et(()=>o("div",{class:"help-examples"},[o("small",{class:"text-muted"},[o("strong",null,"Examples:"),o("br"),M(" Link: "),o("code",null,"<a href='https://example.com' target='_blank'>Click here</a>"),o("br"),M(" Bold: "),o("code",null,"<strong>text</strong>"),M(" | Italic: "),o("code",null,"<em>text</em>"),M(" | Break: "),o("code",null,"<br>")])],-1)),Yu={key:1,class:"description-preview"},Xu=Et(()=>o("div",{class:"preview-label"},"Preview:",-1)),Ju=["innerHTML"],Qu={class:"options-section"},Zu={class:"options-header"},qu=Et(()=>o("label",{class:"form-label"},"Options (Optional)",-1)),em=["onClick"],tm={key:1,class:"options-list"},sm=["onUpdate:modelValue","placeholder"],om=["onClick"],rm=Et(()=>o("small",{class:"text-muted"}," Options allow users to select variants (e.g., shirt sizes: S, M, L, XL) ",-1)),nm={class:"modal-footer-buttons mt-3"},am=Et(()=>o("div",null,null,-1));function im(t,e,n,l,s,a){const r=$("FilePlus"),d=$("Trash2"),i=$("FormKit"),c=$("modal-component");return f(),q(c,{show:n.show,onClose:e[3]||(e[3]=h=>t.$emit("close"))},{header:G(()=>[o("div",Ru,[Ou,o("button",{class:"btn btn-sm btn-success",onClick:e[0]||(e[0]=(...h)=>a.addPurchase&&a.addPurchase(...h))},[D(r,{size:16,class:"me-1"}),M(" Add Purchase ")])])]),body:G(()=>[o("div",Iu,[s.formPurchases.length===0?(f(),p("div",ku,' No optional purchases yet. Click "Add Purchase" to create one. ')):T("",!0),(f(!0),p(te,null,de(s.formPurchases,(h,m)=>(f(),p("div",{key:h.id,class:"purchase-group"},[o("div",$u,[o("h6",null,"Optional Purchase "+S(m+1),1),o("button",{class:"btn btn-sm btn-danger",onClick:u=>a.deletePurchase(m)},[D(d,{size:16})],8,Au)]),o("div",Mu,[D(i,{type:"text",modelValue:h.label,"onUpdate:modelValue":u=>h.label=u,label:"Label",help:"Short name shown to user (e.g., 'T-Shirt')",validation:"required"},null,8,["modelValue","onUpdate:modelValue"]),o("div",Fu,[o("div",Nu,[Lu,o("button",{type:"button",class:"btn btn-sm btn-outline-info",onClick:u=>a.toggleHtmlHelp(m)},S(s.showHtmlHelp[m]?"Hide":"Show")+" HTML Help ",9,Uu)]),s.showHtmlHelp[m]?(f(),p("div",ju,[Vu,o("div",Hu,[o("button",{type:"button",class:"btn btn-sm btn-outline-secondary",onClick:u=>a.insertHtmlTemplate(m,"<a href='https://example.com' target='_blank'>Link Text</a>"),title:"Insert link that opens in new tab"}," + Link ",8,Gu),o("button",{type:"button",class:"btn btn-sm btn-outline-secondary",onClick:u=>a.insertHtmlTemplate(m,"<strong>bold text</strong>"),title:"Insert bold text"}," + Bold ",8,Bu),o("button",{type:"button",class:"btn btn-sm btn-outline-secondary",onClick:u=>a.insertHtmlTemplate(m,"<em>italic text</em>"),title:"Insert italic text"}," + Italic ",8,Ku),o("button",{type:"button",class:"btn btn-sm btn-outline-secondary",onClick:u=>a.insertHtmlTemplate(m,"<br>"),title:"Insert line break"}," + Line Break ",8,zu)]),Wu])):T("",!0),D(i,{type:"textarea",modelValue:h.description,"onUpdate:modelValue":u=>h.description=u,help:"HTML description shown above the checkbox",rows:"3"},null,8,["modelValue","onUpdate:modelValue"]),h.description&&h.description.trim()?(f(),p("div",Yu,[Xu,o("div",{class:"preview-content",innerHTML:h.description},null,8,Ju)])):T("",!0)]),D(i,{type:"number",modelValue:h.amount,"onUpdate:modelValue":u=>h.amount=u,label:"Amount ($)",number:"float",step:"0.01",validation:"required"},null,8,["modelValue","onUpdate:modelValue"]),o("div",Qu,[o("div",Zu,[qu,o("button",{type:"button",class:"btn btn-sm btn-outline-primary",onClick:u=>a.addOption(m)}," + Add Option ",8,em)]),h.options&&h.options.length>0?(f(),q(i,{key:0,type:"text",modelValue:h.optionsLabel,"onUpdate:modelValue":u=>h.optionsLabel=u,label:"Options Label",help:"Label for the dropdown (e.g., 'Size', 'Color')"},null,8,["modelValue","onUpdate:modelValue"])):T("",!0),h.options&&h.options.length>0?(f(),p("div",tm,[(f(!0),p(te,null,de(h.options,(u,v)=>(f(),p("div",{key:v,class:"option-row"},[ae(o("input",{type:"text","onUpdate:modelValue":g=>h.options[v]=g,class:"form-control form-control-sm",placeholder:`Option ${v+1}`},null,8,sm),[[ve,h.options[v]]]),o("button",{type:"button",class:"btn btn-sm btn-outline-danger",onClick:g=>a.removeOption(m,v)},[D(d,{size:14})],8,om)]))),128))])):T("",!0),rm])])]))),128))]),o("div",nm,[o("button",{class:"btn btn-sm btn-primary px-5 mx-3",onClick:e[1]||(e[1]=(...h)=>a.submitHandler&&a.submitHandler(...h))},"Save All"),o("button",{class:"btn btn-sm btn-secondary px-3 mx-3",onClick:e[2]||(e[2]=h=>t.$emit("close"))},"Cancel")])]),footer:G(()=>[am]),_:1},8,["show"])}const lm=ge(Tu,[["render",im],["__scopeId","data-v-43f3ae8c"]]);const cm={components:{Eye:gl,Code:dl},props:{modelValue:{type:String,default:""},placeholder:{type:String,default:"Enter text..."},showPreview:{type:Boolean,default:!1},minHeight:{type:String,default:"300px"},label:{type:String,default:"Content"}},emits:["update:modelValue"],data(){return{content:"",showHtmlSource:!1,showPreviewPanel:!1,isTyping:!1,colors:[{name:"Black",value:"#000000"},{name:"Dark Gray",value:"#666666"},{name:"Red",value:"#e74c3c"},{name:"Orange",value:"#e67e22"},{name:"Yellow",value:"#f39c12"},{name:"Green",value:"#27ae60"},{name:"Blue",value:"#3498db"},{name:"Purple",value:"#9b59b6"},{name:"Pink",value:"#e91e63"},{name:"Teal",value:"#1abc9c"}],showColorPicker:!1,colorPickerType:null}},mounted(){this.content=this.modelValue||"",this.$refs.editor&&(this.$refs.editor.innerHTML=this.content)},watch:{modelValue(t){t!==this.content&&!this.isTyping&&(this.content=t||"",this.$refs.editor&&document.activeElement!==this.$refs.editor&&(this.$refs.editor.innerHTML=this.content))}},methods:{execCommand(t,e=null){var n;document.execCommand(t,!1,e),(n=this.$refs.editor)==null||n.focus()},insertLink(){const t=prompt("Enter URL:","https://");t&&(this.execCommand("createLink",t),setTimeout(()=>{const e=window.getSelection();if(e.anchorNode){let n=e.anchorNode.parentElement;n.tagName==="A"&&n.setAttribute("target","_blank")}},10))},insertHeading(t){this.execCommand("formatBlock",`h${t}`)},insertList(t){t==="ul"?this.execCommand("insertUnorderedList"):this.execCommand("insertOrderedList")},applyColor(t,e){e==="text"?this.execCommand("foreColor",t):this.execCommand("backColor",t),this.showColorPicker=!1,this.colorPickerType=null},toggleColorPicker(t){this.colorPickerType===t&&this.showColorPicker?(this.showColorPicker=!1,this.colorPickerType=null):(this.showColorPicker=!0,this.colorPickerType=t)},onInput(t){this.isTyping=!0,this.content=t.target.innerHTML,this.$emit("update:modelValue",this.content),setTimeout(()=>{this.isTyping=!1},100)},updateFromSource(){this.$emit("update:modelValue",this.content),this.$nextTick(()=>{this.$refs.editor&&(this.$refs.editor.innerHTML=this.content)})},toggleHtmlSource(){this.showHtmlSource=!this.showHtmlSource,this.showHtmlSource||this.$nextTick(()=>{this.$refs.editor&&(this.$refs.editor.innerHTML=this.content)})},togglePreview(){this.showPreviewPanel=!this.showPreviewPanel}}},wt=t=>(nt("data-v-b60f1e5a"),t=t(),rt(),t),dm={class:"rich-text-editor"},um={class:"editor-header"},mm={key:0,class:"form-label mb-0"},hm={class:"header-buttons"},fm={key:0,class:"editor-section"},pm={class:"toolbar"},vm={class:"toolbar-group"},gm=wt(()=>o("strong",null,"B",-1)),ym=[gm],bm=wt(()=>o("em",null,"I",-1)),Cm=[bm],Sm=wt(()=>o("u",null,"U",-1)),Dm=[Sm],xm=wt(()=>o("s",null,"S",-1)),_m=[xm],Em={class:"toolbar-group"},wm={class:"toolbar-group"},Pm={class:"color-picker-wrapper"},Tm=wt(()=>o("span",{style:{position:"relative"}},[M(" A "),o("span",{style:{position:"absolute",bottom:"-2px",left:"0",right:"0",height:"3px",background:"currentColor"}})],-1)),Rm=[Tm],Om={key:0,class:"color-picker-panel"},Im={class:"color-grid"},km=["title","onClick"],$m={class:"color-picker-wrapper"},Am=wt(()=>o("span",{style:{position:"relative",padding:"2px 4px",background:"#ffeb3b",color:"#000"}}," A ",-1)),Mm=[Am],Fm={key:0,class:"color-picker-panel"},Nm={class:"color-grid"},Lm=["title","onClick"],Um={class:"toolbar-group"},jm={class:"toolbar-group"},Vm={class:"toolbar-group"},Hm={class:"toolbar-group"},Gm=["data-placeholder"],Bm={key:1,class:"html-source-section"},Km=wt(()=>o("small",{class:"text-muted"}," Edit the raw HTML. Switch back to Visual Editor to see the formatted result. ",-1)),zm={key:2,class:"preview-section mt-3"},Wm={class:"preview-header"},Ym=wt(()=>o("strong",null,"Preview",-1)),Xm=["innerHTML"];function Jm(t,e,n,l,s,a){const r=$("Eye"),d=$("Code");return f(),p("div",dm,[o("div",um,[n.label?(f(),p("label",mm,S(n.label),1)):T("",!0),o("div",hm,[n.showPreview?(f(),p("button",{key:0,type:"button",class:le(["btn btn-sm",s.showPreviewPanel?"btn-primary":"btn-outline-primary"]),onClick:e[0]||(e[0]=(...i)=>a.togglePreview&&a.togglePreview(...i))},[D(r,{size:16,class:"me-1"}),M(" "+S(s.showPreviewPanel?"Hide":"Show")+" Preview ",1)],2)):T("",!0),o("button",{type:"button",class:le(["btn btn-sm btn-outline-secondary",{"ms-2":n.showPreview}]),onClick:e[1]||(e[1]=(...i)=>a.toggleHtmlSource&&a.toggleHtmlSource(...i))},[D(d,{size:16,class:"me-1"}),M(" "+S(s.showHtmlSource?"Visual Editor":"HTML Source"),1)],2)])]),s.showHtmlSource?(f(),p("div",Bm,[ae(o("textarea",{"onUpdate:modelValue":e[20]||(e[20]=i=>s.content=i),class:"form-control font-monospace",rows:"15",style:es({minHeight:n.minHeight}),onInput:e[21]||(e[21]=(...i)=>a.updateFromSource&&a.updateFromSource(...i))},null,36),[[ve,s.content]]),Km])):(f(),p("div",fm,[o("div",pm,[o("div",vm,[o("button",{type:"button",onClick:e[2]||(e[2]=i=>a.execCommand("bold")),class:"toolbar-btn",title:"Bold"},ym),o("button",{type:"button",onClick:e[3]||(e[3]=i=>a.execCommand("italic")),class:"toolbar-btn",title:"Italic"},Cm),o("button",{type:"button",onClick:e[4]||(e[4]=i=>a.execCommand("underline")),class:"toolbar-btn",title:"Underline"},Dm),o("button",{type:"button",onClick:e[5]||(e[5]=i=>a.execCommand("strikeThrough")),class:"toolbar-btn",title:"Strikethrough"},_m)]),o("div",Em,[o("button",{type:"button",onClick:e[6]||(e[6]=i=>a.insertHeading(1)),class:"toolbar-btn",title:"Heading 1"}," H1 "),o("button",{type:"button",onClick:e[7]||(e[7]=i=>a.insertHeading(2)),class:"toolbar-btn",title:"Heading 2"}," H2 "),o("button",{type:"button",onClick:e[8]||(e[8]=i=>a.insertHeading(3)),class:"toolbar-btn",title:"Heading 3"}," H3 "),o("button",{type:"button",onClick:e[9]||(e[9]=i=>a.execCommand("formatBlock","p")),class:"toolbar-btn",title:"Paragraph"}," P ")]),o("div",wm,[o("div",Pm,[o("button",{type:"button",onClick:e[10]||(e[10]=i=>a.toggleColorPicker("text")),class:le(["toolbar-btn",{active:s.showColorPicker&&s.colorPickerType==="text"}]),title:"Text Color"},Rm,2),s.showColorPicker&&s.colorPickerType==="text"?(f(),p("div",Om,[o("div",Im,[(f(!0),p(te,null,de(s.colors,i=>(f(),p("button",{key:i.value,type:"button",class:"color-swatch",style:es({backgroundColor:i.value}),title:i.name,onClick:c=>a.applyColor(i.value,"text")},null,12,km))),128))])])):T("",!0)]),o("div",$m,[o("button",{type:"button",onClick:e[11]||(e[11]=i=>a.toggleColorPicker("background")),class:le(["toolbar-btn",{active:s.showColorPicker&&s.colorPickerType==="background"}]),title:"Background Color"},Mm,2),s.showColorPicker&&s.colorPickerType==="background"?(f(),p("div",Fm,[o("div",Nm,[(f(!0),p(te,null,de(s.colors,i=>(f(),p("button",{key:i.value,type:"button",class:"color-swatch",style:es({backgroundColor:i.value}),title:i.name,onClick:c=>a.applyColor(i.value,"background")},null,12,Lm))),128))])])):T("",!0)])]),o("div",Um,[o("button",{type:"button",onClick:e[12]||(e[12]=i=>a.insertList("ul")),class:"toolbar-btn",title:"Bullet List"},"  List "),o("button",{type:"button",onClick:e[13]||(e[13]=i=>a.insertList("ol")),class:"toolbar-btn",title:"Numbered List"}," 1. List ")]),o("div",jm,[o("button",{type:"button",onClick:e[14]||(e[14]=i=>a.execCommand("justifyLeft")),class:"toolbar-btn",title:"Align Left"},"  "),o("button",{type:"button",onClick:e[15]||(e[15]=i=>a.execCommand("justifyCenter")),class:"toolbar-btn",title:"Align Center"},"  "),o("button",{type:"button",onClick:e[16]||(e[16]=i=>a.execCommand("justifyRight")),class:"toolbar-btn",title:"Align Right"},"  ")]),o("div",Vm,[o("button",{type:"button",onClick:e[17]||(e[17]=i=>a.insertLink()),class:"toolbar-btn",title:"Insert Link"},"  Link ")]),o("div",Hm,[o("button",{type:"button",onClick:e[18]||(e[18]=i=>a.execCommand("removeFormat")),class:"toolbar-btn",title:"Clear Formatting"}," Clear ")])]),o("div",{ref:"editor",class:"rich-editor",style:es({minHeight:n.minHeight}),contenteditable:"true",onInput:e[19]||(e[19]=(...i)=>a.onInput&&a.onInput(...i)),"data-placeholder":n.placeholder},null,44,Gm)])),s.showPreviewPanel&&n.showPreview?(f(),p("div",zm,[o("div",Wm,[D(r,{size:18,class:"me-2"}),Ym]),o("div",{class:"preview-content",innerHTML:s.content},null,8,Xm)])):T("",!0)])}const po=ge(cm,[["render",Jm],["__scopeId","data-v-b60f1e5a"]]);const Qm={components:{ModalComponent:Xe,RichTextEditor:po},props:["waiver","show"],emits:["save","close"],data(){return{formError:[],waiverData:{format:"html",header:"",text:""},isEditing:!1}},mounted(){this.loadWaiver()},watch:{waiver:{handler(t,e){t!==e&&!this.isEditing&&this.loadWaiver()},immediate:!0},show(t){t&&(this.isEditing=!1,this.loadWaiver())},"waiverData.header"(){this.isEditing=!0},"waiverData.text"(){this.isEditing=!0},"waiverData.format"(){this.isEditing=!0}},methods:{loadWaiver(){if(console.log("Loading waiver:",this.waiver),!this.waiver){this.waiverData={format:"html",header:"",text:""};return}this.waiverData={...this.waiver,format:this.waiver.format||"html",header:this.waiver.header||"",text:this.waiver.text||""},console.log("Loaded waiverData:",this.waiverData)},async submitHandler(){console.log("Saving waiver:",this.waiverData),await Z.patch(`/api/races/${this.$route.params.raceid}`,{waiver:this.waiverData}).then(t=>{t.data&&(this.$emit("save",this.waiverData),console.log(t.data))}).catch(t=>{this.formError=["Error submitting request"],console.log(t)})}}},vo=t=>(nt("data-v-925a1be2"),t=t(),rt(),t),Zm=vo(()=>o("h5",{class:"mb-0"},"Edit Waiver / Liability Release",-1)),qm={class:"edit-waiver-form"},eh=vo(()=>o("div",{class:"alert alert-info py-2 mb-3"},[o("small",null,[o("strong",null,"Tip:"),M(" This waiver text will be shown to users during registration. They must check a box acknowledging they've read and accepted it. ")])],-1)),th={class:"modal-footer-buttons mt-4"},sh=vo(()=>o("div",null,null,-1));function oh(t,e,n,l,s,a){const r=$("FormKit"),d=$("RichTextEditor"),i=$("modal-component");return f(),q(i,{show:n.show,onClose:e[6]||(e[6]=c=>t.$emit("close"))},{header:G(()=>[Zm]),body:G(()=>[o("div",qm,[eh,D(r,{type:"select",modelValue:s.waiverData.format,"onUpdate:modelValue":e[0]||(e[0]=c=>s.waiverData.format=c),label:"Format",options:{html:"HTML (Rich Text)",text:"Plain Text"},help:"HTML format allows rich formatting. Plain text shows header and text separately."},null,8,["modelValue","options"]),s.waiverData.format!=="html"?(f(),q(r,{key:0,type:"text",modelValue:s.waiverData.header,"onUpdate:modelValue":e[1]||(e[1]=c=>s.waiverData.header=c),label:"Header",help:"Header text (shown in plain text mode only)"},null,8,["modelValue"])):T("",!0),s.waiverData.format==="html"?(f(),q(d,{key:1,modelValue:s.waiverData.text,"onUpdate:modelValue":e[2]||(e[2]=c=>s.waiverData.text=c),label:"Waiver Text",placeholder:"Enter your waiver/liability release text here...","show-preview":!0,"min-height":"400px"},null,8,["modelValue"])):(f(),q(r,{key:2,type:"textarea",modelValue:s.waiverData.text,"onUpdate:modelValue":e[3]||(e[3]=c=>s.waiverData.text=c),label:"Waiver Text",rows:"10"},null,8,["modelValue"]))]),o("div",th,[o("button",{class:"btn btn-sm btn-primary px-5 mx-3",onClick:e[4]||(e[4]=(...c)=>a.submitHandler&&a.submitHandler(...c))},"Save Waiver"),o("button",{class:"btn btn-sm btn-secondary px-3 mx-3",onClick:e[5]||(e[5]=c=>t.$emit("close"))},"Cancel")])]),footer:G(()=>[sh]),_:1},8,["show"])}const rh=ge(Qm,[["render",oh],["__scopeId","data-v-925a1be2"]]);const nh={components:{ModalComponent:Xe},props:["eventDetails","show"],emits:["save","close"],data(){return{formError:[],eventDetailsData:{name:"",formattedDates:"",tagline:"",logoUrl:"",headerPhoto:"",homepageUrl:"",regOpenDate:"",regCloseDate:"",facebookShare:{url:""}}}},mounted(){this.loadEventDetails()},watch:{eventDetails:{handler(){this.loadEventDetails()},immediate:!0}},methods:{loadEventDetails(){var t;if(console.log("Loading event details:",this.eventDetails),!this.eventDetails){this.eventDetailsData={name:"",formattedDates:"",tagline:"",logoUrl:"",headerPhoto:"",homepageUrl:"",regOpenDate:"",regCloseDate:"",facebookShare:{url:""}};return}this.eventDetailsData={...this.eventDetails,name:this.eventDetails.name||"",formattedDates:this.eventDetails.formattedDates||"",tagline:this.eventDetails.tagline||"",logoUrl:this.eventDetails.logoUrl||"",headerPhoto:this.eventDetails.headerPhoto||"",homepageUrl:this.eventDetails.homepageUrl||"",regOpenDate:this.eventDetails.regOpenDate||"",regCloseDate:this.eventDetails.regCloseDate||"",facebookShare:{...this.eventDetails.facebookShare||{},url:((t=this.eventDetails.facebookShare)==null?void 0:t.url)||""}},console.log("Loaded eventDetailsData:",this.eventDetailsData)},async submitHandler(){console.log("Saving event details:",this.eventDetailsData),await Z.patch(`/api/races/${this.$route.params.raceid}`,{eventDetails:this.eventDetailsData}).then(t=>{t.data&&(this.$emit("save",this.eventDetailsData),console.log(t.data))}).catch(t=>{this.formError=["Error submitting request"],console.log(t)})}}},Bt=t=>(nt("data-v-99524000"),t=t(),rt(),t),ah=Bt(()=>o("h5",{class:"mb-0"},"Edit Registration Form Header",-1)),ih={class:"edit-event-details-form"},lh=Bt(()=>o("div",{class:"alert alert-info py-2 mb-3"},[o("small",null,[o("strong",null,"Tip:"),M(" These details appear in the header of your registration form. Make sure to use clear, engaging text and high-quality images. ")])],-1)),ch=Bt(()=>o("h6",{class:"mb-3"},"Event Information",-1)),dh=Bt(()=>o("h6",{class:"mt-4 mb-3"},"Visual Assets",-1)),uh={key:0,class:"mb-3"},mh={class:"image-preview"},hh=["src"],fh={key:1,class:"mb-3"},ph={class:"image-preview"},vh=["src"],gh=Bt(()=>o("h6",{class:"mt-4 mb-3"},"Links",-1)),yh={class:"modal-footer-buttons mt-4"},bh=Bt(()=>o("div",null,null,-1));function Ch(t,e,n,l,s,a){const r=$("FormKit"),d=$("modal-component");return f(),q(d,{show:n.show,onClose:e[8]||(e[8]=i=>t.$emit("close"))},{header:G(()=>[ah]),body:G(()=>[o("div",ih,[lh,ch,D(r,{type:"text",modelValue:s.eventDetailsData.name,"onUpdate:modelValue":e[0]||(e[0]=i=>s.eventDetailsData.name=i),label:"Header Event Name",help:"The main event name displayed in the registration header"},null,8,["modelValue"]),D(r,{type:"text",modelValue:s.eventDetailsData.formattedDates,"onUpdate:modelValue":e[1]||(e[1]=i=>s.eventDetailsData.formattedDates=i),label:"Formatted Dates",help:"e.g., 'Sept 28th, Oct 5th, 12th, 19th, and 26th'"},null,8,["modelValue"]),D(r,{type:"text",modelValue:s.eventDetailsData.tagline,"onUpdate:modelValue":e[2]||(e[2]=i=>s.eventDetailsData.tagline=i),label:"Tagline",help:"A catchy tagline or subtitle for your event"},null,8,["modelValue"]),dh,D(r,{type:"text",modelValue:s.eventDetailsData.logoUrl,"onUpdate:modelValue":e[3]||(e[3]=i=>s.eventDetailsData.logoUrl=i),label:"Logo URL",help:"URL to your event logo image"},null,8,["modelValue"]),s.eventDetailsData.logoUrl?(f(),p("div",uh,[o("div",mh,[o("img",{src:s.eventDetailsData.logoUrl,alt:"Logo Preview",style:{"max-width":"150px","max-height":"150px"}},null,8,hh)])])):T("",!0),D(r,{type:"text",modelValue:s.eventDetailsData.headerPhoto,"onUpdate:modelValue":e[4]||(e[4]=i=>s.eventDetailsData.headerPhoto=i),label:"Header Photo URL",help:"URL to a banner/header photo displayed at the top"},null,8,["modelValue"]),s.eventDetailsData.headerPhoto?(f(),p("div",fh,[o("div",ph,[o("img",{src:s.eventDetailsData.headerPhoto,alt:"Header Photo Preview",style:{"max-width":"100%","max-height":"200px"}},null,8,vh)])])):T("",!0),gh,D(r,{type:"text",modelValue:s.eventDetailsData.homepageUrl,"onUpdate:modelValue":e[5]||(e[5]=i=>s.eventDetailsData.homepageUrl=i),label:"Event Homepage URL",help:"Link to your event's main website"},null,8,["modelValue"])]),o("div",yh,[o("button",{class:"btn btn-sm btn-primary px-5 mx-3",onClick:e[6]||(e[6]=(...i)=>a.submitHandler&&a.submitHandler(...i))},"Save Header Details"),o("button",{class:"btn btn-sm btn-secondary px-3 mx-3",onClick:e[7]||(e[7]=i=>t.$emit("close"))},"Cancel")])]),footer:G(()=>[bh]),_:1},8,["show"])}const Sh=ge(nh,[["render",Ch],["__scopeId","data-v-99524000"]]);const Dh={components:{ModalComponent:Xe,RichTextEditor:po},props:{emailTemplate:{type:[Object,String],default:null},show:{type:Boolean,default:!1},raceData:{type:Object,required:!0}},emits:["save","close"],data(){return{formError:[],templateData:{subject:"",body:""},showPreview:!1,previewHtml:"",previewSubject:"",isEditing:!1}},computed:{defaultTemplate(){return{subject:"{{eventName}} Registration",body:`<html><head></head><body>
<h1>Thank you for registering for {{eventName}}</h1>
<p>
Name: {{name}}<br>
Team/Sponsor: {{sponsor}}<br>
Race Category: {{category}}<br>
<p><a href="{{rosterLink}}">Go Here</a> to see who else is signed up<p>
<p>For information about the event, check out <a href="{{eventHomePageUrl}}">{{eventHomePageUrl}}</a></p>
<p>For issues with your registration information, <a href="mailto:{{eventContactEmail}}">email us!</a></p>
</body></html>`}},availableVariables(){var t,e,n,l,s,a,r,d,i;return[{name:"{{name}}",description:"Registrant full name",example:"John Doe"},{name:"{{sponsor}}",description:"Team/Sponsor name",example:"Sample Racing Team"},{name:"{{eventName}}",description:"Event name",example:((e=(t=this.raceData)==null?void 0:t.eventDetails)==null?void 0:e.name)||"Sample Race Event"},{name:"{{category}}",description:"Race category",example:((s=(l=(n=this.raceData)==null?void 0:n.regCategories)==null?void 0:l[0])==null?void 0:s.catdispname)||"Men's Cat 1"},{name:"{{rosterLink}}",description:"Link to race roster",example:`${window.location.origin}/#/roster/${((a=this.raceData)==null?void 0:a.raceid)||"raceid"}`},{name:"{{eventHomePageUrl}}",description:"Event homepage URL",example:((d=(r=this.raceData)==null?void 0:r.eventDetails)==null?void 0:d.homepageUrl)||"https://example.com"},{name:"{{eventContactEmail}}",description:"Event contact email",example:((i=this.raceData)==null?void 0:i.contactEmail)||"support@signup.bike"}]},sampleData(){var t,e,n,l,s,a,r,d,i;return{name:"John Doe",sponsor:"Sample Racing Team",eventName:((e=(t=this.raceData)==null?void 0:t.eventDetails)==null?void 0:e.name)||"Sample Race Event",category:((s=(l=(n=this.raceData)==null?void 0:n.regCategories)==null?void 0:l[0])==null?void 0:s.catdispname)||"Men's Cat 1",rosterLink:`${window.location.origin}/#/roster/${((a=this.raceData)==null?void 0:a.raceid)||"raceid"}`,eventHomePageUrl:((d=(r=this.raceData)==null?void 0:r.eventDetails)==null?void 0:d.homepageUrl)||"https://example.com",eventContactEmail:((i=this.raceData)==null?void 0:i.contactEmail)||"support@signup.bike"}}},mounted(){this.loadTemplate()},watch:{emailTemplate:{handler(t,e){t!==e&&!this.isEditing&&this.loadTemplate()},deep:!0},show(t){t&&(this.isEditing=!1,this.loadTemplate())},"templateData.subject"(){this.isEditing=!0},"templateData.body"(){this.isEditing=!0}},methods:{normalizeTemplate(t){return t?typeof t=="object"?{...t,subject:t.subject||this.defaultTemplate.subject,body:t.body||this.defaultTemplate.body}:typeof t=="string"?{subject:this.defaultTemplate.subject,body:t}:{...this.defaultTemplate}:{...this.defaultTemplate}},loadTemplate(){this.templateData=this.normalizeTemplate(this.emailTemplate)},resetToDefault(){confirm("Are you sure you want to reset to the default template? This will discard your current changes.")&&(this.templateData={...this.defaultTemplate})},copyVariable(t){navigator.clipboard.writeText(t).then(()=>{console.log("Copied:",t)})},renderPreview(){let t=this.templateData.subject,e=this.templateData.body;Object.keys(this.sampleData).forEach(n=>{const l=new RegExp(`{{${n}}}`,"g");t=t.replace(l,this.sampleData[n]),e=e.replace(l,this.sampleData[n])}),this.previewSubject=t,this.previewHtml=e,this.showPreview=!0},async submitHandler(){console.log("Saving email template:",this.templateData);try{await Z.patch(`/api/races/${this.$route.params.raceid}`,{emailTemplate:this.templateData}),this.$emit("save",this.templateData)}catch(t){this.formError=["Error saving email template"],console.error(t)}}}},pt=t=>(nt("data-v-972fa4db"),t=t(),rt(),t),xh=pt(()=>o("h5",{class:"mb-0"},"Edit Registration Confirmation Email",-1)),_h={class:"edit-email-form"},Eh=pt(()=>o("div",{class:"alert alert-info py-2 mb-3"},[o("small",null,[o("strong",null,"Tip:"),M(" This email is automatically sent when someone registers for your event. Use the template variables below to personalize the message with race and registrant information. ")])],-1)),wh={class:"row mb-3"},Ph={class:"col-md-8"},Th={class:"mb-3"},Rh=pt(()=>o("label",{class:"form-label"},"Email Subject Line",-1)),Oh=pt(()=>o("small",{class:"text-muted"},"You can use template variables in the subject line too!",-1)),Ih={class:"mt-3 d-flex gap-2"},kh={class:"col-md-4"},$h={class:"template-variables p-3 bg-light border rounded"},Ah=pt(()=>o("h6",{class:"mb-3"},"Available Variables",-1)),Mh=pt(()=>o("small",{class:"text-muted mb-2 d-block"}," Click to copy, then paste into your template: ",-1)),Fh={class:"variable-list"},Nh=["onClick"],Lh={class:"variable-code"},Uh={class:"variable-description text-muted small mt-1"},jh={class:"variable-example text-success small"},Vh={key:0,class:"preview-section mt-4 p-3 border rounded bg-light"},Hh={class:"d-flex justify-content-between align-items-center mb-3"},Gh=pt(()=>o("h6",{class:"mb-0"},"Preview with Sample Data",-1)),Bh={class:"preview-content bg-white p-3 border rounded"},Kh={class:"mb-3 pb-2 border-bottom"},zh=pt(()=>o("strong",null,"Subject:",-1)),Wh=["innerHTML"],Yh=pt(()=>o("small",{class:"text-muted mt-2 d-block"}," This preview uses sample data. Actual emails will use real registrant information. ",-1)),Xh={key:0,class:"alert alert-danger mt-3"},Jh={class:"modal-footer-buttons mt-4"},Qh=pt(()=>o("div",null,null,-1));function Zh(t,e,n,l,s,a){const r=$("RichTextEditor"),d=$("modal-component");return f(),q(d,{show:n.show,onClose:e[7]||(e[7]=i=>t.$emit("close")),size:"xl"},{header:G(()=>[xh]),body:G(()=>[o("div",_h,[Eh,o("div",wh,[o("div",Ph,[o("div",Th,[Rh,ae(o("input",{type:"text",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=i=>s.templateData.subject=i),placeholder:"Enter email subject..."},null,512),[[ve,s.templateData.subject]]),Oh]),D(r,{modelValue:s.templateData.body,"onUpdate:modelValue":e[1]||(e[1]=i=>s.templateData.body=i),label:"Email Body",placeholder:"Enter your email message here...","show-preview":!1,"min-height":"400px"},null,8,["modelValue"]),o("div",Ih,[o("button",{class:"btn btn-sm btn-outline-primary",onClick:e[2]||(e[2]=(...i)=>a.renderPreview&&a.renderPreview(...i))}," Preview with Sample Data "),o("button",{class:"btn btn-sm btn-outline-secondary",onClick:e[3]||(e[3]=(...i)=>a.resetToDefault&&a.resetToDefault(...i))}," Reset to Default Template ")])]),o("div",kh,[o("div",$h,[Ah,Mh,o("div",Fh,[(f(!0),p(te,null,de(a.availableVariables,i=>(f(),p("div",{key:i.name,class:"variable-item mb-2 p-2 bg-white border rounded",onClick:c=>a.copyVariable(i.name),role:"button",tabindex:"0"},[o("code",Lh,S(i.name),1),o("div",Uh,S(i.description),1),o("div",jh," Example: "+S(i.example),1)],8,Nh))),128))])])])]),s.showPreview?(f(),p("div",Vh,[o("div",Hh,[Gh,o("button",{class:"btn btn-sm btn-outline-secondary",onClick:e[4]||(e[4]=i=>s.showPreview=!1)}," Close Preview ")]),o("div",Bh,[o("div",Kh,[zh,M(" "+S(s.previewSubject),1)]),o("div",{innerHTML:s.previewHtml},null,8,Wh)]),Yh])):T("",!0)]),s.formError.length>0?(f(),p("div",Xh,[(f(!0),p(te,null,de(s.formError,(i,c)=>(f(),p("div",{key:c},S(i),1))),128))])):T("",!0),o("div",Jh,[o("button",{class:"btn btn-primary px-5 mx-2",onClick:e[5]||(e[5]=(...i)=>a.submitHandler&&a.submitHandler(...i))}," Save Email Template "),o("button",{class:"btn btn-secondary px-3 mx-2",onClick:e[6]||(e[6]=i=>t.$emit("close"))}," Cancel ")])]),footer:G(()=>[Qh]),_:1},8,["show"])}const qh=ge(Dh,[["render",Zh],["__scopeId","data-v-972fa4db"]]);const ef={components:{ModalComponent:Xe,EditRaceCategoriesComponent:Yd,EditRaceCouponsComponent:pu,EditRacePaymentsComponent:Pu,EditRaceOptionalPurchasesComponent:lm,EditRaceWaiverComponent:rh,EditRaceEventDetailsComponent:Sh,EditRaceEmailTemplateComponent:qh,RichTextEditor:po,Link:lo,Edit3:io},data(){return{categories:{},loading:!1,error:null,formError:[],formInputData:{},editedCategories:[],editedCoupons:{},editedPaymentOptions:[],editedOptionalPurchases:[],editedWaiver:null,editedEmailTemplate:null,editedHeaderContent:"",editedEventDetails:{},raceData:{},showModal:!1,modalMode:null,seriesData:null,activeTab:"settings",showHeaderContentEditor:!1}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{dollas(t){return typeof t=="string"&&(t=parseInt(t)),t.toLocaleString("en-US",{style:"currency",currency:"USD"})},async fetchData(){if(this.error=null,this.loading=!0,this.$route.params.raceid)try{const t=await Z(`/api/races/${this.$route.params.raceid}`);this.raceData=t.data,this.editedHeaderContent=this.raceData.headerContent||"",this.showHeaderContentEditor=!!this.raceData.headerContent,this.raceData.series?await this.fetchSeriesData():this.seriesData=null,this.loading=!1}catch(t){this.loading=!1,this.error=t.toString(),console.error(t)}},async fetchSeriesData(){if(this.raceData.series)try{const t=await Z(`/api/series/${this.raceData.series}`);this.seriesData=t.data}catch(t){console.error("Error fetching series data:",t),this.seriesData=null}},isSeriesCategory(t){return!this.seriesData||!this.seriesData.regCategories?!1:this.seriesData.regCategories.some(e=>e.id===t)},isRaceOverride(t){return t._isRaceOverride===!0},isPureSeriesCategory(t){return t._isSeriesCategory===!0},getCategoryPaymentInfo(t){var s,a,r,d,i;const e=this.isSeriesCategory(t.id),n={forcedPayment:null,group:null,fallback:null},l=this.raceData.paymentOptions&&this.raceData.paymentOptions.length>0&&!this.raceData._paymentOptionsFromSeries;if(e&&((s=this.seriesData)!=null&&s.categoryGroups)){for(const c of this.seriesData.categoryGroups)if(c.categories&&c.categories.includes(t.id)){const h=((a=c.paymentOptions)==null?void 0:a.map(m=>m.name).join(", "))||"No payments";n.group={type:"series-group",label:c.name,payments:h,source:"series-group"};break}}if(t.paytype){let c="race",h=this.paymentOptions[t.paytype]||t.paytype,m=!1;if(l&&this.paymentOptions[t.paytype])c="race",h=this.paymentOptions[t.paytype];else{if(n.group){const v=this.seriesData.categoryGroups.find(g=>g.categories&&g.categories.includes(t.id));if(v){const g=(r=v.paymentOptions)==null?void 0:r.find(y=>y.type===t.paytype);g&&(c="series-group",h=g.name,m=!0)}}if(!m&&e&&((d=this.seriesData)!=null&&d.defaultPaymentOptions)){const v=this.seriesData.defaultPaymentOptions.find(g=>g.type===t.paytype);v&&(c="series-default",h=v.name,m=!0)}}n.forcedPayment={type:"forced",label:h,source:c,paytype:t.paytype}}if(!n.forcedPayment&&e&&(i=this.seriesData)!=null&&i.defaultPaymentOptions&&this.seriesData.defaultPaymentOptions.length>0){const c=this.seriesData.defaultPaymentOptions.map(h=>h.name).join(", ");n.fallback={type:"series-default",label:"Series Defaults",payments:c,source:"series-default"}}return!n.forcedPayment&&!n.group&&!n.fallback&&(n.fallback={type:"any",label:"Any payment type",source:"race"}),n},editProperty(t,e,n){this.showModal=!0,this.modalMode=t,this[e]=n},setActiveTab(t){this.activeTab=t},editOptionalPurchases(){this.showModal=!0,this.modalMode="optionalpurchases"},closeModal(){this.showModal=!1},async saveProperty(t){console.log("Saved property data"),this.showModal=!1,this.modalMode=null,console.log(t),await this.fetchData()},async saveRaceData(t){const e={...this.formInputData};e.eventDetails&&this.raceData.eventDetails&&(e.eventDetails={...this.raceData.eventDetails,...e.eventDetails}),e.stripeMeta&&this.raceData.stripeMeta&&(e.stripeMeta={...this.raceData.stripeMeta,...e.stripeMeta}),await Z.patch(`/api/races/${this.$route.params.raceid}`,e).then(n=>{if(n.data)return console.log(n.data),this.fetchData()}).catch(n=>{this.formError=["Error submitting request"],console.log(n)})},async saveHeaderContent(){try{await Z.patch(`/api/races/${this.$route.params.raceid}`,{headerContent:this.editedHeaderContent}),await this.fetchData()}catch(t){console.error("Error saving header content:",t),alert("Error saving header content")}}},computed:{defaultEmailSubject(){return"{{eventName}} Registration"},emailPreviewData(){var t,e,n,l,s,a,r,d,i,c;return{name:"John Doe",sponsor:"Sample Racing Team",eventName:((e=(t=this.raceData)==null?void 0:t.eventDetails)==null?void 0:e.name)||((n=this.raceData)==null?void 0:n.displayName)||"Sample Race Event",category:((a=(s=(l=this.raceData)==null?void 0:l.regCategories)==null?void 0:s[0])==null?void 0:a.catdispname)||"Men's Cat 1",rosterLink:`${window.location.origin}/#/roster/${((r=this.raceData)==null?void 0:r.raceid)||"raceid"}`,eventHomePageUrl:((i=(d=this.raceData)==null?void 0:d.eventDetails)==null?void 0:i.homepageUrl)||"https://example.com",eventContactEmail:((c=this.raceData)==null?void 0:c.contactEmail)||"support@signup.bike"}},renderedEmailPreview(){let t=this.defaultEmailSubject,e=`<html><head></head><body>
<h1>Thank you for registering for {{eventName}}</h1>
<p>
Name: {{name}}<br>
Team/Sponsor: {{sponsor}}<br>
Race Category: {{category}}<br>
<p><a href="{{rosterLink}}">Go Here</a> to see who else is signed up<p>
<p>For information about the event, check out <a href="{{eventHomePageUrl}}">{{eventHomePageUrl}}</a></p>
<p>For issues with your registration information, <a href="mailto:{{eventContactEmail}}">email us!</a></p>
</body></html>`;this.raceData.emailTemplate&&(typeof this.raceData.emailTemplate=="object"?(t=this.raceData.emailTemplate.subject||t,e=this.raceData.emailTemplate.body||e):e=this.raceData.emailTemplate);const n=this.emailPreviewData;return Object.keys(n).forEach(l=>{const s=new RegExp(`{{${l}}}`,"g");t=t.replace(s,n[l]),e=e.replace(s,n[l])}),{subject:t,body:e.substring(0,500)+(e.length>500?"...":"")}},sortedCats(){return X.orderBy(this.raceData.regCategories,"disporder")},loaded(){return!!this.raceData},eventDate(){return dt(this.raceData.eventDate).format("YYYY-MM-DDTHH:mm")},regOpenDate(){return dt(this.raceData.regOpenDate).format("YYYY-MM-DDTHH:mm")},timeToOpen(){var t;return dt().to((t=this.raceData.eventDetails)==null?void 0:t.regOpenDate)},timeToClose(){var t;return dt().to((t=this.raceData.eventDetails)==null?void 0:t.regCloseDate)},paymentOptions(){let t={};return X.forEach(this.raceData.paymentOptions,e=>{t[e.type]=e.name}),t},allPaymentOptionsWithSource(){var l,s;const t=[],e=new Set;return this.raceData.paymentOptions&&this.raceData.paymentOptions.length>0&&!this.raceData._paymentOptionsFromSeries&&(this.raceData.paymentOptions||[]).forEach(a=>{t.push({...a,source:"race",sourceLabel:"Race-specific",usedBy:"Race Categories",key:`race-${a.type}`,priority:1}),e.add(a.type)}),(l=this.seriesData)!=null&&l.defaultPaymentOptions&&this.seriesData.defaultPaymentOptions.forEach(a=>{const r=e.has(a.type);t.push({...a,source:"series-default",sourceLabel:"Series Default",usedBy:"Series Categories (not in groups)",key:`series-default-${a.type}`,priority:3,isOverridden:r,overriddenBy:r?"race":null})}),(s=this.seriesData)!=null&&s.categoryGroups&&this.seriesData.categoryGroups.forEach(a=>{(a.paymentOptions||[]).forEach(r=>{const d=e.has(r.type);t.push({...r,source:"series-group",sourceLabel:`Series Group: ${a.name}`,seriesGroup:a.name,groupName:a.name,usedBy:`Series Categories in "${a.name}"`,key:`series-group-${a.name}-${r.type}`,priority:2,isOverridden:d,overriddenBy:d?"race":null})})}),t.sort((a,r)=>a.priority-r.priority)}}},tf={class:"container"},sf={key:0,class:"loading"},of={key:1},rf={key:0,class:"error"},nf={key:1},af={key:0,class:"series-banner alert alert-info d-flex align-items-center justify-content-between mb-3"},lf={class:"d-flex align-items-center"},cf=o("strong",null,"Part of Series:",-1),df={key:0,class:"ms-2 text-muted"},uf={class:"d-flex flex-row"},mf={class:"my-3 mx-5"},hf=["href"],ff={class:"my-3"},pf=["href"],vf={class:"row"},gf={class:"col-md-12"},yf={class:"nav nav-tabs mb-3",role:"tablist"},bf={class:"nav-item",role:"presentation"},Cf={class:"nav-item",role:"presentation"},Sf={class:"nav-item",role:"presentation"},Df={class:"nav-item",role:"presentation"},xf={class:"tab-content"},_f=o("h6",{class:"mt-3 mb-2"},"Registration Dates",-1),Ef={class:"small text-muted"},wf={class:"small text-muted"},Pf={key:0,class:"alert alert-warning mt-3 mb-0"},Tf=o("small",null,[o("strong",null," Landing Page Visibility:"),M(' This race is part of a series and may be hidden on the main landing page. Only the first upcoming race in the series will be shown (unless "Disable Series Redirect" is enabled in Advanced settings). The race will still be visible when viewing the specific series page. ')],-1),Rf=[Tf],Of=o("h6",{class:"mt-3 mb-2"},"Registration Limits",-1),If={class:"small text-muted"},kf={class:"registration-section"},$f={class:"row"},Af={class:"col-lg-6"},Mf={class:"content-card mb-4"},Ff={class:"d-flex justify-content-between align-items-center mb-3"},Nf=o("h5",{class:"mb-0"},"Categories",-1),Lf={key:0,class:"series-preview-info mb-2"},Uf={class:"text-muted"},jf={class:"ms-2",style:{color:"#f57c00"}},Vf={class:"category-preview"},Hf={class:"cat-preview-name"},Gf={class:"cat-preview-badges"},Bf={key:0,class:"sponsored-badge"},Kf=["title"],zf=["title"],Wf=["title"],Yf={key:3,class:"text-muted small"},Xf={class:"col-lg-6"},Jf={class:"content-card mb-4"},Qf={class:"d-flex justify-content-between align-items-center mb-3"},Zf=o("h5",{class:"mb-0"},"Race Payment Options",-1),qf={key:0,class:"alert alert-info py-2 mb-3"},ep=Oo("<small><strong>Hybrid Payment Model - Priority Order:</strong><br> 1. <strong>Race Payment Options</strong> override series defaults/groups when payment type matches<br> 2. <strong>Series Category Groups</strong> define payment options for categories in that group<br> 3. <strong>Series Default Options</strong> apply to series categories not in any group<br> 4. <strong>Race-only Categories</strong> use race payment options<br><br>  <em>Tip: Define a race payment option with the same &quot;type&quot; to override series amounts/names</em></small>",1),tp=[ep],sp={class:"table table-sm"},op=o("thead",null,[o("tr",null,[o("th",{scope:"col"},"Payment Option"),o("th",{scope:"col"},"Price"),o("th",{scope:"col"},"Used By")])],-1),rp={key:1,class:"text-muted small"},np={key:2,class:"text-warning small"},ap={key:0,class:"badge bg-primary",title:"Race-specific payment option"},ip=["title"],lp=["title"],cp={class:"text-muted small mt-1"},dp={key:1,class:"text-muted text-center py-3"},up={class:"row"},mp={class:"col-lg-6"},hp={class:"content-card mb-4"},fp={class:"d-flex justify-content-between align-items-center mb-3"},pp=o("h5",{class:"mb-0"},"Coupons",-1),vp={key:0},gp={class:"table table-sm"},yp=o("thead",null,[o("tr",null,[o("th",{scope:"col"},"Coupon Code"),o("th",{scope:"col"},"Discount"),o("th",{scope:"col"},"Type")])],-1),bp={key:0,class:"badge bg-warning text-dark"},Cp={key:1,class:"badge bg-success"},Sp={key:1,class:"text-muted text-center py-3"},Dp={class:"content-card mb-4"},xp={class:"d-flex justify-content-between align-items-center mb-3"},_p=o("h5",{class:"mb-0"},"Optional Purchases",-1),Ep={key:0},wp={class:"table table-sm"},Pp=o("thead",null,[o("tr",null,[o("th",{scope:"col"},"Label"),o("th",{scope:"col"},"Description"),o("th",{scope:"col"},"Amount"),o("th",{scope:"col"},"Options")])],-1),Tp=["innerHTML"],Rp={key:1,class:"text-muted"},Op={key:0,class:"badge bg-info"},Ip={key:1,class:"text-muted"},kp={key:1,class:"text-muted text-center py-3"},$p={class:"content-section"},Ap={class:"content-card mb-4"},Mp={class:"d-flex justify-content-between align-items-center mb-3"},Fp=o("h5",{class:"mb-0"},"Registration Form Header",-1),Np={key:0,class:"preview-box"},Lp={class:"event-header-preview"},Up={class:"row align-items-center"},jp={key:0,class:"col-md-3 text-center"},Vp=["src"],Hp={class:"col"},Gp={class:"fw-bold mb-2"},Bp={key:0,class:"lead mb-2"},Kp={key:1,class:"mb-2"},zp={key:2,class:"mb-2"},Wp=["href"],Yp={key:0,class:"mt-3"},Xp=o("div",{class:"text-muted small mb-1"},"Header Photo:",-1),Jp=["src"],Qp={key:1,class:"alert alert-warning mb-0"},Zp=o("small",null,' No header details configured. Click "Edit Header" to add them.',-1),qp=[Zp],ev={class:"content-card mb-4"},tv={key:0},sv=o("h5",{class:"mb-3"},"Extra Content Below Header",-1),ov={key:1},rv={class:"d-flex justify-content-between align-items-center mb-3"},nv=o("h5",{class:"mb-0"},"Extra Content Below Header",-1),av={key:0,class:"mt-3"},iv={class:"preview-box"},lv=o("div",{class:"preview-label"},"Current Content Preview:",-1),cv=["innerHTML"],dv={class:"content-card mb-4"},uv={class:"d-flex justify-content-between align-items-center mb-3"},mv=o("h5",{class:"mb-0"},"Waiver / Liability Release",-1),hv={key:0},fv={class:"mb-2"},pv={class:"badge bg-info"},vv={key:0,class:"ms-2 text-muted small"},gv={class:"preview-box"},yv=o("div",{class:"preview-label"},"Preview:",-1),bv=["innerHTML"],Cv={key:1},Sv={key:1},Dv=o("div",{class:"alert alert-warning mb-0"},[o("small",null,' No waiver configured. Click "Edit Waiver" to add one.')],-1),xv=[Dv],_v={class:"content-card"},Ev={class:"d-flex justify-content-between align-items-center mb-3"},wv=o("h5",{class:"mb-0"},"Registration Confirmation Email",-1),Pv={key:0,class:"mb-2"},Tv=o("span",{class:"badge bg-success"},"Custom Template Active",-1),Rv=o("span",{class:"ms-2 text-muted small"}," A custom email template is configured for this race. ",-1),Ov=[Tv,Rv],Iv={key:1,class:"mb-2"},kv=o("span",{class:"badge bg-secondary"},"Using Default Template",-1),$v=o("span",{class:"ms-2 text-muted small"}," Using the standard registration confirmation email. ",-1),Av=[kv,$v],Mv=o("div",{class:"preview-label"},"Preview with Sample Data:",-1),Fv={class:"preview-box"},Nv={class:"email-preview"},Lv={class:"mb-2 pb-2 border-bottom"},Uv=o("strong",null,"Subject:",-1),jv=["innerHTML"],Vv=o("div",{class:"mt-2"},[o("small",{class:"text-muted"}," Preview uses actual race data with sample registrant information (John Doe, Sample Racing Team). ")],-1),Hv=o("div",{class:"alert alert-info mt-3 mb-0"},[o("small",null,[o("strong",null,"Tip:"),M(" This email is automatically sent to registrants after they complete their registration. You can customize the subject line and body, and use template variables to personalize the message. ")])],-1),Gv=o("h6",{class:"mb-3"},"Display Options",-1),Bv=o("h6",{class:"mt-4 mb-3"},"Feature Toggles",-1),Kv={key:0,class:"mb-3"},zv=o("div",{class:"alert alert-info mt-2 mb-0"},[o("small",null,[o("strong",null,"Series Redirect Behavior:"),o("br"),M(" When "),o("strong",null,"disabled"),M(" (checked): "),o("ul",{class:"mb-1 mt-1"},[o("li",null,"This race will appear on the main landing page"),o("li",null,"Users can register directly for this specific race"),o("li",null,"No automatic redirects occur")]),M(" When "),o("strong",null,"enabled"),M(" (unchecked - default): "),o("ul",{class:"mb-1 mt-1"},[o("li",null,"Only the first/next upcoming race in the series appears on the main landing page"),o("li",null,"Users visiting this race's registration page will be automatically redirected to the next upcoming race in the series"),o("li",null,"Helps prevent users from accidentally registering for the wrong race in a series")]),o("em",null," Tip: Enable this option if you want each race in the series to be independently accessible (e.g., for special events or makeup races).")])],-1),Wv=o("h6",{class:"mt-4 mb-3"},"Payment Integration",-1),Yv=o("h6",{class:"mt-4 mb-3"},"Race Status",-1);function Xv(t,e,n,l,s,a){var w,k;const r=$("Link"),d=$("RouterLink"),i=$("FormKit"),c=$("Edit3"),h=$("RichTextEditor"),m=$("EditRaceCategoriesComponent"),u=$("EditRacePaymentsComponent"),v=$("EditRaceCouponsComponent"),g=$("EditRaceOptionalPurchasesComponent"),y=$("EditRaceWaiverComponent"),b=$("EditRaceEventDetailsComponent"),x=$("EditRaceEmailTemplateComponent");return f(),p("div",tf,[s.loading?(f(),p("div",sf,"Loading...")):(f(),p("div",of,[s.error?(f(),p("div",rf,S(s.error),1)):T("",!0),(f(),p("div",nf,[s.raceData.series&&s.seriesData?(f(),p("div",af,[o("div",lf,[D(r,{size:20,class:"me-2"}),o("div",null,[cf,M(" "+S(s.seriesData.name)+" ",1),s.raceData.seriesRaceNumber?(f(),p("span",df," (Race #"+S(s.raceData.seriesRaceNumber)+") ",1)):T("",!0)])]),D(d,{to:{name:"edit-series",params:{seriesId:s.raceData.series}},class:"btn btn-sm btn-outline-primary"},{default:G(()=>[M(" Edit Series ")]),_:1},8,["to"])])):T("",!0),o("div",uf,[o("div",mf,[o("a",{href:`/#/register/test/${s.raceData.raceid}`},"View Reg Form",8,hf)]),o("div",ff,[o("a",{href:`/#/roster/${s.raceData.raceid}`},"View Roster",8,pf)])]),o("div",vf,[o("div",gf,[o("ul",yf,[o("li",bf,[o("button",{class:le(["nav-link",{active:s.activeTab==="settings"}]),onClick:e[0]||(e[0]=C=>a.setActiveTab("settings")),type:"button"}," Settings ",2)]),o("li",Cf,[o("button",{class:le(["nav-link",{active:s.activeTab==="registration"}]),onClick:e[1]||(e[1]=C=>a.setActiveTab("registration")),type:"button"}," Registration ",2)]),o("li",Sf,[o("button",{class:le(["nav-link",{active:s.activeTab==="content"}]),onClick:e[2]||(e[2]=C=>a.setActiveTab("content")),type:"button"}," Content ",2)]),o("li",Df,[o("button",{class:le(["nav-link",{active:s.activeTab==="advanced"}]),onClick:e[3]||(e[3]=C=>a.setActiveTab("advanced")),type:"button"}," Advanced ",2)])]),o("div",xf,[ae(o("div",{class:le(["tab-pane",{active:s.activeTab==="settings",show:s.activeTab==="settings"}])},[D(i,{type:"form",errors:s.formError,id:"race-settings",onSubmit:a.saveRaceData,"submit-label":"Save Settings",modelValue:s.formInputData,"onUpdate:modelValue":e[4]||(e[4]=C=>s.formInputData=C)},{default:G(()=>{var C,O,R,V;return[D(i,{value:(C=s.raceData)==null?void 0:C.displayName,type:"text",name:"displayName",label:"Event Name"},null,8,["value"]),D(i,{value:(O=s.raceData)==null?void 0:O.contactEmail,type:"text",name:"contactEmail",label:"Contact Email"},null,8,["value"]),D(i,{value:a.eventDate,type:"datetime-local",name:"eventDate",label:"Date"},null,8,["value"]),D(i,{value:(R=s.raceData)==null?void 0:R.seriesRaceNumber,type:"number",name:"seriesRaceNumber",label:"Series Race Number"},null,8,["value"]),_f,D(i,{type:"group",name:"eventDetails"},{default:G(()=>{var B,I,L,H;return[D(i,{value:(I=(B=s.raceData)==null?void 0:B.eventDetails)==null?void 0:I.regOpenDate,type:"datetime-local",name:"regOpenDate",label:"Registration Open Date"},null,8,["value"]),o("p",Ef,"Registration Opens "+S(a.timeToOpen),1),D(i,{value:(H=(L=s.raceData)==null?void 0:L.eventDetails)==null?void 0:H.regCloseDate,type:"datetime-local",name:"regCloseDate",label:"Registration Close Date"},null,8,["value"]),o("p",wf,"Registration Closes "+S(a.timeToClose),1)]}),_:1}),s.raceData.series&&!s.raceData.disableSeriesRedirect?(f(),p("div",Pf,Rf)):T("",!0),Of,D(i,{value:(V=s.raceData)==null?void 0:V.entryCountMax,type:"number",label:"Maximum Number of registrations",name:"entryCountMax"},null,8,["value"]),o("p",If,[o("strong",null,"Current Reg Count: "+S(s.raceData.entryCount),1)])]}),_:1},8,["errors","onSubmit","modelValue"])],2),[[jt,s.activeTab==="settings"]]),ae(o("div",{class:le(["tab-pane",{active:s.activeTab==="registration",show:s.activeTab==="registration"}])},[o("div",kf,[o("div",$f,[o("div",Af,[o("div",Mf,[o("div",Ff,[Nf,o("button",{type:"button",class:"btn btn-sm btn-primary",onClick:e[5]||(e[5]=C=>a.editProperty("categories","editedCategories",[...a.sortedCats]))}," Edit Categories ")]),s.raceData.series&&s.seriesData?(f(),p("div",Lf,[o("small",Uf,[D(r,{size:14,class:"me-1",style:{display:"inline-block","vertical-align":"middle"}}),M(" Link icon = inherited from series "),o("span",jf,[D(c,{size:14,class:"me-1",style:{display:"inline-block","vertical-align":"middle"}}),M(" Edit icon = race override ")])])])):T("",!0),o("div",Vf,[(f(!0),p(te,null,de(a.sortedCats,C=>(f(),p("div",{key:C.id,class:le(["cat-preview-row",{"from-series":a.isPureSeriesCategory(C),"race-override":a.isRaceOverride(C)}])},[o("div",Hf,[a.isPureSeriesCategory(C)?(f(),q(r,{key:0,size:16,class:"series-icon me-1",title:"Inherited from series"})):a.isRaceOverride(C)?(f(),q(c,{key:1,size:16,class:"override-icon me-1",title:"Race override of series category"})):T("",!0),M(" "+S(C.catdispname),1)]),o("div",Gf,[C.sponsored?(f(),p("strong",Bf,"Sponsored")):(f(),p(te,{key:1},[a.getCategoryPaymentInfo(C).forcedPayment?(f(),p("span",{key:0,class:le(["paytype-badge",{"badge-race":a.getCategoryPaymentInfo(C).forcedPayment.source==="race","badge-series-default":a.getCategoryPaymentInfo(C).forcedPayment.source==="series-default","badge-series-group":a.getCategoryPaymentInfo(C).forcedPayment.source==="series-group","badge-race-override":a.getCategoryPaymentInfo(C).forcedPayment.source==="race-override"}]),title:`Forced to: ${a.getCategoryPaymentInfo(C).forcedPayment.paytype}`},S(a.getCategoryPaymentInfo(C).forcedPayment.label),11,Kf)):T("",!0),a.getCategoryPaymentInfo(C).group?(f(),p("span",{key:1,class:"paytype-badge badge-series-group",title:a.getCategoryPaymentInfo(C).group.payments},S(a.getCategoryPaymentInfo(C).group.label),9,zf)):T("",!0),a.getCategoryPaymentInfo(C).fallback?(f(),p("span",{key:2,class:le(["paytype-badge",{"badge-series-default":a.getCategoryPaymentInfo(C).fallback.source==="series-default"}]),title:a.getCategoryPaymentInfo(C).fallback.payments},S(a.getCategoryPaymentInfo(C).fallback.label),11,Wf)):T("",!0),!a.getCategoryPaymentInfo(C).forcedPayment&&!a.getCategoryPaymentInfo(C).group&&!a.getCategoryPaymentInfo(C).fallback?(f(),p("span",Yf," Any payment ")):T("",!0)],64))])],2))),128))])])]),o("div",Xf,[o("div",Jf,[o("div",Qf,[Zf,o("button",{type:"button",class:"btn btn-sm btn-primary",onClick:e[6]||(e[6]=C=>a.editProperty("paymentOptions","editedPaymentOptions",[...s.raceData.paymentOptions]))}," Edit Race Payments ")]),s.seriesData&&(((w=s.seriesData.defaultPaymentOptions)==null?void 0:w.length)>0||((k=s.seriesData.categoryGroups)==null?void 0:k.length)>0)?(f(),p("div",qf,tp)):T("",!0),o("table",sp,[op,o("tbody",null,[(f(!0),p(te,null,de(a.allPaymentOptionsWithSource,C=>(f(),p("tr",{key:C.key,class:le({"from-series":C.source!=="race","is-overridden":C.isOverridden})},[o("td",null,[C.source!=="race"?(f(),q(r,{key:0,size:16,class:"series-icon me-1",title:`From ${C.sourceLabel}`},null,8,["title"])):T("",!0),o("strong",{class:le({"text-decoration-line-through text-muted":C.isOverridden})},S(C.name),3),C.seriesGroup?(f(),p("div",rp," Group: "+S(C.seriesGroup),1)):T("",!0),C.isOverridden?(f(),p("div",np,"  Overridden by race payment option ")):T("",!0)]),o("td",{class:le({"text-decoration-line-through text-muted":C.isOverridden})},S(a.dollas(C.amount)),3),o("td",null,[C.source==="race"?(f(),p("span",ap," Race ")):C.source==="series-group"?(f(),p("span",{key:1,class:"badge bg-info",title:C.usedBy}," Series Group ",8,ip)):C.source==="series-default"?(f(),p("span",{key:2,class:"badge bg-success",title:C.usedBy}," Series Default ",8,lp)):T("",!0),o("div",cp,S(C.usedBy),1)])],2))),128))])]),a.allPaymentOptionsWithSource.length===0?(f(),p("div",dp," No payment options configured ")):T("",!0)])])]),o("div",up,[o("div",mp,[o("div",hp,[o("div",fp,[pp,o("button",{type:"button",class:"btn btn-sm btn-primary",onClick:e[7]||(e[7]=C=>a.editProperty("coupons","editedCoupons",{...s.raceData.couponCodes}))}," Edit Coupons ")]),s.raceData.couponCodes&&Object.keys(s.raceData.couponCodes).length>0?(f(),p("div",vp,[o("table",gp,[yp,o("tbody",null,[(f(!0),p(te,null,de(s.raceData.couponCodes,(C,O)=>(f(),p("tr",{key:O},[o("td",null,[o("strong",null,S(O),1)]),o("td",null,S(((C.fractionDiscount||0)*100).toFixed(1))+"% off",1),o("td",null,[C.singleUse?(f(),p("span",bp," Single Use ")):(f(),p("span",Cp," Multi-Use "))])]))),128))])])])):(f(),p("div",Sp," No coupons configured "))]),o("div",Dp,[o("div",xp,[_p,o("button",{type:"button",class:"btn btn-sm btn-primary",onClick:e[8]||(e[8]=C=>a.editProperty("optionalpurchases","editedOptionalPurchases",s.raceData.optionalPurchases?[...s.raceData.optionalPurchases]:[]))}," Edit Optional Purchases ")]),s.raceData.optionalPurchases&&s.raceData.optionalPurchases.length>0?(f(),p("div",Ep,[o("table",wp,[Pp,o("tbody",null,[(f(!0),p(te,null,de(s.raceData.optionalPurchases,(C,O)=>(f(),p("tr",{key:O},[o("td",null,[o("strong",null,S(C.label),1)]),o("td",null,[C.description?(f(),p("div",{key:0,innerHTML:C.description,class:"small text-muted"},null,8,Tp)):(f(),p("span",Rp,""))]),o("td",null,S(a.dollas(parseFloat(C.amount))),1),o("td",null,[C.options&&C.options.length>0?(f(),p("span",Op,S(C.optionsLabel||"Options")+": "+S(C.options.join(", ")),1)):(f(),p("span",Ip,""))])]))),128))])])])):(f(),p("div",kp," No optional purchases configured "))])])])])],2),[[jt,s.activeTab==="registration"]]),ae(o("div",{class:le(["tab-pane",{active:s.activeTab==="content",show:s.activeTab==="content"}])},[o("div",$p,[o("div",Ap,[o("div",Mp,[Fp,o("button",{type:"button",class:"btn btn-sm btn-primary",onClick:e[9]||(e[9]=C=>a.editProperty("eventDetails","editedEventDetails",s.raceData.eventDetails?{...s.raceData.eventDetails}:{}))}," Edit Header ")]),s.raceData.eventDetails&&Object.keys(s.raceData.eventDetails).length>0?(f(),p("div",Np,[o("div",Lp,[o("div",Up,[s.raceData.eventDetails.logoUrl?(f(),p("div",jp,[o("img",{src:s.raceData.eventDetails.logoUrl,alt:"Event Logo",style:{"max-width":"150px","max-height":"150px"}},null,8,Vp)])):T("",!0),o("div",Hp,[o("h4",Gp,S(s.raceData.eventDetails.name||"No name set"),1),s.raceData.eventDetails.tagline?(f(),p("p",Bp,S(s.raceData.eventDetails.tagline),1)):T("",!0),s.raceData.eventDetails.formattedDates?(f(),p("p",Kp,S(s.raceData.eventDetails.formattedDates),1)):T("",!0),s.raceData.eventDetails.homepageUrl?(f(),p("div",zp,[o("a",{href:s.raceData.eventDetails.homepageUrl,target:"_blank",class:"btn btn-sm btn-success"}," Event Homepage ",8,Wp)])):T("",!0)])]),s.raceData.eventDetails.headerPhoto?(f(),p("div",Yp,[Xp,o("img",{src:s.raceData.eventDetails.headerPhoto,alt:"Header Photo",style:{"max-width":"100%","max-height":"200px"}},null,8,Jp)])):T("",!0)])])):(f(),p("div",Qp,qp))]),o("div",ev,[s.showHeaderContentEditor?(f(),p("div",ov,[o("div",rv,[nv,o("button",{type:"button",class:"btn btn-sm btn-success",onClick:e[11]||(e[11]=(...C)=>a.saveHeaderContent&&a.saveHeaderContent(...C))}," Save Header Content ")]),D(h,{modelValue:s.editedHeaderContent,"onUpdate:modelValue":e[12]||(e[12]=C=>s.editedHeaderContent=C),label:"Header Content",placeholder:"Enter additional content to display below the registration form header...","min-height":"200px"},null,8,["modelValue"]),s.raceData.headerContent?(f(),p("div",av,[o("div",iv,[lv,o("div",{innerHTML:s.raceData.headerContent},null,8,cv)])])):T("",!0)])):(f(),p("div",tv,[sv,o("button",{type:"button",class:"btn btn-sm btn-primary",onClick:e[10]||(e[10]=C=>s.showHeaderContentEditor=!0)},[D(c,{size:16,class:"me-1"}),M(" Add Header Content ")])]))]),o("div",dv,[o("div",uv,[mv,o("button",{type:"button",class:"btn btn-sm btn-primary",onClick:e[13]||(e[13]=C=>a.editProperty("waiver","editedWaiver",s.raceData.waiver?{...s.raceData.waiver}:null))}," Edit Waiver ")]),s.raceData.waiver&&s.raceData.waiver.text?(f(),p("div",hv,[o("div",fv,[o("span",pv,S(s.raceData.waiver.format==="html"?"HTML (Rich Text)":"Plain Text"),1),s.raceData.waiver.format!=="html"&&s.raceData.waiver.header?(f(),p("span",vv," Header: "+S(s.raceData.waiver.header),1)):T("",!0)]),o("div",gv,[yv,s.raceData.waiver.format==="html"?(f(),p("div",{key:0,innerHTML:s.raceData.waiver.text.substring(0,300)+(s.raceData.waiver.text.length>300?"...":"")},null,8,bv)):(f(),p("div",Cv,S(s.raceData.waiver.text.substring(0,300)+(s.raceData.waiver.text.length>300?"...":"")),1))])])):(f(),p("div",Sv,xv))]),o("div",_v,[o("div",Ev,[wv,o("button",{type:"button",class:"btn btn-sm btn-primary",onClick:e[14]||(e[14]=C=>a.editProperty("emailTemplate","editedEmailTemplate",s.raceData.emailTemplate||null))}," Edit Email Template ")]),s.raceData.emailTemplate?(f(),p("div",Pv,Ov)):(f(),p("div",Iv,Av)),Mv,o("div",Fv,[o("div",Nv,[o("div",Lv,[Uv,M(" "+S(a.renderedEmailPreview.subject),1)]),o("div",{innerHTML:a.renderedEmailPreview.body,style:{"font-size":"0.875rem"}},null,8,jv)])]),Vv,Hv])])],2),[[jt,s.activeTab==="content"]]),ae(o("div",{class:le(["tab-pane",{active:s.activeTab==="advanced",show:s.activeTab==="advanced"}])},[D(i,{type:"form",errors:s.formError,id:"race-advanced",onSubmit:a.saveRaceData,"submit-label":"Save Advanced Settings",modelValue:s.formInputData,"onUpdate:modelValue":e[15]||(e[15]=C=>s.formInputData=C)},{default:G(()=>{var C,O;return[Gv,D(i,{value:(C=s.raceData)==null?void 0:C.showPaytypeOnRoster,type:"checkbox",label:"Show Payment Type as stages on roster",name:"showPaytypeOnRoster"},null,8,["value"]),Bv,D(i,{value:s.raceData.couponsEnabled,type:"checkbox",label:"Enable Coupons",name:"couponsEnabled"},null,8,["value"]),D(i,{value:(O=s.raceData)==null?void 0:O.cashPaymentsEnabled,type:"checkbox",label:"Enable Cash payments on race day",name:"cashPaymentsEnabled"},null,8,["value"]),D(i,{value:s.raceData.disableAge,type:"checkbox",label:"Disable Birthdate requirement",name:"disableAge"},null,8,["value"]),s.raceData.series?(f(),p("div",Kv,[D(i,{value:s.raceData.disableSeriesRedirect,type:"checkbox",label:"Disable Series Redirect",name:"disableSeriesRedirect"},null,8,["value"]),zv])):(f(),q(i,{key:1,value:s.raceData.disableSeriesRedirect,type:"checkbox",label:"Disable Series Redirect",name:"disableSeriesRedirect"},null,8,["value"])),Wv,D(i,{value:s.raceData.isTestData,type:"checkbox",label:"Use Test payment integrations",name:"isTestData"},null,8,["value"]),D(i,{type:"group",name:"stripeMeta"},{default:G(()=>{var R,V;return[D(i,{value:(V=(R=s.raceData)==null?void 0:R.stripeMeta)==null?void 0:V.accountId,type:"text",name:"accountId",label:"Stripe Integration Account ID"},null,8,["value"])]}),_:1}),Yv,D(i,{value:s.raceData.archived,type:"checkbox",label:"Archive Race (will not be visible in admin race list)",name:"archived"},null,8,["value"])]}),_:1},8,["errors","onSubmit","modelValue"])],2),[[jt,s.activeTab==="advanced"]])])])]),(f(),q(_t,{to:"body"},[s.modalMode=="categories"?(f(),q(m,{key:0,show:s.showModal,categories:s.editedCategories,payTypes:a.paymentOptions,seriesId:s.raceData.series,onClose:a.closeModal,onSave:a.saveProperty},null,8,["show","categories","payTypes","seriesId","onClose","onSave"])):T("",!0),s.modalMode=="paymentOptions"?(f(),q(u,{key:1,paymentOptions:s.editedPaymentOptions,show:s.showModal,onClose:a.closeModal,onSave:a.saveProperty},null,8,["paymentOptions","show","onClose","onSave"])):T("",!0),s.modalMode=="coupons"?(f(),q(v,{key:2,coupons:s.editedCoupons,show:s.showModal,onClose:a.closeModal,onSave:a.saveProperty},null,8,["coupons","show","onClose","onSave"])):T("",!0),s.modalMode=="optionalpurchases"?(f(),q(g,{key:3,optionalPurchases:s.editedOptionalPurchases,show:s.showModal,onClose:a.closeModal,onSave:a.saveProperty},null,8,["optionalPurchases","show","onClose","onSave"])):T("",!0),s.modalMode=="waiver"?(f(),q(y,{key:4,waiver:s.editedWaiver,show:s.showModal,onClose:a.closeModal,onSave:a.saveProperty},null,8,["waiver","show","onClose","onSave"])):T("",!0),s.modalMode=="eventDetails"?(f(),q(b,{key:5,eventDetails:s.editedEventDetails,show:s.showModal,onClose:a.closeModal,onSave:a.saveProperty},null,8,["eventDetails","show","onClose","onSave"])):T("",!0),s.modalMode=="emailTemplate"?(f(),q(x,{key:6,emailTemplate:s.editedEmailTemplate,raceData:s.raceData,show:s.showModal,onClose:a.closeModal,onSave:a.saveProperty},null,8,["emailTemplate","raceData","show","onClose","onSave"])):T("",!0)]))]))]))])}const Jv=ge(ef,[["render",Xv]]);const Qv={components:{ModalComponent:Xe,RacerFormComponent:Mo,Grid:no},data(){return{categories:{},loading:!1,error:null,formError:[],formInputData:{},data:{},racerToEdit:null,showModal:!1,filterKey:"",filterUnpaid:!1,filterNoBib:!1,filterCats:"all",filterSimilar:!0}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{dollas(t){return t.toLocaleString("en-US",{style:"currency",currency:"USD"})},fetchData(){this.error=null,this.loading=!0,this.$route.params.raceid&&this.$route.params.series&&Z(`/api/racers/series/${this.$route.params.series}`).then(({data:t})=>{console.log(t),this.data={registeredRacers:t.racers,regCategories:t.regCategories,races:t.races},this.loading=!1,this.error=""}).catch(t=>{this.loading=!1,this.error=t.toString(),console.error(t)}),this.error="invalid URL"},catName(t){let e=X.find(this.data.regCategories,{id:t});return e?e.catdispname:""},createReg(){this.racerToEdit={paytype:"cash",status:"unpaid",raceid:this.$route.params.raceid},this.showModal=!0},editRacer(t){let e=X.clone(X.find(this.data.registeredRacers,{paymentId:t}));e?(this.racerToEdit=e,this.showModal=!0):alert("no payment id found for racer")},racerUpdated(){this.racerToEdit=null,this.showModal=!1,this.fetchData()},capitalize(t){return X.capitalize(t)},closeModal(){this.showModal=!1,X.defer(()=>{document.querySelector("#racerFilterTxtInput").focus()})},resetFilters(){this.filterKey="",this.filterUnpaid=!1,this.filterNoBib=!1,this.filterCats="all"}},computed:{loaded(){return!!this.data},sortedCats(){let t={all:"All Categories"};return X.forEach(X.orderBy(this.data.regCategories,"disporder"),e=>{t[e.id]=e.catdispname}),t},filteredRacers(){const t=this.filterKey&&this.filterKey.toLowerCase();let e=this.data.registeredRacers;if(this.filterSimilar){let n=[];return X.forEach(this.data.races,(l,s)=>{console.log(l);let a=X.filter(e,{raceid:l});X.forEach(a,(r,d)=>{X.forEach(X.filter(e,{raceid:this.data.races[s+1]}),i=>{(r.first_name.toLowerCase()===i.first_name.toLowerCase()||r.last_name.toLowerCase()===i.last_name.toLowerCase())&&(X.includes(n,r)||n.push(r),X.includes(n,i)||n.push(i))})})}),X.sortBy(n,[function(l){return l.last_name.toLowerCase()}])}return(t.length||this.filterUnpaid||this.filterCats!=="all"||this.filterNoBib)&&(e=e.filter(n=>this.filterUnpaid&&n.status!=="unpaid"||this.filterNoBib&&n.bibNumber||this.filterCats!="all"&&n.category!=this.filterCats?!1:["first_name","last_name","bibNumber"].some(l=>String(n[l]).toLowerCase().indexOf(t)>-1))),X.sortBy(e,[function(n){return n.last_name.toLowerCase()}])}}},Zv={key:0,class:"loading"},qv={key:1},eg={key:0,class:"error"},tg={key:1,class:"container-fluid"},sg={class:"racer-controls d-flex flex-row justify-content-between flex-wrap align-items-top pt-3 pb-2 mb-3 p-2 border-bottom"},og={class:"p-2"},rg={class:"flex-grow-1 p-2"},ng={class:"d-flex flex-row search-checks"},ag={class:"d-flex flex-grow-1 justify-content-between pt-4"},ig={class:"table-responsive"},lg={class:"table table-striped table-sm"},cg=o("th",{scope:"col"},"First Name",-1),dg=o("th",{scope:"col"},"Last Name",-1),ug=o("th",{scope:"col"},"Email",-1),mg=o("th",{scope:"col"},"Category",-1),hg=o("th",{scope:"col"},"Bib Number",-1),fg=o("th",{scope:"col"},"Paytype",-1),pg=o("th",{scope:"col"},"EventName",-1),vg={scope:"col"},gg=["onClick"],yg={key:2},bg=o("div",{class:"text-center"},[o("h2",{class:"mt-5"},"Race not available for registration...")],-1),Cg=[bg];function Sg(t,e,n,l,s,a){const r=$("FormKit"),d=$("RacerFormComponent"),i=$("modal-component");return s.loading?(f(),p("div",Zv,"Loading...")):(f(),p("div",qv,[s.error?(f(),p("div",eg,S(s.error),1)):T("",!0),a.loaded?(f(),p("div",tg,[o("div",sg,[o("div",og,[D(r,{id:"racerFilterTxtInput",type:"text",name:"search",label:"Search:",help:"search in first, last or bib number",delay:300,modelValue:s.filterKey,"onUpdate:modelValue":e[0]||(e[0]=c=>s.filterKey=c)},null,8,["modelValue"])]),o("div",rg,[D(r,{type:"select",name:"categories",label:"Filter by Category",options:a.sortedCats,modelValue:s.filterCats,"onUpdate:modelValue":e[1]||(e[1]=c=>s.filterCats=c)},null,8,["options","modelValue"]),o("div",ng,[D(r,{type:"checkbox",name:"unpaid",label:"Unpaid Only",modelValue:s.filterUnpaid,"onUpdate:modelValue":e[2]||(e[2]=c=>s.filterUnpaid=c)},null,8,["modelValue"]),D(r,{type:"checkbox",name:"noBib",label:"No Bib Only",modelValue:s.filterNoBib,"onUpdate:modelValue":e[3]||(e[3]=c=>s.filterNoBib=c)},null,8,["modelValue"]),D(r,{type:"checkbox",name:"duplicates",label:"Duplicates",modelValue:s.filterSimilar,"onUpdate:modelValue":e[4]||(e[4]=c=>s.filterSimilar=c)},null,8,["modelValue"])])]),o("div",ag,[o("a",{class:"btn btn-primary align-self-start",onClick:e[5]||(e[5]=(...c)=>a.resetFilters&&a.resetFilters(...c))},"Reset Filters")])]),o("div",ig,[o("table",lg,[o("thead",null,[o("tr",null,[cg,dg,ug,mg,hg,fg,pg,o("th",vg,[o("strong",null,S(a.filteredRacers.length)+" Found",1)])])]),o("tbody",null,[(f(!0),p(te,null,de(a.filteredRacers,(c,h)=>(f(),p("tr",{key:h},[o("td",null,S(c.first_name),1),o("td",null,S(c.last_name),1),o("td",null,S(c.email),1),o("td",null,S(a.catName(c.category)),1),o("td",null,S(c.bibNumber),1),o("td",null,S(c.paytype),1),o("td",null,S(c.eventDisplayName),1),o("td",null,[o("div",{class:"btn btn-sm btn-outline-secondary",onClick:m=>a.editRacer(c.paymentId)},S("edit"),8,gg)])]))),128))])]),(f(),q(_t,{to:"body"},[D(i,{show:s.showModal,onClose:a.closeModal},{body:G(()=>[D(d,{onSaved:a.racerUpdated,racerData:s.racerToEdit,categories:s.data.regCategories,payments:s.data.paymentOptions,formMode:"edit",series:s.data.series},null,8,["onSaved","racerData","categories","payments","series"])]),_:1},8,["show","onClose"])]))])])):(f(),p("div",yg,Cg))]))}const Dg=ge(Qv,[["render",Sg]]);const xg={components:{Grid:no},data(){return{categories:{},loading:!1,error:null,data:{},showModal:!1,filterKey:"",filterUnpaid:!1,filterNoBib:!1,filterCats:"all"}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{fetchData(){this.error=null,this.loading=!0,this.$route.params.raceid&&Z(`/api/racers/race/${this.$route.params.raceid}`).then(t=>{this.data=t.data,this.loading=!1}).catch(t=>{this.loading=!1,this.error=t.toString(),console.error(t)})},resetFilters(){this.filterKey="",this.filterUnpaid=!1,this.filterNoBib=!1,this.filterCats="all"},optionalPurchases(t){if(!t)return"";let e="",n=[],l=Object.keys(t).filter(s=>s.split("-").length==1);return l.length&&l.forEach(s=>{if(t[s+"-option"])return n.push(`${this.capitalize(s)}: ${t[s+"-option"]}`);n.push(this.capitalize(s))}),e=n.join(", "),e},capitalize(t){return X.capitalize(t)}},computed:{loaded(){return!!this.data},sortedCats(){let t={all:"All Categories"};return X.forEach(X.orderBy(this.data.regCategories,"disporder"),e=>{t[e.id]=e.catdispname}),t},filteredRacers(){const t=this.filterKey&&this.filterKey.toLowerCase();let e=this.data.registeredRacers.filter(n=>n.optionalPurchases&&Object.keys(n.optionalPurchases).length>0);return(t.length||this.filterUnpaid||this.filterCats!=="all"||this.filterNoBib)&&(e=e.filter(n=>this.filterUnpaid&&n.status!=="unpaid"||this.filterNoBib&&n.bibNumber||this.filterCats!="all"&&n.category!=this.filterCats?!1:["first_name","last_name","bibNumber"].some(l=>String(n[l]).toLowerCase().indexOf(t)>-1))),X.sortBy(e,[function(n){return n.last_name.toLowerCase()}])}}},_g={key:0,class:"loading"},Eg={key:1},wg={key:0,class:"error"},Pg={key:1,class:"container-fluid"},Tg={class:"d-flex flex-row justify-content-center"},Rg={class:"p-2"},Og={class:"racer-controls d-flex flex-row justify-content-between flex-wrap align-items-top pb-2 mb-3 border-bottom"},Ig={class:"p-2"},kg={class:"flex-grow-1 p-2"},$g={class:"d-flex flex-row search-checks"},Ag={class:"d-flex flex-grow-1 justify-content-between p-2 pt-4"},Mg={class:"table-responsive"},Fg={class:"table table-striped table-sm"},Ng=o("th",{scope:"col"},"First Name",-1),Lg=o("th",{scope:"col"},"Last Name",-1),Ug=o("th",{scope:"col"},"Purchases",-1),jg={scope:"col"},Vg={key:2},Hg=o("div",{class:"text-center"},[o("h2",{class:"mt-5"},"Race not available for registration...")],-1),Gg=[Hg];function Bg(t,e,n,l,s,a){const r=$("FormKit");return s.loading?(f(),p("div",_g,"Loading...")):(f(),p("div",Eg,[s.error?(f(),p("div",wg,S(s.error),1)):T("",!0),a.loaded?(f(),p("div",Pg,[o("div",Tg,[o("div",Rg,[o("h3",null,S(s.data.displayName),1)])]),o("div",Og,[o("div",Ig,[D(r,{id:"racerFilterTxtInput",type:"text",name:"search",label:"Search:",help:"search in first, last or bib number",delay:300,modelValue:s.filterKey,"onUpdate:modelValue":e[0]||(e[0]=d=>s.filterKey=d)},null,8,["modelValue"])]),o("div",kg,[D(r,{type:"select",name:"categories",label:"Filter by Category",options:a.sortedCats,modelValue:s.filterCats,"onUpdate:modelValue":e[1]||(e[1]=d=>s.filterCats=d)},null,8,["options","modelValue"]),o("div",$g,[D(r,{type:"checkbox",name:"unpaid",label:"Unpaid Only",modelValue:s.filterUnpaid,"onUpdate:modelValue":e[2]||(e[2]=d=>s.filterUnpaid=d)},null,8,["modelValue"]),D(r,{type:"checkbox",name:"noBib",label:"No Bib Only",modelValue:s.filterNoBib,"onUpdate:modelValue":e[3]||(e[3]=d=>s.filterNoBib=d)},null,8,["modelValue"])])]),o("div",Ag,[o("a",{class:"btn btn-primary align-self-start",onClick:e[4]||(e[4]=(...d)=>a.resetFilters&&a.resetFilters(...d))},"Reset Filters")])]),o("div",Mg,[o("table",Fg,[o("thead",null,[o("tr",null,[Ng,Lg,Ug,o("th",jg,[o("strong",null,S(a.filteredRacers.length)+" Found",1)])])]),o("tbody",null,[(f(!0),p(te,null,de(a.filteredRacers,(d,i)=>(f(),p("tr",{key:i},[o("td",null,S(d.first_name),1),o("td",null,S(d.last_name),1),o("td",null,S(a.optionalPurchases(d.optionalPurchases)),1),o("td",null,S(d.paytype),1)]))),128))])])])])):(f(),p("div",Vg,Gg))]))}const Kg=ge(xg,[["render",Bg]]),zg={props:["races"],components:{RouterView:ro},data(){return{count:0}},computed:{}},Wg={class:"container-fluid"},Yg={class:"nav nav-tabs"},Xg={class:"nav-item"},Jg={class:"nav-item"},Qg={class:"nav-item"};function Zg(t,e,n,l,s,a){const r=$("RouterLink"),d=$("RouterView");return f(),p("div",Wg,[o("ul",Yg,[o("li",Xg,[D(r,{class:le(["nav-link",{active:t.$route.name=="edit-race"}]),to:{name:"edit-race"}},{default:G(()=>[M(" Event Settings ")]),_:1},8,["class"])]),o("li",Jg,[D(r,{class:le(["nav-link",{active:t.$route.name=="edit-racers"}]),to:{name:"edit-racers"}},{default:G(()=>[M(" Event Registrations ")]),_:1},8,["class"])]),o("li",Qg,[D(r,{class:le(["nav-link",{active:t.$route.name=="racer-purchases"}]),to:{name:"racer-purchases"}},{default:G(()=>[M(" Extra Purchases ")]),_:1},8,["class"])])]),D(d)])}const qg=ge(zg,[["render",Zg]]);const ey={components:{},props:["raceData"],emits:["save","close"],data(){return{formError:[],formInputData:{}}},mounted(){},computed:{eventDate(){return dt(this.raceData.eventDate).format("YYYY-MM-DDTHH:mm")},regOpenDate(){return dt(this.raceData.regOpenDate).format("YYYY-MM-DDTHH:mm")},timeToOpen(){var t;return dt().to((t=this.formInputData.eventDetails)==null?void 0:t.regOpenDate)},timeToClose(){var t;return dt().to((t=this.formInputData.eventDetails)==null?void 0:t.regCloseDate)}},methods:{submitHandler(){this.formInputData.raceid=this.formatNameToId(this.formInputData.displayName),this.$emit("save",this.formInputData)},formatNameToId(t){return t.replace(/\s+/g,"_").toLowerCase().replace("+","_plus_").replace("-","_minus_").replace(/\W/g,"")}}},ty={class:"edit-categories-form"},sy={class:"modal-footer-buttons mt-3"};function oy(t,e,n,l,s,a){const r=$("FormKit");return f(),p(te,null,[o("div",ty,[D(r,{type:"form",modelValue:s.formInputData,"onUpdate:modelValue":e[0]||(e[0]=d=>s.formInputData=d),id:"race-clone-form",label:"Race Information",validation:"required",actions:!1},{default:G(()=>{var d,i;return[D(r,{value:(d=n.raceData)==null?void 0:d.displayName,type:"text",name:"displayName",label:"Event Name"},null,8,["value"]),D(r,{value:(i=n.raceData)==null?void 0:i.contactEmail,type:"text",name:"contactEmail",label:"Contact Email"},null,8,["value"]),D(r,{value:a.eventDate,type:"datetime-local",name:"eventDate",label:"Date"},null,8,["value"]),D(r,{type:"group",name:"eventDetails"},{default:G(()=>{var c,h,m,u,v,g,y,b,x,w,k,C,O,R,V,B;return[D(r,{value:(h=(c=n.raceData)==null?void 0:c.eventDetails)==null?void 0:h.name,type:"text",name:"name",label:"Header Event Name"},null,8,["value"]),D(r,{value:(u=(m=n.raceData)==null?void 0:m.eventDetails)==null?void 0:u.formattedDates,type:"text",name:"formattedDates",label:"Header Formatted dates"},null,8,["value"]),D(r,{value:(g=(v=n.raceData)==null?void 0:v.eventDetails)==null?void 0:g.tagline,type:"text",name:"tagline",label:"Header tagline text"},null,8,["value"]),D(r,{value:(b=(y=n.raceData)==null?void 0:y.eventDetails)==null?void 0:b.regOpenDate,type:"datetime-local",name:"regOpenDate",label:"Registration Open Date"},null,8,["value"]),o("p",null,"Registration Opens "+S(a.timeToOpen),1),D(r,{value:(w=(x=n.raceData)==null?void 0:x.eventDetails)==null?void 0:w.regCloseDate,type:"datetime-local",name:"regCloseDate",label:"Registration Close Date"},null,8,["value"]),o("p",null,"Registration Closes "+S(a.timeToClose),1),D(r,{value:(C=(k=n.raceData)==null?void 0:k.eventDetails)==null?void 0:C.logoUrl,type:"text",name:"logoUrl",label:"Logo URL"},null,8,["value"]),D(r,{value:(R=(O=n.raceData)==null?void 0:O.eventDetails)==null?void 0:R.headerPhoto,type:"text",name:"headerPhoto",label:"Header Photo URL"},null,8,["value"]),D(r,{value:(B=(V=n.raceData)==null?void 0:V.eventDetails)==null?void 0:B.homepageUrl,type:"text",name:"homepageUrl",label:"Home Page URL"},null,8,["value"]),D(r,{type:"group",name:"facebookShare"},{default:G(()=>{var I,L,H;return[D(r,{value:(H=(L=(I=n.raceData)==null?void 0:I.eventDetails)==null?void 0:L.facebookShare)==null?void 0:H.url,type:"text",name:"url",label:"FB Share URL"},null,8,["value"])]}),_:1})]}),_:1})]}),_:1},8,["modelValue"])]),o("div",sy,[o("button",{class:"btn btn-sm btn-primary px-5 mx-3",onClick:e[1]||(e[1]=(...d)=>a.submitHandler&&a.submitHandler(...d))},"Save"),o("button",{class:"btn btn-sm btn-danger px-3 mx-3",onClick:e[2]||(e[2]=d=>t.$emit("close"))},"Cancel")])],64)}const ry=ge(ey,[["render",oy]]);const ny={components:{RouterLink:us,Check:ao,Copy:ms,Pencil:$t,ModalComponent:Xe,CloneRaceComponent:ry},data(){return{loading:!1,modalMode:null,showModal:!1,raceToClone:{},error:null,seriesList:[]}},created(){this.fetchSeriesList(),this.$watch(()=>[this.$route.params,this.$route.query],()=>{this.fetchData()},{immediate:!0})},methods:{async fetchSeriesList(){try{const t=await Z("/api/series/");this.seriesList=t.data}catch(t){console.error("Error fetching series list:",t)}},fetchData(){if(this.error=null,this.loading=!0,this.$route){let t={};const e={};return this.$route.query.archived=="true"&&(e.archived=!0),this.$route.query.startDate&&(e.startDate=this.$route.query.startDate),this.$route.query.endDate&&(e.endDate=this.$route.query.endDate),Object.keys(e).length>0&&(t.params=e),Z("/api/races/",t).then(n=>{this.raceData=n.data,this.loading=!1}).catch(n=>{this.loading=!1,this.error=n.toString(),console.error(n)})}},createRaceClone(t){this.showModal=!0,this.modalMode="clone",this.raceToClone=X.omit(t,"series","seriesRaceNumber","archived")},async cloneRace(t){console.log("race to clone"),console.log(this.raceToClone.raceid),console.log(t.raceid),await Z.post(`/api/races/clone/${this.raceToClone.raceid}`,t).then(e=>{if(e.data)return console.log(t),this.closeModal(),console.log(e.data),this.fetchData()}).catch(e=>{this.formError=["Error submitting request"],console.log(e)})},closeModal(){this.showModal=!1,this.modalMode=null},getSeriesName(t){if(!t)return"";const e=this.seriesList.find(n=>n.seriesId===t||n.series===t);return e?e.displayName||e.name:t}},computed:{loaded(){return!!this.raceData},currentPeriod(){return this.$route.query.startDate&&this.$route.query.endDate?`${this.$route.query.startDate} to ${this.$route.query.endDate}`:"Recent & Upcoming"},filteredRaceData(){return this.raceData?this.$route.query.series?this.raceData.filter(t=>t.series===this.$route.query.series):this.raceData:[]},currentSeriesName(){if(!this.$route.query.series)return null;const t=this.seriesList.find(e=>e.seriesId===this.$route.query.series||e.series===this.$route.query.series);return t?t.displayName||t.name:this.$route.query.series},yearLinks(){const t=dt().year(),e=[];for(let n=0;n<4;n++){const l=t-n;e.push({year:l,label:l.toString(),startDate:`${l}-01-01`,endDate:`${l}-12-31`})}return e}}},ay={key:0,class:"loading"},iy={key:1},ly={key:0,class:"error"},cy={key:1},dy={class:"d-flex justify-content-between align-items-center mb-3"},uy={key:0,class:"badge bg-info ms-2"},my={class:"mb-3"},hy={class:"row"},fy={class:"col-md-8"},py={class:"btn-group",role:"group"},vy={class:"col-md-4"},gy=o("label",{for:"seriesFilter",class:"form-label small text-muted mb-1"},"Filter by Series:",-1),yy={class:"input-group input-group-sm"},by=["value"],Cy=o("option",{value:""},"All Races",-1),Sy=["value"],Dy={class:"table-responsive"},xy={class:"table table-striped table-hover table-sm"},_y=o("thead",null,[o("tr",null,[o("th",{scope:"col"},"Name"),o("th",{scope:"col"},"Series"),o("th",null,"Test Payments")])],-1),Ey=["href"],wy=["href"],Py=["href"],Ty=["href"],Ry=o("h5",null," Clone Race ",-1),Oy=o("div",null,null,-1),Iy={key:2},ky=o("div",{class:"text-center"},[o("h2",{class:"mt-5"},"Error loading races...")],-1),$y=[ky];function Ay(t,e,n,l,s,a){const r=$("Pencil"),d=$("RouterLink"),i=$("Check"),c=$("Copy"),h=$("CloneRaceComponent"),m=$("modal-component");return s.loading?(f(),p("div",ay,"Loading...")):(f(),p("div",iy,[s.error?(f(),p("div",ly,S(s.error),1)):T("",!0),a.loaded?(f(),p("div",cy,[o("div",dy,[o("h2",null,[M(" Active Races - "+S(a.currentPeriod)+" ",1),a.currentSeriesName?(f(),p("span",uy,[M(S(a.currentSeriesName)+" ",1),D(d,{to:{name:"edit-series",params:{seriesId:t.$route.query.series}},class:"text-white text-decoration-none ms-2",title:"Edit series"},{default:G(()=>[D(r,{size:16})]),_:1},8,["to"])])):T("",!0)])]),o("div",my,[o("div",hy,[o("div",fy,[o("div",py,[D(d,{to:{name:t.$route.name,query:{}},class:le(["btn btn-sm",t.$route.query.startDate?"btn-outline-primary":"btn-primary"])},{default:G(()=>[M(" Recent & Upcoming ")]),_:1},8,["to","class"]),(f(!0),p(te,null,de(a.yearLinks,u=>(f(),q(d,{key:u.year,to:{name:t.$route.name,query:{startDate:u.startDate,endDate:u.endDate}},class:le(["btn btn-sm",t.$route.query.startDate===u.startDate?"btn-primary":"btn-outline-primary"])},{default:G(()=>[M(S(u.label),1)]),_:2},1032,["to","class"]))),128))])]),o("div",vy,[gy,o("div",yy,[o("select",{id:"seriesFilter",class:"form-select form-select-sm",value:t.$route.query.series||"",onChange:e[0]||(e[0]=u=>t.$router.push({name:t.$route.name,query:{...t.$route.query,series:u.target.value||void 0}}))},[Cy,(f(!0),p(te,null,de(s.seriesList,u=>(f(),p("option",{key:u.seriesId||u.series,value:u.seriesId||u.series},S(u.displayName||u.name)+" ("+S(u.year)+") ",9,Sy))),128))],40,by),t.$route.query.series?(f(),p("button",{key:0,class:"btn btn-outline-secondary",type:"button",onClick:e[1]||(e[1]=u=>t.$router.push({name:t.$route.name,query:{...t.$route.query,series:void 0}})),title:"Clear filter"},"  ")):T("",!0)])])])]),o("div",Dy,[o("table",xy,[_y,o("tbody",null,[(f(!0),p(te,null,de(a.filteredRaceData,(u,v)=>(f(),p("tr",{key:v},[o("td",null,[D(d,{to:{name:"edit-racers",params:{raceid:u.raceid}}},{default:G(()=>[M(S(u.displayName),1)]),_:2},1032,["to"])]),o("td",null,S(a.getSeriesName(u.series)),1),o("td",null,[u.isTestData?(f(),q(i,{key:0,color:"orange"})):T("",!0)]),o("td",null,[o("a",{href:`/#/register/${u.raceid}`},"Goto Reg Form",8,Ey)]),o("td",null,[D(c,{class:"mx-3",color:"black",onClick:g=>a.createRaceClone(u)},null,8,["onClick"]),o("a",{class:"btn btn-sm btn-secondary mx-1",href:`/api/racers/race/${u.raceid}/export-contact`},"Contact List",8,wy),o("a",{class:"btn btn-sm btn-secondary mx-1",href:`/api/racers/race/${u.raceid}/export`},"export",8,Py),o("a",{class:"btn btn-sm btn-secondary mx-1",href:`/api/racers/race/${u.raceid}/export?assignedBibsOnly=true`},"webscorer export",8,Ty)])]))),128))])]),(f(),q(_t,{to:"body"},[s.modalMode=="clone"?(f(),q(m,{key:0,show:s.showModal,onClose:a.closeModal},{header:G(()=>[Ry]),body:G(()=>[D(h,{raceData:s.raceToClone,onClose:a.closeModal,onSave:a.cloneRace},null,8,["raceData","onClose","onSave"])]),footer:G(()=>[Oy]),_:1},8,["show","onClose"])):T("",!0)]))])])):(f(),p("div",Iy,$y))]))}const My=ge(ny,[["render",Ay]]),Fy={components:{RouterView:ro},data(){return{count:0}},computed:{}},Ny={class:"container-fluid"},Ly=o("ul",{class:"nav nav-tabs"},null,-1);function Uy(t,e,n,l,s,a){const r=$("RouterView");return f(),p("div",Ny,[Ly,D(r)])}const jy=ge(Fy,[["render",Uy]]);const Vy={components:{RouterLink:us,Check:ao},data(){return{loading:!1,error:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{fetchData(){if(this.error=null,this.loading=!0,this.$route)return Z("/api/results/").then(t=>{this.results=t.data,this.loading=!1}).catch(t=>{this.loading=!1,this.error=t.toString(),console.error(t)})}},computed:{loaded(){return!!this.results}}},Hy={key:0,class:"loading"},Gy={key:1},By={key:0,class:"error"},Ky={key:1},zy=o("h2",null,"Race Result Uploads",-1),Wy={class:"table-responsive"},Yy={class:"table table-striped table-hover table-sm"},Xy=o("thead",null,[o("tr",null,[o("th",{scope:"col"},"Event Name"),o("th",{scope:"col"},"Series Points Display Name"),o("th",{scope:"col"},"Formatted Date"),o("th",{scope:"col"},"series ID"),o("th",{scope:"col"},"Finalized")])],-1),Jy=["href"],Qy=o("td",null,null,-1),Zy={key:2},qy=o("div",{class:"text-center"},[o("h2",{class:"mt-5"},"Error loading results...")],-1),eb=[qy];function tb(t,e,n,l,s,a){const r=$("Check"),d=$("RouterLink");return s.loading?(f(),p("div",Hy,"Loading...")):(f(),p("div",Gy,[s.error?(f(),p("div",By,S(s.error),1)):T("",!0),a.loaded?(f(),p("div",Ky,[zy,o("div",Wy,[o("table",Yy,[Xy,o("tbody",null,[(f(!0),p(te,null,de(t.results,(i,c)=>(f(),p("tr",{key:c},[o("td",null,S(i.eventName),1),o("td",null,S(i.shortName),1),o("td",null,S(i.formattedStartDate),1),o("td",null,S(i.series),1),o("td",null,[i.final?(f(),q(r,{key:0,color:"red"})):T("",!0)]),o("td",null,[D(d,{to:{name:"edit-result",params:{resultid:i.raceid}}},{default:G(()=>[M("Edit")]),_:2},1032,["to"])]),o("td",null,[o("a",{href:`/#/result/${i.raceid}`,target:"_blank"},"View Output",8,Jy)]),Qy]))),128))])])])])):(f(),p("div",Zy,eb))]))}const sb=ge(Vy,[["render",tb]]);const ob={components:{},data(){return{categories:{},loading:!1,error:null,formError:[],formInputData:{},raceData:{}}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{dollas(t){return typeof t=="string"&&(t=parseInt(t)),t.toLocaleString("en-US",{style:"currency",currency:"USD"})},fetchData(){if(this.error=null,this.loading=!0,this.$route.params.resultid)return Z(`/api/results/${this.$route.params.resultid}`).then(t=>{this.raceData=t.data,this.loading=!1}).catch(t=>{this.raceData={},this.loading=!1,this.error=t.toString(),console.error(t)})},editCategories(){},editPaytypes(){},async saveRaceData(t){await Z.patch(`/api/results/${this.raceData._id}`,this.formInputData).then(e=>{if(e.data)return console.log(e.data),this.fetchData()}).catch(e=>{this.formError=["Error submitting request"],console.log(e)})}},computed:{loaded(){return!!this.raceData}}},rb={class:"container"},nb={key:0,class:"loading"},ab={key:1},ib={key:0,class:"error"},lb={key:1},cb={class:"my-3"},db=["href"],ub={class:"row"},mb={class:"col-md-6"},hb={key:2},fb=o("div",{class:"text-center"},[o("h2",{class:"mt-5"},"Result upload not found...")],-1),pb=[fb];function vb(t,e,n,l,s,a){const r=$("FormKit");return f(),p("div",rb,[s.loading?(f(),p("div",nb,"Loading...")):(f(),p("div",ab,[s.error?(f(),p("div",ib,S(s.error),1)):T("",!0),s.raceData.raceid?(f(),p("div",lb,[o("div",cb,[o("a",{href:`/#/result/${s.raceData.raceid}`},"View Result",8,db)]),o("div",ub,[o("div",mb,[D(r,{type:"form",errors:s.formError,id:"race-settings",onSubmit:a.saveRaceData,"submit-label":"Save",modelValue:s.formInputData,"onUpdate:modelValue":e[0]||(e[0]=d=>s.formInputData=d)},{default:G(()=>{var d,i,c,h,m,u;return[D(r,{value:(d=s.raceData)==null?void 0:d.eventName,type:"text",name:"eventName",label:"Event Name"},null,8,["value"]),D(r,{value:(i=s.raceData)==null?void 0:i.shortName,type:"text",name:"shortName",label:"Short Name for series points column header"},null,8,["value"]),D(r,{value:(c=s.raceData)==null?void 0:c.formattedStartDate,type:"text",name:"formattedStartDate",label:"Display Date"},null,8,["value"]),D(r,{value:(h=s.raceData)==null?void 0:h.series,type:"text",name:"series",label:"series"},null,8,["value"]),D(r,{value:(m=s.raceData)==null?void 0:m.showMillis,type:"checkbox",label:"Show milliseconds on times",name:"showMillis"},null,8,["value"]),D(r,{value:(u=s.raceData)==null?void 0:u.final,type:"checkbox",label:"Finalized - results cannot be updated via upload",name:"final"},null,8,["value"])]}),_:1},8,["errors","onSubmit","modelValue"])])])])):(f(),p("div",hb,pb))]))])}const gb=ge(ob,[["render",vb]]);const yb={components:{RouterLink:us,Check:ao},data(){return{seriesOptions:!1,loading:!1,error:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{getSeriesResult(t){return X.find(this.results,{series:t})},fetchData(){if(this.error=null,this.loading=!0,this.$route)return Z("/api/results/series/").then(t=>(this.results=t.data,this.loading=!1,this.getRaceResults())).catch(t=>{this.loading=!1,this.error=t.toString(),console.error(t)})},getRaceResults(){return Z("/api/results/").then(t=>{let e={};t.data.forEach(n=>{n.series&&(this.getSeriesResult(n.series)||(e[n.series]?e[n.series]+=1:e[n.series]=1))}),this.seriesOptions=e}).catch(t=>{console.error(t)})},async generateSeriesPoints(t){await Z.post(`/api/results/series/${t}/generate`).then(e=>{if(e.data)return console.log(e.data),this.fetchData()})}},computed:{loaded(){return!!this.seriesOptions}}},bb={key:0,class:"loading"},Cb={key:1},Sb={key:0,class:"error"},Db={key:1},xb=o("div",{class:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom"},[o("h2",null,"Series Points Listings"),o("div",{class:"btn-toolbar mb-2 mb-md-0"})],-1),_b={key:0,class:"table-responsive"},Eb={class:"table table-striped table-hover table-sm"},wb=o("thead",null,[o("tr",null,[o("th",{scope:"col"},"series ID"),o("th",{scope:"col"},"Display Name"),o("th",{scope:"col"},"Published")])],-1),Pb=["href"],Tb=["onClick"],Rb={key:1},Ob=o("h4",null,"No series points calculations found",-1),Ib=[Ob],kb=o("h4",null,"Races without points Listings",-1),$b={key:2,class:"table-responsive"},Ab={class:"table table-striped table-hover table-sm"},Mb=o("thead",null,[o("tr",null,[o("th",{scope:"col"},"series ID"),o("th",{scope:"col"},"number of results")])],-1),Fb=["onClick"],Nb={key:2},Lb=o("div",{class:"text-center"},[o("h2",{class:"mt-5"},"Error loading results...")],-1),Ub=[Lb];function jb(t,e,n,l,s,a){const r=$("Check"),d=$("RouterLink");return s.loading?(f(),p("div",bb,"Loading...")):(f(),p("div",Cb,[s.error?(f(),p("div",Sb,S(s.error),1)):T("",!0),a.loaded?(f(),p("div",Db,[xb,Object.keys(t.results).length?(f(),p("div",_b,[o("table",Eb,[wb,o("tbody",null,[(f(!0),p(te,null,de(t.results,(i,c)=>(f(),p("tr",null,[o("td",null,S(i.series),1),o("td",null,S(i.eventName),1),o("td",null,[i.published?(f(),q(r,{key:0,color:"green"})):T("",!0)]),o("td",null,[D(d,{to:{name:"edit-series-result",params:{series:i._id}}},{default:G(()=>[M("Edit")]),_:2},1032,["to"])]),o("td",null,[o("a",{href:`/#/result/series/${i.series}`,target:"_blank"},"view series points",8,Pb)]),o("td",null,[i.final?T("",!0):(f(),p("button",{key:0,type:"button",class:"btn btn-sm btn-primary",onClick:h=>a.generateSeriesPoints(i.series)}," Update Series Points ",8,Tb))])]))),256))])])])):(f(),p("div",Rb,Ib)),kb,Object.keys(s.seriesOptions).length?(f(),p("div",$b,[o("table",Ab,[Mb,o("tbody",null,[(f(!0),p(te,null,de(s.seriesOptions,(i,c)=>(f(),p("tr",null,[o("td",null,S(c),1),o("td",null,S(i),1),o("td",null,[o("button",{type:"button",class:"btn btn-sm btn-primary",onClick:h=>a.generateSeriesPoints(c)}," Create Series Points ",8,Fb)])]))),256))])])])):T("",!0)])):(f(),p("div",Nb,Ub))]))}const Vb=ge(yb,[["render",jb]]);const Hb={props:["racerData","series"],emits:["saved"],data(){return{formError:[],submitted:!1,formInputData:{}}},mounted(){this.formInputData=this.racerData},computed:{},methods:{async submitHandler(t){console.log(t);let e;return e=Z.post(`/api/team-comp/racers/?series=${this.series}`,t),await e.then(n=>{if(n.data)return this.submitted=!0,console.log("response data"),console.log(n.data),new Promise(l=>setTimeout(()=>{this.$emit("saved"),l()},100))}).catch(n=>{this.formError=["Error submitting request"],console.log(n)})}}},Gb=o("div",{class:"modal-header"},[o("h5",null," Team Competition Info ")],-1),Bb={class:"edit-racer-form"},Kb={class:"double"};function zb(t,e,n,l,s,a){const r=$("FormKit");return f(),p(te,null,[Gb,o("div",Bb,[D(r,{type:"form",id:"admin-registration",modelValue:s.formInputData,"onUpdate:modelValue":e[0]||(e[0]=d=>s.formInputData=d),"form-class":s.submitted?"hide":"show",errors:s.formError,"submit-label":"Save",onSubmit:a.submitHandler},{default:G(()=>[o("div",Kb,[D(r,{type:"number",name:"Bib",label:"Bib Number"}),D(r,{type:"text",name:"Name",label:"Name",validation:"required"}),D(r,{type:"text",name:"Sponsor",label:"Team Name"}),D(r,{type:"text",name:"Cat",label:"Category"})])]),_:1},8,["modelValue","form-class","errors","onSubmit"])])],64)}const Wb=ge(Hb,[["render",zb]]);const Yb={components:{ModalComponent:Xe,TeamRacerFormComponent:Wb},data(){return{loading:!1,error:null,final:!1,filterKey:"",formError:[],formInputData:{},teamRacerToAdd:{},data:{},showModal:!1}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData(),this.fetchTeamCompRacers()},{immediate:!0})},methods:{dollas(t){return typeof t=="string"&&(t=parseInt(t)),t.toLocaleString("en-US",{style:"currency",currency:"USD"})},fetchData(){if(this.error=null,this.loading=!0,this.$route.params.series)return Z(`/api/results/series/${this.$route.params.series}`).then(t=>{this.data=t.data,this.final=t.data.final,this.loading=!1}).catch(t=>{this.loading=!1,this.error=t.toString(),console.error(t)})},fetchTeamCompRacers(){return Z(`/api/team-comp/racers/?series=${this.$route.params.series}`).then(t=>{this.teamRacers=t.data}).catch(t=>{this.loading=!1,this.error=t.toString(),console.error(t)})},async updateTeamCompRacer(t){console.log(t),this.teamRacerToAdd=t,this.showModal=!0},teamRacerUpdated(){this.teamRacerToAdd={},this.closeModal()},closeModal(){this.showModal=!1},async saveRaceData(t){await Z.patch(`/api/results/series/${this.data._id}`,t).then(e=>{if(e.data)return console.log(e.data),this.fetchData()}).catch(e=>{this.formError=["Error submitting request"],console.log(e)})}},computed:{loaded(){return!!this.raceData},hasTeamComp(){var t,e;return((e=(t=this.data)==null?void 0:t.teamCompDates)==null?void 0:e.length)>1},teamCompRacers(){var t;if(this.hasTeamComp){let e=[];return Object.keys((t=this.data)==null?void 0:t.categories).forEach(n=>{let l=this.data.categories[n],s=l.catdispname;l.results.forEach(a=>{let r={Name:a.Name,Bib:a.Bib,Cat:s,Sponsor:a.Sponsor};e.push(r)})}),this.filterKey&&(e=e.filter(n=>n.Name.toLowerCase().indexOf(this.filterKey.toLowerCase())>-1||n.Bib==parseInt(this.filterKey))),e}}}},Xb={class:"container"},Jb={key:0,class:"loading"},Qb={key:1},Zb={key:0,class:"error"},qb={key:1},e1={class:"my-3"},t1=["href"],s1={class:"row"},o1={class:"col-md-6"},r1={key:0,class:"col-md-6"},n1=o("h5",null,"Racers",-1),a1={class:"btn-toolbar mb-2 mb-md-0"},i1={class:"row"},l1={class:"col"},c1=["onClick"],d1={class:"col"},u1={class:"col"},m1={class:"col"},h1={key:2},f1=o("div",{class:"text-center"},[o("h2",{class:"mt-5"},"Series Points record not found...")],-1),p1=[f1];function v1(t,e,n,l,s,a){var c;const r=$("FormKit"),d=$("TeamRacerFormComponent"),i=$("modal-component");return f(),p("div",Xb,[s.loading?(f(),p("div",Jb,"Loading...")):(f(),p("div",Qb,[s.error?(f(),p("div",Zb,S(s.error),1)):T("",!0),(c=this.data)!=null&&c.series?(f(),p("div",qb,[o("div",e1,[o("a",{href:`/#/result/series/${s.data.series}`,target:"_blank"},"view series points",8,t1)]),o("div",s1,[o("div",o1,[D(r,{type:"form",errors:s.formError,id:"season-pts-form",onSubmit:a.saveRaceData,"submit-label":"Save",modelValue:s.formInputData,"onUpdate:modelValue":e[0]||(e[0]=h=>s.formInputData=h)},{default:G(()=>{var h,m,u,v;return[D(r,{value:(h=s.data)==null?void 0:h.eventName,type:"text",name:"eventName",label:"Event Name"},null,8,["value"]),D(r,{value:(m=s.data)==null?void 0:m.gromRaceDates,type:"text",name:"gromRaceDates",label:"Grom Race Dates"},null,8,["value"]),D(r,{value:(u=s.data)==null?void 0:u.teamCompDates,type:"text",name:"teamCompDates",label:"Team Competition Race Dates"},null,8,["value"]),D(r,{value:s.final,type:"checkbox",label:"Finalized - don't allow updates",name:"final"},null,8,["value"]),D(r,{value:(v=s.data)==null?void 0:v.published,type:"checkbox",label:"Published - will show on main index",name:"published"},null,8,["value"])]}),_:1},8,["errors","onSubmit","modelValue"])]),a.hasTeamComp?(f(),p("div",r1,[n1,o("div",null,[o("div",a1,[D(r,{id:"racerFilterTxtInput",type:"text",name:"search",label:"Search:",help:"search in first, last, bib",delay:300,modelValue:s.filterKey,"onUpdate:modelValue":e[1]||(e[1]=h=>s.filterKey=h)},null,8,["modelValue"])])]),o("div",null,[(f(!0),p(te,null,de(a.teamCompRacers,h=>(f(),p("div",i1,[o("div",l1,[o("div",{class:"btn btn-sm btn-primary",onClick:m=>a.updateTeamCompRacer(h)},"Add",8,c1)]),o("div",d1,S(h.Name),1),o("div",u1,S(h.Bib),1),o("div",m1,S(h.Sponsor),1)]))),256))])])):T("",!0)]),(f(),q(_t,{to:"body"},[D(i,{show:s.showModal,onClose:a.closeModal},{body:G(()=>[D(d,{onSaved:a.teamRacerUpdated,racerData:s.teamRacerToAdd,series:s.data.series},null,8,["onSaved","racerData","series"])]),_:1},8,["show","onClose"])]))])):(f(),p("div",h1,p1))]))])}const g1=ge(Yb,[["render",v1]]);const y1={components:{RouterLink:us,Pencil:$t,Plus:co,ModalComponent:Xe},data(){return{loading:!1,seriesData:null,showModal:!1,modalMode:null,currentSeries:null,error:null}},created(){this.fetchData()},methods:{async fetchData(){this.error=null,this.loading=!0;try{const t=await Z("/api/series/");this.seriesData=t.data,this.loading=!1}catch(t){this.loading=!1,this.error=t.toString(),console.error(t)}},createNewSeries(){this.currentSeries={seriesId:"",name:"",displayName:"",year:new Date().getFullYear(),active:!0,description:""},this.modalMode="create",this.showModal=!0},editSeries(t){this.currentSeries=X.cloneDeep(t),this.modalMode="edit",this.showModal=!0},async saveSeries(){var t,e;try{this.modalMode==="create"?await Z.post("/api/series/",this.currentSeries):await Z.patch(`/api/series/${this.currentSeries.seriesId||this.currentSeries.series}`,this.currentSeries),this.closeModal(),await this.fetchData()}catch(n){console.error("Error saving series:",n),alert("Error saving series: "+(((e=(t=n.response)==null?void 0:t.data)==null?void 0:e.message)||n.message))}},closeModal(){this.showModal=!1,this.modalMode=null,this.currentSeries=null},getRaceCount(t){return""}},computed:{loaded(){return!!this.seriesData}}},qe=t=>(nt("data-v-22e12a9f"),t=t(),rt(),t),b1={key:0,class:"loading"},C1={key:1},S1={key:0,class:"error alert alert-danger"},D1={key:1},x1={class:"d-flex justify-content-between align-items-center mb-3"},_1=qe(()=>o("h2",null,"Series Management",-1)),E1={class:"table-responsive"},w1={class:"table table-striped table-hover table-sm"},P1=qe(()=>o("thead",null,[o("tr",null,[o("th",{scope:"col"},"Display Name"),o("th",{scope:"col"},"Year"),o("th",{scope:"col"},"Season Pass"),o("th",{scope:"col"},"Actions")])],-1)),T1={key:0,class:"badge bg-info"},R1={key:1,class:"text-muted"},O1={key:2},I1=qe(()=>o("div",{class:"text-center"},[o("h2",{class:"mt-5"},"Error loading series...")],-1)),k1=[I1],$1={class:"mb-3"},A1=qe(()=>o("label",{for:"seriesId",class:"form-label"},"Series ID *",-1)),M1=["disabled"],F1=qe(()=>o("small",{class:"form-text text-muted"}," Unique identifier (lowercase, underscores only). Cannot be changed after creation. ",-1)),N1={class:"mb-3"},L1=qe(()=>o("label",{for:"name",class:"form-label"},"Name *",-1)),U1={class:"mb-3"},j1=qe(()=>o("label",{for:"displayName",class:"form-label"},"Display Name *",-1)),V1={class:"mb-3"},H1=qe(()=>o("label",{for:"year",class:"form-label"},"Year *",-1)),G1={class:"mb-3"},B1=qe(()=>o("label",{for:"description",class:"form-label"},"Description",-1)),K1={class:"mb-3 form-check"},z1=qe(()=>o("label",{class:"form-check-label",for:"active"}," Active (series is currently running) ",-1)),W1={key:0,class:"alert alert-info"},Y1=qe(()=>o("strong",null,"Season Pass Pricing:",-1)),X1=qe(()=>o("br",null,null,-1)),J1=qe(()=>o("small",{class:"text-muted"}," Advanced pricing configuration coming soon. Use API for now. ",-1));function Q1(t,e,n,l,s,a){const r=$("Plus"),d=$("Pencil"),i=$("RouterLink"),c=$("modal-component");return f(),p(te,null,[s.loading?(f(),p("div",b1,"Loading...")):(f(),p("div",C1,[s.error?(f(),p("div",S1,S(s.error),1)):T("",!0),a.loaded?(f(),p("div",D1,[o("div",x1,[_1,o("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=(...h)=>a.createNewSeries&&a.createNewSeries(...h))},[D(r,{size:16,class:"me-1"}),M(" New Series ")])]),o("div",E1,[o("table",w1,[P1,o("tbody",null,[(f(!0),p(te,null,de(s.seriesData,h=>{var m;return f(),p("tr",{key:h.seriesId||h.series},[o("td",null,S(h.displayName||h.name),1),o("td",null,S(h.year),1),o("td",null,[h.seasonPassPricing?(f(),p("span",T1,S(((m=h.seasonPassPricing.categoryGroups)==null?void 0:m.length)||0)+" groups ",1)):(f(),p("span",R1,""))]),o("td",null,[D(i,{to:{name:"edit-series",params:{seriesId:h.seriesId||h.series}},class:"btn btn-sm btn-outline-primary me-2",title:"Edit series"},{default:G(()=>[D(d,{size:14})]),_:2},1032,["to"]),D(i,{to:{name:"races",query:{series:h.seriesId||h.series}},class:"btn btn-sm btn-outline-secondary"},{default:G(()=>[M(" View Races ")]),_:2},1032,["to"])])])}),128))])])])])):(f(),p("div",O1,k1))])),(f(),q(_t,{to:"body"},[D(c,{show:s.showModal,onClose:a.closeModal},{header:G(()=>[o("h5",null,S(s.modalMode==="create"?"Create New Series":"Edit Series"),1)]),body:G(()=>{var h;return[s.currentSeries?(f(),p("form",{key:0,onSubmit:e[7]||(e[7]=st((...m)=>a.saveSeries&&a.saveSeries(...m),["prevent"]))},[o("div",$1,[A1,ae(o("input",{type:"text",class:"form-control",id:"seriesId","onUpdate:modelValue":e[1]||(e[1]=m=>s.currentSeries.seriesId=m),disabled:s.modalMode==="edit",required:"",placeholder:"e.g., bear_gravity_2026"},null,8,M1),[[ve,s.currentSeries.seriesId]]),F1]),o("div",N1,[L1,ae(o("input",{type:"text",class:"form-control",id:"name","onUpdate:modelValue":e[2]||(e[2]=m=>s.currentSeries.name=m),required:"",placeholder:"e.g., Bear Gravity Series"},null,512),[[ve,s.currentSeries.name]])]),o("div",U1,[j1,ae(o("input",{type:"text",class:"form-control",id:"displayName","onUpdate:modelValue":e[3]||(e[3]=m=>s.currentSeries.displayName=m),required:"",placeholder:"e.g., Bear Gravity Series 2026"},null,512),[[ve,s.currentSeries.displayName]])]),o("div",V1,[H1,ae(o("input",{type:"number",class:"form-control",id:"year","onUpdate:modelValue":e[4]||(e[4]=m=>s.currentSeries.year=m),required:"",min:"2020",max:"2050"},null,512),[[ve,s.currentSeries.year,void 0,{number:!0}]])]),o("div",G1,[B1,ae(o("textarea",{class:"form-control",id:"description","onUpdate:modelValue":e[5]||(e[5]=m=>s.currentSeries.description=m),rows:"3",placeholder:"Brief description of the series"},null,512),[[ve,s.currentSeries.description]])]),o("div",K1,[ae(o("input",{type:"checkbox",class:"form-check-input",id:"active","onUpdate:modelValue":e[6]||(e[6]=m=>s.currentSeries.active=m)},null,512),[[ds,s.currentSeries.active]]),z1]),s.currentSeries.seasonPassPricing?(f(),p("div",W1,[Y1,M(" "+S(((h=s.currentSeries.seasonPassPricing.categoryGroups)==null?void 0:h.length)||0)+" category groups configured ",1),X1,J1])):T("",!0)],32)):T("",!0)]}),footer:G(()=>[o("button",{type:"button",class:"btn btn-secondary",onClick:e[8]||(e[8]=(...h)=>a.closeModal&&a.closeModal(...h))},"Cancel"),o("button",{type:"button",class:"btn btn-primary",onClick:e[9]||(e[9]=(...h)=>a.saveSeries&&a.saveSeries(...h))},S(s.modalMode==="create"?"Create":"Save Changes"),1)]),_:1},8,["show","onClose"])]))],64)}const Z1=ge(y1,[["render",Q1],["__scopeId","data-v-22e12a9f"]]);const q1={components:{draggable:Fs,Pencil:$t,Copy:ms,Trash2:Gt,Plus:co,Edit:Fo},props:{categories:{type:Array,default:()=>[]},payTypes:{type:Object,default:()=>({})}},emits:["update:categories"],data(){return{formCats:[],editCatId:null,editFormData:{},editModeEnabled:!1}},mounted(){this.formCats=this.categories.map(t=>Object.assign({},t,{isExisting:!0}))},watch:{categories:{handler(t){this.formCats=t.map(e=>Object.assign({},e,{isExisting:!0}))},deep:!0}},methods:{emitUpdate(){const t=this.formCats.map((e,n)=>{let l=Object.assign({},e);return l.disporder=n+1,delete l.isExisting,l});this.$emit("update:categories",t)},editCategoryData(t){this.editCatId!==t&&(this.editCatId=t,this.editFormData=Object.assign({},this.formCats[t]))},saveCategory(t){let e=this.formCats[this.editCatId];!e.isExisting&&e.catdispname!==t.catdispname?t.id=t.catdispname.toLowerCase().replace(/[^a-z0-9]+/g,"_"):t.id=e.id,this.formCats[this.editCatId]=Object.assign({},t,{isExisting:e.isExisting}),this.editCatId=null,this.emitUpdate()},submitForm(t){if(t.preventDefault(),t.stopPropagation(),!this.editFormData.catdispname){alert("Category name is required");return}this.saveCategory(this.editFormData)},cancelEdit(){this.editCatId=null,this.editFormData={}},addCategory(){const t={id:"new_category_"+Date.now(),catdispname:"New Category",laps:1,startTime:"",minAge:null,maxAge:null,sponsored:!1,sponsorName:"",paytype:null,isExisting:!1};this.formCats.push(t),this.editCatId=this.formCats.length-1,this.editFormData=Object.assign({},t)},copyCategory(t,e){t.stopPropagation();let n=Object.assign({},this.formCats[e]);n.catdispname=n.catdispname+" (copy)",n.id=n.catdispname.toLowerCase().replace(/[^a-z0-9]+/g,"_"),n.isExisting=!1,this.formCats.splice(e+1,0,n),this.emitUpdate()},deleteCategory(t,e){t.stopPropagation(),confirm("Delete this category?")&&(this.formCats.splice(e,1),this.emitUpdate())},onDragEnd(){this.emitUpdate()},onDragStart(){this.editCatId!==null&&this.cancelEdit()},checkMove(){return this.editCatId===null}}},et=t=>(nt("data-v-9abebc5a"),t=t(),rt(),t),eC={class:"edit-categories-form"},tC={class:"d-flex justify-content-between align-items-center mb-3"},sC={key:0,class:"text-muted ms-2 small"},oC=["onClick"],rC={class:"row mb-2"},nC={class:"col-md-6"},aC=et(()=>o("label",{class:"form-label small"},"Category Name *",-1)),iC={class:"col-md-2"},lC=et(()=>o("label",{class:"form-label small"},"Laps",-1)),cC={class:"col-md-4"},dC=et(()=>o("label",{class:"form-label small"},"Start Time",-1)),uC={class:"input-group input-group-sm"},mC={class:"row mb-2"},hC={class:"col-md-3"},fC=et(()=>o("label",{class:"form-label small"},"Minimum Age",-1)),pC={class:"col-md-3"},vC=et(()=>o("label",{class:"form-label small"},"Maximum Age",-1)),gC={class:"row mb-3"},yC={class:"col-md-6"},bC={class:"form-check"},CC=et(()=>o("label",{class:"form-check-label",for:"sponsored"}," Sponsored (no entry fee) ",-1)),SC={key:0,class:"col-md-6"},DC=et(()=>o("label",{class:"form-label small"},"Sponsor Name",-1)),xC={key:0,class:"row mb-3"},_C={class:"col-md-12"},EC=et(()=>o("label",{class:"form-label small"},"Force Payment Type (Optional)",-1)),wC=et(()=>o("option",{value:null},"No forced payment type",-1)),PC=["value"],TC=et(()=>o("small",{class:"text-muted"}," If set, this category will only be available with the selected payment type. ",-1)),RC={class:"d-flex gap-2"},OC=et(()=>o("button",{class:"btn btn-sm btn-primary",type:"submit"},"Save",-1)),IC={key:1,class:"cat-row p-2 border rounded bg-white d-flex align-items-center"},kC=et(()=>o("div",{class:"drag-handle me-2",style:{cursor:"move"}},[o("span",{class:"text-muted"},"")],-1)),$C={class:"cat-name flex-grow-1"},AC={key:0,class:"text-muted ms-2 small"},MC={key:1,class:"text-muted ms-2 small"},FC={key:2,class:"text-muted ms-2 small"},NC={class:"cat-badges me-2"},LC={key:0,class:"badge bg-success"},UC={key:1,class:"badge bg-info"},jC={class:"cat-actions d-flex align-items-center gap-2"},VC={class:"badge bg-secondary"},HC=["onClick"],GC=["onClick"],BC={key:1,class:"compact-view"},KC={class:"table-responsive"},zC={class:"table table-sm table-hover table-bordered mb-0"},WC=et(()=>o("thead",{class:"table-light"},[o("tr",null,[o("th",{style:{width:"50px"}},"#"),o("th",null,"Category Name"),o("th",{style:{width:"100px"}},"Start Time"),o("th",{style:{width:"80px"}},"Laps"),o("th",{style:{width:"90px"}},"Min Age"),o("th",{style:{width:"90px"}},"Max Age"),o("th",{style:{width:"150px"}},"Sponsored"),o("th",{style:{width:"150px"}},"Payment Type")])],-1)),YC={class:"text-center text-muted"},XC={class:"text-center"},JC={key:0,class:"text-nowrap"},QC={key:1,class:"text-muted"},ZC={class:"text-center"},qC={class:"text-center"},eS={class:"text-center"},tS={key:0,class:"badge bg-success"},sS={key:1,class:"text-muted"},oS={key:0,class:"badge bg-info"},rS={key:1,class:"text-muted"},nS={key:2,class:"text-center text-muted py-4 border rounded"};function aS(t,e,n,l,s,a){const r=$("Edit"),d=$("Plus"),i=$("Copy"),c=$("Trash2"),h=$("draggable");return f(),p("div",eC,[o("div",tC,[o("div",null,[o("button",{class:le(["btn btn-sm",s.editModeEnabled?"btn-secondary":"btn-outline-secondary"]),onClick:e[0]||(e[0]=m=>s.editModeEnabled=!s.editModeEnabled)},[D(r,{size:16,class:"me-1"}),M(" "+S(s.editModeEnabled?"View Mode":"Enable Editing"),1)],2),s.editModeEnabled?(f(),p("span",sC,"Click to edit, drag to reorder")):T("",!0)]),s.editModeEnabled?(f(),p("button",{key:0,class:"btn btn-sm btn-primary",onClick:e[1]||(e[1]=(...m)=>a.addCategory&&a.addCategory(...m))},[D(d,{size:16,class:"me-1"}),M(" Add Category ")])):T("",!0)]),s.editModeEnabled?(f(),q(h,{key:0,modelValue:s.formCats,"onUpdate:modelValue":e[13]||(e[13]=m=>s.formCats=m),onEnd:a.onDragEnd,onStart:a.onDragStart,"item-key":"id",move:a.checkMove,handle:".drag-handle"},{item:G(({element:m,index:u})=>[o("div",{class:"cat-group mb-2",onClick:v=>a.editCategoryData(u)},[s.editCatId===u?(f(),p("form",{key:0,onSubmit:e[12]||(e[12]=st((...v)=>a.submitForm&&a.submitForm(...v),["prevent"])),class:"p-3 border rounded bg-light"},[o("div",rC,[o("div",nC,[aC,ae(o("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":e[2]||(e[2]=v=>s.editFormData.catdispname=v),required:"",style:{"min-width":"200px"}},null,512),[[ve,s.editFormData.catdispname]])]),o("div",iC,[lC,ae(o("input",{type:"number",class:"form-control form-control-sm","onUpdate:modelValue":e[3]||(e[3]=v=>s.editFormData.laps=v),min:"0"},null,512),[[ve,s.editFormData.laps,void 0,{number:!0}]])]),o("div",cC,[dC,o("div",uC,[ae(o("input",{type:"time",class:"form-control form-control-sm","onUpdate:modelValue":e[4]||(e[4]=v=>s.editFormData.startTime=v),placeholder:"HH:MM"},null,512),[[ve,s.editFormData.startTime]]),s.editFormData.startTime?(f(),p("button",{key:0,class:"btn btn-outline-secondary",type:"button",onClick:e[5]||(e[5]=v=>s.editFormData.startTime=""),title:"Clear start time"},"  ")):T("",!0)])])]),o("div",mC,[o("div",hC,[fC,ae(o("input",{type:"number",class:"form-control form-control-sm","onUpdate:modelValue":e[6]||(e[6]=v=>s.editFormData.minAge=v),min:"0",placeholder:"No minimum"},null,512),[[ve,s.editFormData.minAge,void 0,{number:!0}]])]),o("div",pC,[vC,ae(o("input",{type:"number",class:"form-control form-control-sm","onUpdate:modelValue":e[7]||(e[7]=v=>s.editFormData.maxAge=v),min:"0",placeholder:"No maximum"},null,512),[[ve,s.editFormData.maxAge,void 0,{number:!0}]])])]),o("div",gC,[o("div",yC,[o("div",bC,[ae(o("input",{type:"checkbox",class:"form-check-input",id:"sponsored","onUpdate:modelValue":e[8]||(e[8]=v=>s.editFormData.sponsored=v)},null,512),[[ds,s.editFormData.sponsored]]),CC])]),s.editFormData.sponsored?(f(),p("div",SC,[DC,ae(o("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":e[9]||(e[9]=v=>s.editFormData.sponsorName=v)},null,512),[[ve,s.editFormData.sponsorName]])])):T("",!0)]),!s.editFormData.sponsored&&Object.keys(n.payTypes).length>0?(f(),p("div",xC,[o("div",_C,[EC,ae(o("select",{class:"form-select form-select-sm","onUpdate:modelValue":e[10]||(e[10]=v=>s.editFormData.paytype=v)},[wC,(f(!0),p(te,null,de(n.payTypes,(v,g)=>(f(),p("option",{key:g,value:g},S(v)+" ("+S(g)+") ",9,PC))),128))],512),[[Io,s.editFormData.paytype]]),TC])])):T("",!0),o("div",RC,[OC,o("button",{class:"btn btn-sm btn-secondary",type:"button",onClick:e[11]||(e[11]=st((...v)=>a.cancelEdit&&a.cancelEdit(...v),["stop"]))},"Cancel")])],32)):(f(),p("div",IC,[kC,o("div",$C,[o("strong",null,S(m.catdispname),1),m.startTime?(f(),p("span",AC," "+S(m.startTime),1)):T("",!0),m.laps?(f(),p("span",MC,"("+S(m.laps)+" laps)",1)):T("",!0),m.minAge||m.maxAge?(f(),p("span",FC," Ages: "+S(m.minAge||"")+" - "+S(m.maxAge||""),1)):T("",!0)]),o("div",NC,[m.sponsored?(f(),p("span",LC,"Sponsored")):m.paytype&&n.payTypes[m.paytype]?(f(),p("span",UC,S(n.payTypes[m.paytype]),1)):T("",!0)]),o("div",jC,[o("span",VC,S(u+1),1),o("button",{class:"btn btn-sm btn-outline-secondary",onClick:st(v=>a.copyCategory(v,u),["stop"]),title:"Copy"},[D(i,{size:14})],8,HC),o("button",{class:"btn btn-sm btn-outline-danger",onClick:st(v=>a.deleteCategory(v,u),["stop"]),title:"Delete"},[D(c,{size:14})],8,GC)])]))],8,oC)]),_:1},8,["modelValue","onEnd","onStart","move"])):(f(),p("div",BC,[o("div",KC,[o("table",zC,[WC,o("tbody",null,[(f(!0),p(te,null,de(s.formCats,(m,u)=>(f(),p("tr",{key:m.id},[o("td",YC,S(u+1),1),o("td",null,[o("strong",null,S(m.catdispname),1)]),o("td",XC,[m.startTime?(f(),p("span",JC,S(m.startTime),1)):(f(),p("span",QC,""))]),o("td",ZC,S(m.laps||""),1),o("td",qC,S(m.minAge||""),1),o("td",eS,S(m.maxAge||""),1),o("td",null,[m.sponsored?(f(),p("span",tS,S(m.sponsorName||"Sponsored"),1)):(f(),p("span",sS,""))]),o("td",null,[m.paytype&&n.payTypes[m.paytype]?(f(),p("span",oS,S(n.payTypes[m.paytype]),1)):(f(),p("span",rS,""))])]))),128))])])])])),s.formCats.length===0?(f(),p("div",nS,' No categories defined. Click "Add Category" to create one. ')):T("",!0)])}const iS=ge(q1,[["render",aS],["__scopeId","data-v-9abebc5a"]]);const lS={components:{draggable:Fs,Pencil:$t,Copy:ms,Trash2:Gt,Plus:co,ChevronDown:al,ChevronUp:ll,Edit:Fo},props:{categoryGroups:{type:Array,default:()=>[]},regCategories:{type:Array,default:()=>[]}},emits:["update:categoryGroups"],data(){return{formGroups:[],editGroupId:null,editFormData:{},expandedGroups:[],editModeEnabled:!1}},mounted(){this.formGroups=this.categoryGroups.map(t=>({...t,categories:[...t.categories||[]],paymentOptions:[...t.paymentOptions||[]],isExisting:!0}))},watch:{categoryGroups:{handler(t){this.formGroups=t.map(e=>({...e,categories:[...e.categories||[]],paymentOptions:[...e.paymentOptions||[]],isExisting:!0}))},deep:!0}},methods:{emitUpdate(){const t=this.formGroups.map(e=>{let n={...e};return delete n.isExisting,n});this.$emit("update:categoryGroups",t)},toggleExpand(t){const e=this.expandedGroups.indexOf(t);e>-1?this.expandedGroups.splice(e,1):this.expandedGroups.push(t)},isExpanded(t){return this.expandedGroups.includes(t)},editGroup(t){this.editGroupId!==t&&(this.editGroupId=t,this.editFormData={name:this.formGroups[t].name,categories:[...this.formGroups[t].categories],paymentOptions:this.formGroups[t].paymentOptions.map(e=>({...e}))})},saveGroup(){let t=this.formGroups[this.editGroupId];this.formGroups[this.editGroupId]={...this.editFormData,isExisting:t.isExisting},this.editGroupId=null,this.emitUpdate()},cancelEdit(){this.editGroupId=null,this.editFormData={}},addGroup(){const t={name:"New Category Group",categories:[],paymentOptions:[],isExisting:!1};this.formGroups.push(t),this.editGroupId=this.formGroups.length-1,this.editFormData={name:t.name,categories:[],paymentOptions:[]}},copyGroup(t,e){t.stopPropagation();let n={name:this.formGroups[e].name+" (copy)",categories:[...this.formGroups[e].categories],paymentOptions:this.formGroups[e].paymentOptions.map(l=>({...l})),isExisting:!1};this.formGroups.splice(e+1,0,n),this.emitUpdate()},deleteGroup(t,e){t.stopPropagation(),confirm("Delete this category group? Categories will become ungrouped.")&&(this.formGroups.splice(e,1),this.emitUpdate())},addPaymentOption(){this.editFormData.paymentOptions.push({name:"",type:"",amount:0})},removePaymentOption(t){this.editFormData.paymentOptions.splice(t,1)},addSpecialPaymentType(t){if(this.editFormData.paymentOptions.some(l=>l.type===t)){alert(`A ${t} payment type already exists in this group`);return}const n={type:t,amount:0};t==="season"?n.name="Season Pass":t==="cash"&&(n.name="Cash Payment (at event)"),this.editFormData.paymentOptions.push(n)},isSpecialPaymentType(t){return t==="season"||t==="cash"},getCategoryName(t){const e=this.regCategories.find(n=>n.id===t);return e?e.catdispname:t},getAvailableCategories(){const t=new Set;return this.formGroups.forEach((e,n)=>{n!==this.editGroupId&&e.categories.forEach(l=>t.add(l))}),this.regCategories.filter(e=>!t.has(e.id))},toggleCategory(t){const e=this.editFormData.categories.indexOf(t);e>-1?this.editFormData.categories.splice(e,1):this.editFormData.categories.push(t)},selectAllCategories(){const t=this.getAvailableCategories();this.editFormData.categories=t.map(e=>e.id)},clearAllCategories(){this.editFormData.categories=[]},submitForm(t){if(t.preventDefault(),t.stopPropagation(),!this.editFormData.name){alert("Group name is required");return}if(this.editFormData.categories.length===0){alert("Please select at least one category for this group");return}this.saveGroup()}}},At=t=>(nt("data-v-0e788cd6"),t=t(),rt(),t),cS={class:"edit-category-groups"},dS={class:"d-flex justify-content-between align-items-center mb-3"},uS={key:0,class:"text-muted mb-0 mt-2 small"},mS={key:1,class:"text-muted mb-0 mt-2 small"},hS={key:0,class:"text-center text-muted py-4 border rounded"},fS={class:"mb-3"},pS=At(()=>o("label",{class:"form-label small fw-bold"},"Group Name *",-1)),vS={class:"mb-3"},gS={class:"d-flex justify-content-between align-items-center mb-2"},yS=At(()=>o("label",{class:"form-label small fw-bold mb-0"},"Categories in this Group *",-1)),bS={class:"btn-group btn-group-sm",role:"group"},CS=["disabled"],SS=["disabled"],DS={class:"category-selector border rounded p-2",style:{"max-height":"200px","overflow-y":"auto"}},xS={key:0,class:"text-muted small"},_S={key:1,class:"text-muted small"},ES={key:2},wS=["id","value","checked","onChange"],PS=["for"],TS={class:"text-muted"},RS={key:0},OS={class:"mb-3"},IS=At(()=>o("label",{class:"form-label small fw-bold"},"Payment Options",-1)),kS={key:0,class:"text-center text-muted py-2 border rounded mb-2"},$S={key:1,class:"payment-options-list mb-2"},AS={class:"d-flex justify-content-between align-items-start mb-2"},MS={class:"text-muted"},FS=["onClick"],NS={class:"row g-2"},LS={class:"col-md-5"},US=["onUpdate:modelValue"],jS={class:"col-md-4"},VS=["onUpdate:modelValue","disabled"],HS={class:"col-md-3"},GS=["onUpdate:modelValue"],BS={class:"d-flex gap-2 flex-wrap"},KS={class:"d-flex gap-2"},zS=At(()=>o("button",{class:"btn btn-sm btn-primary",type:"submit"},"Save Group",-1)),WS={key:1,class:"group-card border rounded bg-white"},YS=["onClick"],XS={class:"flex-grow-1"},JS={class:"text-muted small mt-1"},QS={class:"badge bg-secondary me-2"},ZS={class:"badge bg-info"},qS={class:"group-actions d-flex align-items-center gap-2"},e0=["onClick"],t0=["onClick"],s0=["onClick"],o0={class:"btn btn-sm btn-link text-muted",type:"button"},r0={key:0,class:"group-details p-3 border-top bg-light"},n0={class:"mb-3"},a0=At(()=>o("h6",{class:"small fw-bold mb-2"},"Categories:",-1)),i0={class:"d-flex flex-wrap gap-1"},l0={key:0},c0=At(()=>o("h6",{class:"small fw-bold mb-2"},"Payment Options:",-1)),d0={class:"table-responsive"},u0={class:"table table-sm table-bordered mb-0"},m0=At(()=>o("thead",null,[o("tr",null,[o("th",null,"Name"),o("th",null,"Type"),o("th",{class:"text-end"},"Amount")])],-1)),h0={key:0,class:"badge bg-warning text-dark ms-1"},f0={class:"text-end"},p0={key:1,class:"text-muted small"};function v0(t,e,n,l,s,a){const r=$("Edit"),d=$("Plus"),i=$("Trash2"),c=$("Pencil"),h=$("Copy"),m=$("ChevronDown"),u=$("ChevronUp");return f(),p("div",cS,[o("div",dS,[o("div",null,[o("button",{class:le(["btn btn-sm",s.editModeEnabled?"btn-secondary":"btn-outline-secondary"]),onClick:e[0]||(e[0]=v=>s.editModeEnabled=!s.editModeEnabled)},[D(r,{size:16,class:"me-1"}),M(" "+S(s.editModeEnabled?"View Mode":"Enable Editing"),1)],2),s.editModeEnabled?(f(),p("p",mS," Create groups of categories with their payment options. Each category can only belong to one group. ")):(f(),p("p",uS," Click group headers to expand/collapse details "))]),s.editModeEnabled?(f(),p("button",{key:0,class:"btn btn-sm btn-primary",onClick:e[1]||(e[1]=(...v)=>a.addGroup&&a.addGroup(...v))},[D(d,{size:16,class:"me-1"}),M(" Add Group ")])):T("",!0)]),s.formGroups.length===0?(f(),p("div",hS,' No category groups defined. Click "Add Group" to create one. ')):T("",!0),(f(!0),p(te,null,de(s.formGroups,(v,g)=>(f(),p("div",{key:g,class:"group-container mb-3"},[s.editGroupId===g?(f(),p("form",{key:0,onSubmit:e[9]||(e[9]=st((...y)=>a.submitForm&&a.submitForm(...y),["prevent"])),class:"p-3 border rounded bg-light"},[o("div",fS,[pS,ae(o("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":e[2]||(e[2]=y=>s.editFormData.name=y),placeholder:"e.g., High School Categories",required:""},null,512),[[ve,s.editFormData.name]])]),o("div",vS,[o("div",gS,[yS,o("div",bS,[o("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:e[3]||(e[3]=(...y)=>a.selectAllCategories&&a.selectAllCategories(...y)),disabled:a.getAvailableCategories().length===0}," Select All ",8,CS),o("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:e[4]||(e[4]=(...y)=>a.clearAllCategories&&a.clearAllCategories(...y)),disabled:s.editFormData.categories.length===0}," Clear ",8,SS)])]),o("div",DS,[n.regCategories.length===0?(f(),p("div",xS," No categories defined yet. Please add categories first. ")):a.getAvailableCategories().length===0&&s.editFormData.categories.length===0?(f(),p("div",_S," All categories are already assigned to other groups. ")):(f(),p("div",ES,[(f(!0),p(te,null,de(n.regCategories,y=>ae((f(),p("div",{key:y.id,class:"form-check"},[o("input",{class:"form-check-input",type:"checkbox",id:"cat-"+g+"-"+y.id,value:y.id,checked:s.editFormData.categories.includes(y.id),onChange:b=>a.toggleCategory(y.id)},null,40,wS),o("label",{class:"form-check-label",for:"cat-"+g+"-"+y.id},S(y.catdispname),9,PS)])),[[jt,s.editFormData.categories.includes(y.id)||a.getAvailableCategories().some(b=>b.id===y.id)]])),128))]))]),o("small",TS,[M(S(s.editFormData.categories.length)+" categories selected ",1),a.getAvailableCategories().length>0?(f(),p("span",RS," ("+S(a.getAvailableCategories().length)+" available) ",1)):T("",!0)])]),o("div",OS,[IS,s.editFormData.paymentOptions.length===0?(f(),p("div",kS," No payment options defined for this group. ")):(f(),p("div",$S,[(f(!0),p(te,null,de(s.editFormData.paymentOptions,(y,b)=>(f(),p("div",{key:b,class:"payment-option-item border rounded p-2 mb-2"},[o("div",AS,[o("small",MS,"Payment Option "+S(b+1),1),o("button",{class:"btn btn-sm btn-outline-danger py-0 px-1",onClick:x=>a.removePaymentOption(b),type:"button"},[D(i,{size:12})],8,FS)]),o("div",NS,[o("div",LS,[ae(o("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":x=>y.name=x,placeholder:"e.g., Early Bird",required:""},null,8,US),[[ve,y.name]])]),o("div",jS,[ae(o("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":x=>y.type=x,placeholder:"e.g., early_bird",disabled:a.isSpecialPaymentType(y.type),required:""},null,8,VS),[[ve,y.type]])]),o("div",HS,[ae(o("input",{type:"number",class:"form-control form-control-sm","onUpdate:modelValue":x=>y.amount=x,placeholder:"Amount",min:"0",step:"1",required:""},null,8,GS),[[ve,y.amount,void 0,{number:!0}]])])])]))),128))])),o("div",BS,[o("button",{class:"btn btn-sm btn-success",onClick:e[5]||(e[5]=(...y)=>a.addPaymentOption&&a.addPaymentOption(...y)),type:"button"}," + Custom Payment "),o("button",{class:"btn btn-sm btn-info",onClick:e[6]||(e[6]=y=>a.addSpecialPaymentType("season")),type:"button"}," + Season Pass "),o("button",{class:"btn btn-sm btn-info",onClick:e[7]||(e[7]=y=>a.addSpecialPaymentType("cash")),type:"button"}," + Cash Payment ")])]),o("div",KS,[zS,o("button",{class:"btn btn-sm btn-secondary",type:"button",onClick:e[8]||(e[8]=st((...y)=>a.cancelEdit&&a.cancelEdit(...y),["stop"]))},"Cancel")])],32)):(f(),p("div",WS,[o("div",{class:"group-header p-3 d-flex align-items-center",onClick:y=>a.toggleExpand(g),style:{cursor:"pointer"}},[o("div",XS,[o("strong",null,S(v.name),1),o("div",JS,[o("span",QS,S(v.categories.length)+" categories",1),o("span",ZS,S(v.paymentOptions.length)+" payment options",1)])]),o("div",qS,[s.editModeEnabled?(f(),p("button",{key:0,class:"btn btn-sm btn-outline-primary",onClick:st(y=>a.editGroup(g),["stop"]),title:"Edit"},[D(c,{size:14})],8,e0)):T("",!0),s.editModeEnabled?(f(),p("button",{key:1,class:"btn btn-sm btn-outline-secondary",onClick:st(y=>a.copyGroup(y,g),["stop"]),title:"Copy"},[D(h,{size:14})],8,t0)):T("",!0),s.editModeEnabled?(f(),p("button",{key:2,class:"btn btn-sm btn-outline-danger",onClick:st(y=>a.deleteGroup(y,g),["stop"]),title:"Delete"},[D(i,{size:14})],8,s0)):T("",!0),o("button",o0,[a.isExpanded(g)?(f(),q(u,{key:1,size:16})):(f(),q(m,{key:0,size:16}))])])],8,YS),a.isExpanded(g)?(f(),p("div",r0,[o("div",n0,[a0,o("div",i0,[(f(!0),p(te,null,de(v.categories,y=>(f(),p("span",{key:y,class:"badge bg-secondary"},S(a.getCategoryName(y)),1))),128))])]),v.paymentOptions.length>0?(f(),p("div",l0,[c0,o("div",d0,[o("table",u0,[m0,o("tbody",null,[(f(!0),p(te,null,de(v.paymentOptions,(y,b)=>(f(),p("tr",{key:b},[o("td",null,S(y.name),1),o("td",null,[o("code",null,S(y.type),1),a.isSpecialPaymentType(y.type)?(f(),p("span",h0," Special ")):T("",!0)]),o("td",f0,"$"+S(y.amount),1)]))),128))])])])])):(f(),p("div",p0," No payment options defined for this group. "))])):T("",!0)]))]))),128))])}const g0=ge(lS,[["render",v0],["__scopeId","data-v-0e788cd6"]]);const y0={components:{RouterLink:us,ArrowLeft:ol,Save:El,Download:hl,EditSeriesCategoriesComponent:iS,EditCategoryGroupsComponent:g0},data(){return{loading:!1,saving:!1,error:null,saveError:null,saveSuccess:!1,seriesData:null,formData:{name:"",displayName:"",year:new Date().getFullYear(),active:!0,description:"",regCategories:[],categoryGroups:[],defaultPaymentOptions:[]},allRaces:[],racesInSeries:[],racesNotInSeries:[],selectedRacesInSeries:[],selectedRacesNotInSeries:[],loadingRaces:!1,racesError:null,updatingRaces:!1,raceSearchFilter:"",showAddRacesModal:!1,showStickySaveButton:!1,hasUnsavedChanges:!1,originalFormData:null,showImportCategoriesModal:!1,importRaces:[],loadingImportRaces:!1,selectedImportRaceId:null,selectedImportRaceCategories:null}},async created(){await this.fetchData(),this.fetchRaces(),window.addEventListener("scroll",this.handleScroll)},beforeUnmount(){window.removeEventListener("scroll",this.handleScroll)},watch:{"$route.params.seriesId":{async handler(){await this.fetchData(),await this.fetchRaces()}},formData:{handler(){this.checkForChanges()},deep:!0}},methods:{async fetchData(){var t,e;this.error=null,this.loading=!0;try{const n=await Z(`/api/series/${this.$route.params.seriesId}`);this.seriesData=n.data,this.formData={name:this.seriesData.name||"",displayName:this.seriesData.displayName||"",year:this.seriesData.year||new Date().getFullYear(),active:this.seriesData.active!==void 0?this.seriesData.active:!0,description:this.seriesData.description||"",regCategories:this.seriesData.regCategories||[],categoryGroups:this.seriesData.categoryGroups||[],defaultPaymentOptions:this.seriesData.defaultPaymentOptions||[]},this.originalFormData=JSON.parse(JSON.stringify(this.formData)),this.hasUnsavedChanges=!1,this.loading=!1}catch(n){this.loading=!1,this.error=((e=(t=n.response)==null?void 0:t.data)==null?void 0:e.message)||n.message||n.toString(),console.error(n)}},async saveSeries(){var t,e;this.saveError=null,this.saveSuccess=!1,this.saving=!0;try{await Z.patch(`/api/series/${this.$route.params.seriesId}`,this.formData),this.saveSuccess=!0,this.saving=!1,await this.fetchData(),setTimeout(()=>{this.saveSuccess=!1},3e3)}catch(n){this.saving=!1,this.saveError=((e=(t=n.response)==null?void 0:t.data)==null?void 0:e.message)||n.message||"Error saving series",console.error("Error saving series:",n)}},async fetchRaces(){var t,e,n,l;this.loadingRaces=!0,this.racesError=null;try{const s=new Date().toISOString().split("T")[0],a=await Z(`/api/races?startDate=${s}`);this.allRaces=a.data;const r=((t=this.seriesData)==null?void 0:t.seriesId)||((e=this.seriesData)==null?void 0:e.series)||this.$route.params.seriesId;this.racesInSeries=this.allRaces.filter(d=>d.series===r),this.racesNotInSeries=this.allRaces.filter(d=>d.series!==r),this.loadingRaces=!1}catch(s){this.loadingRaces=!1,this.racesError=((l=(n=s.response)==null?void 0:n.data)==null?void 0:l.message)||s.message||"Error loading races",console.error("Error loading races:",s)}},toggleRaceSelection(t){const e=this.selectedRacesNotInSeries.indexOf(t);e>-1?this.selectedRacesNotInSeries.splice(e,1):this.selectedRacesNotInSeries.push(t)},async addRacesToSeries(){var t,e;if(this.selectedRacesNotInSeries.length!==0){this.updatingRaces=!0;try{await Z.post(`/api/series/${this.$route.params.seriesId}/races`,{raceIds:this.selectedRacesNotInSeries,action:"add"}),await this.fetchRaces(),this.selectedRacesNotInSeries=[],this.showAddRacesModal=!1,this.raceSearchFilter=""}catch(n){this.racesError=((e=(t=n.response)==null?void 0:t.data)==null?void 0:e.message)||n.message||"Error adding races",console.error("Error adding races:",n)}finally{this.updatingRaces=!1}}},async removeRaceFromSeries(t){var e,n;if(confirm("Remove this race from the series?")){this.updatingRaces=!0;try{await Z.post(`/api/series/${this.$route.params.seriesId}/races`,{raceIds:[t],action:"remove"}),await this.fetchRaces()}catch(l){this.racesError=((n=(e=l.response)==null?void 0:e.data)==null?void 0:n.message)||l.message||"Error removing race",console.error("Error removing race:",l)}finally{this.updatingRaces=!1}}},formatRaceDate(t){return t?new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):""},handleScroll(){this.showStickySaveButton=window.scrollY>300},checkForChanges(){if(!this.originalFormData)return;const t=JSON.stringify(this.formData),e=JSON.stringify(this.originalFormData);this.hasUnsavedChanges=t!==e},async openImportCategoriesModal(){this.showImportCategoriesModal=!0,this.selectedImportRaceId=null,this.selectedImportRaceCategories=null,await this.fetchImportRaces()},async fetchImportRaces(){this.loadingImportRaces=!0;try{const t=await Z("/api/races?startDate=2020-01-01");this.importRaces=t.data.filter(e=>e.regCategories&&e.regCategories.length>0).sort((e,n)=>{const l=new Date(e.eventDate||0);return new Date(n.eventDate||0)-l}),this.loadingImportRaces=!1}catch(t){this.loadingImportRaces=!1,console.error("Error loading races for import:",t)}},async selectImportRace(t){this.selectedImportRaceId=t;const e=this.importRaces.find(n=>n.raceid===t);e&&e.regCategories&&(this.selectedImportRaceCategories=e.regCategories)},confirmImportCategories(){this.selectedImportRaceCategories&&(this.formData.regCategories=JSON.parse(JSON.stringify(this.selectedImportRaceCategories)),this.showImportCategoriesModal=!1,this.selectedImportRaceId=null,this.selectedImportRaceCategories=null)},closeImportCategoriesModal(){this.showImportCategoriesModal=!1,this.selectedImportRaceId=null,this.selectedImportRaceCategories=null},addDefaultPaymentOption(){this.formData.defaultPaymentOptions.push({name:"",type:"",amount:0})},removeDefaultPaymentOption(t){confirm("Remove this default payment option?")&&this.formData.defaultPaymentOptions.splice(t,1)},addDefaultSpecialPaymentType(t){if(this.formData.defaultPaymentOptions.some(l=>l.type===t)){alert(`A ${t} payment type already exists in default payment options`);return}const n={type:t,amount:0};t==="season"?n.name="Season Pass":t==="cash"&&(n.name="Cash Payment (at event)"),this.formData.defaultPaymentOptions.push(n)},isSpecialPaymentType(t){return t==="season"||t==="cash"}},computed:{loaded(){return!!this.seriesData},filteredRacesNotInSeries(){if(!this.raceSearchFilter)return this.racesNotInSeries;const t=this.raceSearchFilter.toLowerCase();return this.racesNotInSeries.filter(e=>{var l;return(((l=e.eventDetails)==null?void 0:l.name)||"").toLowerCase().includes(t)})},seriesDefaultPaymentTypesMap(){const t={};return(this.formData.defaultPaymentOptions||[]).forEach(e=>{t[e.type]=e.name}),t}}},me=t=>(nt("data-v-57ff0ad8"),t=t(),rt(),t),b0={key:0,class:"loading"},C0={key:0,class:"alert alert-danger"},S0={key:1},D0={class:"d-flex justify-content-between align-items-center mb-4"},x0={class:"d-flex gap-2"},_0=["disabled"],E0={key:0,class:"alert alert-success alert-dismissible fade show",role:"alert"},w0={key:1,class:"alert alert-danger alert-dismissible fade show",role:"alert"},P0={class:"row"},T0={class:"col-lg-9"},R0={class:"card mb-4"},O0=me(()=>o("div",{class:"card-header"},[o("h5",{class:"mb-0"},"Basic Information")],-1)),I0={class:"card-body"},k0={class:"mb-3"},$0=me(()=>o("label",{for:"seriesId",class:"form-label"},"Series ID",-1)),A0=["value"],M0=me(()=>o("small",{class:"form-text text-muted"},"Cannot be changed",-1)),F0={class:"mb-3"},N0=me(()=>o("label",{for:"name",class:"form-label"},"Name *",-1)),L0={class:"mb-3"},U0=me(()=>o("label",{for:"displayName",class:"form-label"},"Display Name *",-1)),j0={class:"mb-3"},V0=me(()=>o("label",{for:"year",class:"form-label"},"Year *",-1)),H0={class:"mb-3"},G0=me(()=>o("label",{for:"description",class:"form-label"},"Description",-1)),B0={class:"mb-3 form-check"},K0=me(()=>o("label",{class:"form-check-label",for:"active"}," Active (series is currently running) ",-1)),z0={class:"card mb-4"},W0={class:"card-header d-flex justify-content-between align-items-center"},Y0=me(()=>o("h5",{class:"mb-0"},"Races in Series",-1)),X0=["disabled"],J0={class:"card-body"},Q0={key:0,class:"text-center py-3"},Z0=me(()=>o("div",{class:"spinner-border spinner-border-sm",role:"status"},[o("span",{class:"visually-hidden"},"Loading races...")],-1)),q0={key:1,class:"alert alert-danger"},eD={key:2},tD={key:0,class:"text-center text-muted py-4"},sD=me(()=>o("p",null,"No races in this series yet.",-1)),oD={key:1,class:"table-responsive"},rD={class:"table table-hover table-sm"},nD=me(()=>o("thead",null,[o("tr",null,[o("th",null,"Date"),o("th",null,"Race Name"),o("th",{class:"text-center"},"Race #"),o("th",{class:"text-center"},"Series Redirect"),o("th",{class:"text-center"},"Actions")])],-1)),aD={class:"text-nowrap"},iD={class:"text-center"},lD={key:0,class:"badge bg-secondary"},cD={key:1,class:"text-muted small"},dD={class:"text-center"},uD={key:0,class:"badge bg-warning text-dark"},mD={key:1,class:"badge bg-success"},hD={class:"text-center"},fD=["onClick","disabled"],pD={class:"card mb-4"},vD={class:"card-header d-flex justify-content-between align-items-center"},gD=me(()=>o("h5",{class:"mb-0"},"Race Categories",-1)),yD={class:"card-body"},bD=me(()=>o("p",{class:"text-muted small mb-3"}," Define the default categories for all races in this series. Individual races can override these. ",-1)),CD={class:"card mb-4"},SD=me(()=>o("div",{class:"card-header"},[o("h5",{class:"mb-0"},"Default Payment Options")],-1)),DD={class:"card-body"},xD=me(()=>o("p",{class:"text-muted small mb-3"},[o("strong",null,"Series-wide default payment options"),M(" that apply to all series categories. These can be overridden by: "),o("br"),M(" Category Group payment options (if a category belongs to a group) "),o("br"),M(" Race-specific payment options (if a race defines a matching payment type) ")],-1)),_D={key:0,class:"text-center text-muted py-3 border rounded mb-3"},ED={key:1,class:"payment-options-list mb-3"},wD={class:"d-flex justify-content-between align-items-start mb-2"},PD={class:"mb-0"},TD=["onClick"],RD={class:"row g-2"},OD={class:"col-md-5"},ID=me(()=>o("label",{class:"form-label small"},"Name *",-1)),kD=["onUpdate:modelValue"],$D={class:"col-md-4"},AD=me(()=>o("label",{class:"form-label small"},"Type ID *",-1)),MD=["onUpdate:modelValue","disabled"],FD={key:0,class:"text-muted"},ND={class:"col-md-3"},LD=me(()=>o("label",{class:"form-label small"},"Amount ($) *",-1)),UD=["onUpdate:modelValue"],jD={class:"d-flex gap-2 flex-wrap"},VD={class:"card mb-4"},HD=me(()=>o("div",{class:"card-header"},[o("h5",{class:"mb-0"},"Category Groups & Payment Options")],-1)),GD={class:"card-body"},BD=me(()=>o("p",{class:"text-muted small mb-3"},[o("strong",null,"Optional:"),M(" Group categories together and assign specific payment options to each group. Group payment options override the default payment options above for categories in that group. ")],-1)),KD={key:0,class:"modal show d-block",tabindex:"-1",style:{"background-color":"rgba(0,0,0,0.5)"}},zD={class:"modal-dialog modal-lg"},WD={class:"modal-content"},YD={class:"modal-header"},XD=me(()=>o("h5",{class:"modal-title"},"Add Races to Series",-1)),JD={class:"modal-body"},QD={class:"mb-3"},ZD={key:0,class:"text-center text-muted py-3"},qD={key:0},ex={key:1},tx={key:1,class:"race-selection-list"},sx=["onClick"],ox={class:"form-check"},rx=["checked","onClick"],nx={class:"form-check-label"},ax={key:2,class:"mt-3 alert alert-info"},ix={class:"modal-footer"},lx=["disabled"],cx={key:1,class:"modal show d-block",tabindex:"-1",style:{"background-color":"rgba(0,0,0,0.5)"}},dx={class:"modal-dialog modal-xl"},ux={class:"modal-content"},mx={class:"modal-header"},hx=me(()=>o("h5",{class:"modal-title"},"Import Categories from Race",-1)),fx={class:"modal-body"},px={key:0,class:"text-center py-4"},vx=me(()=>o("div",{class:"spinner-border",role:"status"},[o("span",{class:"visually-hidden"},"Loading races...")],-1)),gx=me(()=>o("p",{class:"mt-2 text-muted"},"Loading races...",-1)),yx=[vx,gx],bx={key:1,class:"row"},Cx={class:"col-md-5"},Sx=me(()=>o("h6",{class:"mb-3"},"Select a Race",-1)),Dx={key:0,class:"text-center text-muted py-4"},xx=me(()=>o("p",null,"No races with categories found.",-1)),_x=[xx],Ex={key:1,class:"import-race-list"},wx=["onClick"],Px={class:"d-flex flex-column"},Tx={class:"text-muted"},Rx={key:0,class:"ms-2"},Ox={class:"col-md-7"},Ix=me(()=>o("h6",{class:"mb-3"},"Category Preview",-1)),kx={key:0,class:"text-center text-muted py-5"},$x=me(()=>o("p",null," Select a race to preview its categories",-1)),Ax=[$x],Mx={key:1,class:"category-preview"},Fx={class:"alert alert-info mb-3"},Nx={class:"table-responsive"},Lx={class:"table table-sm table-bordered"},Ux=me(()=>o("thead",{class:"table-light"},[o("tr",null,[o("th",{style:{width:"40px"}},"#"),o("th",null,"Category Name"),o("th",{style:{width:"90px"}},"Start Time"),o("th",{style:{width:"60px"}},"Laps"),o("th",{style:{width:"100px"}},"Age Range")])],-1)),jx={class:"text-center text-muted"},Vx={key:0,class:"badge bg-success ms-2"},Hx={class:"text-center"},Gx={key:0},Bx={key:1,class:"text-muted"},Kx={class:"text-center"},zx={class:"text-center text-nowrap"},Wx={key:0},Yx={key:1,class:"text-muted"},Xx={class:"modal-footer"},Jx=["disabled"],Qx={class:"col-lg-3"},Zx={class:"card mb-4"},qx=me(()=>o("div",{class:"card-header"},[o("h6",{class:"mb-0"},"Quick Info")],-1)),e_={class:"card-body"},t_={class:"mb-0"},s_=me(()=>o("dt",{class:"small text-muted"},"Series ID",-1)),o_=me(()=>o("dt",{class:"small text-muted"},"Year",-1)),r_=me(()=>o("dt",{class:"small text-muted"},"Status",-1)),n_={key:0,class:"badge bg-success"},a_={key:1,class:"badge bg-secondary"},i_=me(()=>o("dt",{class:"small text-muted"},"Categories",-1)),l_={key:0,class:"badge bg-primary"},c_={key:1,class:"text-muted"},d_=me(()=>o("dt",{class:"small text-muted"},"Category Groups",-1)),u_={key:0,class:"badge bg-info"},m_={key:1,class:"text-muted"},h_=me(()=>o("dt",{class:"small text-muted"},"Races",-1)),f_={key:0,class:"badge bg-success"},p_={key:1,class:"text-muted"},v_={key:2,class:"text-muted"},g_={key:2},y_=me(()=>o("div",{class:"text-center"},[o("h2",{class:"mt-5"},"Series not found")],-1)),b_=[y_],C_={class:"container"},S_={class:"d-flex justify-content-between align-items-center"},D_={class:"text-white"},x_={key:0,class:"ms-2 text-white-50"},__={key:1,class:"ms-2 text-white-50"},E_=["disabled"];function w_(t,e,n,l,s,a){const r=$("ArrowLeft"),d=$("RouterLink"),i=$("Save"),c=$("Download"),h=$("EditSeriesCategoriesComponent"),m=$("EditCategoryGroupsComponent");return s.loading?(f(),p("div",b0,"Loading...")):(f(),p("div",{key:1,class:le(["edit-series-wrapper",{"has-sticky-bar":s.showStickySaveButton}])},[s.error?(f(),p("div",C0,S(s.error),1)):T("",!0),a.loaded?(f(),p("div",S0,[o("div",D0,[o("h2",null,[D(d,{to:{name:"series"},class:"text-decoration-none me-3"},{default:G(()=>[D(r,{size:24})]),_:1}),M(" Edit Series: "+S(s.seriesData.displayName||s.seriesData.name),1)]),o("div",x0,[D(d,{to:{name:"races",query:{series:s.seriesData.seriesId||s.seriesData.series}},class:"btn btn-outline-secondary"},{default:G(()=>[M(" View Races in Series ")]),_:1},8,["to"]),o("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=(...u)=>a.saveSeries&&a.saveSeries(...u)),disabled:s.saving},[D(i,{size:16,class:"me-1"}),M(" "+S(s.saving?"Saving...":"Save Changes"),1)],8,_0)])]),s.saveSuccess?(f(),p("div",E0,[M(" Series saved successfully! "),o("button",{type:"button",class:"btn-close",onClick:e[1]||(e[1]=u=>s.saveSuccess=!1)})])):T("",!0),s.saveError?(f(),p("div",w0,[M(S(s.saveError)+" ",1),o("button",{type:"button",class:"btn-close",onClick:e[2]||(e[2]=u=>s.saveError=null)})])):T("",!0),o("div",P0,[o("div",T0,[o("div",R0,[O0,o("div",I0,[o("div",k0,[$0,o("input",{type:"text",class:"form-control",id:"seriesId",value:s.seriesData.seriesId||s.seriesData.series,disabled:""},null,8,A0),M0]),o("div",F0,[N0,ae(o("input",{type:"text",class:"form-control",id:"name","onUpdate:modelValue":e[3]||(e[3]=u=>s.formData.name=u),required:""},null,512),[[ve,s.formData.name]])]),o("div",L0,[U0,ae(o("input",{type:"text",class:"form-control",id:"displayName","onUpdate:modelValue":e[4]||(e[4]=u=>s.formData.displayName=u),required:""},null,512),[[ve,s.formData.displayName]])]),o("div",j0,[V0,ae(o("input",{type:"number",class:"form-control",id:"year","onUpdate:modelValue":e[5]||(e[5]=u=>s.formData.year=u),required:"",min:"2020",max:"2050"},null,512),[[ve,s.formData.year,void 0,{number:!0}]])]),o("div",H0,[G0,ae(o("textarea",{class:"form-control",id:"description","onUpdate:modelValue":e[6]||(e[6]=u=>s.formData.description=u),rows:"3"},null,512),[[ve,s.formData.description]])]),o("div",B0,[ae(o("input",{type:"checkbox",class:"form-check-input",id:"active","onUpdate:modelValue":e[7]||(e[7]=u=>s.formData.active=u)},null,512),[[ds,s.formData.active]]),K0])])]),o("div",z0,[o("div",W0,[Y0,o("button",{class:"btn btn-sm btn-primary",onClick:e[8]||(e[8]=u=>s.showAddRacesModal=!0),disabled:s.loadingRaces}," + Add Races ",8,X0)]),o("div",J0,[s.loadingRaces?(f(),p("div",Q0,[Z0,M(" Loading races... ")])):s.racesError?(f(),p("div",q0,S(s.racesError),1)):(f(),p("div",eD,[s.racesInSeries.length===0?(f(),p("div",tD,[sD,o("button",{class:"btn btn-sm btn-primary",onClick:e[9]||(e[9]=u=>s.showAddRacesModal=!0)}," Add Races to Series ")])):(f(),p("div",oD,[o("table",rD,[nD,o("tbody",null,[(f(!0),p(te,null,de(s.racesInSeries,u=>(f(),p("tr",{key:u.raceid},[o("td",aD,S(a.formatRaceDate(u.eventDate)),1),o("td",null,[D(d,{to:{name:"edit-race",params:{raceid:u.raceid}}},{default:G(()=>{var v;return[M(S(((v=u.eventDetails)==null?void 0:v.name)||u.displayName),1)]}),_:2},1032,["to"])]),o("td",iD,[u.seriesRaceNumber?(f(),p("span",lD," #"+S(u.seriesRaceNumber),1)):(f(),p("span",cD,"-"))]),o("td",dD,[u.disableSeriesRedirect?(f(),p("span",uD," Disabled ")):(f(),p("span",mD," Enabled "))]),o("td",hD,[o("button",{class:"btn btn-sm btn-outline-danger",onClick:v=>a.removeRaceFromSeries(u.raceid),disabled:s.updatingRaces,title:"Remove from series"}," Remove ",8,fD)])]))),128))])])]))]))])]),o("div",pD,[o("div",vD,[gD,o("button",{class:"btn btn-sm btn-outline-primary",onClick:e[10]||(e[10]=(...u)=>a.openImportCategoriesModal&&a.openImportCategoriesModal(...u)),title:"Import categories from an existing race"},[D(c,{size:16,class:"me-1"}),M(" Import from Race ")])]),o("div",yD,[bD,D(h,{categories:s.formData.regCategories,payTypes:a.seriesDefaultPaymentTypesMap,"onUpdate:categories":e[11]||(e[11]=u=>s.formData.regCategories=u)},null,8,["categories","payTypes"])])]),o("div",CD,[SD,o("div",DD,[xD,s.formData.defaultPaymentOptions.length===0?(f(),p("div",_D,' No default payment options defined. Click "Add Payment Option" to create one. ')):(f(),p("div",ED,[(f(!0),p(te,null,de(s.formData.defaultPaymentOptions,(u,v)=>(f(),p("div",{key:v,class:"payment-option-card border rounded p-3 mb-2"},[o("div",wD,[o("h6",PD,"Payment Option "+S(v+1),1),o("button",{class:"btn btn-sm btn-outline-danger",onClick:g=>a.removeDefaultPaymentOption(v),type:"button"}," Remove ",8,TD)]),o("div",RD,[o("div",OD,[ID,ae(o("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":g=>u.name=g,placeholder:"e.g., Early Bird Registration",required:""},null,8,kD),[[ve,u.name]])]),o("div",$D,[AD,ae(o("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":g=>u.type=g,placeholder:"e.g., early_bird",disabled:a.isSpecialPaymentType(u.type),required:""},null,8,MD),[[ve,u.type]]),a.isSpecialPaymentType(u.type)?(f(),p("small",FD," Special type (cannot be changed) ")):T("",!0)]),o("div",ND,[LD,ae(o("input",{type:"number",class:"form-control form-control-sm","onUpdate:modelValue":g=>u.amount=g,placeholder:"0",min:"0",step:"1",required:""},null,8,UD),[[ve,u.amount,void 0,{number:!0}]])])])]))),128))])),o("div",jD,[o("button",{class:"btn btn-sm btn-success",onClick:e[12]||(e[12]=(...u)=>a.addDefaultPaymentOption&&a.addDefaultPaymentOption(...u)),type:"button"}," + Add Custom Payment "),o("button",{class:"btn btn-sm btn-info",onClick:e[13]||(e[13]=u=>a.addDefaultSpecialPaymentType("season")),type:"button"}," + Season Pass "),o("button",{class:"btn btn-sm btn-info",onClick:e[14]||(e[14]=u=>a.addDefaultSpecialPaymentType("cash")),type:"button"}," + Cash Payment ")])])]),o("div",VD,[HD,o("div",GD,[BD,D(m,{categoryGroups:s.formData.categoryGroups,regCategories:s.formData.regCategories,"onUpdate:categoryGroups":e[15]||(e[15]=u=>s.formData.categoryGroups=u)},null,8,["categoryGroups","regCategories"])])]),s.showAddRacesModal?(f(),p("div",KD,[o("div",zD,[o("div",WD,[o("div",YD,[XD,o("button",{type:"button",class:"btn-close",onClick:e[16]||(e[16]=u=>s.showAddRacesModal=!1)})]),o("div",JD,[o("div",QD,[ae(o("input",{type:"text",class:"form-control","onUpdate:modelValue":e[17]||(e[17]=u=>s.raceSearchFilter=u),placeholder:" Filter races by name..."},null,512),[[ve,s.raceSearchFilter]])]),a.filteredRacesNotInSeries.length===0?(f(),p("div",ZD,[s.raceSearchFilter?(f(),p("p",qD,"No races match your search.")):(f(),p("p",ex,"All upcoming races are already in this series."))])):(f(),p("div",tx,[(f(!0),p(te,null,de(a.filteredRacesNotInSeries,u=>{var v;return f(),p("div",{key:u.raceid,class:le(["race-selection-item",{selected:s.selectedRacesNotInSeries.includes(u.raceid)}]),onClick:g=>a.toggleRaceSelection(u.raceid)},[o("div",ox,[o("input",{class:"form-check-input",type:"checkbox",checked:s.selectedRacesNotInSeries.includes(u.raceid),onClick:st(g=>a.toggleRaceSelection(u.raceid),["stop"])},null,8,rx),o("label",nx,[o("strong",null,S(a.formatRaceDate(u.eventDate)),1),M(" - "+S(((v=u.eventDetails)==null?void 0:v.name)||u.displayName),1)])])],10,sx)}),128))])),s.selectedRacesNotInSeries.length>0?(f(),p("div",ax,S(s.selectedRacesNotInSeries.length)+" race(s) selected ",1)):T("",!0)]),o("div",ix,[o("button",{type:"button",class:"btn btn-secondary",onClick:e[18]||(e[18]=u=>s.showAddRacesModal=!1)},"Cancel"),o("button",{type:"button",class:"btn btn-primary",onClick:e[19]||(e[19]=(...u)=>a.addRacesToSeries&&a.addRacesToSeries(...u)),disabled:s.selectedRacesNotInSeries.length===0||s.updatingRaces},S(s.updatingRaces?"Adding...":`Add ${s.selectedRacesNotInSeries.length} Race(s)`),9,lx)])])])])):T("",!0),s.showImportCategoriesModal?(f(),p("div",cx,[o("div",dx,[o("div",ux,[o("div",mx,[hx,o("button",{type:"button",class:"btn-close",onClick:e[20]||(e[20]=(...u)=>a.closeImportCategoriesModal&&a.closeImportCategoriesModal(...u))})]),o("div",fx,[s.loadingImportRaces?(f(),p("div",px,yx)):(f(),p("div",bx,[o("div",Cx,[Sx,s.importRaces.length===0?(f(),p("div",Dx,_x)):(f(),p("div",Ex,[(f(!0),p(te,null,de(s.importRaces,u=>{var v;return f(),p("div",{key:u.raceid,class:le(["import-race-item",{selected:s.selectedImportRaceId===u.raceid}]),onClick:g=>a.selectImportRace(u.raceid)},[o("div",Px,[o("strong",null,S(((v=u.eventDetails)==null?void 0:v.name)||u.displayName),1),o("small",Tx,[M(S(a.formatRaceDate(u.eventDate))+" ",1),u.regCategories?(f(),p("span",Rx," ("+S(u.regCategories.length)+" categories) ",1)):T("",!0)])])],10,wx)}),128))]))]),o("div",Ox,[Ix,s.selectedImportRaceId?s.selectedImportRaceCategories?(f(),p("div",Mx,[o("div",Fx,[o("strong",null,S(s.selectedImportRaceCategories.length),1),M(" categories will be imported ")]),o("div",Nx,[o("table",Lx,[Ux,o("tbody",null,[(f(!0),p(te,null,de(s.selectedImportRaceCategories,(u,v)=>(f(),p("tr",{key:u.id||v},[o("td",jx,S(v+1),1),o("td",null,[o("strong",null,S(u.catdispname),1),u.sponsored?(f(),p("span",Vx,"Sponsored")):T("",!0)]),o("td",Hx,[u.startTime?(f(),p("span",Gx,S(u.startTime),1)):(f(),p("span",Bx,""))]),o("td",Kx,S(u.laps||""),1),o("td",zx,[u.minAge||u.maxAge?(f(),p("span",Wx,S(u.minAge||"")+" - "+S(u.maxAge||""),1)):(f(),p("span",Yx,""))])]))),128))])])])])):T("",!0):(f(),p("div",kx,Ax))])]))]),o("div",Xx,[o("button",{type:"button",class:"btn btn-secondary",onClick:e[21]||(e[21]=(...u)=>a.closeImportCategoriesModal&&a.closeImportCategoriesModal(...u))},"Cancel"),o("button",{type:"button",class:"btn btn-primary",onClick:e[22]||(e[22]=(...u)=>a.confirmImportCategories&&a.confirmImportCategories(...u)),disabled:!s.selectedImportRaceId},[D(c,{size:16,class:"me-1"}),M(" Import Categories ")],8,Jx)])])])])):T("",!0)]),o("div",Qx,[o("div",Zx,[qx,o("div",e_,[o("dl",t_,[s_,o("dd",null,[o("code",null,S(s.seriesData.seriesId||s.seriesData.series),1)]),o_,o("dd",null,S(s.formData.year),1),r_,o("dd",null,[s.formData.active?(f(),p("span",n_,"Active")):(f(),p("span",a_,"Inactive"))]),i_,o("dd",null,[s.formData.regCategories.length>0?(f(),p("span",l_,S(s.formData.regCategories.length)+" categories ",1)):(f(),p("span",c_,"None defined"))]),d_,o("dd",null,[s.formData.categoryGroups.length>0?(f(),p("span",u_,S(s.formData.categoryGroups.length)+" groups ",1)):(f(),p("span",m_,"None defined"))]),h_,o("dd",null,[!s.loadingRaces&&s.racesInSeries.length>0?(f(),p("span",f_,S(s.racesInSeries.length)+" races ",1)):s.loadingRaces?(f(),p("span",p_,"Loading...")):(f(),p("span",v_,"No races"))])])])])])])])):(f(),p("div",g_,b_)),D(oo,{name:"slide-up"},{default:G(()=>[a.loaded&&s.showStickySaveButton?(f(),p("div",{key:0,class:le(["sticky-save-bar",{"has-changes":s.hasUnsavedChanges}])},[o("div",C_,[o("div",S_,[o("div",D_,[o("strong",null,S(s.seriesData.displayName||s.seriesData.name),1),s.hasUnsavedChanges?(f(),p("span",x_,"- Unsaved changes")):(f(),p("span",__,"- All changes saved"))]),o("button",{class:"btn btn-light btn-lg",onClick:e[23]||(e[23]=(...u)=>a.saveSeries&&a.saveSeries(...u)),disabled:s.saving||!s.hasUnsavedChanges},[D(i,{size:18,class:"me-2"}),M(" "+S(s.saving?"Saving...":s.hasUnsavedChanges?"Save Changes":"Saved"),1)],8,E_)])])],2)):T("",!0)]),_:1})],2))}const P_=ge(y0,[["render",w_],["__scopeId","data-v-57ff0ad8"]]),T_=va({history:ga("/"),routes:[{path:"/payments/",component:Ai,name:"payments"},{path:"/races/",component:My,name:"races"},{path:"/series/",component:Z1,name:"series"},{path:"/series/:seriesId",component:P_,name:"edit-series"},{path:"/results/",component:sb,name:"results"},{path:"/series-results/",component:Vb,name:"series-results"},{path:"/edit-series-result/:series",component:g1,name:"edit-series-result"},{path:"/results/:resultid/",component:jy,name:"view-result",children:[{path:"",component:gb,name:"edit-result"}]},{path:"/race/:raceid/",component:qg,name:"view-race",children:[{path:"",component:Jv,name:"edit-race"},{path:"racers/",component:rc,name:"edit-racers"},{path:"racers-purchases/",component:Kg,name:"racer-purchases"},{path:"series/:series",component:Dg,name:"edit-series-racers"}]}]});ya.init({clientToken:"pub5b9b0cfce30b3b609b588d9f3ac85ebb",site:"datadoghq.com",env:"production",service:"admin-site",version:"1.0.1",forwardErrorsToLogs:!0,sampleRate:100});const go=Ro(Xa);go.use(ba,Ca);go.use(T_);go.mount("#app");
//# sourceMappingURL=admin-a3c320b2.js.map
