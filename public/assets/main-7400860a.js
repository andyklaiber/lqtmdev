import{_ as S,R as q,r as k,o as a,c as r,a as b,b as t,d as C,e as m,t as c,w as N,f as x,n as B,p as K,g as z,h as w,i as y,F as p,j as D,k as O,l as J,m as Q,q as X,s as Z,u as ee,v as te,x as se}from"./main-42df6384.js";const ae={components:{RouterView:q},data(){return{races:[]}},mounted:function(){},computed:{}},re={class:"container"};function ie(e,s,n,u,o,i){const g=k("RouterView");return a(),r("div",re,[b(g)])}const oe=S(ae,[["render",ie]]),ne={props:["url"],created(){(function(e,s,n){var u,o=e.getElementsByTagName(s)[0];e.getElementById(n)||(u=e.createElement(s),u.id=n,u.src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v15.0",o.parentNode.insertBefore(u,o))})(document,"script","facebook-jssdk")},mounted(){window.FB&&FB.XFBML.parse()}},le={id:"1"},ce=t("div",{id:"fb-root"},null,-1),de=["data-href"];function ue(e,s,n,u,o,i){return a(),r("div",le,[ce,t("div",{class:"fb-share-button","data-href":this.url,"data-layout":"button","data-size":"large"},null,8,de)])}const he=S(ne,[["render",ue]]),me={components:{FbShareComponent:he},props:["details","raceid","compactMode","series","seriesData","seriesRaceCount","hideRosterButton"],data(){return{}},computed:{seriesDisplayText(){if(!this.seriesData)return"Part of a Series";const e=this.seriesData.displayName||this.seriesData.name||"Series",s=this.seriesData.year?` ${this.seriesData.year}`:"";return`${e}${s}`},isRosterPage(){return this.$route.path.includes("/roster/")},isRegPage(){return this.$route.name==="register"},regDisabled(){return C().isBefore(this.details.regOpenDate)},regEnded(){return C().isAfter(this.details.regCloseDate)},regTimeToOpen(){return C().to(this.details.regOpenDate)},regTimeToClose(){return C().to(this.details.regCloseDate)},imgWidth(){return this.compactMode?150:225}}},pe={class:"container mb-4"},_e=["src"],ye={class:"row p-1 px-3 pb-0 pe-lg-0 pt-lg-3 align-items-center rounded-3 border shadow"},ge={key:0,class:"col-md-3 px-3"},fe={class:"d-flex justify-content-center"},ve=["href"],be=["src","width"],De={class:"col-md-7 p-3 p-lg-3 pt-lg-3"},ke={class:"row"},$e={class:"col col-md-auto"},Ce={class:"display-7 fw-bold lh-3"},Re={key:0,class:"lead mb-0 fw-bold"},Se={class:"display-9"},we={key:0,class:"mb-2"},Te=t("i",{class:"bi bi-collection"},null,-1),xe={key:1,class:"d-grid gap-2 d-md-flex justify-content-md mb-4 mb-lg-3"},Pe={class:"col-md-auto"},Ne=["href"],Be={class:"col col-lg-2"},Oe={key:0},Ee={key:2,class:"fw-bold"},Me={key:3,class:"row"},Fe={key:0,class:"fw-bold"},Le={key:0,class:"fw-bold"},Ae={key:1,class:"fw-bold"},Ie={key:1,class:"col col-md-auto"},Ve={key:2,class:"col"};function Ue(e,s,n,u,o,i){var l;const g=k("RouterLink"),v=k("FbShareComponent");return a(),r("div",pe,[i.isRegPage?(a(),r("img",{key:0,class:"img-fluid",src:n.details.headerPhoto,alt:""},null,8,_e)):m("",!0),t("div",ye,[n.details.logoUrl?(a(),r("div",ge,[t("div",fe,[t("a",{href:n.details.homepageUrl},[t("img",{class:"pb-1",src:n.details.logoUrl,alt:"",width:i.imgWidth},null,8,be)],8,ve)])])):m("",!0),t("div",De,[t("div",ke,[t("div",$e,[t("h3",Ce,c(n.details.name),1),n.compactMode?m("",!0):(a(),r("p",Re,c(n.details.tagline),1))])]),t("p",Se,c(n.details.formattedDates),1),n.series&&n.seriesRaceCount>1?(a(),r("div",we,[b(g,{to:{name:"racesBySeries",params:{seriesid:n.series}},class:"badge bg-primary text-decoration-none"},{default:N(()=>[Te,x(" "+c(i.seriesDisplayText),1)]),_:1},8,["to"])])):m("",!0),n.details.homepageUrl&&!n.compactMode?(a(),r("div",xe,[t("div",Pe,[t("a",{class:"btn btn-sm btn-success",href:n.details.homepageUrl},"Event Homepage",8,Ne)]),t("div",Be,[n.details.facebookShare?(a(),r("div",Oe,[b(v,{url:n.details.homepageUrl},null,8,["url"])])):m("",!0)])])):m("",!0),i.regDisabled?(a(),r("div",Ee," Registration will open "+c(i.regTimeToOpen),1)):(a(),r("div",Me,[(l=n.details)!=null&&l.regCloseDate?(a(),r("div",Fe,[i.regEnded?(a(),r("div",Le," Registration is closed ")):(a(),r("div",Ae," Registration will close "+c(i.regTimeToClose),1))])):m("",!0),!i.isRegPage&&!i.regEnded?(a(),r("div",Ie,[b(g,{class:"btn btn-success",to:{name:"register",params:{raceid:n.raceid}}},{default:N(()=>[x("Register")]),_:1},8,["to"])])):m("",!0),!i.isRosterPage&&!n.hideRosterButton?(a(),r("div",Ve,[b(g,{class:"btn btn-secondary",to:{name:"roster",params:{raceid:n.raceid}}},{default:N(()=>[x("See who is signed up ")]),_:1},8,["to"])])):m("",!0)]))])])])}const E=S(me,[["render",Ue]]);const je={props:["races"],data(){return{count:0,loggedIn:!1}},computed:{}},H=e=>(K("data-v-2f3c77b1"),e=e(),z(),e),qe={class:"navbar navbar-expand-md navbar-dark bg-dark fixed-top"},He={class:"container-fluid"},Ye=H(()=>t("a",{class:"navbar-brand",href:"/"},"Signup.bike",-1)),Ge=H(()=>t("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarsExample04","aria-controls":"navbarsExample04","aria-expanded":"false","aria-label":"Toggle navigation"},[t("span",{class:"navbar-toggler-icon"})],-1)),We={class:"collapse navbar-collapse",id:"navbarsExample04"},Ke={class:"navbar-nav me-auto mb-4 mb-md-0 px-5"},ze={class:"nav-item"};function Je(e,s,n,u,o,i){const g=k("RouterLink");return a(),r("nav",qe,[t("div",He,[Ye,Ge,t("div",We,[t("ul",Ke,[t("li",ze,[b(g,{class:B(["nav-link",{active:e.$route.name=="home"}]),to:{name:"home"}},{default:N(()=>[x(" Upcoming Races ")]),_:1},8,["class"])])]),o.loggedIn?(a(),r("button",{key:0,type:"button",class:"btn btn-secondary",onClick:s[0]||(s[0]=v=>e.$emit("logout"))},"Logout")):m("",!0)])])])}const M=S(je,[["render",Je],["__scopeId","data-v-2f3c77b1"]]);const Qe={emits:["logout"],components:{MainNav:M,RouterView:q,EventDetailsComponent:E},data(){return{count:0,races:[],loading:!0}},created(){this.$watch(()=>this.$route.query,()=>{this.fetchData()},{immediate:!0})},methods:{fetchData(){if(this.error=null,this.loading=!0,console.log("fetch plz"),this.$route)return w("/api/races/").then(e=>{this.races=e.data,this.loading=!1,console.log("fetched"),console.log(this.races)}).catch(e=>{this.loading=!1,this.error=e.toString(),console.error(e)})},shouldHideRosterButton(e){return e.hideRosterButton||e.entryCount===0}},computed:{isFilteredBySeries(){return!!this.$route.params.seriesid},filteredSeriesName(){var s,n;if(!this.isFilteredBySeries)return null;const e=this.displayRaces[0];return((s=e==null?void 0:e.seriesData)==null?void 0:s.displayName)||((n=e==null?void 0:e.seriesData)==null?void 0:n.name)||"this series"},displayRaces(){let e={},s=y.filter(this.races,n=>{if(this.$route.params.seriesid){if(n.series!==this.$route.params.seriesid)return!1}else if(n.series&&e[n.series]&&!n.disableSeriesRedirect)return!1;let u=C().isBefore(C(n.eventDate));return console.log("isInFuture"+u+" "+n.displayName),n.isTestData&&!this.$route.query.test||!u&&!this.$route.query.past?!1:(typeof n.series=="string"&&n.series.length>1&&(console.log("set as shown "+n.raceid),e[n.series]=!0),!0)});return y.sortBy(s,[function(n){return C(n.eventDate)}])},seriesRaceCounts(){const e={};return this.displayRaces.forEach(s=>{s.series&&(e[s.series]=(e[s.series]||0)+1)}),e},loggedIn(){return!1}}},Xe={key:0},Ze={key:1},et={key:0,class:"alert alert-info d-flex justify-content-between align-items-center mb-4",role:"alert"};function tt(e,s,n,u,o,i){const g=k("MainNav"),v=k("RouterLink"),l=k("EventDetailsComponent");return a(),r(p,null,[b(g),o.loading?(a(),r("div",Xe," Plz wait, loading... ")):(a(),r("div",Ze,[i.isFilteredBySeries?(a(),r("div",et,[t("div",null,[t("strong",null,"Viewing races in "+c(i.filteredSeriesName),1)]),b(v,{to:"/",class:"btn btn-sm btn-outline-primary"},{default:N(()=>[x(" View All Upcoming Races ")]),_:1})])):m("",!0),(a(!0),r(p,null,D(i.displayRaces,(h,_)=>(a(),r("div",{key:_},[b(l,{details:h.eventDetails,raceid:h.raceid,series:h.series,"series-data":h.seriesData,"series-race-count":i.seriesRaceCounts[h.series],hideRosterButton:i.shouldHideRosterButton(h),"compact-mode":"true"},null,8,["details","raceid","series","series-data","series-race-count","hideRosterButton"])]))),128))]))],64)}const F=S(Qe,[["render",tt],["__scopeId","data-v-87709bc4"]]);let L=(e,s=!1)=>{const n=new Date(Date.UTC(0,0,0,0,0,0,e));let o=[n.getUTCMinutes(),n.getUTCSeconds()].map(i=>String(i).padStart(2,"0")).join(":");return s&&(o=o.concat("."+`${n.getUTCMilliseconds()}`.padStart(3,"0"))),n.getUTCHours()&&(o=n.getUTCHours()+":"+o),o};const st={props:["data","Pos","totLaps","showMillis"],data(){return{count:0}},methods:{msToTimeString(e){return L(e,this.showMillis)}},computed:{incompleteLaps(){return new Array(this.totLaps-this.data.laps.length).fill("-")},formattedTime(){return L(this.data.duration,this.showMillis)},trailingTime(){return this.data.back?this.showMillis?L(this.data.backMs,!0):this.data.back:"-"}}};function at(e,s,n,u,o,i){return a(),r(p,null,[t("td",null,c(n.Pos+1),1),t("td",null,c(n.data.Bib),1),t("td",null,c(n.data.Name),1),t("td",null,c(n.data.Sponsor),1),(a(!0),r(p,null,D(n.data.laps,(g,v)=>(a(),r("td",{key:v},c(i.msToTimeString(g.duration)),1))),128)),n.totLaps-n.data.laps.length>0?(a(!0),r(p,{key:0},D(i.incompleteLaps,g=>(a(),r("td",null,c(g),1))),256)):m("",!0),t("td",null,c(i.formattedTime),1),t("td",null,c(i.trailingTime),1)],64)}const Y=S(st,[["render",at]]),rt={props:["series"],data(){return{count:0,seriesData:{}}},created(){this.$watch(()=>this.series,function(){if(!this.series)return;let e=`/api/series/${this.series}/races`;w(e).then(({data:s})=>{this.seriesData=s})})},computed:{isPcrs(){return this.series&&this.series.indexOf("pcrs")>-1}}},it={id:"top",class:"navbar navbar-light bg-light"},ot={class:"container-fluid"},nt={class:"navbar-brand",href:"#"},lt={key:0,class:"nav-item"},ct=["href"],dt=t("p",{class:"mt-3"},"View Weekly lap times:",-1),ut={class:"nav nav-tabs mt-1 justify-content-center"},ht={key:0,class:"nav-item"},mt={key:1,class:"nav-item"},pt={key:2,class:"nav-item"};function _t(e,s,n,u,o,i){const g=k("RouterLink");return a(),r(p,null,[t("nav",it,[t("div",ot,[t("div",nt,c(o.seriesData.displayName),1),o.seriesData.homepage?(a(),r("div",lt,[t("a",{class:"nav-link active","aria-current":"page",href:o.seriesData.homepage.url},c(o.seriesData.homepage.linkString),9,ct)])):m("",!0)])]),dt,t("ul",ut,[(a(!0),r(p,null,D(o.seriesData.races,v=>(a(),r("li",{key:v.raceid,class:"nav-item"},[b(g,{class:B(["nav-link",{active:e.$route.params.raceid===v.raceid}]),to:`/race/${v.raceid}`},{default:N(()=>[x(c(v.displayName+` - ${v.formattedStartDate}`),1)]),_:2},1032,["class","to"])]))),128)),i.isPcrs?(a(),r("li",ht,[b(g,{class:B(["nav-link",{active:e.$route.path=="/series/pcrs_2022"}]),to:"/series/pcrs_2022"},{default:N(()=>[x("Series Standings")]),_:1},8,["class"])])):m("",!0),i.isPcrs?(a(),r("li",mt,[b(g,{class:B(["nav-link",{active:e.$route.path=="/series/grom/pcrs_2022"}]),to:"/series/grom/pcrs_2022"},{default:N(()=>[x("Grom Series Standings")]),_:1},8,["class"])])):m("",!0),i.isPcrs?(a(),r("li",pt,[b(g,{class:B(["nav-link",{active:e.$route.path=="/teamcomp/pcrs_2022"}]),to:"/teamcomp/pcrs_2022"},{default:N(()=>[x("Team Competition")]),_:1},8,["class"])])):m("",!0)])],64)}const A=S(rt,[["render",_t]]);const yt={components:{ResultRow:Y,SeriesNavBar:A},data(){return{categories:{},loading:!1,error:null,formattedStartDate:"",series:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{scrollMeTo(e){var s=document.querySelector(`#${e}`);s.scrollIntoView({behavior:"smooth"})},fetchData(){if(this.error=null,this.loading=!0,this.$route.params.raceid){let e=`/api/races/results/${this.$route.params.raceid}`;w(e).then(({data:s})=>{this.formattedStartDate=s.raceMeta.formattedStartDate,this.series=s.series,this.loading=!1,this.categories=s.categories}).catch(s=>{console.error(s),this.categories={},this.error=s.toString()})}}},computed:{sortedCats(){return y.orderBy(this.categories,"disporder")},expertCats(){return y.filter(this.sortedCats,{laps:4})},sportCats(){return y.filter(this.sortedCats,{laps:3})},beginnerCats(){return y.filter(this.sortedCats,{laps:2})},gromCats(){return y.filter(this.categories,e=>e.id.indexOf("grom")>-1)},haveResults(){return this.categories?Object.keys(this.categories).length>0:!1}}},gt={key:0,class:"text-center"},ft={class:"mt-5"},vt={key:1,class:"loading"},bt={key:2},Dt={key:0,class:"error"},kt={key:1},$t={class:"container text-center mt-5"},Ct={class:"list-inline"},Rt=["onClick"],St={class:"list-inline"},wt=["onClick"],Tt={class:"list-inline"},xt=["onClick"],Pt={class:"list-inline"},Nt=["onClick"],Bt={class:"container-fluid"},Ot=["id"],Et={class:"table table-striped table-hover"},Mt={key:2},Ft=t("div",{class:"text-center"},[t("h2",{class:"mt-5"},"No results yet...")],-1),Lt=[Ft];function At(e,s,n,u,o,i){const g=k("SeriesNavBar"),v=k("ResultRow");return a(),r(p,null,[b(g,{series:o.series},null,8,["series"]),o.formattedStartDate?(a(),r("div",gt,[t("h2",ft,"Race Results - "+c(o.formattedStartDate),1)])):m("",!0),o.loading?(a(),r("div",vt,"Loading...")):(a(),r("div",bt,[o.error?(a(),r("div",Dt,c(o.error),1)):m("",!0),i.haveResults?(a(),r("div",kt,[t("div",$t,[t("ul",Ct,[(a(!0),r(p,null,D(i.expertCats,(l,h)=>(a(),r("li",{key:l.id,class:"list-inline-item mx-2"},[t("a",{role:"button",onClick:_=>i.scrollMeTo(l.id),class:"link-primary"},c(l.catdispname),9,Rt)]))),128))]),t("ul",St,[(a(!0),r(p,null,D(i.sportCats,(l,h)=>(a(),r("li",{key:l.id,class:"list-inline-item mx-2"},[t("a",{role:"button",onClick:_=>i.scrollMeTo(l.id),class:"link-primary"},c(l.catdispname),9,wt)]))),128))]),t("ul",Tt,[(a(!0),r(p,null,D(i.beginnerCats,(l,h)=>(a(),r("li",{key:l.id,class:"list-inline-item mx-2"},[t("a",{role:"button",onClick:_=>i.scrollMeTo(l.id),class:"link-primary"},c(l.catdispname),9,xt)]))),128))]),t("ul",Pt,[(a(!0),r(p,null,D(i.gromCats,(l,h)=>(a(),r("li",{key:l.id,class:"list-inline-item mx-2"},[t("a",{role:"button",onClick:_=>i.scrollMeTo(l.id),class:"link-primary"},c(l.catdispname),9,Nt)]))),128))])]),t("div",Bt,[(a(!0),r(p,null,D(i.sortedCats,(l,h)=>(a(),r("div",{key:l.id,class:"mt-5"},[t("h3",{id:l.id},c(l.catdispname),9,Ot),t("table",Et,[t("thead",null,[t("tr",null,[(a(!0),r(p,null,D(l.columns,(_,f)=>(a(),r("th",{scope:"col",key:f},c(_),1))),128))])]),t("tbody",null,[(a(!0),r(p,null,D(l.results,(_,f)=>(a(),r("tr",{key:f},[b(v,{totLaps:l.laps,Pos:f,data:_},null,8,["totLaps","Pos","data"])]))),128))])]),t("a",{role:"button",onClick:s[0]||(s[0]=_=>i.scrollMeTo("top")),class:"link-primary"},"Back to Top")]))),128))])])):(a(),r("div",Mt,Lt))]))],64)}const It=S(yt,[["render",At]]),Vt={props:["series","displayName"],data(){return{count:0,seriesData:{},races:[]}},created(){this.$watch(()=>this.series,function(){if(!this.series)return;let e=`/api/results/?series=${this.series}`;w(e).then(({data:s})=>(this.races=s,w(`api/results/series/?series=${this.series}`))).then(({data:s})=>{this.seriesData=s})})},computed:{isPcrs(){return this.series&&this.series.indexOf("pcrs")>-1},hasTeamComp(){var e,s;return((s=(e=this.seriesData)==null?void 0:e.teamCompDates)==null?void 0:s.length)>1},headerName(){var e;return this.displayName||((e=this.seriesData)==null?void 0:e.eventName)},isSeriesResultPage(){return this.$route.name=="seriesResults"}}},Ut={key:0,id:"top",class:"navbar navbar-light bg-light"},jt={class:"container-fluid"},qt={class:"navbar-brand h2",href:"#"},Ht={key:1},Yt=t("p",{class:"mt-3"},"View Individual Event Times:",-1),Gt={class:"nav nav-tabs mt-1 justify-content-center"},Wt={key:0},Kt={key:1};function zt(e,s,n,u,o,i){const g=k("RouterLink");return a(),r(p,null,[i.headerName?(a(),r("nav",Ut,[t("div",jt,[t("div",qt,c(i.headerName),1)])])):m("",!0),o.races.length>1?(a(),r("div",Ht,[Yt,t("ul",Gt,[(a(!0),r(p,null,D(o.races,v=>(a(),r("li",{key:v.raceid,class:"nav-item"},[b(g,{class:B(["nav-link",{active:e.$route.params.id===v.raceid&&e.$route.name=="raceResult"}]),to:`/result/${v.raceid}`},{default:N(()=>[x(c(v.eventName+` - ${v.formattedStartDate}`),1)]),_:2},1032,["class","to"])]))),128)),i.isSeriesResultPage?m("",!0):(a(),r("li",Wt,[b(g,{class:B(["nav-link",{active:e.$route.name=="seriesResults"}]),to:{name:"seriesResults",params:{seriesid:n.series}}},{default:N(()=>[x("Overall Standings")]),_:1},8,["class","to"])])),i.hasTeamComp?(a(),r("li",Kt,[b(g,{class:B(["nav-link",{active:e.$route.name=="teamCompResults"}]),to:{name:"teamCompResults",params:{seriesid:n.series}}},{default:N(()=>[x("Team Competition Standings")]),_:1},8,["class","to"])])):m("",!0)])])):m("",!0)],64)}const I=S(Vt,[["render",zt]]);const Jt={components:{ResultRow:Y,SeriesNavBar:I},data(){return{resultData:{},categories:{},loading:!1,error:null,formattedStartDate:"",series:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{scrollMeTo(e){var s=document.querySelector(`#${e}`);s.scrollIntoView({behavior:"smooth"})},fetchData(){if(this.error=null,this.loading=!0,this.$route.params.id){let e=`/api/results/${this.$route.params.id}`;w(e).then(({data:s})=>{this.formattedStartDate=s.formattedStartDate,this.series=s.series,this.resultData=s,this.loading=!1,this.categories=s.categories}).catch(s=>{console.error(s),this.categories={},s.response.status==404?this.error="":this.error=s.toString(),this.loading=!1})}else this.$router.push("")},metaColumns(e){return e.slice(0,4)},lapColumns(e){let s=[];for(let n=1;n<=e.length;n++)s.push(`Lap ${n}`);return this.fastestLapScoring?s.push("Fastest Lap:"):s.push("Total"),s.push("Time Behind Leader"),s}},computed:{fastestLapScoring(){return this.resultData.scoringType=="fastestlap"},sortedCats(){return y.orderBy(this.categories,"disporder")},haveResults(){return this.categories?Object.keys(this.categories).length>0:!1}}},Qt={key:0,class:"text-center"},Xt={class:"mt-5"},Zt={key:1,class:"text-center"},es={class:"mt-5"},ts={key:2,class:"loading"},ss={key:3},as={key:0,class:"error"},rs={key:1},is={id:"top",class:"container text-center mt-5"},os={class:"list-inline"},ns=["onClick"],ls={class:"container-fluid"},cs=["id"],ds={class:"table table-striped table-hover"},us={key:2},hs=t("div",{class:"text-center"},[t("h2",{class:"mt-5"},"No results yet...")],-1),ms=[hs];function ps(e,s,n,u,o,i){const g=k("SeriesNavBar"),v=k("ResultRow");return a(),r(p,null,[b(g,{series:o.series},null,8,["series"]),o.resultData.eventName?(a(),r("div",Qt,[t("h2",Xt,"Race Results - "+c(o.resultData.eventName),1)])):m("",!0),o.formattedStartDate?(a(),r("div",Zt,[t("h2",es,c(o.formattedStartDate),1)])):m("",!0),o.loading?(a(),r("div",ts,"Loading...")):(a(),r("div",ss,[o.error?(a(),r("div",as,c(o.error),1)):m("",!0),i.haveResults?(a(),r("div",rs,[t("div",is,[t("ul",os,[(a(!0),r(p,null,D(i.sortedCats,(l,h)=>(a(),r("li",{key:l.id,class:"list-inline-item mx-2"},[t("a",{role:"button",onClick:_=>i.scrollMeTo(l.id),class:"link-primary"},c(l.catdispname),9,ns)]))),128))])]),t("div",ls,[(a(!0),r(p,null,D(i.sortedCats,(l,h)=>(a(),r("div",{key:l.id,class:"mt-5"},[t("h3",{id:l.id},c(l.catdispname),9,cs),t("table",ds,[t("thead",null,[t("tr",null,[(a(!0),r(p,null,D(i.metaColumns(l.columns),(_,f)=>(a(),r("th",{scope:"col",key:f},c(_),1))),128)),(a(!0),r(p,null,D(i.lapColumns(l.results[0].laps),(_,f)=>(a(),r("th",{scope:"col",key:f},c(_),1))),128))])]),t("tbody",null,[(a(!0),r(p,null,D(l.results,(_,f)=>(a(),r("tr",{key:f},[b(v,{totLaps:l.results[0].laps.length,Pos:f,data:_,showMillis:o.resultData.showMillis||i.fastestLapScoring},null,8,["totLaps","Pos","data","showMillis"])]))),128))])]),t("a",{role:"button",onClick:s[0]||(s[0]=_=>i.scrollMeTo("top")),class:"link-primary"},"Back to Top")]))),128))])])):(a(),r("div",us,ms))]))],64)}const _s=S(Jt,[["render",ps]]);const ys={props:["data","Pos"],data(){return{count:0}},computed:{}};function gs(e,s,n,u,o,i){return a(),r(p,null,[t("td",null,c(n.Pos+1),1),t("td",null,c(n.data.Bib),1),t("td",null,c(n.data.Name),1),t("td",null,c(n.data.Age),1),t("td",null,c(n.data.Sponsor),1),(a(!0),r(p,null,D(n.data.results,(g,v)=>(a(),r("td",{class:B({"text-danger":g.dropped}),key:v},c(g.resultString),3))),128)),t("td",null,c(n.data.seriesPoints),1)],64)}const G=S(ys,[["render",gs]]);const fs={components:{SeriesResultRow:G,SeriesNavBar:I},data(){return{categories:{},loading:!1,error:null,displayName:"",series:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{scrollMeTo(e){var s=document.querySelector(`#${e}`);s.scrollIntoView({behavior:"smooth"})},fetchData(){if(!this.$route.params.seriesid)return;this.error=null,this.loading=!0;let e=`/api/series/results/${this.$route.params.seriesid}`;w(e).then(({data:s})=>{this.loading=!1,this.categories=s.categories,this.displayName=s.eventName,this.series=this.$route.params.seriesid,y.map(s.categories,n=>y.omit(n,["results","columns"]))}).catch(s=>{console.error(s),this.categories={},this.error=s.toString()})}},computed:{sortedCats(){return y.orderBy(this.categories,"disporder")},haveResults(){return this.categories?Object.keys(this.categories).length>0:!1},isPCRS(){return y.isString(this.series)&&this.series.indexOf("pcrs")>-1}}},vs={key:0,class:"loading"},bs={key:1},Ds={key:0,class:"error"},ks={class:"container-fluid text-center mt-5"},$s=t("h3",null,"Series Standings",-1),Cs=t("p",null,"Glossary of terms below:",-1),Rs={key:0},Ss={key:1},ws={key:1},Ts={class:"container-fluid text-center mt-5"},xs={class:"list-inline"},Ps=["onClick"],Ns={class:"container-fluid"},Bs=["id"],Os={class:"table table-striped table-hover"},Es={key:2},Ms=t("div",{class:"text-center"},[t("h2",{class:"mt-5"},"No results yet...")],-1),Fs=[Ms];function Ls(e,s,n,u,o,i){const g=k("SeriesNavBar"),v=k("SeriesResultRow");return a(),r(p,null,[b(g,{series:o.series,displayName:o.displayName},null,8,["series","displayName"]),o.loading?(a(),r("div",vs,"Loading...")):(a(),r("div",bs,[o.error?(a(),r("div",Ds,c(o.error),1)):m("",!0),t("div",ks,[$s,Cs,i.isPCRS?(a(),r("p",Rs,"1/50 = 1st Place/50 Points   -/- = Did not race")):(a(),r("p",Ss,"1/100 = 1st Place/100 Points   -/- = Did not race"))]),i.haveResults?(a(),r("div",ws,[t("div",Ts,[t("ul",xs,[(a(!0),r(p,null,D(i.sortedCats,l=>(a(),r("li",{key:l.id,class:"list-inline-item mx-2"},[t("a",{role:"button",onClick:h=>i.scrollMeTo(l.id),class:"link-primary"},c(l.catdispname),9,Ps)]))),128))])]),t("div",Ns,[(a(!0),r(p,null,D(i.sortedCats,l=>(a(),r("div",{key:l.id,class:"mt-5"},[t("h3",{id:l.id},c(l.catdispname),9,Bs),t("table",Os,[t("thead",null,[t("tr",null,[(a(!0),r(p,null,D(l.columns,(h,_)=>(a(),r("th",{scope:"col",key:_},c(h),1))),128))])]),t("tbody",null,[(a(!0),r(p,null,D(l.results,(h,_)=>(a(),r("tr",{key:_},[b(v,{Pos:_,data:h},null,8,["Pos","data"])]))),128))])]),t("a",{role:"button",onClick:s[0]||(s[0]=h=>i.scrollMeTo("top")),class:"link-primary"},"Back to Top")]))),128))])])):(a(),r("div",Es,Fs))]))],64)}const As=S(fs,[["render",Ls]]),Is={props:["categories","raceDate"],data(){return{}},methods:{formatStartTime(e){return C(`${C(this.raceDate).format("YYYY-MM-DD")} ${e}`).format("h:mm A")}},computed:{groupByStartTimes(){let e=this.categories.toSorted((s,n)=>C(s.startTime,"H:mm").diff(C(n.startTime,"H:mm")));return y.groupBy(e,"startTime")},hasStartTimes(){return!!y.some(this.categories,"startTime")}}},Vs={key:0},Us=t("h5",null,"Race Start Times:",-1),js={class:"row gap-5 mb-3"},qs={class:""},Hs={class:"row g-2 px-4 gx-4 border bg-light"};function Ys(e,s,n,u,o,i){return n.categories.length&&i.hasStartTimes?(a(),r("div",Vs,[Us,t("div",js,[(a(!0),r(p,null,D(i.groupByStartTimes,(g,v)=>(a(),r("div",{key:v,class:"col-md-5"},[t("h6",qs,c(i.formatStartTime(v))+":",1),t("div",Hs,[(a(!0),r(p,null,D(i.groupByStartTimes[v],l=>(a(),r("div",{key:l.id,class:"col-lg text-nowrap my-1"},c(l.catdispname),1))),128))])]))),128))])])):m("",!0)}const Gs=S(Is,[["render",Ys]]);let Ws=y.debounce((e,s)=>{window.localStorage.setItem(`race-reg-form-data-${s}`,JSON.stringify(e))},3500),Ks=e=>{let s=window.localStorage.getItem(`race-reg-form-data-${e}`);if(s){let n={};try{n=JSON.parse(s)}catch{}return n}return null},zs=e=>{window.localStorage.removeItem(`race-reg-form-data-${e}`)};function Js(e){if(e===0)return 0;let s=e*100,n=s*.04;return n>600&&(n=600),Math.round((s+n+30)/(1-.029))-s}const Qs={components:{MainNav:M,EventDetailsComponent:E,EventCategoryScheduleComponent:Gs},data(){return{categories:{},loading:!1,error:null,formError:[],formInputData:{},raceData:null,seriesData:null,payment:"",birthdate:"",submitted:!1,waiverAccepted:!1,couponError:[],prevBibError:[],seriesRaces:{},seriesRaceIdx:0,previousReg:!1,prevAge:null,originalPaymentOptions:null}},created(){this.$watch(()=>this.$route.params.raceid,()=>{this.fetchData()},{immediate:!0})},watch:{formInputData:{handler(e,s){this.previousReg==!1&&Ws(e,this.$route.params.raceid)},deep:!0}},methods:{dollas(e){return e.toLocaleString("en-US",{style:"currency",currency:"USD"})},fetchData(){this.error=null,this.loading=!0,this.$route.params.raceid&&w(`/api/races/${this.$route.params.raceid}`).then(async e=>{var n,u;this.raceData=e.data,console.log("=== Race Data Loaded ==="),console.log("seriesData:",this.raceData.seriesData),console.log("categoryGroups:",(n=this.raceData.seriesData)==null?void 0:n.categoryGroups),console.log("regCategories:",this.raceData.regCategories),console.log("paymentOptions:",this.raceData.paymentOptions);let s=Ks(this.$route.params.raceid);s&&(y.find((u=this.raceData)==null?void 0:u.regCategories,{id:s.category})||delete s.category,s.waiverAccepted=!1,this.formInputData=s),!this.raceData.disableSeriesRedirect&&this.raceData.series&&this.raceData.toString().length>1&&this.$route.name!=="register-test"&&await w(`/api/series/${this.raceData.series}/registration`).then(({data:o})=>{this.seriesRaces=o;let i=C();this.seriesRaceIdx=0,y.some(o,({eventDate:g,raceid:v},l)=>C(g).isBefore(i)?!1:(this.seriesRaceIdx=l,this.$route.params.raceid!==v&&this.$router.push(`/register/${v}`),!0))}),this.loading=!1,this.raceData.paymentOptions&&this.raceData.paymentOptions.length>0&&(this.payment=this.raceData.paymentOptions[0].type)}).catch(e=>{if(this.raceData=null,this.loading=!1,this.error=e.toString(),e.code=="ERR_BAD_REQUEST")return console.warn("tried to load raceid: "+this.$route.params.raceid),console.warn(e.message);console.error(e)})},findPrevBib(e){w.post("/api/racers/bib",{series:`${this.raceData.series}`,bibNumber:e}).then(({data:s})=>{if(console.log("prevbib"),s.paytype==="season"){this.prevBibError=["You are already registered for the whole season. You do not need to register every week."];return}s.prevPaymentId=s.paymentId,delete s.optionalPurchases,delete s.paymentId,this.formInputData=s,this.prevAge=s.racerAge}).catch(({response:s})=>{console.dir(s),s.status==404&&(this.prevBibError=[s.data.message])})},onPrevBibChange(e){e?this.findPrevBib(e):(this.prevBibError=[],this.prevAge=null)},getCouponPricing(e){this.originalPaymentOptions||(this.originalPaymentOptions=y.cloneDeep(this.raceData.paymentOptions)),w.post("/api/payments/pricing",{raceid:`${this.$route.params.raceid}`,couponCode:e}).then(({data:s})=>{if(this.raceData.paymentOptions=s.paymentOptions,s.validCoupon)this.couponError=[];else{if(s.reason)return this.couponError=[s.reason];this.couponError=["Invalid Coupon Code"]}})},onCouponChange(e){e?this.getCouponPricing(e):(this.couponError=[],this.originalPaymentOptions&&(this.raceData.paymentOptions=y.cloneDeep(this.originalPaymentOptions),this.originalPaymentOptions=null))},submitForm(e){e.preventDefault(),this.$formkit.submit("race-registration")},async submit(e){console.log(e),e.birthdate=void 0,e.racerAge=this.racerAge,e.paytype=this.payment,e.timestamp=C().format(),await w.post(`/api/payments/start-registration?race=${this.raceData.raceid}`,e).then(s=>{if(s.data){if(console.log("response data"),console.log(s.data),s.data.redirect)return this.submitted=!0,zs(this.$route.params.raceid),new Promise(n=>setTimeout(()=>{window.location.href=s.data.redirect,n()},2e3));s.data.message&&(this.formError=[s.data.message])}}).catch(s=>{var n,u;if((u=(n=s.response)==null?void 0:n.data)!=null&&u.message)return this.formError=[s.response.data.message];this.formError=["Error submitting request"]})},getEventTimeObj(e){return C(`${C(this.raceData.eventDate).format("YYYY-MM-DD")} ${e}`)},isSeriesCategory(e){var s,n;return(n=(s=this.raceData)==null?void 0:s.seriesData)!=null&&n.regCategories?this.raceData.seriesData.regCategories.some(u=>u.id===e):!1},isRaceOverride(e){return e._isRaceOverride===!0},isPureSeriesCategory(e){return e._isSeriesCategory===!0},getSeriesPaymentGroup(e){var s,n;return(n=(s=this.raceData)==null?void 0:s.seriesData)!=null&&n.categoryGroups?this.raceData.seriesData.categoryGroups.find(u=>u.categories&&u.categories.includes(e)):null},getAvailablePaymentOptionsForCategory(e){var i,g,v,l,h,_;if(!e)return[];console.log("=== getAvailablePaymentOptionsForCategory (Hybrid Model) ==="),console.log("Category:",e.catdispname,e.id),console.log("seriesData:",(i=this.raceData)==null?void 0:i.seriesData);const s=new Map;(this.raceData.paymentOptions||[]).forEach(f=>{s.set(f.type,f)});const n=this.isSeriesCategory(e.id),u=this.isRaceOverride(e),o=this.isPureSeriesCategory(e);if(console.log(`Category ${e.catdispname}:`,{isSeriesCategory:n,isRaceOverride:u,isPureSeriesCategory:o,hasPaytype:!!e.paytype}),u&&e.paytype){const f=[],$=new Set,T=(g=this.raceData.paymentOptions)==null?void 0:g.find(d=>d.type===e.paytype);T&&(f.push({...T,source:"race-override-paytype"}),$.add(T.type),console.log(`Race override ${e.catdispname} with paytype ${e.paytype}, added matching race option:`,T));const R=this.getSeriesPaymentGroup(e.id);return R&&R.paymentOptions&&R.paymentOptions.length>0&&(console.log(`Race override ${e.catdispname} also has series group ${R.name}, checking group options:`,R.paymentOptions),R.paymentOptions.forEach(d=>{$.has(d.type)?console.log(`  Skipped series group option ${d.name} (${d.type}) - race override takes precedence`):(f.push({...d,source:"series-group"}),$.add(d.type),console.log(`  Added series group option: ${d.name} (${d.type})`))})),console.log(`Race override ${e.catdispname} final options with paytype:`,f),f}if(e._isRaceSpecific&&e.paytype){const f=(v=this.raceData.paymentOptions)==null?void 0:v.find($=>$.type===e.paytype);return f?(console.log(`Race-specific category ${e.catdispname} with paytype ${e.paytype}:`,f),[{...f,source:"race-paytype"}]):(console.warn(`Race-specific category ${e.catdispname} has paytype ${e.paytype} but no matching race payment option found`),[])}if(u&&!e.paytype)return console.log(`Race override ${e.catdispname} without paytype, using all race payment options`),(this.raceData.paymentOptions||[]).map(f=>({...f,source:"race-override"}));if(o){const f=this.getSeriesPaymentGroup(e.id);if(console.log("Found payment group:",f),e.paytype){const $=[],T=new Set,R=(l=this.raceData.paymentOptions)==null?void 0:l.find(d=>d.type===e.paytype);if(R)console.log(`Series category ${e.catdispname} with paytype ${e.paytype}, adding race option:`,R),$.push({...R,source:"race-paytype"}),T.add(e.paytype);else if((h=this.raceData.seriesData)!=null&&h.defaultPaymentOptions){const d=this.raceData.seriesData.defaultPaymentOptions.find(P=>P.type===e.paytype);d&&(console.log(`Series category ${e.catdispname} with paytype ${e.paytype}, adding series default:`,d),$.push({...d,source:"series-default-paytype"}),T.add(e.paytype))}return f&&f.paymentOptions&&f.paymentOptions.length>0&&(console.log(`Series category ${e.catdispname} with paytype also has group ${f.name}, adding group options`),f.paymentOptions.forEach(d=>{if(!T.has(d.type)){if(s.has(d.type)){const P=s.get(d.type);console.log(`  Race overrides group ${d.type}: ${d.name} -> ${P.name}`),$.push({...d,name:P.name,amount:P.amount,source:"race-override-group"})}else $.push({...d,source:"series-group"});T.add(d.type)}})),$.length>0?(console.log(`Series category ${e.catdispname} final options with paytype:`,$),$):(console.warn(`Series category ${e.catdispname} has paytype ${e.paytype} but no matching payment option found`),[])}if(f&&f.paymentOptions&&f.paymentOptions.length>0){console.log(`Category ${e.catdispname} is in series group ${f.name}`);const $=f.paymentOptions.map(d=>{if(s.has(d.type)){const P=s.get(d.type);return console.log(`Race overrides ${d.type}: ${d.name} ($${d.amount}) -> ${P.name} ($${P.amount})`),{...d,name:P.name,amount:P.amount,source:"race-override-group"}}return{...d,source:"series-group"}}),T=new Set(f.paymentOptions.map(d=>d.type)),R=(this.raceData.paymentOptions||[]).filter(d=>!T.has(d.type)).map(d=>({...d,source:"race-additional"}));return R.length>0&&(console.log("Adding race-specific payment options not in group:",R),$.push(...R)),console.log("Final merged payment options (group + race):",$),$}if((_=this.raceData.seriesData)!=null&&_.defaultPaymentOptions&&this.raceData.seriesData.defaultPaymentOptions.length>0){console.log(`Category ${e.catdispname} uses series default payment options`);const $=this.raceData.seriesData.defaultPaymentOptions.map(d=>{if(s.has(d.type)){const P=s.get(d.type);return console.log(`Race overrides ${d.type}: ${d.name} ($${d.amount}) -> ${P.name} ($${P.amount})`),{...d,name:P.name,amount:P.amount,source:"race-override-default"}}return{...d,source:"series-default"}}),T=new Set(this.raceData.seriesData.defaultPaymentOptions.map(d=>d.type)),R=(this.raceData.paymentOptions||[]).filter(d=>!T.has(d.type)).map(d=>({...d,source:"race-additional"}));return R.length>0&&(console.log("Adding race-specific payment options not in defaults:",R),$.push(...R)),console.log("Final merged payment options (defaults + race):",$),$}}return console.log(`Category ${e.catdispname} uses race payment options:`,this.raceData.paymentOptions),(this.raceData.paymentOptions||[]).map(f=>({...f,source:"race"}))}},computed:{startTimes(){return this.hasStartTimes?y.map(y.uniqBy(this.raceData.regCategories,"startTime"),"startTime"):null},hasStartTimes(){return!!y.some(this.raceData.regCategories,"startTime")},currentTime(){return C().local().format()},firstRaceTime(){return this.hasStartTimes?C.min(y.map(this.startTimes,e=>C(`${this.eventDateFormatted} ${e}`))):null},lastRaceTime(){return this.hasStartTimes?C.max(y.map(this.startTimes,e=>C(`${this.eventDateFormatted} ${e}`))):null},sortedCats(){const e=y.filter(this.raceData.regCategories,n=>!0);let s={};return y.forEach(y.orderBy(e,"disporder"),n=>{s[n.id]=n.catdispname}),s},loaded(){return!!this.raceData},submitLabel(){return this.payment=="cash"||this.sponsoredCategorySelected?"Sign Up!":"Go to Payment"},cashEnabled(){return!!this.raceData.cashPaymentsEnabled},eventDateFormatted(){return C(this.raceData.eventDate).format("YYYY-MM-DD")},regDisabled(){return this.$route.name=="register-test"?!1:this.eventFull||C().isBefore(this.raceData.eventDetails.regOpenDate)||this.raceData.eventDetails.regCloseDate&&C().isAfter(this.raceData.eventDetails.regCloseDate)?!0:this.lastRaceTime?C().isAfter(this.lastRaceTime.subtract(5,"minute")):!1},eventFull(){return!!(this.raceData.entryCountMax&&this.raceData.entryCountMax>1&&this.raceData.entryCount>=this.raceData.entryCountMax)},paymentOptions(){let e={};if(!this.selectedCategory)return console.log("No category selected, showing no payment options"),e;console.log("=== Building paymentOptions (Hybrid Model) ==="),console.log("Selected category:",this.selectedCategory.catdispname,this.selectedCategory.id);const s=this.getAvailablePaymentOptionsForCategory(this.selectedCategory);console.log("Available payment options for category:",s);const n=y.sortBy(s,u=>parseFloat(u.amount||0));return y.forEach(n,u=>{if(console.log("Processing payment option:",u.type,u.name,u),u.type==="season"&&u.categoryGroups&&this.formInputData.category){const o=u.categoryGroups.find(i=>i.categories.includes(this.formInputData.category));o?e[u.type]=o.name:u.defaultName?e[u.type]=u.defaultName:e[u.type]=u.name}else e[u.type]=u.name}),this.cashEnabled&&!this.selectedCategory.sponsored&&(e.cash="Cash Payment (This Race Only)"),console.log("Final payment options object:",e),console.log("Final payment options count:",Object.keys(e).length),e},paymentCostDets(){var g,v,l,h;if(!this.selectedCategory)return{};if(this.paymenttypeRequiredCategorySelected&&(this.payment=(g=this.selectedCategory)==null?void 0:g.paytype),this.sponsoredCategorySelected)return this.payment="season",{cost:this.dollas(0),regFee:this.dollas(0),tot:this.dollas(0)};let e;this.payment==="cash"?e="single":e=this.payment;const s=this.getAvailablePaymentOptionsForCategory(this.selectedCategory);let n=s.find(_=>_.type===e);if(n||(console.log("Selected payment type not found, selecting first available"),s.length>0?(n=s[0],this.payment=n.type):(n=(l=(v=this.raceData)==null?void 0:v.paymentOptions)==null?void 0:l[0],n&&(this.payment=n.type))),!n)return console.error("No payment option found"),{};if(n.categoryGroups&&this.formInputData.category){const _=n.categoryGroups.find(f=>f.categories.includes(this.formInputData.category));_?n={...n,amount:_.amount,name:_.name}:n.defaultAmount!==void 0&&(n={...n,amount:n.defaultAmount,name:n.defaultName||n.name})}const u=parseFloat(n.amount);let o=0;u>0&&this.payment!=="cash"&&(o=(n.regFee+n.stripeFee)/100);const i={};if(y.assign(i,n,{name:n.name,cost:this.dollas(u),regFee:this.dollas(o),tot:this.dollas(parseFloat(n.amount)+parseFloat(o))}),(h=this.raceData)!=null&&h.optionalPurchases&&this.formInputData.optionalPurchases){let _=u;this.raceData.optionalPurchases.forEach(({id:f,label:$,description:T,amount:R})=>{this.formInputData.optionalPurchases[f]&&(i.options||(i.options=[]),i.options.push({description:T,label:$,id:f,amount:this.dollas(parseFloat(R))}),_+=parseFloat(R))}),o=Js(_)/100,i.regFee=this.dollas(o),i.tot=this.dollas(_+o)}return i},showPaymentOption(){console.log("=== showPaymentOption ==="),console.log("paymenttypeRequiredCategorySelected:",this.paymenttypeRequiredCategorySelected),console.log("sponsoredCategorySelected:",this.sponsoredCategorySelected),console.log("cashEnabled:",this.cashEnabled);const e=this.selectedCategory?this.getAvailablePaymentOptionsForCategory(this.selectedCategory):[];return console.log("Available payment options count:",e.length),this.paymenttypeRequiredCategorySelected?(console.log("Hiding because paymenttypeRequiredCategorySelected"),!1):this.sponsoredCategorySelected?(console.log("Hiding because sponsoredCategorySelected"),!1):this.cashEnabled?(console.log("Showing because cashEnabled"),!0):e.length<2?(console.log("Hiding because only 1 payment option available for this category"),!1):(console.log("Showing payment options"),!0)},paymenttypeRequiredCategorySelected(){if(console.log("=== paymenttypeRequiredCategorySelected (Hybrid Model) ==="),console.log("selectedCategory:",this.selectedCategory),!this.selectedCategory)return console.log("Returning true (no category selected)"),!0;const e=this.getAvailablePaymentOptionsForCategory(this.selectedCategory);return console.log("Available payment options:",e.length),e.length<=1&&!this.cashEnabled?(console.log("Returning true (only one payment option)"),!0):(console.log("Returning false (multiple payment options available)"),!1)},sponsoredCategorySelected(){var e;return!!((e=this.selectedCategory)!=null&&e.sponsored)},selectedCategory(){var e,s;return this.formInputData&&this.formInputData.category?y.find((e=this.raceData)==null?void 0:e.regCategories,{id:(s=this.formInputData)==null?void 0:s.category}):null},racerAge(){if(this.prevAge)return this.prevAge;if(this.birthdate){const e=C(),s=C(this.birthdate);return e.year()-s.year()}},shouldHideRosterButton(){var e,s;return((e=this.raceData)==null?void 0:e.hideRosterButton)||((s=this.raceData)==null?void 0:s.entryCount)===0}}},Xs={key:0,class:"loading"},Zs={key:1},ea={key:0,class:"error"},ta={key:1},sa={key:0,class:"h5"},aa={key:1},ra=t("h3",null,"Registration is closed.",-1),ia=[ra],oa={key:2,class:"mb-5"},na=["innerHTML"],la={key:1},ca={class:"row"},da={class:"col-md-6 order-md-1 mb-3"},ua=t("h4",{class:"d-flex justify-content-between align-items-center mb-3"},[t("h5",null,"Registration Info"),t("span",{class:"badge badge-secondary badge-pill"},"3")],-1),ha={class:"form-group pt-3"},ma={key:1,class:"fw-bolder"},pa={class:"form-group pt-3"},_a={key:0,class:"col-md-5 order-md-2 mb-4"},ya=t("h4",{class:"d-flex justify-content-between align-items-center mb-3"},[t("h5",null,"Payment Detail")],-1),ga={class:"list-group mb-3"},fa={class:"list-group mb-3"},va={key:0},ba={class:"list-group mb-3"},Da=["innerHTML"],ka={class:"list-group mb-3 formkit-fieldset"},$a={class:"list-group-item d-flex justify-content-between lh-condensed"},Ca=t("h6",{class:"my-0"},"Event Entry:",-1),Ra={class:"text-muted"},Sa={key:0,class:"mx-3 text-decoration-line-through text-danger"},wa={class:"list-group-item d-flex justify-content-between lh-condensed"},Ta={class:"my-0"},xa={key:0,class:"text-muted"},Pa={class:"list-group-item d-flex justify-content-between lh-condensed"},Na=t("div",null,[t("h6",{class:"my-0"},"Online Processing Fee:"),t("small",{class:"text-muted"},"Credit Card Processing and Online Registration")],-1),Ba={class:"text-muted"},Oa={class:"list-group-item d-flex justify-content-between"},Ea=t("span",null,"Total (USD)",-1),Ma={key:0},Fa={class:"mb-5"},La={key:1,class:"alert alert-info mb-4"},Aa=t("h5",{class:"alert-heading"},"Series Registration",-1),Ia={class:"mb-0"},Va=t("strong",null,"all races",-1),Ua={key:2},ja=t("h2",{class:"text-danger"},"Your registration will not be active until payment is received at the event",-1),qa=[ja],Ha={key:3},Ya=["innerHTML"],Ga={key:1},Wa={key:2},Ka=t("h2",null,"Submission successful, redirecting",-1),za=[Ka],Ja={key:2},Qa=t("div",{class:"text-center"},[t("h2",{class:"mt-5"},"Race not found...")],-1),Xa=[Qa];function Za(e,s,n,u,o,i){var _,f;const g=k("MainNav"),v=k("EventDetailsComponent"),l=k("FormKit"),h=k("EventCategoryScheduleComponent");return a(),r(p,null,[b(g),o.loading?(a(),r("div",Xs,"Loading...")):(a(),r("div",Zs,[o.error?(a(),r("div",ea,c(o.error),1)):m("",!0),i.loaded?(a(),r("div",ta,[b(v,{details:o.raceData.eventDetails,raceid:o.raceData.raceid,hideRosterButton:i.shouldHideRosterButton,series:o.raceData.series,seriesData:o.raceData.seriesData,seriesRaceCount:2},null,8,["details","raceid","hideRosterButton","series","seriesData"]),i.eventFull?(a(),r("div",sa,"This event has reached the registration entry max of "+c(o.raceData.entryCountMax),1)):m("",!0),i.regDisabled?(a(),r("div",aa,ia)):(a(),r("div",oa,[(_=o.raceData)!=null&&_.headerContent?(a(),r("div",{key:0,class:"mb-3",innerHTML:o.raceData.headerContent},null,8,na)):m("",!0),((f=o.raceData)==null?void 0:f.seriesRaceNumber)>1?(a(),r("div",la,[b(l,{"label-class":"text-danger fw-bold fs-5",type:"checkbox",name:"prevBibLookup",label:"I have a bib number!",help:"Look up your information from a previous race in this series",modelValue:o.previousReg,"onUpdate:modelValue":s[0]||(s[0]=$=>o.previousReg=$)},null,8,["modelValue"]),o.previousReg?(a(),O(l,{key:0,type:"number",name:"bibNumber",label:"Bib Number:",help:"Enter your Bib Number from your previous race to pre-fill your info",delay:1500,onInput:i.onPrevBibChange,errors:o.prevBibError,validation:"required"},null,8,["onInput","errors"])):m("",!0)])):m("",!0),b(l,{type:"form",id:"race-registration",modelValue:o.formInputData,"onUpdate:modelValue":s[4]||(s[4]=$=>o.formInputData=$),"form-class":o.submitted?"hide":"show",errors:o.formError,actions:!1,onSubmit:i.submit},{default:N(()=>{var $,T,R;return[t("div",ca,[t("div",da,[ua,b(l,{type:"text",name:"first_name",label:"First name",help:"What is your first name",validation:"required"}),b(l,{type:"text",name:"last_name",label:"Last name",help:"What is your last name",validation:"required"}),t("div",ha,[o.previousReg?m("",!0):(a(),O(l,{key:0,type:"email",name:"email",label:"Your email",help:"Enter an email address",validation:"required|email"}))]),b(l,{type:"text",name:"sponsor",label:"Your Team or Sponsor",help:"Enter an optional Team or Sponsor name",maxlength:"25"}),!(($=o.raceData)!=null&&$.disableAge)&&!o.previousReg?(a(),O(l,{key:0,type:"date",name:"birthdate",label:"Birthday",modelValue:o.birthdate,"onUpdate:modelValue":s[1]||(s[1]=d=>o.birthdate=d),help:"Tap on the year at the top of the popup to change it",validation:"required|before:2020-01-01","validation-visibility":"live"},null,8,["modelValue"])):m("",!0),(T=o.raceData)!=null&&T.disableAge?m("",!0):(a(),r("p",ma,"Racing Age (as of Dec 31): "+c(i.racerAge),1)),t("div",pa,[b(l,{type:"select",id:"category",label:"Category:",placeholder:"Select a category",name:"category",options:i.sortedCats,validation:"required","validation-visibility":"dirty","validation-messages":{is:"You must select a category"}},null,8,["options"])]),o.previousReg?m("",!0):(a(),O(l,{key:2,type:"text",name:"contactNumber",label:"Phone Number",help:"If there is an issue on race day, we will try to contact you via this number"})),o.previousReg?m("",!0):(a(),O(l,{key:3,type:"text",name:"emergencyNumber",label:"Emergency Contact Name and Number",help:"In case of an emergency, we will contact this person"}))]),i.paymentCostDets?(a(),r("div",_a,[ya,t("fieldset",ga,[t("div",null,[o.raceData.couponsEnabled?(a(),O(l,{key:0,type:"text",name:"coupon",label:"Coupon Code",help:"",delay:1e3,onInput:i.onCouponChange,errors:o.couponError},null,8,["onInput","errors"])):m("",!0)])]),t("fieldset",fa,[t("div",null,[i.showPaymentOption?(a(),O(l,{key:0,type:"radio",name:"paytype",label:"Payment option",options:i.paymentOptions,validation:"required",modelValue:o.payment,"onUpdate:modelValue":s[2]||(s[2]=d=>o.payment=d)},null,8,["options","modelValue"])):m("",!0)])]),o.raceData.optionalPurchases&&(i.showPaymentOption||i.paymentCostDets.name)?(a(),r("div",va,[b(l,{type:"group",name:"optionalPurchases"},{default:N(()=>[(a(!0),r(p,null,D(o.raceData.optionalPurchases,(d,P)=>(a(),r("div",ba,[t("h6",{innerHTML:d.description},null,8,Da),b(l,{type:"checkbox",label:`${d.label} - ${i.dollas(parseFloat(d.amount))}`,name:d.id},null,8,["label","name"]),d.options&&o.formInputData.optionalPurchases[d.id]?(a(),O(l,{key:0,type:"select",options:d.options,label:d.optionsLabel,name:`${d.id}-option`},null,8,["options","label","name"])):m("",!0)]))),256))]),_:1})])):m("",!0),t("ul",ka,[t("li",$a,[t("div",null,[Ca,t("small",Ra,c(i.paymentCostDets.name),1)]),t("div",null,[i.paymentCostDets.discounted?(a(),r("span",Sa,c(i.dollas(i.paymentCostDets.orig)),1)):m("",!0),t("span",{class:B({"text-success":i.paymentCostDets.discounted})},c(i.paymentCostDets.cost),3)])]),i.paymentCostDets.options?(a(!0),r(p,{key:0},D(i.paymentCostDets.options,(d,P)=>(a(),r("li",wa,[t("div",null,[t("h6",Ta,c(d.label),1),d.option?(a(),r("small",xa,c(d.option),1)):m("",!0)]),t("div",null,[t("span",null,c(d.amount),1)])]))),256)):m("",!0),t("li",Pa,[Na,t("span",Ba,c(i.paymentCostDets.regFee),1)]),t("li",Oa,[Ea,t("strong",null,c(i.paymentCostDets.tot),1)])])])):m("",!0)]),i.sponsoredCategorySelected?(a(),r("div",Ma,[t("p",Fa,[t("h5",null,"Your "+c(i.selectedCategory.catdispname)+" race entry is sponsored by "+c(i.selectedCategory.sponsorName),1)])])):m("",!0),o.payment==="season"?(a(),r("div",La,[Aa,t("p",Ia,[x("This payment option will register you for "),Va,x(" in the "+c(((R=o.raceData.seriesData)==null?void 0:R.displayName)||"series")+". You will not need to register for each individual race.",1)])])):m("",!0),o.payment==="cash"?(a(),r("div",Ua,qa)):m("",!0),o.raceData.waiver?(a(),r("div",Ha,[o.raceData.waiver.format=="html"?(a(),r("div",{key:0,innerHTML:o.raceData.waiver.text},null,8,Ya)):(a(),r("div",Ga,[t("h5",null,c(o.raceData.waiver.header),1),t("p",null,c(o.raceData.waiver.text),1)])),b(l,{type:"checkbox",modelValue:o.waiverAccepted,"onUpdate:modelValue":s[3]||(s[3]=d=>o.waiverAccepted=d),label:"I HAVE READ AND UNDERSTAND THIS WAIVER",help:"I acknowledge that I have read, understand, and accepted the above release of liability.",name:"waiverAccepted",validation:"accepted","validation-messages":{accepted:"You must agree to the terms of the liability release above"},"validation-visibility":"live"},null,8,["modelValue"])])):m("",!0),b(l,{type:"submit",label:i.submitLabel,onClick:i.submitForm},null,8,["label","onClick"])]}),_:1},8,["modelValue","form-class","errors","onSubmit"]),o.submitted?(a(),r("div",Wa,za)):m("",!0)])),b(h,{categories:o.raceData.regCategories,raceDate:o.raceData.eventDate},null,8,["categories","raceDate"])])):(a(),r("div",Ja,Xa))]))],64)}const U=S(Qs,[["render",Za]]);const er={components:{EventDetailsComponent:E,MainNav:M},data(){return{categories:{},loading:!1,error:null,raceData:{},regData:{},payment:"",payStatus:!1,paymentData:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{fetchData(){this.error=null,this.loading=!0,this.$route.params.raceid&&this.$route.params.payment_id&&w(`/api/races/${this.$route.params.raceid}`).then(e=>(this.raceData=e.data,w(`/api/payments/status?payment_id=${this.$route.params.payment_id}`).then(s=>{var n;this.loading=!1,this.payStatus=s.data.status,this.paymentUrl=(n=s.data.stripePayment)==null?void 0:n.url,this.regData=s.data.regData,this.payment=s.data.regData.paytype,this.paymentData=s.data}))).catch(e=>{this.error="Failed to load race "+this.$route.params.raceid,console.error(e)})},async getReceipt(){try{const e=await w(`/api/payments/receipt?payment_id=${this.$route.params.payment_id}`);e.data&&e.data.receipt_url&&window.open(e.data.receipt_url,"_blank")}catch(e){console.error("Error fetching receipt:",e),alert("Unable to retrieve receipt. This payment may not have a Stripe receipt available.")}}},computed:{sortedCats(){let e={};return y.forEach(y.orderBy(this.raceData.regCategories,"disporder"),s=>{e[s.id]=s.catdispname}),e},loaded(){return!!this.raceData},paymentOptions(){let e={};return y.forEach(this.raceData.paymentOptions,s=>{e[s.type]=s.name}),e},pendingPayment(){return!!(this.regData.raceid!=this.$route.params.raceid||this.payStatus&&this.payStatus!="paid")},sponsoredCategorySelected(){var e;return!!((e=this.selectedCategory)!=null&&e.sponsored)},selectedCategory(){return y.find(this.raceData.regCategories,{id:this.regData.category})},shouldHideRosterButton(){var e,s;return((e=this.raceData)==null?void 0:e.hideRosterButton)||((s=this.raceData)==null?void 0:s.entryCount)===0},hasStripeReceipt(){var e,s,n;return((e=this.paymentData)==null?void 0:e.stripePayment)&&((s=this.paymentData)==null?void 0:s.stripePayment.payment_intent)&&this.payStatus==="paid"&&((n=this.paymentData)==null?void 0:n.stripePayment.amount_total)>0}}},tr={key:0,class:"loading"},sr={key:1},ar={key:0,class:"error"},rr={key:1},ir={class:"row"},or={class:"col-md-6 order-md-1"},nr={key:0},lr=t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[t("h4",null,"Your Registration is Confirmed")],-1),cr={key:0,class:"mb-3"},dr=t("i",{class:"bi bi-receipt me-2"},null,-1),ur={key:1,class:"mb-5"},hr=t("div",{class:"d-flex justify-content-between align-items-center mb-3 text-danger"},[t("h4",null,"Your Registration is Incomplete")],-1),mr={key:0},pr=t("p",{class:"text-danger h5"},"Please make your cash payment at the event to complete your registration.",-1),_r=t("p",null,'Your name will not show up on the "Who is signed up" list until payment is completed.',-1),yr=[pr,_r],gr={key:1},fr=["href"],vr={class:"col"},br={class:"row"},Dr={class:"form-group pt-3"},kr={class:"form-group pt-3"},$r={key:2},Cr={key:0},Rr=["href"],Sr={key:1},wr=t("a",{href:"mailto:support@signup.bike"},"support@signup.bike",-1),Tr=[wr],xr={key:2},Pr={class:"text-center"},Nr={class:"mt-5"};function Br(e,s,n,u,o,i){const g=k("MainNav"),v=k("EventDetailsComponent"),l=k("FormKit");return a(),r(p,null,[b(g),o.loading?(a(),r("div",tr,"Loading...")):(a(),r("div",sr,[o.error?(a(),r("div",ar,c(o.error),1)):m("",!0),i.loaded?(a(),r("div",rr,[b(v,{details:o.raceData.eventDetails,raceid:o.raceData.raceid,hideRosterButton:i.shouldHideRosterButton},null,8,["details","raceid","hideRosterButton"]),b(l,{type:"form",id:"race-registration",disabled:"",actions:!1,modelValue:o.regData,"onUpdate:modelValue":s[1]||(s[1]=h=>o.regData=h)},{default:N(()=>[t("div",ir,[t("div",or,[i.pendingPayment?m("",!0):(a(),r("div",nr,[lr,i.hasStripeReceipt?(a(),r("div",cr,[t("button",{type:"button",class:"btn btn-primary",onClick:s[0]||(s[0]=J((...h)=>i.getReceipt&&i.getReceipt(...h),["prevent"])),title:"View your Stripe receipt"},[dr,x("View Receipt ")])])):m("",!0)])),i.pendingPayment?(a(),r("div",ur,[hr,o.payment==="cash"?(a(),r("div",mr,yr)):(a(),r("div",gr,[t("a",{href:e.paymentUrl},"Complete your payment",8,fr)]))])):m("",!0),t("div",vr,[t("div",br,[b(l,{type:"text",name:"first_name",label:"First name"}),b(l,{type:"text",name:"last_name",label:"Last name"})])]),t("div",Dr,[b(l,{type:"email",name:"email",label:"Email"})]),t("div",kr,[b(l,{type:"text",name:"sponsor",label:"Your Team or Sponsor"}),b(l,{type:"select",label:"Race Category:",name:"category",options:i.sortedCats},null,8,["options"])]),i.sponsoredCategorySelected?(a(),r("div",$r,[t("h5",null," Your "+c(i.selectedCategory.catdispname)+" race entry is sponsored by "+c(i.selectedCategory.sponsorName),1)])):m("",!0)])])]),_:1},8,["modelValue"]),x(" Please send any corrections or questions to "),o.raceData.contactEmail?(a(),r("div",Cr,[t("a",{href:`mailto:${o.raceData.contactEmail}`},c(o.raceData.contactEmail),9,Rr)])):(a(),r("div",Sr,Tr))])):(a(),r("div",xr,[t("div",Pr,[t("h2",Nr," Unable to load requested information "+c(e.$route.params.raceid)+" payment: "+c(e.$route.params.payment_id),1)])]))]))],64)}const Or=S(er,[["render",Br]]);const Er={components:{SeriesResultRow:G,SeriesNavBar:A},data(){return{categories:{},loading:!1,error:null,displayName:"",series:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{scrollMeTo(e){var s=document.querySelector(`#${e}`);s.scrollIntoView({behavior:"smooth"})},fetchData(){if(!this.$route.params.seriesid)return;this.error=null,this.loading=!0;let e=`/api/series/results/${this.$route.params.seriesid}`;w(e).then(({data:s})=>{this.loading=!1,this.categories=s.categories,this.displayName=s.displayName,this.series=this.$route.params.seriesid;let n=y.map(s.categories,u=>y.omit(u,["results","columns"]));console.log("temp:",y.orderBy(n,"disporder"))}).catch(s=>{console.error(s),this.categories={},this.error=s.toString()})}},computed:{sortedCats(){let e;return this.$route.path.indexOf("grom")>-1?e=y.filter(this.categories,s=>s.id.indexOf("grom")>-1):e=y.filter(this.categories,s=>s.id.indexOf("grom")==-1),y.orderBy(e,"disporder")},expertCats(){return y.filter(this.sortedCats,{laps:4})},sportCats(){return y.filter(this.sortedCats,{laps:3})},beginnerCats(){return y.filter(this.sortedCats,{laps:2})},gromCats(){return this.$route.path.indexOf("grom")>-1?y.filter(this.categories,e=>e.id.indexOf("grom")>-1):[]},haveResults(){return this.categories?Object.keys(this.categories).length>0:!1}}},Mr={key:0,class:"loading"},Fr={key:1},Lr={key:0,class:"error"},Ar={class:"container-fluid text-center mt-5"},Ir=t("h3",null,"Series Standings",-1),Vr=t("p",null,[x("Glossary of terms below:"),t("br"),x(" 1/50 = 1st Place/50 Points -/- = Did not race")],-1),Ur={key:1},jr={class:"container-fluid text-center mt-5"},qr={class:"list-inline"},Hr=["onClick"],Yr={class:"list-inline"},Gr=["onClick"],Wr={class:"list-inline"},Kr=["onClick"],zr={class:"list-inline"},Jr=["onClick"],Qr={class:"container-fluid"},Xr=["id"],Zr={class:"table table-striped table-hover"},ei={key:2},ti=t("div",{class:"text-center"},[t("h2",{class:"mt-5"},"No results yet...")],-1),si=[ti];function ai(e,s,n,u,o,i){const g=k("SeriesNavBar"),v=k("SeriesResultRow");return a(),r(p,null,[b(g,{series:o.series},null,8,["series"]),o.loading?(a(),r("div",Mr,"Loading...")):(a(),r("div",Fr,[o.error?(a(),r("div",Lr,c(o.error),1)):m("",!0),t("div",Ar,[t("h2",null,c(o.displayName),1),Ir,Vr]),i.haveResults?(a(),r("div",Ur,[t("div",jr,[t("ul",qr,[(a(!0),r(p,null,D(i.expertCats,l=>(a(),r("li",{key:l.id,class:"list-inline-item mx-2"},[t("a",{role:"button",onClick:h=>i.scrollMeTo(l.id),class:"link-primary"},c(l.catdispname),9,Hr)]))),128))]),t("ul",Yr,[(a(!0),r(p,null,D(i.sportCats,l=>(a(),r("li",{key:l.id,class:"list-inline-item mx-2"},[t("a",{role:"button",onClick:h=>i.scrollMeTo(l.id),class:"link-primary"},c(l.catdispname),9,Gr)]))),128))]),t("ul",Wr,[(a(!0),r(p,null,D(i.beginnerCats,l=>(a(),r("li",{key:l.id,class:"list-inline-item mx-2"},[t("a",{role:"button",onClick:h=>i.scrollMeTo(l.id),class:"link-primary"},c(l.catdispname),9,Kr)]))),128))]),t("ul",zr,[(a(!0),r(p,null,D(i.gromCats,l=>(a(),r("li",{key:l.id,class:"list-inline-item mx-2"},[t("a",{role:"button",onClick:h=>i.scrollMeTo(l.id),class:"link-primary"},c(l.catdispname),9,Jr)]))),128))])]),t("div",Qr,[(a(!0),r(p,null,D(i.sortedCats,l=>(a(),r("div",{key:l.id,class:"mt-5"},[t("h3",{id:l.id},c(l.catdispname),9,Xr),t("table",Zr,[t("thead",null,[t("tr",null,[(a(!0),r(p,null,D(l.columns,(h,_)=>(a(),r("th",{scope:"col",key:_},c(h),1))),128))])]),t("tbody",null,[(a(!0),r(p,null,D(l.results,(h,_)=>(a(),r("tr",{key:_},[b(v,{Pos:_,data:h},null,8,["Pos","data"])]))),128))])]),t("a",{role:"button",onClick:s[0]||(s[0]=h=>i.scrollMeTo("top")),class:"link-primary"},"Back to Top")]))),128))])])):(a(),r("div",ei,si))]))],64)}const j=S(Er,[["render",ai]]),ri={props:["data","Pos","dates"],data(){return{count:0}},computed:{}};function ii(e,s,n,u,o,i){return a(),r(p,null,[t("td",null,c(n.data.Name),1),t("td",null,c(n.data.Cat),1),(a(!0),r(p,null,D(n.dates,(g,v)=>(a(),r("td",{key:v},c(n.data[g]||"-"),1))),128))],64)}const W=S(ri,[["render",ii]]);const oi={components:{ResultRow:W,SeriesNavBar:A},data(){return{teamResults:{},loading:!1,error:null,series:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{scrollMeTo(e){var s=document.querySelector(`#${e}`);s.scrollIntoView({behavior:"smooth"})},fetchData(){if(!this.$route.params.seriesid)return;this.error=null,this.loading=!0;let e=`/api/team-comp?series=${this.$route.params.seriesid}`;w(e).then(({data:s})=>{this.loading=!1,this.series=this.$route.params.seriesid,this.teamResults=s,this.teamDates=s.teamCompDates}).catch(s=>{console.error(s),this.teamResults={},this.error=s.toString()})}},computed:{dates:()=>{}}},ni={key:0,class:"loading"},li={key:1},ci={key:0,class:"error"},di=t("h2",{class:"mt-5"},"Team Standings",-1),ui={class:"container-fluid mt-5"},hi={class:"table table-striped table-hover"},mi=t("thead",null,[t("tr",null,[t("th",null,"Position"),t("th",null,"Team"),t("th",null,"Total Score")])],-1),pi=t("h2",{class:"mt-5"},"Team Results",-1),_i={class:"container-fluid"},yi={class:"table table-striped table-hover"},gi=t("thead",null,[t("tr",null,[t("th",{style:{width:"25%"}},"Racer Name"),t("th",{style:{width:"25%"}},"Class"),t("th",{style:{width:"12.5%"}},"5/4"),t("th",{style:{width:"12.5%"}},"5/11"),t("th",{style:{width:"12.5%"}},"5/18"),t("th",{style:{width:"12.5%"}},"5/25")])],-1),fi={class:"table table-striped table-hover"},vi=t("th",{style:{width:"50%","text-align":"right"}},"Score (Avg of individual results):",-1),bi={style:{width:"12.5%"}},Di={style:{width:"12.5%"}},ki={style:{width:"12.5%"}},$i={style:{width:"12.5%"}};function Ci(e,s,n,u,o,i){const g=k("SeriesNavBar"),v=k("ResultRow");return a(),r(p,null,[b(g,{series:o.series},null,8,["series"]),o.loading?(a(),r("div",ni,"Loading...")):(a(),r("div",li,[o.error?(a(),r("div",ci,c(o.error),1)):m("",!0),di,t("div",ui,[t("table",hi,[mi,t("tbody",null,[(a(!0),r(p,null,D(o.teamResults.result,(l,h)=>(a(),r("tr",{key:h},[t("td",null,c(h+1),1),t("td",null,c(l.teamName),1),t("td",null,c(l.totalScore),1)]))),128))])])]),pi,(a(!0),r(p,null,D(o.teamResults.result,(l,h)=>(a(),r("div",{class:"mt-5",key:h},[t("h3",null,c(l.teamName),1),t("div",_i,[t("table",yi,[gi,t("tbody",null,[(a(!0),r(p,null,D(o.teamResults.teamDets[l.teamName],(_,f)=>(a(),r("tr",{key:f},[b(v,{data:_,dates:e.teamDates},null,8,["data","dates"])]))),128))])]),t("table",fi,[t("thead",null,[t("tr",null,[vi,t("th",bi,c(l.results["5/4"]?l.results["5/4"].avg:"-"),1),t("th",Di,c(l.results["5/11"]?l.results["5/11"].avg:"-"),1),t("th",ki,c(l.results["5/18"]?l.results["5/18"].avg:"-"),1),t("th",$i,c(l.results["5/25"]?l.results["5/25"].avg:"-"),1)])])])])]))),128))]))],64)}const Ri=S(oi,[["render",Ci]]);const Si={components:{ResultRow:W,SeriesNavBar:I},data(){return{teamResults:{},teamDates:[],loading:!1,error:null,series:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{scrollMeTo(e){var s=document.querySelector(`#${e}`);s.scrollIntoView({behavior:"smooth"})},fetchData(){if(!this.$route.params.seriesid)return;this.error=null,this.loading=!0;let e=`/api/team-comp?series=${this.$route.params.seriesid}`;w(e).then(({data:s})=>{this.loading=!1,this.series=this.$route.params.seriesid,this.teamResults=s,this.teamDates=s.teamCompDates}).catch(s=>{console.error(s),this.teamResults={},this.error=s.toString()})}},computed:{dates:()=>{},fivePlusTeams(){var e;return y.filter((e=this.teamResults)==null?void 0:e.result,s=>s.count>4)},threeFourTeams(){var e;return y.filter((e=this.teamResults)==null?void 0:e.result,s=>s.count<5)},sortedResults(){return y.sortBy(this.teamResults.result,"teamName")}}},wi={key:0,class:"loading"},Ti={key:1},xi={key:0,class:"error"},Pi=t("h2",{class:"mt-5"}," 5+ Team Standings",-1),Ni={class:"container-fluid mt-5"},Bi={class:"table table-striped table-hover"},Oi=t("thead",null,[t("tr",null,[t("th",null,"Position"),t("th",null,"Team"),t("th",null,"Total Score")])],-1),Ei=t("h2",{class:"mt-5"}," 3 Person Team Standings",-1),Mi={class:"container-fluid mt-5"},Fi={class:"table table-striped table-hover"},Li=t("thead",null,[t("tr",null,[t("th",null,"Position"),t("th",null,"Team"),t("th",null,"Total Score")])],-1),Ai=t("h2",{class:"mt-5"},"Team Results",-1),Ii={class:"container-fluid"},Vi={class:"table table-striped table-hover"},Ui=t("th",{style:{width:"25%"}},"Racer Name",-1),ji=t("th",{style:{width:"25%"}},"Class",-1),qi=t("td",{colspan:"2",style:{"text-align":"right"}},"Score (Avg of individual results):",-1);function Hi(e,s,n,u,o,i){const g=k("SeriesNavBar"),v=k("ResultRow");return a(),r(p,null,[b(g,{series:o.series},null,8,["series"]),o.loading?(a(),r("div",wi,"Loading...")):(a(),r("div",Ti,[o.error?(a(),r("div",xi,c(o.error),1)):m("",!0),Pi,t("div",Ni,[t("table",Bi,[Oi,t("tbody",null,[(a(!0),r(p,null,D(i.fivePlusTeams,(l,h)=>(a(),r("tr",{key:h},[t("td",null,c(h+1),1),t("td",null,c(l.teamName),1),t("td",null,c(l.totalScore),1)]))),128))])])]),Ei,t("div",Mi,[t("table",Fi,[Li,t("tbody",null,[(a(!0),r(p,null,D(i.threeFourTeams,(l,h)=>(a(),r("tr",{key:h},[t("td",null,c(h+1),1),t("td",null,c(l.teamName),1),t("td",null,c(l.totalScore),1)]))),128))])])]),Ai,(a(!0),r(p,null,D(i.sortedResults,(l,h)=>(a(),r("div",{class:"mt-5",key:h},[t("h3",null,c(l.teamName),1),t("div",Ii,[t("table",Vi,[t("thead",null,[t("tr",null,[Ui,ji,(a(!0),r(p,null,D(o.teamDates,_=>(a(),r("th",null,c(_),1))),256))])]),t("tbody",null,[(a(!0),r(p,null,D(o.teamResults.teamDets[l.teamName],(_,f)=>(a(),r("tr",{key:f},[b(v,{data:_,dates:o.teamDates},null,8,["data","dates"])]))),128)),t("tr",null,[qi,(a(!0),r(p,null,D(o.teamDates,_=>(a(),r("td",null,c(l.results[_]?l.results[_].avg:"-"),1))),256))])])])])]))),128))]))],64)}const Yi=S(Si,[["render",Hi]]);const Gi={components:{EventDetailsComponent:E,MainNav:M},data(){return{categories:{},loading:!1,error:null,formattedStartDate:"",series:null,stageFilter:"all",racers:[],raceData:{}}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{scrollMeTo(e){var s=document.querySelector(`#${e}`);s.scrollIntoView({behavior:"smooth"})},fetchData(){this.error=null,this.loading=!0,this.$route.params.raceid&&w(`/api/races/roster/${this.$route.params.raceid}`).then(({data:e})=>{this.raceData=e,this.series=e.series,this.loading=!1,this.categories=e.regCategories,this.racers=e.registeredRacers}).catch(e=>{var s;if(this.loading=!1,((s=e.response)==null?void 0:s.status)===404){this.error="Race not found";return}console.error(e),this.categories={},this.error=e.toString()})},replacePlusSymbol(e){return e.replace("+","Plus")},payTypeToStage(e){const s=y.find(this.raceData.paymentOptions,{type:e});return s?s.name:""}},computed:{showPaytype(){var e;return!!((e=this.raceData)!=null&&e.showPaytypeOnRoster)},filterOptions(){let e={all:"All Stages"};return y.forEach(this.raceData.paymentOptions,s=>{e[s.type]=s.name}),e},filteredRacers(){return this.showPaytype&&this.stageFilter!=="all"?y.filter(this.racers,e=>e.paytype==this.stageFilter||e.paytype=="season"):this.racers},groupedRacers(){return y.groupBy(this.filteredRacers,"category")},sortedCats(){return y.filter(y.orderBy(this.categories,"disporder"),e=>y.includes(Object.keys(this.groupedRacers),e.id))},raceDate(){return C(this.raceData.eventDate).format("ddd, MMM D")},shouldHideRosterButton(){var e,s;return((e=this.raceData)==null?void 0:e.hideRosterButton)||((s=this.racers)==null?void 0:s.length)===0}}},Wi={key:0,class:"loading"},Ki={key:1},zi={key:0,class:"error"},Ji={key:1,id:"top"},Qi={key:0},Xi={class:"row"},Zi={key:0,class:"col-md-6"},eo={class:"container text-center mt-5"},to={class:"list-inline"},so=["onClick"],ao={class:"container-fluid"},ro=["id"],io={class:"table table-striped table-hover"},oo=t("th",null," First Name ",-1),no=t("th",null," Last Name ",-1),lo=t("th",null," Team/Sponsor ",-1),co={key:0},uo={key:0},ho={key:1},mo=t("div",{class:"text-center"},[t("h2",{class:"mt-5"},"No registrations yet...")],-1),po=[mo];function _o(e,s,n,u,o,i){const g=k("MainNav"),v=k("EventDetailsComponent"),l=k("FormKit");return a(),r(p,null,[b(g),o.loading?(a(),r("div",Wi,"Loading...")):(a(),r("div",Ki,[o.error?(a(),r("div",zi,c(o.error),1)):(a(),r("div",Ji,[b(v,{details:o.raceData.eventDetails,raceid:o.raceData.raceid,hideRosterButton:i.shouldHideRosterButton},null,8,["details","raceid","hideRosterButton"]),Object.keys(o.racers).length?(a(),r("div",Qi,[t("div",Xi,[t("div",{class:B({"col-md-6":i.showPaytype})},[t("h4",null,c(i.filteredRacers.length)+" Registered for "+c(o.raceData.displayName)+" on "+c(i.raceDate),1)],2),i.showPaytype?(a(),r("div",Zi,[b(l,{type:"select",label:"Show registrations for:",name:"stageFilter",modelValue:o.stageFilter,"onUpdate:modelValue":s[0]||(s[0]=h=>o.stageFilter=h),default:"all",options:i.filterOptions},null,8,["modelValue","options"])])):m("",!0)]),t("div",eo,[t("ul",to,[(a(!0),r(p,null,D(i.sortedCats,h=>(a(),r("li",{key:h.id,class:"list-inline-item mx-2"},[t("a",{role:"button",onClick:_=>i.scrollMeTo(i.replacePlusSymbol(h.id)),class:"link-primary"},c(h.catdispname),9,so)]))),128))])]),t("div",ao,[(a(!0),r(p,null,D(i.sortedCats,h=>(a(),r("div",{key:h.id,class:"mt-5"},[t("h3",{id:i.replacePlusSymbol(h.id)},c(h.catdispname),9,ro),t("table",io,[t("thead",null,[t("tr",null,[oo,no,lo,i.showPaytype?(a(),r("th",co," Stages ")):m("",!0)])]),t("tbody",null,[(a(!0),r(p,null,D(i.groupedRacers[h.id],(_,f)=>(a(),r("tr",{key:f},[t("td",null,c(_.first_name),1),t("td",null,c(_.last_name),1),t("td",null,c(_.sponsor),1),i.showPaytype?(a(),r("td",uo,c(i.payTypeToStage(_.paytype)),1)):m("",!0)]))),128))])]),t("a",{role:"button",onClick:s[1]||(s[1]=_=>i.scrollMeTo("top")),class:"link-primary"},"Back to Top")]))),128))])])):(a(),r("div",ho,po))]))]))],64)}const yo=S(Gi,[["render",_o]]),go=Q({history:X("/"),routes:[{path:"/",name:"home",component:F},{path:"/results/",name:"results",component:F},{path:"/races/series/:seriesid",name:"racesBySeries",component:F},{path:"/race/:raceid",component:It},{path:"/result/:id",name:"raceResult",component:_s},{path:"/result/series/:seriesid",name:"seriesResults",component:As},{path:"/result/series/:seriesid/team",name:"teamCompResults",component:Yi},{path:"/register/:raceid",name:"register",component:U},{path:"/register/test/:raceid",name:"register-test",component:U},{path:"/regconfirmation/:raceid/:payment_id",component:Or},{path:"/roster/:raceid",name:"roster",component:yo},{path:"/series/:seriesid",component:j},{path:"/series/grom/:seriesid",component:j},{path:"/teamcomp/:seriesid",component:Ri}]});Z.init({clientToken:"pub5b9b0cfce30b3b609b588d9f3ac85ebb",site:"datadoghq.com",env:"production",service:"public-site",version:"1.0.1",forwardErrorsToLogs:!0,sampleRate:100});const V=ee(oe);V.use(te,se);V.use(go);V.mount("#app");
//# sourceMappingURL=main-7400860a.js.map
