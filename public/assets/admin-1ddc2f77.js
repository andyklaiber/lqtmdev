import{B as Qo,y as Zo,C as qo,E as en,F as Q,K as tn,z as sn,S as on,A as nn,T as xt,D as rn,G as oo,H as an,V as ln,I as cn,J as dn,L as un,M as mn,N as hn,O as fn,P as pn,Q as gn,u as To,k as ee,e as P,c as p,b as o,U as vn,W as yn,X as bn,Y as _n,Z as Cn,$ as Oo,f as T,a as D,a0 as Dn,a1 as Sn,a2 as xn,a3 as En,a4 as wn,a5 as Pn,a6 as Rn,a7 as Tn,a8 as On,a9 as In,aa as kn,ab as $n,ac as An,ad as Mn,ae as Fn,af as Nn,ag as Ln,ah as Un,ai as Js,aj as jn,ak as Vn,al as Hn,am as Bn,an as Gn,ao as Kn,ap as zn,aq as Yn,ar as Wn,as as Xn,at as Jn,au as Qn,av as Zn,aw as qn,ax as er,ay as tr,az as sr,aA as or,aB as nr,n as ne,aC as rr,aD as es,aE as ar,aF as ir,aG as lr,aH as cr,aI as dr,aJ as ur,aK as mr,aL as hr,aM as fr,aN as pr,aO as gr,aP as vr,aQ as yr,o as u,g as rt,aR as br,aS as _r,p as at,aT as Cr,aU as Dr,aV as Sr,aW as xr,aX as Er,aY as wr,j as ie,aZ as xs,r as A,a_ as Pr,a$ as Rr,b0 as Tr,b1 as Or,b2 as Ir,b3 as kr,b4 as $r,b5 as Ar,b6 as Mr,b7 as Fr,b8 as Nr,b9 as Lr,ba as Ur,t as b,bb as jr,bc as Vr,bd as Hr,be as Br,bf as Gr,bg as Kr,bh as zr,bi as Yr,bj as Wr,bk as Xr,bl as Jr,bm as Qr,bn as Zr,bo as qr,bp as ea,bq as ta,br as ds,bs as sa,bt as oa,bu as Io,bv as ge,bw as jt,bx as na,by as ra,bz as aa,bA as ia,bB as la,bC as ca,bD as da,w as V,bE as ua,bF as le,bG as ko,bH as ma,l as st,bI as ha,_ as ve,h as W,R as no,i as J,d as ot,bJ as $o,bK as fa,bL as pa,bM as us,m as ga,q as va,s as ya,v as ba,x as _a}from"./main-42df6384.js";const Ca=()=>{},Da=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition:Qo,BaseTransitionPropsValidators:Zo,Comment:qo,EffectScope:en,Fragment:Q,KeepAlive:tn,ReactiveEffect:sn,Static:on,Suspense:nn,Teleport:xt,Text:rn,Transition:oo,TransitionGroup:an,VueElement:ln,assertNumber:cn,callWithAsyncErrorHandling:dn,callWithErrorHandling:un,camelize:mn,capitalize:hn,cloneVNode:fn,compatUtils:pn,compile:Ca,computed:gn,createApp:To,createBlock:ee,createCommentVNode:P,createElementBlock:p,createElementVNode:o,createHydrationRenderer:vn,createPropsRestProxy:yn,createRenderer:bn,createSSRApp:_n,createSlots:Cn,createStaticVNode:Oo,createTextVNode:T,createVNode:D,customRef:Dn,defineAsyncComponent:Sn,defineComponent:xn,defineCustomElement:En,defineEmits:wn,defineExpose:Pn,defineModel:Rn,defineOptions:Tn,defineProps:On,defineSSRCustomElement:In,defineSlots:kn,get devtools(){return $n},effect:An,effectScope:Mn,getCurrentInstance:Fn,getCurrentScope:Nn,getTransitionRawChildren:Ln,guardReactiveProps:Un,h:Js,handleError:jn,hasInjectionContext:Vn,hydrate:Hn,initCustomFormatter:Bn,initDirectivesForSSR:Gn,inject:Kn,isMemoSame:zn,isProxy:Yn,isReactive:Wn,isReadonly:Xn,isRef:Jn,isRuntimeOnly:Qn,isShallow:Zn,isVNode:qn,markRaw:er,mergeDefaults:tr,mergeModels:sr,mergeProps:or,nextTick:nr,normalizeClass:ne,normalizeProps:rr,normalizeStyle:es,onActivated:ar,onBeforeMount:ir,onBeforeUnmount:lr,onBeforeUpdate:cr,onDeactivated:dr,onErrorCaptured:ur,onMounted:mr,onRenderTracked:hr,onRenderTriggered:fr,onScopeDispose:pr,onServerPrefetch:gr,onUnmounted:vr,onUpdated:yr,openBlock:u,popScopeId:rt,provide:br,proxyRefs:_r,pushScopeId:at,queuePostFlushCb:Cr,reactive:Dr,readonly:Sr,ref:xr,registerRuntimeCompiler:Er,render:wr,renderList:ie,renderSlot:xs,resolveComponent:A,resolveDirective:Pr,resolveDynamicComponent:Rr,resolveFilter:Tr,resolveTransitionHooks:Or,setBlockTracking:Ir,setDevtoolsHook:kr,setTransitionHooks:$r,shallowReactive:Ar,shallowReadonly:Mr,shallowRef:Fr,ssrContextKey:Nr,ssrUtils:Lr,stop:Ur,toDisplayString:b,toHandlerKey:jr,toHandlers:Vr,toRaw:Hr,toRef:Br,toRefs:Gr,toValue:Kr,transformVNodeArgs:zr,triggerRef:Yr,unref:Wr,useAttrs:Xr,useCssModule:Jr,useCssVars:Qr,useModel:Zr,useSSRContext:qr,useSlots:ea,useTransitionState:ta,vModelCheckbox:ds,vModelDynamic:sa,vModelRadio:oa,vModelSelect:Io,vModelText:ge,vShow:jt,version:na,warn:ra,watch:aa,watchEffect:ia,watchPostEffect:la,watchSyncEffect:ca,withAsyncContext:da,withCtx:V,withDefaults:ua,withDirectives:le,withKeys:ko,withMemo:ma,withModifiers:st,withScopeId:ha},Symbol.toStringTag,{value:"Module"}));const Sa={props:["message"],data(){return{errorMsg:[""]}},methods:{login(t){const{email:e,password:a}=t;return W.post("/api/auth/login",{email:e,password:a}).then(c=>{console.log(c),this.$emit("login"),this.$router.push({name:"races"})}).catch(c=>{c.response.status===401&&(this.errorMsg=["Invalid credentials, please try again"]),console.error(c)})}}},xa={class:"form-signin w-100 m-auto"},Ea={key:0},wa=o("h1",{class:"h3 mb-3 fw-normal"},"Sign in:",-1);function Pa(t,e,a,c,s,r){const n=A("FormKit");return u(),p("main",xa,[a.message?(u(),p("h3",Ea,b(a.message),1)):P("",!0),wa,D(n,{type:"form",onSubmit:r.login,errors:s.errorMsg},{default:V(()=>[D(n,{type:"email",name:"email",label:"Email address",validation:"","validation-visibility":"live"}),D(n,{type:"password",name:"password",label:"Password",validation:"required"})]),_:1},8,["onSubmit","errors"])])}const Ra=ve(Sa,[["render",Pa]]);const Ta={emits:["logout"],components:{RouterView:no},data(){return{count:0}},computed:{}},Ao=t=>(at("data-v-bb2a66e9"),t=t(),rt(),t),Oa={class:"navbar navbar-expand-md navbar-dark bg-dark fixed-top"},Ia={class:"container-fluid"},ka=Ao(()=>o("a",{class:"navbar-brand",href:"/"},"Signup.bike Admin",-1)),$a=Ao(()=>o("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarsExample04","aria-controls":"navbarsExample04","aria-expanded":"false","aria-label":"Toggle navigation"},[o("span",{class:"navbar-toggler-icon"})],-1)),Aa={class:"collapse navbar-collapse",id:"navbarsExample04"},Ma={class:"navbar-nav me-auto mb-2 mb-md-0"},Fa={class:"nav-item"},Na={class:"nav-item"},La={class:"nav-item"},Ua={class:"nav-item"},ja={class:"nav-item"},Va={class:"container-fluid"};function Ha(t,e,a,c,s,r){const n=A("RouterLink"),d=A("RouterView");return u(),p(Q,null,[o("nav",Oa,[o("div",Ia,[ka,$a,o("div",Aa,[o("ul",Ma,[o("li",Fa,[D(n,{class:ne(["nav-link",{active:t.$route.name=="races"}]),to:{name:"races"}},{default:V(()=>[T(" Races ")]),_:1},8,["class"])]),o("li",Na,[D(n,{class:ne(["nav-link",{active:t.$route.name=="series"||t.$route.name=="edit-series"}]),to:{name:"series"}},{default:V(()=>[T(" Series ")]),_:1},8,["class"])]),o("li",La,[D(n,{class:ne(["nav-link",{active:t.$route.name=="payments"}]),to:{name:"payments"}},{default:V(()=>[T(" Payments ")]),_:1},8,["class"])]),o("li",Ua,[D(n,{class:ne(["nav-link",{active:t.$route.name=="results"}]),to:{name:"results"}},{default:V(()=>[T(" Results ")]),_:1},8,["class"])]),o("li",ja,[D(n,{class:ne(["nav-link",{active:t.$route.name=="series-results"}]),to:{name:"series-results"}},{default:V(()=>[T(" Series Points ")]),_:1},8,["class"])])]),o("button",{type:"button",class:"btn btn-secondary",onClick:e[0]||(e[0]=i=>t.$emit("logout"))},"Logout")])])]),o("body",null,[o("div",Va,[D(d)])])],64)}const Ba=ve(Ta,[["render",Ha],["__scopeId","data-v-bb2a66e9"]]);const Ga={components:{LoginComponent:Ra,Manage:Ba},data(){return{showLogin:!1,loginText:""}},created(){this.checkAuth()},methods:{hideLogin(){this.showLogin=!1},checkAuth(){if(console.log(this.$route.path),this.$route.path=="/login/")this.showLogin=!0;else return W.post("/api/auth/login",{}).then(t=>{console.log(t),this.showLogin=!1,!this.$route.path&&this.$router.push({name:"races"})}).catch(t=>{if(t.response.status===401)return this.showLogin=!0;console.error(t)})},logout(){return W.get("/api/auth/logout").then(t=>{console.log(t),this.showLogin=!0,this.loginText="You are logged out."})}}},Ka={key:0},za={class:"container"},Ya={key:1};function Wa(t,e,a,c,s,r){const n=A("LoginComponent"),d=A("Manage");return s.showLogin?(u(),p("div",Ka,[o("div",za,[D(n,{onLogin:r.hideLogin,message:s.loginText},null,8,["onLogin","message"])])])):(u(),p("div",Ya,[D(d,{onLogout:r.logout},null,8,["onLogout"])]))}const Xa=ve(Ga,[["render",Wa]]);const Ja={props:{show:Boolean,size:{type:String,default:"md",validator:t=>["sm","md","lg","xl"].includes(t)}},computed:{containerClass(){return`modal-container modal-${this.size}`}}},Qa={key:0,class:"modal-mask"},Za={class:"modal-wrapper"},qa={class:"modal-header"},ei={class:"modal-body"},ti={class:"modal-footer"};function si(t,e,a,c,s,r){return u(),ee(oo,{name:"modal"},{default:V(()=>[a.show?(u(),p("div",Qa,[o("div",Za,[o("div",{class:ne(r.containerClass),onKeydown:e[1]||(e[1]=ko(n=>t.$emit("close"),["esc"])),tabIndex:"0"},[o("div",qa,[xs(t.$slots,"header")]),o("div",ei,[xs(t.$slots,"body",{},()=>[T("default body")])]),o("div",ti,[xs(t.$slots,"footer",{},()=>[o("button",{class:"btn btn-sm btn-danger modal-default-button",onClick:e[0]||(e[0]=n=>t.$emit("close"))},"Cancel")])])],34)])])):P("",!0)]),_:3})}const Xe=ve(Ja,[["render",si]]),oi={props:["paymentData","races","formMode"],data(){return{formError:[],formInputData:{},target:"",successMessage:""}},mounted(){console.log(this.races),this.target=Object.keys(this.races)[0],console.log(this.target)},computed:{raceOptions(){let t=this.races;return delete t[this.paymentData.regData.raceid],t}},methods:{async moveReg(t){return console.log(t),console.log(this.target),W.put("/api/payments/move-reg",{},{params:{paymentId:this.paymentData._id,raceId:this.target}}).then(e=>{this.successMessage="Registration moved"}).catch(e=>{this.formError=["Error submitting request"],console.log(e)})},async deleteReg(t){return console.log(t),W.delete(`/api/racers/race/${this.target}`,{params:{paymentId:this.paymentData._id}}).then(e=>{this.successMessage="Registration deleted"}).catch(e=>{this.formError=["Error submitting request"],console.log(e)})}}},ni=o("div",{class:"modal-header"},[o("h5",null," Edit Payment ")],-1),ri={key:0};function ai(t,e,a,c,s,r){const n=A("FormKit");return u(),p(Q,null,[ni,o("div",null,[T(" Move This reg to Event: "),D(n,{type:"select",label:"Select an Event:",placeHolder:"Select race to transfer to",name:"selectedRace",options:r.raceOptions},null,8,["options"]),o("div",{class:"btn btn-sm btn-primary",onClick:e[0]||(e[0]=d=>r.moveReg())},"Transfer")]),o("div",null,[T(" Delete registration "),o("div",{class:"btn btn-sm btn-primary",onClick:e[1]||(e[1]=d=>r.deleteReg())},"Delete!")]),s.successMessage?(u(),p("div",ri,b(s.successMessage),1)):P("",!0)],64)}const ii=ve(oi,[["render",ai]]);const li={components:{ModalComponent:Xe,EditPaymentComponent:ii},data(){return{loading:!1,error:null,races:[],filterKey:"",filterPayStatus:"all",filterEvent:!1,filterPaytype:"all",filterOptionalPurchases:"all",payments:[],selectedRaceId:"",showModal:!1,orphanedPayments:[],orphanedLoading:!1,orphanedError:null,fixingOrphaned:!1,fixResults:null,duplicatePayments:[],duplicatesLoading:!1,duplicatesError:null,showDetailsModal:!1,selectedPaymentDetails:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},watch:{selectedRaceId:{handler(t){this.getPaymentsForRace(this.selectedRaceId)},immediate:!0}},methods:{dollas(t){return J.isNumber(t)?parseFloat(t/100).toLocaleString("en-US",{style:"currency",currency:"USD"}):""},async getReceipt(t){try{const e=await W(`/api/payments/receipt?payment_id=${t}`);e.data&&e.data.receipt_url&&window.open(e.data.receipt_url,"_blank")}catch(e){console.error("Error fetching receipt:",e),alert("Unable to retrieve receipt. This payment may not have a Stripe receipt available.")}},hasStripeReceipt(t){return t.stripePayment&&t.stripePayment.payment_intent&&t.status==="paid"&&t.stripePayment.amount_total>0},fetchData(){if(this.error=null,this.loading=!0,this.$route)return W("/api/races/").then(t=>{this.races=t.data,this.races.length>0&&(this.selectedRaceId=this.races[0].raceid),this.loading=!1}).catch(t=>{this.loading=!1,this.error=t.toString(),console.error(t)})},getPaymentsForRace(t){t&&W(`/api/payments/${t}`).then(e=>{this.payments=e.data,this.loading=!1}).catch(e=>{this.loading=!1,this.error=e.toString(),console.error(e)})},editPayment(t){let e=J.clone(J.find(this.payments,{_id:t}));e?(console.log("payment Data:"),console.log(e),this.paymentToEdit=e,this.paymentFormMode="edit",this.showModal=!0):alert("no payment id found for racer")},closeModal(){this.showModal=!1},isSponsoredCategory(t){var a;if(!this.selectedRaceData||!this.selectedRaceData.regCategories||!((a=t.regData)!=null&&a.category))return!1;const e=J.find(this.selectedRaceData.regCategories,{id:t.regData.category});return(e==null?void 0:e.sponsored)===!0},async checkOrphanedPayments(){if(this.selectedRaceId){this.orphanedLoading=!0,this.orphanedError=null,this.fixResults=null;try{const t=await W(`/api/payments/admin/orphaned-payments?raceid=${this.selectedRaceId}`);this.orphanedPayments=t.data.payments||[]}catch(t){console.error("Error checking orphaned payments:",t),this.orphanedError=t.message||"Failed to check orphaned payments"}finally{this.orphanedLoading=!1}}},async fixOrphanedPayments(){if(!(!this.selectedRaceId||this.orphanedPayments.length===0||!confirm(`This will retry registration for ${this.orphanedPayments.length} orphaned payment(s). Confirmation emails will NOT be sent. Continue?`))){this.fixingOrphaned=!0,this.orphanedError=null;try{const e=await W.post("/api/payments/admin/batch-retry-registration",{raceid:this.selectedRaceId,sendEmails:!1});this.fixResults=e.data,await this.checkOrphanedPayments(),await this.getPaymentsForRace(this.selectedRaceId);const{successful:a,failed:c,alreadyRegistered:s}=this.fixResults;let r=`Results:
`;r+=`✓ Successfully registered: ${a.length}
`,s.length>0&&(r+=`ℹ Already registered: ${s.length}
`),c.length>0&&(r+=`✗ Failed: ${c.length}
`),alert(r)}catch(e){console.error("Error fixing orphaned payments:",e),this.orphanedError=e.message||"Failed to fix orphaned payments",alert("Error: "+this.orphanedError)}finally{this.fixingOrphaned=!1}}},async retryOrphanedPayment(t){if(confirm("Retry registration for this payment? No confirmation email will be sent."))try{const a=await W.post("/api/payments/admin/retry-registration",{paymentId:t});alert("Registration completed successfully!"),await this.checkOrphanedPayments(),await this.getPaymentsForRace(this.selectedRaceId)}catch(a){console.error("Error retrying payment:",a),alert("Error: "+(a.message||"Failed to retry registration"))}},async checkDuplicatePayments(){if(this.selectedRaceId){this.duplicatesLoading=!0,this.duplicatesError=null;try{const t=await W(`/api/payments/admin/duplicate-payments?raceid=${this.selectedRaceId}`);this.duplicatePayments=t.data.duplicates||[]}catch(t){console.error("Error checking duplicate payments:",t),this.duplicatesError=t.message||"Failed to check duplicate payments"}finally{this.duplicatesLoading=!1}}},async deletePayment(t,e){if(confirm(`Are you sure you want to delete this payment record for ${e}?

This will:
- Delete the payment record
- Remove the racer from the race registration

This action cannot be undone!`))try{await W.delete(`/api/payments/admin/payment/${t}`),alert("Payment deleted successfully!"),await this.checkDuplicatePayments(),await this.getPaymentsForRace(this.selectedRaceId)}catch(c){console.error("Error deleting payment:",c),alert("Error: "+(c.message||"Failed to delete payment"))}},showPaymentDetails(t){this.selectedPaymentDetails=t,this.showDetailsModal=!0},closeDetailsModal(){this.showDetailsModal=!1,this.selectedPaymentDetails=null},getStripePaymentLink(t){var s;if(!((s=t.stripePayment)!=null&&s.payment_intent))return null;const a=t.stripePayment.livemode===!1?"https://dashboard.stripe.com/test":"https://dashboard.stripe.com",c=t.stripePayment.on_behalf_of||t.stripePayment.account;return c?`${a}/connect/accounts/${c}/payments/${t.stripePayment.payment_intent}`:`${a}/payments/${t.stripePayment.payment_intent}`},getStripeCustomerLink(t){var s;if(!((s=t.stripePayment)!=null&&s.customer))return null;const a=t.stripePayment.livemode===!1?"https://dashboard.stripe.com/test":"https://dashboard.stripe.com",c=t.stripePayment.on_behalf_of||t.stripePayment.account;return c?`${a}/connect/accounts/${c}/customers/${t.stripePayment.customer}`:`${a}/customers/${t.stripePayment.customer}`},formatStripeDate(t){return t?ot(t*1e3).format("MMM DD, YYYY HH:mm:ss"):"-"}},computed:{loaded(){return!!this.payments},raceSelectOptions(){let t={};return J.each(this.races,({raceid:e,displayName:a})=>t[e]=a),t},selectedRaceData(){return J.find(this.races,{raceid:this.selectedRaceId})},seriesRaces(){let t=J.find(this.races,{raceid:this.selectedRaceId});if(console.log("race data"),console.log(t),!t||!t.series)return[];console.log("series races"),console.log();let e={};return J.each(J.filter(this.races,{series:t.series}),({raceid:a,displayName:c})=>e[a]=c),e},filterOptionalOptions(){let t={all:"All"};return this.payments.forEach(({regData:e})=>{e&&e.optionalPurchases&&Object.keys(e.optionalPurchases).forEach(a=>{e.optionalPurchases[a]===!0&&(t[a]=a)})}),t},filterPayStatusOptions(){return{all:"All",unpaid:"unpaid",paid:"paid",free:"free"}},filterPayTypeOptions(){return{all:"All",season:"Season",single:"Single",cash:"cash"}},filteredPayments(){const t=this.filterKey&&this.filterKey.toLowerCase();return this.payments&&(t.length||this.filterPayStatus!=="all"||this.filterPaytype!=="all"||this.filterOptionalPurchases!=="all")?J.filter(this.payments,e=>{var a,c,s;if(this.filterOptionalPurchases!=="all"&&(!e.regData.optionalPurchases||e.regData.optionalPurchases[this.filterOptionalPurchases]!==!0))return!1;if(this.filterPayStatus!=="all"){if(this.filterPayStatus==="free"){const r=((a=e.regData)==null?void 0:a.paytype)==="volunteer",n=this.isSponsoredCategory(e);if(!r&&!n)return!1}else if(this.filterPayStatus!==e.status||this.filterPayStatus==="paid"&&(!((c=e.stripePayment)!=null&&c.amount_total)||e.stripePayment.amount_total===0))return!1}return this.filterPaytype!=="all"&&((s=e.regData)==null?void 0:s.paytype)!==this.filterPaytype?!1:parseInt(t)?parseInt(t)===parseInt(e.regData.bibNumber):["first_name","last_name"].some(r=>String(e.regData[r]).toLowerCase().indexOf(t)>-1)}):this.payments}}},ci={key:0,class:"loading"},di={key:1},ui={key:0,class:"error"},mi={key:1},hi={class:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom"},fi={class:"btn-toolbar mb-2 mb-md-0"},pi={class:"btn-toolbar mb-2 mb-md-0"},gi={class:"btn-toolbar mb-2 mb-md-0"},vi={class:"btn-toolbar mb-2 mb-md-0"},yi={class:"btn-toolbar mb-2 mb-md-0"},bi={class:"card mb-4 border-warning"},_i={class:"card-header bg-warning bg-opacity-10"},Ci={class:"d-flex justify-content-between align-items-center"},Di=o("h5",{class:"mb-0"},[o("i",{class:"bi bi-exclamation-triangle-fill text-warning me-2"}),T(" Orphaned Payments Check ")],-1),Si=["disabled"],xi={key:0},Ei={key:1},wi={key:0,class:"card-body"},Pi={key:0,class:"alert alert-danger"},Ri={key:1},Ti={class:"alert alert-warning"},Oi={class:"mb-3"},Ii=["disabled"],ki={key:0},$i={key:1},Ai={class:"table-responsive"},Mi={class:"table table-sm table-bordered"},Fi=o("thead",null,[o("tr",null,[o("th",null,"Name"),o("th",null,"Email"),o("th",null,"Category"),o("th",null,"Pay Type"),o("th",null,"Amount"),o("th",null,"Date"),o("th",null,"Action")])],-1),Ni=["onClick"],Li={key:2,class:"alert alert-success"},Ui=o("i",{class:"bi bi-check-circle-fill me-2"},null,-1),ji={class:"card mb-4 border-danger"},Vi={class:"card-header bg-danger bg-opacity-10"},Hi={class:"d-flex justify-content-between align-items-center"},Bi=o("h5",{class:"mb-0"},[o("i",{class:"bi bi-files text-danger me-2"}),T(" Duplicate Payments Check ")],-1),Gi=["disabled"],Ki={key:0},zi={key:1},Yi={key:0,class:"card-body"},Wi={key:0,class:"alert alert-danger"},Xi={key:1},Ji={class:"alert alert-danger"},Qi={class:"border-bottom pb-2"},Zi={class:"badge bg-danger ms-2"},qi={key:0,class:"badge bg-success ms-2"},el={key:1,class:"badge bg-warning ms-2"},tl={class:"table-responsive"},sl={class:"table table-sm table-bordered"},ol=o("thead",null,[o("tr",null,[o("th",null,"Status"),o("th",null,"Email"),o("th",null,"Pay Type"),o("th",null,"Amount"),o("th",null,"Date"),o("th",null,"Bib"),o("th",null,"Action")])],-1),nl={key:0,class:"badge bg-success"},rl=o("i",{class:"bi bi-check-circle-fill"},null,-1),al={key:1,class:"badge bg-secondary"},il=["onClick","disabled","title"],ll={key:2,class:"alert alert-success"},cl=o("i",{class:"bi bi-check-circle-fill me-2"},null,-1),dl={class:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center"},ul=o("h2",null,"Payments",-1),ml={class:"h5"},hl={class:"table-responsive"},fl={class:"table table-striped table-hover table-sm"},pl=o("thead",null,[o("tr",null,[o("th",{scope:"col"},"Status"),o("th",{scope:"col"},"name"),o("th",{scope:"col"},"Reg Email"),o("th",{scope:"col"},"Paytype"),o("th",{scope:"col"},"Sponsored"),o("th",{scope:"col"},"Amount"),o("th",{scope:"col"},"Bib"),o("th",{scope:"col"},"Confirmation"),o("th",{scope:"col"},"Receipt"),o("th",{scope:"col"},"Actions")])],-1),gl=["href"],vl=["href"],yl=["onClick"],bl={key:1,class:"text-muted"},_l=["onClick"],Cl=o("i",{class:"bi bi-info-circle"},null,-1),Dl=["onClick"],Sl=o("h4",{class:"modal-title"},"Payment Details",-1),xl={key:0,class:"payment-details"},El={key:0,class:"alert alert-info mb-3"},wl=o("h5",{class:"alert-heading"},[o("i",{class:"bi bi-gift-fill me-2"}),T("Sponsored/Free Registration ")],-1),Pl=o("p",{class:"mb-2"},"This registration was completed without payment.",-1),Rl={key:0,class:"mb-0"},Tl=o("strong",null,"Coupon Code:",-1),Ol={class:"badge bg-info fs-6"},Il={key:0,class:"ms-2"},kl={key:1,class:"mb-0 text-muted"},$l=o("small",null,"Marked as sponsored payment in system",-1),Al=[$l],Ml={class:"card mb-3"},Fl=o("div",{class:"card-header bg-primary text-white"},[o("h5",{class:"mb-0"},[o("i",{class:"bi bi-person-fill me-2"}),T("Registration Information")])],-1),Nl={class:"card-body"},Ll={class:"row"},Ul={class:"col-md-6"},jl=o("strong",null,"Name:",-1),Vl=o("strong",null,"Email:",-1),Hl=["href"],Bl=o("strong",null,"Category:",-1),Gl=o("strong",null,"Bib Number:",-1),Kl={class:"col-md-6"},zl=o("strong",null,"Race ID:",-1),Yl=o("strong",null,"Payment Type:",-1),Wl=o("strong",null,"Status:",-1),Xl={key:0},Jl=o("strong",null,"Team:",-1),Ql={key:0,class:"mt-3"},Zl=o("h6",null,"Optional Purchases:",-1),ql={class:"list-unstyled"},ec={key:0,class:"bi bi-check-circle-fill text-success me-2"},tc={key:1,class:"mt-3"},sc=o("h6",null,"Emergency Contact:",-1),oc={class:"mb-1"},nc=o("strong",null,"Name:",-1),rc={key:0,class:"mb-0"},ac=o("strong",null,"Phone:",-1),ic={key:1,class:"card mb-3"},lc=o("div",{class:"card-header bg-success text-white"},[o("h5",{class:"mb-0"},[o("i",{class:"bi bi-credit-card-fill me-2"}),T("Stripe Payment Information")])],-1),cc={class:"card-body"},dc={class:"row"},uc={class:"col-md-6"},mc=o("strong",null,"Amount:",-1),hc=o("strong",null,"Currency:",-1),fc=o("strong",null,"Payment Status:",-1),pc={class:"badge bg-success"},gc=o("strong",null,"Mode:",-1),vc={class:"col-md-6"},yc=o("strong",null,"Created:",-1),bc={key:0},_c=o("strong",null,"Payment Intent:",-1),Cc={class:"small"},Dc={key:1},Sc=o("strong",null,"Customer ID:",-1),xc={class:"small"},Ec={class:"mt-3 d-flex gap-2"},wc=["href"],Pc=o("i",{class:"bi bi-box-arrow-up-right me-1"},null,-1),Rc=["href"],Tc=o("i",{class:"bi bi-person-badge me-1"},null,-1),Oc={key:0,class:"mt-3"},Ic=o("strong",null,"Payment Methods:",-1),kc={key:2,class:"card mb-3"},$c=o("div",{class:"card-header bg-light"},[o("h5",{class:"mb-0"},[o("i",{class:"bi bi-credit-card me-2"}),T("Payment Information")])],-1),Ac={class:"card-body"},Mc={class:"alert alert-secondary mb-0"},Fc=o("i",{class:"bi bi-info-circle me-2"},null,-1),Nc={key:0},Lc={class:"card"},Uc=o("div",{class:"card-header bg-secondary text-white"},[o("h5",{class:"mb-0"},[o("i",{class:"bi bi-gear-fill me-2"}),T("System Information")])],-1),jc={class:"card-body"},Vc=o("strong",null,"Payment Record ID:",-1),Hc={key:0},Bc=o("strong",null,"Stripe Session ID:",-1),Gc={class:"small"},Kc={key:1},zc=o("strong",null,"Sponsored Payment:",-1),Yc=o("span",{class:"badge bg-success"},"Yes",-1),Wc={key:2},Xc=o("div",{class:"text-center"},[o("h2",{class:"mt-5"},"Error loading payments...")],-1),Jc=[Xc];function Qc(t,e,a,c,s,r){const n=A("FormKit"),d=A("EditPaymentComponent"),i=A("modal-component");return s.loading?(u(),p("div",ci,"Loading...")):(u(),p("div",di,[s.error?(u(),p("div",ui,b(s.error),1)):P("",!0),r.loaded?(u(),p("div",mi,[o("div",hi,[o("div",fi,[D(n,{type:"select",label:"Select an Event:",name:"selectedRace",modelValue:s.selectedRaceId,"onUpdate:modelValue":e[0]||(e[0]=l=>s.selectedRaceId=l),options:r.raceSelectOptions},null,8,["modelValue","options"])]),o("div",pi,[D(n,{id:"racerFilterTxtInput",type:"text",name:"search",label:"Search:",help:"search in first, last, bib number",delay:300,modelValue:s.filterKey,"onUpdate:modelValue":e[1]||(e[1]=l=>s.filterKey=l)},null,8,["modelValue"])]),o("div",gi,[D(n,{type:"select",label:"Filter by Status:",name:"filterPayStatus",modelValue:s.filterPayStatus,"onUpdate:modelValue":e[2]||(e[2]=l=>s.filterPayStatus=l),default:"all",options:r.filterPayStatusOptions},null,8,["modelValue","options"])]),o("div",vi,[D(n,{type:"select",label:"Filter by PayType:",name:"filterPaytype",modelValue:s.filterPaytype,"onUpdate:modelValue":e[3]||(e[3]=l=>s.filterPaytype=l),default:"all",options:r.filterPayTypeOptions},null,8,["modelValue","options"])]),o("div",yi,[D(n,{type:"select",label:"Filter by optional purchases:",name:"filterOptionalPurchases",modelValue:s.filterOptionalPurchases,"onUpdate:modelValue":e[4]||(e[4]=l=>s.filterOptionalPurchases=l),default:"All",options:r.filterOptionalOptions},null,8,["modelValue","options"])])]),o("div",bi,[o("div",_i,[o("div",Ci,[Di,o("button",{class:"btn btn-sm btn-warning",onClick:e[5]||(e[5]=(...l)=>r.checkOrphanedPayments&&r.checkOrphanedPayments(...l)),disabled:s.orphanedLoading||!s.selectedRaceId},[s.orphanedLoading?(u(),p("span",xi,"Checking...")):(u(),p("span",Ei,"Check for Orphaned Payments"))],8,Si)])]),s.orphanedPayments.length>0||s.orphanedError?(u(),p("div",wi,[s.orphanedError?(u(),p("div",Pi,b(s.orphanedError),1)):s.orphanedPayments.length>0?(u(),p("div",Ri,[o("div",Ti,[o("strong",null,"Found "+b(s.orphanedPayments.length)+" orphaned payment(s)",1),T(" - These payments were completed but registration was not saved. ")]),o("div",Oi,[o("button",{class:"btn btn-primary",onClick:e[6]||(e[6]=(...l)=>r.fixOrphanedPayments&&r.fixOrphanedPayments(...l)),disabled:s.fixingOrphaned},[s.fixingOrphaned?(u(),p("span",ki,"Fixing...")):(u(),p("span",$i,"Fix All Orphaned Payments"))],8,Ii)]),o("div",Ai,[o("table",Mi,[Fi,o("tbody",null,[(u(!0),p(Q,null,ie(s.orphanedPayments,l=>(u(),p("tr",{key:l._id},[o("td",null,b(l.regData.first_name)+" "+b(l.regData.last_name),1),o("td",null,b(l.regData.email),1),o("td",null,b(l.regData.category),1),o("td",null,b(l.regData.paytype),1),o("td",null,b(r.dollas(l.amount)),1),o("td",null,b(l.created?t.dayjs(l.created).format("MM/DD/YY HH:mm"):"-"),1),o("td",null,[o("button",{class:"btn btn-sm btn-success",onClick:m=>r.retryOrphanedPayment(l._id)}," Retry ",8,Ni)])]))),128))])])])])):(u(),p("div",Li,[Ui,T(" No orphaned payments found for this race. ")]))])):P("",!0)]),o("div",ji,[o("div",Vi,[o("div",Hi,[Bi,o("button",{class:"btn btn-sm btn-danger",onClick:e[7]||(e[7]=(...l)=>r.checkDuplicatePayments&&r.checkDuplicatePayments(...l)),disabled:s.duplicatesLoading||!s.selectedRaceId},[s.duplicatesLoading?(u(),p("span",Ki,"Checking...")):(u(),p("span",zi,"Check for Duplicate Payments"))],8,Gi)])]),s.duplicatePayments.length>0||s.duplicatesError?(u(),p("div",Yi,[s.duplicatesError?(u(),p("div",Wi,b(s.duplicatesError),1)):s.duplicatePayments.length>0?(u(),p("div",Xi,[o("div",Ji,[o("strong",null,"Found "+b(s.duplicatePayments.length)+" person(s) with duplicate payments",1),T(" - Review and delete unwanted payment records. ")]),(u(!0),p(Q,null,ie(s.duplicatePayments,l=>(u(),p("div",{key:l.key,class:"mb-4"},[o("h6",Qi,[T(b(l.first_name)+" "+b(l.last_name)+" - "+b(l.category)+" ",1),o("span",Zi,b(l.count)+" payments",1),l.registeredCount>0?(u(),p("span",qi,b(l.registeredCount)+" registered ",1)):(u(),p("span",el," None registered "))]),o("div",tl,[o("table",sl,[ol,o("tbody",null,[(u(!0),p(Q,null,ie(l.payments,m=>(u(),p("tr",{key:m._id,class:ne({"table-success":m.isRegistered})},[o("td",null,[m.isRegistered?(u(),p("span",nl,[rl,T(" Registered ")])):(u(),p("span",al," Not Registered "))]),o("td",null,b(m.regData.email),1),o("td",null,b(m.regData.paytype),1),o("td",null,b(r.dollas(m.amount)),1),o("td",null,b(m.created?t.dayjs(m.created).format("MM/DD/YY HH:mm"):"-"),1),o("td",null,b(m.regData.bibNumber||"-"),1),o("td",null,[o("button",{class:"btn btn-sm btn-danger",onClick:f=>r.deletePayment(m._id,`${l.first_name} ${l.last_name}`),disabled:m.isRegistered&&l.registeredCount===1,title:m.isRegistered&&l.registeredCount===1?"Cannot delete the only registered payment":"Delete this payment"}," Delete ",8,il)])],2))),128))])])])]))),128))])):(u(),p("div",ll,[cl,T(" No duplicate payments found for this race. ")]))])):P("",!0)]),o("div",dl,[ul,o("div",ml,"Count: "+b(r.filteredPayments.length),1)]),o("div",hl,[o("table",fl,[pl,o("tbody",null,[(u(!0),p(Q,null,ie(r.filteredPayments,(l,m)=>{var f;return u(),p("tr",{key:m},[o("td",null,b(l.status),1),o("td",null,b(l.regData.first_name+" "+l.regData.last_name),1),o("td",null,[o("a",{href:`mailto:${l.regData.email}`},b(l.regData.email),9,gl)]),o("td",null,b(l.regData.paytype),1),o("td",null,b(r.isSponsoredCategory(l)?"Yes":""),1),o("td",null,b(r.dollas((f=l.stripePayment)==null?void 0:f.amount_total)),1),o("td",null,b(l.regData.bibNumber),1),o("td",null,[o("a",{href:`/#/regconfirmation/${l.regData.raceid}/${l._id}`,target:"_blank"},"View",8,vl)]),o("td",null,[r.hasStripeReceipt(l)?(u(),p("button",{key:0,class:"btn btn-sm btn-primary",onClick:h=>r.getReceipt(l._id),title:"View Stripe Receipt"}," Receipt ",8,yl)):(u(),p("span",bl,"-"))]),o("td",null,[o("button",{class:"btn btn-sm btn-info me-1",onClick:h=>r.showPaymentDetails(l),title:"View Details"},[Cl,T(" Details ")],8,_l),l.status!=="unpaid"&&l.regData.paytype!="season"?(u(),p("button",{key:0,class:"btn btn-sm btn-secondary",onClick:h=>r.editPayment(l._id)},"Edit",8,Dl)):P("",!0)])])}),128))])]),(u(),ee(xt,{to:"body"},[s.payments.length>0?(u(),ee(i,{key:0,show:s.showModal,onClose:r.closeModal},{body:V(()=>[D(d,{races:r.seriesRaces,paymentData:t.paymentToEdit,formMode:t.paymentFormMode},null,8,["races","paymentData","formMode"])]),_:1},8,["show","onClose"])):P("",!0),D(i,{show:s.showDetailsModal,onClose:r.closeDetailsModal},{header:V(()=>[Sl]),body:V(()=>{var l;return[s.selectedPaymentDetails?(u(),p("div",xl,[s.selectedPaymentDetails.sponsoredPayment||s.selectedPaymentDetails.regData.coupon&&!s.selectedPaymentDetails.stripePayment?(u(),p("div",El,[wl,Pl,s.selectedPaymentDetails.regData.coupon?(u(),p("p",Rl,[Tl,T(),o("span",Ol,b(s.selectedPaymentDetails.regData.coupon),1),s.selectedPaymentDetails.regData.fractionDiscount?(u(),p("span",Il," ("+b((s.selectedPaymentDetails.regData.fractionDiscount*100).toFixed(0))+"% discount) ",1)):P("",!0)])):P("",!0),s.selectedPaymentDetails.sponsoredPayment?(u(),p("p",kl,Al)):P("",!0)])):P("",!0),o("div",Ml,[Fl,o("div",Nl,[o("div",Ll,[o("div",Ul,[o("p",null,[jl,T(" "+b(s.selectedPaymentDetails.regData.first_name)+" "+b(s.selectedPaymentDetails.regData.last_name),1)]),o("p",null,[Vl,T(),o("a",{href:`mailto:${s.selectedPaymentDetails.regData.email}`},b(s.selectedPaymentDetails.regData.email),9,Hl)]),o("p",null,[Bl,T(" "+b(s.selectedPaymentDetails.regData.category),1)]),o("p",null,[Gl,T(" "+b(s.selectedPaymentDetails.regData.bibNumber||"Not assigned"),1)])]),o("div",Kl,[o("p",null,[zl,T(" "+b(s.selectedPaymentDetails.regData.raceid),1)]),o("p",null,[Yl,T(" "+b(s.selectedPaymentDetails.regData.paytype),1)]),o("p",null,[Wl,T(),o("span",{class:ne(["badge",{"bg-success":s.selectedPaymentDetails.status==="paid","bg-warning":s.selectedPaymentDetails.status==="unpaid"}])},b(s.selectedPaymentDetails.status),3)]),s.selectedPaymentDetails.regData.team?(u(),p("p",Xl,[Jl,T(" "+b(s.selectedPaymentDetails.regData.team),1)])):P("",!0)])]),s.selectedPaymentDetails.regData.optionalPurchases&&Object.keys(s.selectedPaymentDetails.regData.optionalPurchases).length>0?(u(),p("div",Ql,[Zl,o("ul",ql,[(u(!0),p(Q,null,ie(s.selectedPaymentDetails.regData.optionalPurchases,(m,f)=>(u(),p("li",{key:f},[m?(u(),p("i",ec)):P("",!0),T(" "+b(f)+": "+b(m),1)]))),128))])])):P("",!0),s.selectedPaymentDetails.regData.emergencyContact?(u(),p("div",tc,[sc,o("p",oc,[nc,T(" "+b(s.selectedPaymentDetails.regData.emergencyContact),1)]),s.selectedPaymentDetails.regData.emergencyPhone?(u(),p("p",rc,[ac,T(" "+b(s.selectedPaymentDetails.regData.emergencyPhone),1)])):P("",!0)])):P("",!0)])]),s.selectedPaymentDetails.stripePayment?(u(),p("div",ic,[lc,o("div",cc,[o("div",dc,[o("div",uc,[o("p",null,[mc,T(" "+b(r.dollas(s.selectedPaymentDetails.stripePayment.amount_total)),1)]),o("p",null,[hc,T(" "+b((l=s.selectedPaymentDetails.stripePayment.currency)==null?void 0:l.toUpperCase()),1)]),o("p",null,[fc,T(),o("span",pc,b(s.selectedPaymentDetails.stripePayment.payment_status),1)]),o("p",null,[gc,T(),o("span",{class:ne(["badge",s.selectedPaymentDetails.stripePayment.livemode?"bg-danger":"bg-warning"])},b(s.selectedPaymentDetails.stripePayment.livemode?"Live":"Test"),3)])]),o("div",vc,[o("p",null,[yc,T(" "+b(r.formatStripeDate(s.selectedPaymentDetails.stripePayment.created)),1)]),s.selectedPaymentDetails.stripePayment.payment_intent?(u(),p("p",bc,[_c,T(),o("code",Cc,b(s.selectedPaymentDetails.stripePayment.payment_intent),1)])):P("",!0),s.selectedPaymentDetails.stripePayment.customer?(u(),p("p",Dc,[Sc,T(),o("code",xc,b(s.selectedPaymentDetails.stripePayment.customer),1)])):P("",!0)])]),o("div",Ec,[r.getStripePaymentLink(s.selectedPaymentDetails)?(u(),p("a",{key:0,href:r.getStripePaymentLink(s.selectedPaymentDetails),target:"_blank",class:"btn btn-sm btn-outline-primary"},[Pc,T("View in Stripe Dashboard ")],8,wc)):P("",!0),r.getStripeCustomerLink(s.selectedPaymentDetails)?(u(),p("a",{key:1,href:r.getStripeCustomerLink(s.selectedPaymentDetails),target:"_blank",class:"btn btn-sm btn-outline-secondary"},[Tc,T("View Customer ")],8,Rc)):P("",!0)]),s.selectedPaymentDetails.stripePayment.payment_method_types?(u(),p("div",Oc,[o("p",null,[Ic,T(" "+b(s.selectedPaymentDetails.stripePayment.payment_method_types.join(", ")),1)])])):P("",!0)])])):(u(),p("div",kc,[$c,o("div",Ac,[o("div",Mc,[Fc,T(" No Stripe payment associated with this registration. "),s.selectedPaymentDetails.sponsoredPayment||s.selectedPaymentDetails.regData.coupon?(u(),p("span",Nc," This was a sponsored or free entry. ")):P("",!0)])])])),o("div",Lc,[Uc,o("div",jc,[o("p",null,[Vc,T(),o("code",null,b(s.selectedPaymentDetails._id),1)]),s.selectedPaymentDetails.payment_id?(u(),p("p",Hc,[Bc,T(),o("code",Gc,b(s.selectedPaymentDetails.payment_id),1)])):P("",!0),s.selectedPaymentDetails.sponsoredPayment?(u(),p("p",Kc,[zc,T(),Yc])):P("",!0)])])])):P("",!0)]}),_:1},8,["show","onClose"])]))])])):(u(),p("div",Wc,Jc))]))}const Zc=ve(li,[["render",Qc]]);const qc={props:{data:Array,columns:Array,filterKey:String,editIdColumn:String},emits:["edit"],data(){return{sortKey:"",sortOrders:this.columns.reduce((t,e)=>(t[e]=1,t),{})}},computed:{filteredData(){const t=this.sortKey,e=this.filterKey&&this.filterKey.toLowerCase(),a=this.sortOrders[t]||1;let c=this.data;return e&&(c=c.filter(s=>Object.keys(s).some(r=>String(s[r]).toLowerCase().indexOf(e)>-1))),t&&(c=c.slice().sort((s,r)=>(s=s[t],r=r[t],(s===r?0:s>r?1:-1)*a))),c}},methods:{sortBy(t){this.sortKey=t,this.sortOrders[t]=this.sortOrders[t]*-1},capitalize(t){return t.charAt(0).toUpperCase()+t.slice(1)}}},ed={class:"table-responsive"},td={key:0,class:"table table-striped table-sm"},sd=["onClick"],od={key:0},nd=["onClick"],rd={key:1};function ad(t,e,a,c,s,r){return u(),p("div",ed,[r.filteredData.length?(u(),p("table",td,[o("thead",null,[o("tr",null,[(u(!0),p(Q,null,ie(a.columns,n=>(u(),p("th",{onClick:d=>r.sortBy(n),class:ne({active:s.sortKey==n})},[T(b(r.capitalize(n))+" ",1),o("span",{class:ne(["arrow",s.sortOrders[n]>0?"asc":"dsc"])},null,2)],10,sd))),256))])]),o("tbody",null,[(u(!0),p(Q,null,ie(r.filteredData,n=>(u(),p("tr",null,[(u(!0),p(Q,null,ie(a.columns,d=>(u(),p("td",null,b(n[d]),1))),256)),a.editIdColumn?(u(),p("td",od,[o("div",{class:"btn btn-sm btn-outline-secondary",onClick:d=>t.$emit("edit",n[a.editIdColumn])},"edit",8,nd)])):P("",!0)]))),256))])])):(u(),p("p",rd,"No data found."))])}const ro=ve(qc,[["render",ad],["__scopeId","data-v-37b58472"]]);const id={props:["racerData","categories","payments","formMode","series","seriesData"],emits:["saved"],data(){return{birthdate:"",formError:[],submitted:!1,paymentType:"season",prevBibError:[],bibError:[],formInputData:{}}},mounted(){if(this.formMode==="create"){this.paymentType=this.racerData.paytype;return}(this.formMode==="edit"||this.formMode==="regcash")&&(this.formInputData=this.racerData),J.defer(()=>{document.querySelector("#bibNumber").focus()})},computed:{sortedCats(){let t={};return J.forEach(J.orderBy(this.categories,"disporder"),e=>{t[e.id]=e.catdispname}),t},paymentOptions(){var e;let t={};return J.forEach(this.payments,a=>{t[a.type]=a.name}),(e=this.seriesData)!=null&&e.categoryGroups&&this.seriesData.categoryGroups.forEach(a=>{a.paymentOptions&&a.paymentOptions.forEach(c=>{t[c.type]||(t[c.type]=`${c.name} (${a.name})`)})}),t.cash="Cash Single Entry",t.volunteer="Volunteer Single Entry",t.season="Season Comp",t},racerAge(){if(this.birthdate){const t=ot(),e=ot(this.birthdate);return t.year()-e.year()}},unpaidReg(){return this.formMode==="create"?this.paymentType=="cash":this.paymentType=="cash"&&this.racerData.status=="unpaid"},paymentAmount(){if(this.racerData.paytype==="cash"){let t=J.find(this.payments,{type:"single"});return t?t.amount:null}}},methods:{dollas(t){return typeof t=="string"&&(t=parseInt(t)),t!==0&&!t?"":t.toLocaleString("en-US",{style:"currency",currency:"USD"})},findPrevBib(t){W.post(`/api/racers/bib/${t}`,{series:`${this.series}`}).then(({data:e})=>{if(console.log("prevbib"),console.log(e),e.paytype==="season"){this.prevBibError=["Racer is already registered for the whole season"];return}e.prevPaymentId=e.paymentId,delete e.paymentId,delete e.paymentReceived,delete e.raceid,this.formInputData=e,this.prevAge=e.racerAge}).catch(({response:e})=>{console.dir(e),e.status==404&&(this.prevBibError=[e.data.message])})},onPrevBibChange(t){t?this.findPrevBib(t):(this.prevBibError=[],this.prevAge=null)},onBibChange(t){if(!t){this.bibError=[];return}W.post(`/api/racers/bib/${t}`,{series:`${this.series}`}).then(({data:e})=>{if(console.log("bib check:",e),this.formMode==="edit"&&e.paymentId&&this.racerData.paymentId&&e.paymentId.toString()===this.racerData.paymentId.toString()){this.bibError=[];return}const a=(this.formInputData.first_name||"").toLowerCase().trim(),c=(this.formInputData.last_name||"").toLowerCase().trim(),s=(e.first_name||"").toLowerCase().trim(),r=(e.last_name||"").toLowerCase().trim();if(a&&c&&a===s&&c===r){this.bibError=[];return}this.bibError=[`Bib number ${t} is already in use by ${e.first_name} ${e.last_name}`]}).catch(({response:e})=>{console.log("bib check response:",e),e&&e.status==404?this.bibError=[]:console.error("Error checking bib:",e)})},async submitHandler(t){if(console.log(t),this.bibError.length>0){this.formError=["Please fix the bib number error before submitting"];return}let e;if(this.formMode==="create"||this.formMode==="regcash"){let a=this.paymentAmount;(t.paytype=="season"||t.paytype=="volunteer")&&(a=0,t.compedEntry=!0),e=W.post("/api/payments/register",{...t,paymentAmount:a},{params:{paymentId:t.paymentId,raceId:this.$route.params.raceid}})}else delete t.status,e=W.patch(`/api/racers/race/${this.$route.params.raceid}`,t,{params:{paymentId:this.racerData.paymentId}});return await e.then(a=>{if(a.data)return this.submitted=!0,console.log("response data"),console.log(a.data),new Promise(c=>setTimeout(()=>{this.$emit("saved"),c()},100))}).catch(a=>{this.formError=["Error submitting request"],console.log(a)})}}},ld={class:"modal-header"},cd={class:"edit-racer-form"},dd={class:"double"},ud={class:"double"},md={class:"double"},hd={key:0},fd=o("p",{class:"text-danger h4"},"Cash Payment Required",-1);function pd(t,e,a,c,s,r){const n=A("FormKit");return u(),p(Q,null,[o("div",ld,[o("h5",null,b(a.racerData.status==="unpaid"?"Register Racer":"Edit Racer Data"),1)]),o("div",cd,[a.formMode=="create"?(u(),ee(n,{key:0,type:"number",name:"bibNumber",label:"Bib Number:",help:"Enter racer's bib number from a previous race",delay:1500,onInput:r.onPrevBibChange,errors:s.prevBibError},null,8,["onInput","errors"])):P("",!0),D(n,{type:"form",id:"admin-registration",modelValue:s.formInputData,"onUpdate:modelValue":e[1]||(e[1]=d=>s.formInputData=d),"form-class":s.submitted?"hide":"show",errors:s.formError,"submit-label":"Save",onSubmit:r.submitHandler},{default:V(()=>[o("div",dd,[D(n,{type:"text",name:"first_name",label:"First name",validation:"required"}),D(n,{type:"text",name:"last_name",label:"Last name",validation:"required"})]),o("div",ud,[D(n,{type:"email",name:"email",label:"Email",validation:"email"}),D(n,{type:"text",name:"sponsor",label:"Team or Sponsor"})]),D(n,{type:"text",name:"contactNumber",label:"Phone Number",help:"If there is an issue on race day, we will try to contact you via this number"}),D(n,{type:"text",name:"emergencyNumber",label:"Emergency Contact Name and Number",help:"In case of an emergency, we will contact this person"}),D(n,{type:"text",name:"racerAge",label:"Racer Age",help:"age on dec 31"}),o("div",md,[D(n,{type:"select",id:"category",label:"Race Category:",placeholder:"Select a category",name:"category",options:r.sortedCats,validation:"required","validation-visibility":"dirty","validation-messages":{is:"You must select a race category"}},null,8,["options"]),D(n,{type:"select",id:"paytype",label:"Payment Type:",name:"paytype",options:r.paymentOptions,modelValue:s.paymentType,"onUpdate:modelValue":e[0]||(e[0]=d=>s.paymentType=d),validation:"required","validation-visibility":"dirty","validation-messages":{is:"You must select a Payment Type"}},null,8,["options","modelValue"])]),D(n,{id:"bibNumber",type:"text",name:"bibNumber",label:"Bib Number",delay:500,onInput:r.onBibChange,errors:s.bibError},null,8,["onInput","errors"]),r.unpaidReg?(u(),p("div",hd,[fd,D(n,{type:"checkbox",label:`I Collected ${r.dollas(r.paymentAmount)} from the racer`,name:"paymentReceived",validation:"required"},null,8,["label"])])):P("",!0)]),_:1},8,["modelValue","form-class","errors","onSubmit"])])],64)}const Mo=ve(id,[["render",pd]]),vs={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var gd=["size","color"];function Qs(){return Qs=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(t[c]=a[c])}return t},Qs.apply(this,arguments)}function vd(t,e){if(t==null)return{};var a={},c=Object.keys(t),s,r;for(r=0;r<c.length;r++)s=c[r],!(e.indexOf(s)>=0)&&(a[s]=t[s]);return a}var yd=function(e){return e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()},bd=function(e,a){return function(c,s){var r=c.size,n=c.color,d=vd(c,gd),i=s.attrs;s.emit;var l=s.slots;return Js("svg",Qs({},vs,{width:r||vs.width,height:r||vs.height,stroke:n||vs.stroke},i,{class:["lucide","lucide-"+yd(e),(i==null?void 0:i.class)||""]},d),[].concat(a.map(function(m){return Js.apply(void 0,m)}),l.default?[l.default()]:[]))}};const Ve=bd;var _d=Ve("ArrowLeftIcon",[["line",{x1:"19",y1:"12",x2:"5",y2:"12",key:"17g05t"}],["polyline",{points:"12 19 5 12 12 5",key:"1ksm0z"}]]);const Cd=_d;var Dd=Ve("CheckIcon",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]);const ao=Dd;var Sd=Ve("ChevronDownIcon",[["polyline",{points:"6 9 12 15 18 9",key:"1do0m2"}]]);const xd=Sd;var Ed=Ve("ChevronUpIcon",[["polyline",{points:"18 15 12 9 6 15",key:"1uugdp"}]]);const wd=Ed;var Pd=Ve("CodeIcon",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);const Rd=Pd;var Td=Ve("CopyIcon",[["rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2",key:"1ma1o8"}],["path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1",key:"pklvoz"}]]);const ms=Td;var Od=Ve("DownloadIcon",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",y1:"15",x2:"12",y2:"3",key:"nqo27w"}]]);const Id=Od;var kd=Ve("Edit3Icon",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z",key:"18w55b"}]]);const io=kd;var $d=Ve("EditIcon",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z",key:"1cs3r3"}]]);const Fo=$d;var Ad=Ve("EyeIcon",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const Md=Ad;var Fd=Ve("FilePlusIcon",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"12",y1:"18",x2:"12",y2:"12",key:"16t3gy"}],["line",{x1:"9",y1:"15",x2:"15",y2:"15",key:"1hgpwl"}]]);const No=Fd;var Nd=Ve("LinkIcon",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);const lo=Nd;var Ld=Ve("LockIcon",[["rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",key:"biyj2e"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);const Ud=Ld;var jd=Ve("PencilIcon",[["line",{x1:"18",y1:"2",x2:"22",y2:"6",key:"1k5sg2"}],["path",{d:"M7.5 20.5 19 9l-4-4L3.5 16.5 2 22z",key:"12iwkt"}]]);const $t=jd;var Vd=Ve("PlusIcon",[["line",{x1:"12",y1:"5",x2:"12",y2:"19",key:"myz83a"}],["line",{x1:"5",y1:"12",x2:"19",y2:"12",key:"1smlys"}]]);const co=Vd;var Hd=Ve("SaveIcon",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);const Bd=Hd;var Gd=Ve("Trash2Icon",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",y1:"11",x2:"10",y2:"17",key:"m9v7hp"}],["line",{x1:"14",y1:"11",x2:"14",y2:"17",key:"23cpt9"}]]);const Bt=Gd;const Kd={components:{ModalComponent:Xe,RacerFormComponent:Mo,Grid:ro,Link:lo,Edit3:io},data(){return{categories:{},loading:!1,error:null,formError:[],formInputData:{},data:{},racerToEdit:null,racerFormMode:"edit",showModal:!1,filterKey:"",filterUnpaid:!1,filterNoBib:!1,filterCats:"all"}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{dollas(t){return t.toLocaleString("en-US",{style:"currency",currency:"USD"})},fetchData(){this.error=null,this.loading=!0,this.$route.params.raceid&&W(`/api/racers/race/${this.$route.params.raceid}`).then(t=>{this.data=t.data,this.loading=!1}).catch(t=>{this.loading=!1,this.error=t.toString(),console.error(t)})},catName(t){let e=J.find(this.data.regCategories,{id:t});return e?e.catdispname:""},createReg(){this.racerToEdit={paytype:"cash",status:"unpaid",raceid:this.$route.params.raceid},this.racerFormMode="create",this.showModal=!0},regCash(t){let e=J.clone(J.find(this.data.registeredRacers,{paymentId:t}));e?(console.log("racerData:"),console.log(e),this.racerToEdit=e,this.racerFormMode="regcash",this.showModal=!0):alert("no payment id found for racer")},editRacer(t){let e=J.clone(J.find(this.data.registeredRacers,{paymentId:t}));e?(console.log("racerData:"),console.log(e),this.racerToEdit=e,this.racerFormMode="edit",this.showModal=!0):alert("no payment id found for racer")},racerUpdated(){this.racerToEdit=null,this.showModal=!1,this.fetchData()},capitalize(t){return J.capitalize(t)},closeModal(){this.showModal=!1,J.defer(()=>{document.querySelector("#racerFilterTxtInput").focus()})},resetFilters(){this.filterKey="",this.filterUnpaid=!1,this.filterNoBib=!1,this.filterCats="all"},optionalPurchases(t){if(!t)return"";let e="",a=[],c=Object.keys(t).filter(s=>s.split("-").length==1);return c.length&&c.forEach(s=>{if(t[s+"-option"])return a.push(`${this.capitalize(s)}: ${t[s+"-option"]}`);a.push(this.capitalize(s))}),e=a.join(", "),e},isSeriesCategory(t){var e,a;return(a=(e=this.data)==null?void 0:e.seriesData)!=null&&a.regCategories?this.data.seriesData.regCategories.some(c=>c.id===t):!1},isRaceOverride(t){return t._isRaceOverride===!0},isPureSeriesCategory(t){return t._isSeriesCategory===!0},getCategoryWithSource(t){const e=J.find(this.data.regCategories,{id:t});return e?{...e,isFromSeries:this.isPureSeriesCategory(e),isRaceOverride:this.isRaceOverride(e)}:null}},computed:{loaded(){return!!this.data},sortedCats(){let t={all:"All Categories"};return J.forEach(J.orderBy(this.data.regCategories,"disporder"),e=>{let a=e.catdispname;t[e.id]=a}),t},filteredRacers(){const t=this.filterKey&&this.filterKey.toLowerCase();let e=this.data.registeredRacers;return(t.length||this.filterUnpaid||this.filterCats!=="all"||this.filterNoBib)&&(e=e.filter(a=>this.filterUnpaid&&a.status!=="unpaid"||this.filterNoBib&&a.bibNumber||this.filterCats!="all"&&a.category!=this.filterCats?!1:["first_name","last_name","bibNumber"].some(c=>String(a[c]).toLowerCase().indexOf(t)>-1))),J.sortBy(e,[function(a){return a.last_name.toLowerCase()}])}}},zd={key:0,class:"loading"},Yd={key:1},Wd={key:0,class:"error"},Xd={key:1,class:"container-fluid"},Jd={class:"d-flex flex-row justify-content-center"},Qd={class:"p-2"},Zd={class:"racer-controls d-flex flex-row justify-content-between flex-wrap align-items-top pb-2 mb-3 border-bottom"},qd={class:"p-2"},eu={class:"flex-grow-1 p-2"},tu={class:"d-flex flex-row search-checks"},su={class:"d-flex flex-grow-1 justify-content-between p-2 pt-4"},ou={class:"table-responsive"},nu={class:"table table-striped table-sm"},ru=o("th",{scope:"col"},"First Name",-1),au=o("th",{scope:"col"},"Last Name",-1),iu=o("th",{scope:"col"},"Category",-1),lu=o("th",{scope:"col"},"Race Age",-1),cu=o("th",{scope:"col"},"Bib Number",-1),du=o("th",{scope:"col"},"Purchases",-1),uu=o("th",{scope:"col"},"Paytype",-1),mu=o("th",{scope:"col"},"Payment Status",-1),hu={scope:"col"},fu={key:0},pu={key:1},gu=["onClick"],vu=["onClick"],yu={key:2},bu=o("div",{class:"text-center"},[o("h2",{class:"mt-5"},"Race not available for registration...")],-1),_u=[bu];function Cu(t,e,a,c,s,r){const n=A("FormKit"),d=A("RacerFormComponent"),i=A("modal-component");return s.loading?(u(),p("div",zd,"Loading...")):(u(),p("div",Yd,[s.error?(u(),p("div",Wd,b(s.error),1)):P("",!0),r.loaded?(u(),p("div",Xd,[o("div",Jd,[o("div",Qd,[o("h3",null,b(s.data.displayName),1)])]),o("div",Zd,[o("div",qd,[D(n,{id:"racerFilterTxtInput",type:"text",name:"search",label:"Search:",help:"search in first, last or bib number",delay:300,modelValue:s.filterKey,"onUpdate:modelValue":e[0]||(e[0]=l=>s.filterKey=l)},null,8,["modelValue"])]),o("div",eu,[D(n,{type:"select",name:"categories",label:"Filter by Category",options:r.sortedCats,modelValue:s.filterCats,"onUpdate:modelValue":e[1]||(e[1]=l=>s.filterCats=l)},null,8,["options","modelValue"]),o("div",tu,[D(n,{type:"checkbox",name:"unpaid",label:"Unpaid Only",modelValue:s.filterUnpaid,"onUpdate:modelValue":e[2]||(e[2]=l=>s.filterUnpaid=l)},null,8,["modelValue"]),D(n,{type:"checkbox",name:"noBib",label:"No Bib Only",modelValue:s.filterNoBib,"onUpdate:modelValue":e[3]||(e[3]=l=>s.filterNoBib=l)},null,8,["modelValue"])])]),o("div",su,[o("a",{class:"btn btn-primary align-self-start",onClick:e[4]||(e[4]=(...l)=>r.resetFilters&&r.resetFilters(...l))},"Reset Filters"),o("div",{class:"btn btn-md btn-success align-self-start",onClick:e[5]||(e[5]=l=>r.createReg())},"Add New Registration")])]),o("div",ou,[o("table",nu,[o("thead",null,[o("tr",null,[ru,au,iu,lu,cu,du,uu,mu,o("th",hu,[o("strong",null,b(r.filteredRacers.length)+" Found",1)])])]),o("tbody",null,[(u(!0),p(Q,null,ie(r.filteredRacers,(l,m)=>(u(),p("tr",{key:m},[o("td",null,b(l.first_name),1),o("td",null,b(l.last_name),1),o("td",null,[r.getCategoryWithSource(l.category)?(u(),p("span",fu,b(r.catName(l.category)),1)):(u(),p("span",pu,b(r.catName(l.category)),1))]),o("td",null,b(l.racerAge),1),o("td",null,b(l.bibNumber),1),o("td",null,b(r.optionalPurchases(l.optionalPurchases)),1),o("td",null,b(l.paytype),1),o("td",{class:ne({"text-success":l.status!=="unpaid","text-danger":l.status==="unpaid"})},b(r.capitalize(l.status)),3),o("td",null,[l.status!=="unpaid"?(u(),p("div",{key:0,class:"btn btn-sm btn-outline-secondary",onClick:f=>r.editRacer(l.paymentId)},b("edit"),8,gu)):P("",!0),l.status==="unpaid"?(u(),p("div",{key:1,class:"btn btn-sm btn-outline-secondary",onClick:f=>r.regCash(l.paymentId)},b("Register"),8,vu)):P("",!0)])]))),128))])]),(u(),ee(xt,{to:"body"},[D(i,{show:s.showModal,onClose:r.closeModal},{body:V(()=>[D(d,{onSaved:r.racerUpdated,racerData:s.racerToEdit,categories:s.data.regCategories,payments:s.data.paymentOptions,formMode:s.racerFormMode,series:s.data.series,seriesData:s.data.seriesData},null,8,["onSaved","racerData","categories","payments","formMode","series","seriesData"])]),_:1},8,["show","onClose"])]))])])):(u(),p("div",yu,_u))]))}const Du=ve(Kd,[["render",Cu]]);var Lo={exports:{}};const Su=$o(Da);/**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function yo(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);e&&(c=c.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),a.push.apply(a,c)}return a}function ft(t){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};e%2?yo(Object(a),!0).forEach(function(c){xu(t,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):yo(Object(a)).forEach(function(c){Object.defineProperty(t,c,Object.getOwnPropertyDescriptor(a,c))})}return t}function Es(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Es=function(e){return typeof e}:Es=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Es(t)}function xu(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function nt(){return nt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(t[c]=a[c])}return t},nt.apply(this,arguments)}function Eu(t,e){if(t==null)return{};var a={},c=Object.keys(t),s,r;for(r=0;r<c.length;r++)s=c[r],!(e.indexOf(s)>=0)&&(a[s]=t[s]);return a}function wu(t,e){if(t==null)return{};var a=Eu(t,e),c,s;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(s=0;s<r.length;s++)c=r[s],!(e.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(t,c)&&(a[c]=t[c])}return a}function Pu(t){return Ru(t)||Tu(t)||Ou(t)||Iu()}function Ru(t){if(Array.isArray(t))return Zs(t)}function Tu(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Ou(t,e){if(t){if(typeof t=="string")return Zs(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);if(a==="Object"&&t.constructor&&(a=t.constructor.name),a==="Map"||a==="Set")return Array.from(t);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Zs(t,e)}}function Zs(t,e){(e==null||e>t.length)&&(e=t.length);for(var a=0,c=new Array(e);a<e;a++)c[a]=t[a];return c}function Iu(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ku="1.14.0";function vt(t){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(t)}var yt=vt(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),hs=vt(/Edge/i),bo=vt(/firefox/i),rs=vt(/safari/i)&&!vt(/chrome/i)&&!vt(/android/i),Uo=vt(/iP(ad|od|hone)/i),$u=vt(/chrome/i)&&vt(/android/i),jo={capture:!1,passive:!1};function he(t,e,a){t.addEventListener(e,a,!yt&&jo)}function ue(t,e,a){t.removeEventListener(e,a,!yt&&jo)}function Os(t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch{return!1}return!1}}function Au(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function dt(t,e,a,c){if(t){a=a||document;do{if(e!=null&&(e[0]===">"?t.parentNode===a&&Os(t,e):Os(t,e))||c&&t===a)return t;if(t===a)break}while(t=Au(t))}return null}var _o=/\s+/g;function we(t,e,a){if(t&&e)if(t.classList)t.classList[a?"add":"remove"](e);else{var c=(" "+t.className+" ").replace(_o," ").replace(" "+e+" "," ");t.className=(c+(a?" "+e:"")).replace(_o," ")}}function z(t,e,a){var c=t&&t.style;if(c){if(a===void 0)return document.defaultView&&document.defaultView.getComputedStyle?a=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(a=t.currentStyle),e===void 0?a:a[e];!(e in c)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),c[e]=a+(typeof a=="string"?"":"px")}}function kt(t,e){var a="";if(typeof t=="string")a=t;else do{var c=z(t,"transform");c&&c!=="none"&&(a=c+" "+a)}while(!e&&(t=t.parentNode));var s=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return s&&new s(a)}function Vo(t,e,a){if(t){var c=t.getElementsByTagName(e),s=0,r=c.length;if(a)for(;s<r;s++)a(c[s],s);return c}return[]}function ht(){var t=document.scrollingElement;return t||document.documentElement}function xe(t,e,a,c,s){if(!(!t.getBoundingClientRect&&t!==window)){var r,n,d,i,l,m,f;if(t!==window&&t.parentNode&&t!==ht()?(r=t.getBoundingClientRect(),n=r.top,d=r.left,i=r.bottom,l=r.right,m=r.height,f=r.width):(n=0,d=0,i=window.innerHeight,l=window.innerWidth,m=window.innerHeight,f=window.innerWidth),(e||a)&&t!==window&&(s=s||t.parentNode,!yt))do if(s&&s.getBoundingClientRect&&(z(s,"transform")!=="none"||a&&z(s,"position")!=="static")){var h=s.getBoundingClientRect();n-=h.top+parseInt(z(s,"border-top-width")),d-=h.left+parseInt(z(s,"border-left-width")),i=n+r.height,l=d+r.width;break}while(s=s.parentNode);if(c&&t!==window){var g=kt(s||t),v=g&&g.a,y=g&&g.d;g&&(n/=y,d/=v,f/=v,m/=y,i=n+m,l=d+f)}return{top:n,left:d,bottom:i,right:l,width:f,height:m}}}function Co(t,e,a){for(var c=St(t,!0),s=xe(t)[e];c;){var r=xe(c)[a],n=void 0;if(a==="top"||a==="left"?n=s>=r:n=s<=r,!n)return c;if(c===ht())break;c=St(c,!1)}return!1}function Ht(t,e,a,c){for(var s=0,r=0,n=t.children;r<n.length;){if(n[r].style.display!=="none"&&n[r]!==q.ghost&&(c||n[r]!==q.dragged)&&dt(n[r],a.draggable,t,!1)){if(s===e)return n[r];s++}r++}return null}function uo(t,e){for(var a=t.lastElementChild;a&&(a===q.ghost||z(a,"display")==="none"||e&&!Os(a,e));)a=a.previousElementSibling;return a||null}function Ie(t,e){var a=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)t.nodeName.toUpperCase()!=="TEMPLATE"&&t!==q.clone&&(!e||Os(t,e))&&a++;return a}function Do(t){var e=0,a=0,c=ht();if(t)do{var s=kt(t),r=s.a,n=s.d;e+=t.scrollLeft*r,a+=t.scrollTop*n}while(t!==c&&(t=t.parentNode));return[e,a]}function Mu(t,e){for(var a in t)if(t.hasOwnProperty(a)){for(var c in e)if(e.hasOwnProperty(c)&&e[c]===t[a][c])return Number(a)}return-1}function St(t,e){if(!t||!t.getBoundingClientRect)return ht();var a=t,c=!1;do if(a.clientWidth<a.scrollWidth||a.clientHeight<a.scrollHeight){var s=z(a);if(a.clientWidth<a.scrollWidth&&(s.overflowX=="auto"||s.overflowX=="scroll")||a.clientHeight<a.scrollHeight&&(s.overflowY=="auto"||s.overflowY=="scroll")){if(!a.getBoundingClientRect||a===document.body)return ht();if(c||e)return a;c=!0}}while(a=a.parentNode);return ht()}function Fu(t,e){if(t&&e)for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a]);return t}function js(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}var as;function Ho(t,e){return function(){if(!as){var a=arguments,c=this;a.length===1?t.call(c,a[0]):t.apply(c,a),as=setTimeout(function(){as=void 0},e)}}}function Nu(){clearTimeout(as),as=void 0}function Bo(t,e,a){t.scrollLeft+=e,t.scrollTop+=a}function mo(t){var e=window.Polymer,a=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):a?a(t).clone(!0)[0]:t.cloneNode(!0)}function So(t,e){z(t,"position","absolute"),z(t,"top",e.top),z(t,"left",e.left),z(t,"width",e.width),z(t,"height",e.height)}function Vs(t){z(t,"position",""),z(t,"top",""),z(t,"left",""),z(t,"width",""),z(t,"height","")}var Be="Sortable"+new Date().getTime();function Lu(){var t=[],e;return{captureAnimationState:function(){if(t=[],!!this.options.animation){var c=[].slice.call(this.el.children);c.forEach(function(s){if(!(z(s,"display")==="none"||s===q.ghost)){t.push({target:s,rect:xe(s)});var r=ft({},t[t.length-1].rect);if(s.thisAnimationDuration){var n=kt(s,!0);n&&(r.top-=n.f,r.left-=n.e)}s.fromRect=r}})}},addAnimationState:function(c){t.push(c)},removeAnimationState:function(c){t.splice(Mu(t,{target:c}),1)},animateAll:function(c){var s=this;if(!this.options.animation){clearTimeout(e),typeof c=="function"&&c();return}var r=!1,n=0;t.forEach(function(d){var i=0,l=d.target,m=l.fromRect,f=xe(l),h=l.prevFromRect,g=l.prevToRect,v=d.rect,y=kt(l,!0);y&&(f.top-=y.f,f.left-=y.e),l.toRect=f,l.thisAnimationDuration&&js(h,f)&&!js(m,f)&&(v.top-f.top)/(v.left-f.left)===(m.top-f.top)/(m.left-f.left)&&(i=ju(v,h,g,s.options)),js(f,m)||(l.prevFromRect=m,l.prevToRect=f,i||(i=s.options.animation),s.animate(l,v,f,i)),i&&(r=!0,n=Math.max(n,i),clearTimeout(l.animationResetTimer),l.animationResetTimer=setTimeout(function(){l.animationTime=0,l.prevFromRect=null,l.fromRect=null,l.prevToRect=null,l.thisAnimationDuration=null},i),l.thisAnimationDuration=i)}),clearTimeout(e),r?e=setTimeout(function(){typeof c=="function"&&c()},n):typeof c=="function"&&c(),t=[]},animate:function(c,s,r,n){if(n){z(c,"transition",""),z(c,"transform","");var d=kt(this.el),i=d&&d.a,l=d&&d.d,m=(s.left-r.left)/(i||1),f=(s.top-r.top)/(l||1);c.animatingX=!!m,c.animatingY=!!f,z(c,"transform","translate3d("+m+"px,"+f+"px,0)"),this.forRepaintDummy=Uu(c),z(c,"transition","transform "+n+"ms"+(this.options.easing?" "+this.options.easing:"")),z(c,"transform","translate3d(0,0,0)"),typeof c.animated=="number"&&clearTimeout(c.animated),c.animated=setTimeout(function(){z(c,"transition",""),z(c,"transform",""),c.animated=!1,c.animatingX=!1,c.animatingY=!1},n)}}}}function Uu(t){return t.offsetWidth}function ju(t,e,a,c){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-a.top,2)+Math.pow(e.left-a.left,2))*c.animation}var Ft=[],Hs={initializeByDefault:!0},fs={mount:function(e){for(var a in Hs)Hs.hasOwnProperty(a)&&!(a in e)&&(e[a]=Hs[a]);Ft.forEach(function(c){if(c.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),Ft.push(e)},pluginEvent:function(e,a,c){var s=this;this.eventCanceled=!1,c.cancel=function(){s.eventCanceled=!0};var r=e+"Global";Ft.forEach(function(n){a[n.pluginName]&&(a[n.pluginName][r]&&a[n.pluginName][r](ft({sortable:a},c)),a.options[n.pluginName]&&a[n.pluginName][e]&&a[n.pluginName][e](ft({sortable:a},c)))})},initializePlugins:function(e,a,c,s){Ft.forEach(function(d){var i=d.pluginName;if(!(!e.options[i]&&!d.initializeByDefault)){var l=new d(e,a,e.options);l.sortable=e,l.options=e.options,e[i]=l,nt(c,l.defaults)}});for(var r in e.options)if(e.options.hasOwnProperty(r)){var n=this.modifyOption(e,r,e.options[r]);typeof n<"u"&&(e.options[r]=n)}},getEventProperties:function(e,a){var c={};return Ft.forEach(function(s){typeof s.eventProperties=="function"&&nt(c,s.eventProperties.call(a[s.pluginName],e))}),c},modifyOption:function(e,a,c){var s;return Ft.forEach(function(r){e[r.pluginName]&&r.optionListeners&&typeof r.optionListeners[a]=="function"&&(s=r.optionListeners[a].call(e[r.pluginName],c))}),s}};function ts(t){var e=t.sortable,a=t.rootEl,c=t.name,s=t.targetEl,r=t.cloneEl,n=t.toEl,d=t.fromEl,i=t.oldIndex,l=t.newIndex,m=t.oldDraggableIndex,f=t.newDraggableIndex,h=t.originalEvent,g=t.putSortable,v=t.extraEventProperties;if(e=e||a&&a[Be],!!e){var y,_=e.options,S="on"+c.charAt(0).toUpperCase()+c.substr(1);window.CustomEvent&&!yt&&!hs?y=new CustomEvent(c,{bubbles:!0,cancelable:!0}):(y=document.createEvent("Event"),y.initEvent(c,!0,!0)),y.to=n||a,y.from=d||a,y.item=s||a,y.clone=r,y.oldIndex=i,y.newIndex=l,y.oldDraggableIndex=m,y.newDraggableIndex=f,y.originalEvent=h,y.pullMode=g?g.lastPutMode:void 0;var w=ft(ft({},v),fs.getEventProperties(c,e));for(var $ in w)y[$]=w[$];a&&a.dispatchEvent(y),_[S]&&_[S].call(e,y)}}var Vu=["evt"],Ye=function(e,a){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=c.evt,r=wu(c,Vu);fs.pluginEvent.bind(q)(e,a,ft({dragEl:N,parentEl:Te,ghostEl:ce,rootEl:Se,nextEl:It,lastDownEl:ws,cloneEl:Oe,cloneHidden:Dt,dragStarted:ss,putSortable:je,activeSortable:q.active,originalEvent:s,oldIndex:Vt,oldDraggableIndex:is,newIndex:Ze,newDraggableIndex:Ct,hideGhostForTarget:Yo,unhideGhostForTarget:Wo,cloneNowHidden:function(){Dt=!0},cloneNowShown:function(){Dt=!1},dispatchSortableEvent:function(d){Ke({sortable:a,name:d,originalEvent:s})}},r))};function Ke(t){ts(ft({putSortable:je,cloneEl:Oe,targetEl:N,rootEl:Se,oldIndex:Vt,oldDraggableIndex:is,newIndex:Ze,newDraggableIndex:Ct},t))}var N,Te,ce,Se,It,ws,Oe,Dt,Vt,Ze,is,Ct,ys,je,Ut=!1,Is=!1,ks=[],Tt,lt,Bs,Gs,xo,Eo,ss,Nt,ls,cs=!1,bs=!1,Ps,He,Ks=[],qs=!1,$s=[],Ms=typeof document<"u",_s=Uo,wo=hs||yt?"cssFloat":"float",Hu=Ms&&!$u&&!Uo&&"draggable"in document.createElement("div"),Go=function(){if(Ms){if(yt)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto",t.style.pointerEvents==="auto"}}(),Ko=function(e,a){var c=z(e),s=parseInt(c.width)-parseInt(c.paddingLeft)-parseInt(c.paddingRight)-parseInt(c.borderLeftWidth)-parseInt(c.borderRightWidth),r=Ht(e,0,a),n=Ht(e,1,a),d=r&&z(r),i=n&&z(n),l=d&&parseInt(d.marginLeft)+parseInt(d.marginRight)+xe(r).width,m=i&&parseInt(i.marginLeft)+parseInt(i.marginRight)+xe(n).width;if(c.display==="flex")return c.flexDirection==="column"||c.flexDirection==="column-reverse"?"vertical":"horizontal";if(c.display==="grid")return c.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(r&&d.float&&d.float!=="none"){var f=d.float==="left"?"left":"right";return n&&(i.clear==="both"||i.clear===f)?"vertical":"horizontal"}return r&&(d.display==="block"||d.display==="flex"||d.display==="table"||d.display==="grid"||l>=s&&c[wo]==="none"||n&&c[wo]==="none"&&l+m>s)?"vertical":"horizontal"},Bu=function(e,a,c){var s=c?e.left:e.top,r=c?e.right:e.bottom,n=c?e.width:e.height,d=c?a.left:a.top,i=c?a.right:a.bottom,l=c?a.width:a.height;return s===d||r===i||s+n/2===d+l/2},Gu=function(e,a){var c;return ks.some(function(s){var r=s[Be].options.emptyInsertThreshold;if(!(!r||uo(s))){var n=xe(s),d=e>=n.left-r&&e<=n.right+r,i=a>=n.top-r&&a<=n.bottom+r;if(d&&i)return c=s}}),c},zo=function(e){function a(r,n){return function(d,i,l,m){var f=d.options.group.name&&i.options.group.name&&d.options.group.name===i.options.group.name;if(r==null&&(n||f))return!0;if(r==null||r===!1)return!1;if(n&&r==="clone")return r;if(typeof r=="function")return a(r(d,i,l,m),n)(d,i,l,m);var h=(n?d:i).options.group.name;return r===!0||typeof r=="string"&&r===h||r.join&&r.indexOf(h)>-1}}var c={},s=e.group;(!s||Es(s)!="object")&&(s={name:s}),c.name=s.name,c.checkPull=a(s.pull,!0),c.checkPut=a(s.put),c.revertClone=s.revertClone,e.group=c},Yo=function(){!Go&&ce&&z(ce,"display","none")},Wo=function(){!Go&&ce&&z(ce,"display","")};Ms&&document.addEventListener("click",function(t){if(Is)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),Is=!1,!1},!0);var Ot=function(e){if(N){e=e.touches?e.touches[0]:e;var a=Gu(e.clientX,e.clientY);if(a){var c={};for(var s in e)e.hasOwnProperty(s)&&(c[s]=e[s]);c.target=c.rootEl=a,c.preventDefault=void 0,c.stopPropagation=void 0,a[Be]._onDragOver(c)}}},Ku=function(e){N&&N.parentNode[Be]._isOutsideThisEl(e.target)};function q(t,e){if(!(t&&t.nodeType&&t.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=nt({},e),t[Be]=this;var a={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Ko(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(n,d){n.setData("Text",d.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:q.supportPointer!==!1&&"PointerEvent"in window&&!rs,emptyInsertThreshold:5};fs.initializePlugins(this,t,a);for(var c in a)!(c in e)&&(e[c]=a[c]);zo(e);for(var s in this)s.charAt(0)==="_"&&typeof this[s]=="function"&&(this[s]=this[s].bind(this));this.nativeDraggable=e.forceFallback?!1:Hu,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?he(t,"pointerdown",this._onTapStart):(he(t,"mousedown",this._onTapStart),he(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(he(t,"dragover",this),he(t,"dragenter",this)),ks.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),nt(this,Lu())}q.prototype={constructor:q,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(Nt=null)},_getDirection:function(e,a){return typeof this.options.direction=="function"?this.options.direction.call(this,e,a,N):this.options.direction},_onTapStart:function(e){if(e.cancelable){var a=this,c=this.el,s=this.options,r=s.preventOnFilter,n=e.type,d=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,i=(d||e).target,l=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||i,m=s.filter;if(qu(c),!N&&!(/mousedown|pointerdown/.test(n)&&e.button!==0||s.disabled)&&!l.isContentEditable&&!(!this.nativeDraggable&&rs&&i&&i.tagName.toUpperCase()==="SELECT")&&(i=dt(i,s.draggable,c,!1),!(i&&i.animated)&&ws!==i)){if(Vt=Ie(i),is=Ie(i,s.draggable),typeof m=="function"){if(m.call(this,e,i,this)){Ke({sortable:a,rootEl:l,name:"filter",targetEl:i,toEl:c,fromEl:c}),Ye("filter",a,{evt:e}),r&&e.cancelable&&e.preventDefault();return}}else if(m&&(m=m.split(",").some(function(f){if(f=dt(l,f.trim(),c,!1),f)return Ke({sortable:a,rootEl:f,name:"filter",targetEl:i,fromEl:c,toEl:c}),Ye("filter",a,{evt:e}),!0}),m)){r&&e.cancelable&&e.preventDefault();return}s.handle&&!dt(l,s.handle,c,!1)||this._prepareDragStart(e,d,i)}}},_prepareDragStart:function(e,a,c){var s=this,r=s.el,n=s.options,d=r.ownerDocument,i;if(c&&!N&&c.parentNode===r){var l=xe(c);if(Se=r,N=c,Te=N.parentNode,It=N.nextSibling,ws=c,ys=n.group,q.dragged=N,Tt={target:N,clientX:(a||e).clientX,clientY:(a||e).clientY},xo=Tt.clientX-l.left,Eo=Tt.clientY-l.top,this._lastX=(a||e).clientX,this._lastY=(a||e).clientY,N.style["will-change"]="all",i=function(){if(Ye("delayEnded",s,{evt:e}),q.eventCanceled){s._onDrop();return}s._disableDelayedDragEvents(),!bo&&s.nativeDraggable&&(N.draggable=!0),s._triggerDragStart(e,a),Ke({sortable:s,name:"choose",originalEvent:e}),we(N,n.chosenClass,!0)},n.ignore.split(",").forEach(function(m){Vo(N,m.trim(),zs)}),he(d,"dragover",Ot),he(d,"mousemove",Ot),he(d,"touchmove",Ot),he(d,"mouseup",s._onDrop),he(d,"touchend",s._onDrop),he(d,"touchcancel",s._onDrop),bo&&this.nativeDraggable&&(this.options.touchStartThreshold=4,N.draggable=!0),Ye("delayStart",this,{evt:e}),n.delay&&(!n.delayOnTouchOnly||a)&&(!this.nativeDraggable||!(hs||yt))){if(q.eventCanceled){this._onDrop();return}he(d,"mouseup",s._disableDelayedDrag),he(d,"touchend",s._disableDelayedDrag),he(d,"touchcancel",s._disableDelayedDrag),he(d,"mousemove",s._delayedDragTouchMoveHandler),he(d,"touchmove",s._delayedDragTouchMoveHandler),n.supportPointer&&he(d,"pointermove",s._delayedDragTouchMoveHandler),s._dragStartTimer=setTimeout(i,n.delay)}else i()}},_delayedDragTouchMoveHandler:function(e){var a=e.touches?e.touches[0]:e;Math.max(Math.abs(a.clientX-this._lastX),Math.abs(a.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){N&&zs(N),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;ue(e,"mouseup",this._disableDelayedDrag),ue(e,"touchend",this._disableDelayedDrag),ue(e,"touchcancel",this._disableDelayedDrag),ue(e,"mousemove",this._delayedDragTouchMoveHandler),ue(e,"touchmove",this._delayedDragTouchMoveHandler),ue(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,a){a=a||e.pointerType=="touch"&&e,!this.nativeDraggable||a?this.options.supportPointer?he(document,"pointermove",this._onTouchMove):a?he(document,"touchmove",this._onTouchMove):he(document,"mousemove",this._onTouchMove):(he(N,"dragend",this),he(Se,"dragstart",this._onDragStart));try{document.selection?Rs(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,a){if(Ut=!1,Se&&N){Ye("dragStarted",this,{evt:a}),this.nativeDraggable&&he(document,"dragover",Ku);var c=this.options;!e&&we(N,c.dragClass,!1),we(N,c.ghostClass,!0),q.active=this,e&&this._appendGhost(),Ke({sortable:this,name:"start",originalEvent:a})}else this._nulling()},_emulateDragOver:function(){if(lt){this._lastX=lt.clientX,this._lastY=lt.clientY,Yo();for(var e=document.elementFromPoint(lt.clientX,lt.clientY),a=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(lt.clientX,lt.clientY),e!==a);)a=e;if(N.parentNode[Be]._isOutsideThisEl(e),a)do{if(a[Be]){var c=void 0;if(c=a[Be]._onDragOver({clientX:lt.clientX,clientY:lt.clientY,target:e,rootEl:a}),c&&!this.options.dragoverBubble)break}e=a}while(a=a.parentNode);Wo()}},_onTouchMove:function(e){if(Tt){var a=this.options,c=a.fallbackTolerance,s=a.fallbackOffset,r=e.touches?e.touches[0]:e,n=ce&&kt(ce,!0),d=ce&&n&&n.a,i=ce&&n&&n.d,l=_s&&He&&Do(He),m=(r.clientX-Tt.clientX+s.x)/(d||1)+(l?l[0]-Ks[0]:0)/(d||1),f=(r.clientY-Tt.clientY+s.y)/(i||1)+(l?l[1]-Ks[1]:0)/(i||1);if(!q.active&&!Ut){if(c&&Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))<c)return;this._onDragStart(e,!0)}if(ce){n?(n.e+=m-(Bs||0),n.f+=f-(Gs||0)):n={a:1,b:0,c:0,d:1,e:m,f};var h="matrix(".concat(n.a,",").concat(n.b,",").concat(n.c,",").concat(n.d,",").concat(n.e,",").concat(n.f,")");z(ce,"webkitTransform",h),z(ce,"mozTransform",h),z(ce,"msTransform",h),z(ce,"transform",h),Bs=m,Gs=f,lt=r}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!ce){var e=this.options.fallbackOnBody?document.body:Se,a=xe(N,!0,_s,!0,e),c=this.options;if(_s){for(He=e;z(He,"position")==="static"&&z(He,"transform")==="none"&&He!==document;)He=He.parentNode;He!==document.body&&He!==document.documentElement?(He===document&&(He=ht()),a.top+=He.scrollTop,a.left+=He.scrollLeft):He=ht(),Ks=Do(He)}ce=N.cloneNode(!0),we(ce,c.ghostClass,!1),we(ce,c.fallbackClass,!0),we(ce,c.dragClass,!0),z(ce,"transition",""),z(ce,"transform",""),z(ce,"box-sizing","border-box"),z(ce,"margin",0),z(ce,"top",a.top),z(ce,"left",a.left),z(ce,"width",a.width),z(ce,"height",a.height),z(ce,"opacity","0.8"),z(ce,"position",_s?"absolute":"fixed"),z(ce,"zIndex","100000"),z(ce,"pointerEvents","none"),q.ghost=ce,e.appendChild(ce),z(ce,"transform-origin",xo/parseInt(ce.style.width)*100+"% "+Eo/parseInt(ce.style.height)*100+"%")}},_onDragStart:function(e,a){var c=this,s=e.dataTransfer,r=c.options;if(Ye("dragStart",this,{evt:e}),q.eventCanceled){this._onDrop();return}Ye("setupClone",this),q.eventCanceled||(Oe=mo(N),Oe.draggable=!1,Oe.style["will-change"]="",this._hideClone(),we(Oe,this.options.chosenClass,!1),q.clone=Oe),c.cloneId=Rs(function(){Ye("clone",c),!q.eventCanceled&&(c.options.removeCloneOnHide||Se.insertBefore(Oe,N),c._hideClone(),Ke({sortable:c,name:"clone"}))}),!a&&we(N,r.dragClass,!0),a?(Is=!0,c._loopId=setInterval(c._emulateDragOver,50)):(ue(document,"mouseup",c._onDrop),ue(document,"touchend",c._onDrop),ue(document,"touchcancel",c._onDrop),s&&(s.effectAllowed="move",r.setData&&r.setData.call(c,s,N)),he(document,"drop",c),z(N,"transform","translateZ(0)")),Ut=!0,c._dragStartId=Rs(c._dragStarted.bind(c,a,e)),he(document,"selectstart",c),ss=!0,rs&&z(document.body,"user-select","none")},_onDragOver:function(e){var a=this.el,c=e.target,s,r,n,d=this.options,i=d.group,l=q.active,m=ys===i,f=d.sort,h=je||l,g,v=this,y=!1;if(qs)return;function _(ye,Ce){Ye(ye,v,ft({evt:e,isOwner:m,axis:g?"vertical":"horizontal",revert:n,dragRect:s,targetRect:r,canSort:f,fromSortable:h,target:c,completed:w,onMove:function(Pe,Re){return Cs(Se,a,N,s,Pe,xe(Pe),e,Re)},changed:$},Ce))}function S(){_("dragOverAnimationCapture"),v.captureAnimationState(),v!==h&&h.captureAnimationState()}function w(ye){return _("dragOverCompleted",{insertion:ye}),ye&&(m?l._hideClone():l._showClone(v),v!==h&&(we(N,je?je.options.ghostClass:l.options.ghostClass,!1),we(N,d.ghostClass,!0)),je!==v&&v!==q.active?je=v:v===q.active&&je&&(je=null),h===v&&(v._ignoreWhileAnimating=c),v.animateAll(function(){_("dragOverAnimationComplete"),v._ignoreWhileAnimating=null}),v!==h&&(h.animateAll(),h._ignoreWhileAnimating=null)),(c===N&&!N.animated||c===a&&!c.animated)&&(Nt=null),!d.dragoverBubble&&!e.rootEl&&c!==document&&(N.parentNode[Be]._isOutsideThisEl(e.target),!ye&&Ot(e)),!d.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),y=!0}function $(){Ze=Ie(N),Ct=Ie(N,d.draggable),Ke({sortable:v,name:"change",toEl:a,newIndex:Ze,newDraggableIndex:Ct,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),c=dt(c,d.draggable,a,!0),_("dragOver"),q.eventCanceled)return y;if(N.contains(e.target)||c.animated&&c.animatingX&&c.animatingY||v._ignoreWhileAnimating===c)return w(!1);if(Is=!1,l&&!d.disabled&&(m?f||(n=Te!==Se):je===this||(this.lastPutMode=ys.checkPull(this,l,N,e))&&i.checkPut(this,l,N,e))){if(g=this._getDirection(e,c)==="vertical",s=xe(N),_("dragOverValid"),q.eventCanceled)return y;if(n)return Te=Se,S(),this._hideClone(),_("revert"),q.eventCanceled||(It?Se.insertBefore(N,It):Se.appendChild(N)),w(!0);var C=uo(a,d.draggable);if(!C||Xu(e,g,this)&&!C.animated){if(C===N)return w(!1);if(C&&a===e.target&&(c=C),c&&(r=xe(c)),Cs(Se,a,N,s,c,r,e,!!c)!==!1)return S(),a.appendChild(N),Te=a,$(),w(!0)}else if(C&&Wu(e,g,this)){var I=Ht(a,0,d,!0);if(I===N)return w(!1);if(c=I,r=xe(c),Cs(Se,a,N,s,c,r,e,!1)!==!1)return S(),a.insertBefore(N,I),Te=a,$(),w(!0)}else if(c.parentNode===a){r=xe(c);var O=0,H,G=N.parentNode!==a,k=!Bu(N.animated&&N.toRect||s,c.animated&&c.toRect||r,g),L=g?"top":"left",B=Co(c,"top","top")||Co(N,"top","top"),re=B?B.scrollTop:void 0;Nt!==c&&(H=r[L],cs=!1,bs=!k&&d.invertSwap||G),O=Ju(e,c,r,g,k?1:d.swapThreshold,d.invertedSwapThreshold==null?d.swapThreshold:d.invertedSwapThreshold,bs,Nt===c);var F;if(O!==0){var U=Ie(N);do U-=O,F=Te.children[U];while(F&&(z(F,"display")==="none"||F===ce))}if(O===0||F===c)return w(!1);Nt=c,ls=O;var oe=c.nextElementSibling,j=!1;j=O===1;var X=Cs(Se,a,N,s,c,r,e,j);if(X!==!1)return(X===1||X===-1)&&(j=X===1),qs=!0,setTimeout(Yu,30),S(),j&&!oe?a.appendChild(N):c.parentNode.insertBefore(N,j?oe:c),B&&Bo(B,0,re-B.scrollTop),Te=N.parentNode,H!==void 0&&!bs&&(Ps=Math.abs(H-xe(c)[L])),$(),w(!0)}if(a.contains(N))return w(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){ue(document,"mousemove",this._onTouchMove),ue(document,"touchmove",this._onTouchMove),ue(document,"pointermove",this._onTouchMove),ue(document,"dragover",Ot),ue(document,"mousemove",Ot),ue(document,"touchmove",Ot)},_offUpEvents:function(){var e=this.el.ownerDocument;ue(e,"mouseup",this._onDrop),ue(e,"touchend",this._onDrop),ue(e,"pointerup",this._onDrop),ue(e,"touchcancel",this._onDrop),ue(document,"selectstart",this)},_onDrop:function(e){var a=this.el,c=this.options;if(Ze=Ie(N),Ct=Ie(N,c.draggable),Ye("drop",this,{evt:e}),Te=N&&N.parentNode,Ze=Ie(N),Ct=Ie(N,c.draggable),q.eventCanceled){this._nulling();return}Ut=!1,bs=!1,cs=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),eo(this.cloneId),eo(this._dragStartId),this.nativeDraggable&&(ue(document,"drop",this),ue(a,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),rs&&z(document.body,"user-select",""),z(N,"transform",""),e&&(ss&&(e.cancelable&&e.preventDefault(),!c.dropBubble&&e.stopPropagation()),ce&&ce.parentNode&&ce.parentNode.removeChild(ce),(Se===Te||je&&je.lastPutMode!=="clone")&&Oe&&Oe.parentNode&&Oe.parentNode.removeChild(Oe),N&&(this.nativeDraggable&&ue(N,"dragend",this),zs(N),N.style["will-change"]="",ss&&!Ut&&we(N,je?je.options.ghostClass:this.options.ghostClass,!1),we(N,this.options.chosenClass,!1),Ke({sortable:this,name:"unchoose",toEl:Te,newIndex:null,newDraggableIndex:null,originalEvent:e}),Se!==Te?(Ze>=0&&(Ke({rootEl:Te,name:"add",toEl:Te,fromEl:Se,originalEvent:e}),Ke({sortable:this,name:"remove",toEl:Te,originalEvent:e}),Ke({rootEl:Te,name:"sort",toEl:Te,fromEl:Se,originalEvent:e}),Ke({sortable:this,name:"sort",toEl:Te,originalEvent:e})),je&&je.save()):Ze!==Vt&&Ze>=0&&(Ke({sortable:this,name:"update",toEl:Te,originalEvent:e}),Ke({sortable:this,name:"sort",toEl:Te,originalEvent:e})),q.active&&((Ze==null||Ze===-1)&&(Ze=Vt,Ct=is),Ke({sortable:this,name:"end",toEl:Te,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){Ye("nulling",this),Se=N=Te=ce=It=Oe=ws=Dt=Tt=lt=ss=Ze=Ct=Vt=is=Nt=ls=je=ys=q.dragged=q.ghost=q.clone=q.active=null,$s.forEach(function(e){e.checked=!0}),$s.length=Bs=Gs=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":N&&(this._onDragOver(e),zu(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],a,c=this.el.children,s=0,r=c.length,n=this.options;s<r;s++)a=c[s],dt(a,n.draggable,this.el,!1)&&e.push(a.getAttribute(n.dataIdAttr)||Zu(a));return e},sort:function(e,a){var c={},s=this.el;this.toArray().forEach(function(r,n){var d=s.children[n];dt(d,this.options.draggable,s,!1)&&(c[r]=d)},this),a&&this.captureAnimationState(),e.forEach(function(r){c[r]&&(s.removeChild(c[r]),s.appendChild(c[r]))}),a&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,a){return dt(e,a||this.options.draggable,this.el,!1)},option:function(e,a){var c=this.options;if(a===void 0)return c[e];var s=fs.modifyOption(this,e,a);typeof s<"u"?c[e]=s:c[e]=a,e==="group"&&zo(c)},destroy:function(){Ye("destroy",this);var e=this.el;e[Be]=null,ue(e,"mousedown",this._onTapStart),ue(e,"touchstart",this._onTapStart),ue(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(ue(e,"dragover",this),ue(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(a){a.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),ks.splice(ks.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Dt){if(Ye("hideClone",this),q.eventCanceled)return;z(Oe,"display","none"),this.options.removeCloneOnHide&&Oe.parentNode&&Oe.parentNode.removeChild(Oe),Dt=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Dt){if(Ye("showClone",this),q.eventCanceled)return;N.parentNode==Se&&!this.options.group.revertClone?Se.insertBefore(Oe,N):It?Se.insertBefore(Oe,It):Se.appendChild(Oe),this.options.group.revertClone&&this.animate(N,Oe),z(Oe,"display",""),Dt=!1}}};function zu(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function Cs(t,e,a,c,s,r,n,d){var i,l=t[Be],m=l.options.onMove,f;return window.CustomEvent&&!yt&&!hs?i=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(i=document.createEvent("Event"),i.initEvent("move",!0,!0)),i.to=e,i.from=t,i.dragged=a,i.draggedRect=c,i.related=s||e,i.relatedRect=r||xe(e),i.willInsertAfter=d,i.originalEvent=n,t.dispatchEvent(i),m&&(f=m.call(l,i,n)),f}function zs(t){t.draggable=!1}function Yu(){qs=!1}function Wu(t,e,a){var c=xe(Ht(a.el,0,a.options,!0)),s=10;return e?t.clientX<c.left-s||t.clientY<c.top&&t.clientX<c.right:t.clientY<c.top-s||t.clientY<c.bottom&&t.clientX<c.left}function Xu(t,e,a){var c=xe(uo(a.el,a.options.draggable)),s=10;return e?t.clientX>c.right+s||t.clientX<=c.right&&t.clientY>c.bottom&&t.clientX>=c.left:t.clientX>c.right&&t.clientY>c.top||t.clientX<=c.right&&t.clientY>c.bottom+s}function Ju(t,e,a,c,s,r,n,d){var i=c?t.clientY:t.clientX,l=c?a.height:a.width,m=c?a.top:a.left,f=c?a.bottom:a.right,h=!1;if(!n){if(d&&Ps<l*s){if(!cs&&(ls===1?i>m+l*r/2:i<f-l*r/2)&&(cs=!0),cs)h=!0;else if(ls===1?i<m+Ps:i>f-Ps)return-ls}else if(i>m+l*(1-s)/2&&i<f-l*(1-s)/2)return Qu(e)}return h=h||n,h&&(i<m+l*r/2||i>f-l*r/2)?i>m+l/2?1:-1:0}function Qu(t){return Ie(N)<Ie(t)?1:-1}function Zu(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,a=e.length,c=0;a--;)c+=e.charCodeAt(a);return c.toString(36)}function qu(t){$s.length=0;for(var e=t.getElementsByTagName("input"),a=e.length;a--;){var c=e[a];c.checked&&$s.push(c)}}function Rs(t){return setTimeout(t,0)}function eo(t){return clearTimeout(t)}Ms&&he(document,"touchmove",function(t){(q.active||Ut)&&t.cancelable&&t.preventDefault()});q.utils={on:he,off:ue,css:z,find:Vo,is:function(e,a){return!!dt(e,a,e,!1)},extend:Fu,throttle:Ho,closest:dt,toggleClass:we,clone:mo,index:Ie,nextTick:Rs,cancelNextTick:eo,detectDirection:Ko,getChild:Ht};q.get=function(t){return t[Be]};q.mount=function(){for(var t=arguments.length,e=new Array(t),a=0;a<t;a++)e[a]=arguments[a];e[0].constructor===Array&&(e=e[0]),e.forEach(function(c){if(!c.prototype||!c.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(c));c.utils&&(q.utils=ft(ft({},q.utils),c.utils)),fs.mount(c)})};q.create=function(t,e){return new q(t,e)};q.version=ku;var Ae=[],os,to,so=!1,Ys,Ws,As,ns;function em(){function t(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return t.prototype={dragStarted:function(a){var c=a.originalEvent;this.sortable.nativeDraggable?he(document,"dragover",this._handleAutoScroll):this.options.supportPointer?he(document,"pointermove",this._handleFallbackAutoScroll):c.touches?he(document,"touchmove",this._handleFallbackAutoScroll):he(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(a){var c=a.originalEvent;!this.options.dragOverBubble&&!c.rootEl&&this._handleAutoScroll(c)},drop:function(){this.sortable.nativeDraggable?ue(document,"dragover",this._handleAutoScroll):(ue(document,"pointermove",this._handleFallbackAutoScroll),ue(document,"touchmove",this._handleFallbackAutoScroll),ue(document,"mousemove",this._handleFallbackAutoScroll)),Po(),Ts(),Nu()},nulling:function(){As=to=os=so=ns=Ys=Ws=null,Ae.length=0},_handleFallbackAutoScroll:function(a){this._handleAutoScroll(a,!0)},_handleAutoScroll:function(a,c){var s=this,r=(a.touches?a.touches[0]:a).clientX,n=(a.touches?a.touches[0]:a).clientY,d=document.elementFromPoint(r,n);if(As=a,c||this.options.forceAutoScrollFallback||hs||yt||rs){Xs(a,this.options,d,c);var i=St(d,!0);so&&(!ns||r!==Ys||n!==Ws)&&(ns&&Po(),ns=setInterval(function(){var l=St(document.elementFromPoint(r,n),!0);l!==i&&(i=l,Ts()),Xs(a,s.options,l,c)},10),Ys=r,Ws=n)}else{if(!this.options.bubbleScroll||St(d,!0)===ht()){Ts();return}Xs(a,this.options,St(d,!1),!1)}}},nt(t,{pluginName:"scroll",initializeByDefault:!0})}function Ts(){Ae.forEach(function(t){clearInterval(t.pid)}),Ae=[]}function Po(){clearInterval(ns)}var Xs=Ho(function(t,e,a,c){if(e.scroll){var s=(t.touches?t.touches[0]:t).clientX,r=(t.touches?t.touches[0]:t).clientY,n=e.scrollSensitivity,d=e.scrollSpeed,i=ht(),l=!1,m;to!==a&&(to=a,Ts(),os=e.scroll,m=e.scrollFn,os===!0&&(os=St(a,!0)));var f=0,h=os;do{var g=h,v=xe(g),y=v.top,_=v.bottom,S=v.left,w=v.right,$=v.width,C=v.height,I=void 0,O=void 0,H=g.scrollWidth,G=g.scrollHeight,k=z(g),L=g.scrollLeft,B=g.scrollTop;g===i?(I=$<H&&(k.overflowX==="auto"||k.overflowX==="scroll"||k.overflowX==="visible"),O=C<G&&(k.overflowY==="auto"||k.overflowY==="scroll"||k.overflowY==="visible")):(I=$<H&&(k.overflowX==="auto"||k.overflowX==="scroll"),O=C<G&&(k.overflowY==="auto"||k.overflowY==="scroll"));var re=I&&(Math.abs(w-s)<=n&&L+$<H)-(Math.abs(S-s)<=n&&!!L),F=O&&(Math.abs(_-r)<=n&&B+C<G)-(Math.abs(y-r)<=n&&!!B);if(!Ae[f])for(var U=0;U<=f;U++)Ae[U]||(Ae[U]={});(Ae[f].vx!=re||Ae[f].vy!=F||Ae[f].el!==g)&&(Ae[f].el=g,Ae[f].vx=re,Ae[f].vy=F,clearInterval(Ae[f].pid),(re!=0||F!=0)&&(l=!0,Ae[f].pid=setInterval((function(){c&&this.layer===0&&q.active._onTouchMove(As);var oe=Ae[this.layer].vy?Ae[this.layer].vy*d:0,j=Ae[this.layer].vx?Ae[this.layer].vx*d:0;typeof m=="function"&&m.call(q.dragged.parentNode[Be],j,oe,t,As,Ae[this.layer].el)!=="continue"||Bo(Ae[this.layer].el,j,oe)}).bind({layer:f}),24))),f++}while(e.bubbleScroll&&h!==i&&(h=St(h,!1)));so=l}},30),Xo=function(e){var a=e.originalEvent,c=e.putSortable,s=e.dragEl,r=e.activeSortable,n=e.dispatchSortableEvent,d=e.hideGhostForTarget,i=e.unhideGhostForTarget;if(a){var l=c||r;d();var m=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:a,f=document.elementFromPoint(m.clientX,m.clientY);i(),l&&!l.el.contains(f)&&(n("spill"),this.onSpill({dragEl:s,putSortable:c}))}};function ho(){}ho.prototype={startIndex:null,dragStart:function(e){var a=e.oldDraggableIndex;this.startIndex=a},onSpill:function(e){var a=e.dragEl,c=e.putSortable;this.sortable.captureAnimationState(),c&&c.captureAnimationState();var s=Ht(this.sortable.el,this.startIndex,this.options);s?this.sortable.el.insertBefore(a,s):this.sortable.el.appendChild(a),this.sortable.animateAll(),c&&c.animateAll()},drop:Xo};nt(ho,{pluginName:"revertOnSpill"});function fo(){}fo.prototype={onSpill:function(e){var a=e.dragEl,c=e.putSortable,s=c||this.sortable;s.captureAnimationState(),a.parentNode&&a.parentNode.removeChild(a),s.animateAll()},drop:Xo};nt(fo,{pluginName:"removeOnSpill"});var tt;function tm(){function t(){this.defaults={swapClass:"sortable-swap-highlight"}}return t.prototype={dragStart:function(a){var c=a.dragEl;tt=c},dragOverValid:function(a){var c=a.completed,s=a.target,r=a.onMove,n=a.activeSortable,d=a.changed,i=a.cancel;if(n.options.swap){var l=this.sortable.el,m=this.options;if(s&&s!==l){var f=tt;r(s)!==!1?(we(s,m.swapClass,!0),tt=s):tt=null,f&&f!==tt&&we(f,m.swapClass,!1)}d(),c(!0),i()}},drop:function(a){var c=a.activeSortable,s=a.putSortable,r=a.dragEl,n=s||this.sortable,d=this.options;tt&&we(tt,d.swapClass,!1),tt&&(d.swap||s&&s.options.swap)&&r!==tt&&(n.captureAnimationState(),n!==c&&c.captureAnimationState(),sm(r,tt),n.animateAll(),n!==c&&c.animateAll())},nulling:function(){tt=null}},nt(t,{pluginName:"swap",eventProperties:function(){return{swapItem:tt}}})}function sm(t,e){var a=t.parentNode,c=e.parentNode,s,r;!a||!c||a.isEqualNode(e)||c.isEqualNode(t)||(s=Ie(t),r=Ie(e),a.isEqualNode(c)&&s<r&&r++,a.insertBefore(e,a.children[s]),c.insertBefore(t,c.children[r]))}var ae=[],Qe=[],Qt,ct,Zt=!1,We=!1,Lt=!1,_e,qt,Ds;function om(){function t(e){for(var a in this)a.charAt(0)==="_"&&typeof this[a]=="function"&&(this[a]=this[a].bind(this));e.options.supportPointer?he(document,"pointerup",this._deselectMultiDrag):(he(document,"mouseup",this._deselectMultiDrag),he(document,"touchend",this._deselectMultiDrag)),he(document,"keydown",this._checkKeyDown),he(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(s,r){var n="";ae.length&&ct===e?ae.forEach(function(d,i){n+=(i?", ":"")+d.textContent}):n=r.textContent,s.setData("Text",n)}}}return t.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(a){var c=a.dragEl;_e=c},delayEnded:function(){this.isMultiDrag=~ae.indexOf(_e)},setupClone:function(a){var c=a.sortable,s=a.cancel;if(this.isMultiDrag){for(var r=0;r<ae.length;r++)Qe.push(mo(ae[r])),Qe[r].sortableIndex=ae[r].sortableIndex,Qe[r].draggable=!1,Qe[r].style["will-change"]="",we(Qe[r],this.options.selectedClass,!1),ae[r]===_e&&we(Qe[r],this.options.chosenClass,!1);c._hideClone(),s()}},clone:function(a){var c=a.sortable,s=a.rootEl,r=a.dispatchSortableEvent,n=a.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||ae.length&&ct===c&&(Ro(!0,s),r("clone"),n()))},showClone:function(a){var c=a.cloneNowShown,s=a.rootEl,r=a.cancel;this.isMultiDrag&&(Ro(!1,s),Qe.forEach(function(n){z(n,"display","")}),c(),Ds=!1,r())},hideClone:function(a){var c=this;a.sortable;var s=a.cloneNowHidden,r=a.cancel;this.isMultiDrag&&(Qe.forEach(function(n){z(n,"display","none"),c.options.removeCloneOnHide&&n.parentNode&&n.parentNode.removeChild(n)}),s(),Ds=!0,r())},dragStartGlobal:function(a){a.sortable,!this.isMultiDrag&&ct&&ct.multiDrag._deselectMultiDrag(),ae.forEach(function(c){c.sortableIndex=Ie(c)}),ae=ae.sort(function(c,s){return c.sortableIndex-s.sortableIndex}),Lt=!0},dragStarted:function(a){var c=this,s=a.sortable;if(this.isMultiDrag){if(this.options.sort&&(s.captureAnimationState(),this.options.animation)){ae.forEach(function(n){n!==_e&&z(n,"position","absolute")});var r=xe(_e,!1,!0,!0);ae.forEach(function(n){n!==_e&&So(n,r)}),We=!0,Zt=!0}s.animateAll(function(){We=!1,Zt=!1,c.options.animation&&ae.forEach(function(n){Vs(n)}),c.options.sort&&Ss()})}},dragOver:function(a){var c=a.target,s=a.completed,r=a.cancel;We&&~ae.indexOf(c)&&(s(!1),r())},revert:function(a){var c=a.fromSortable,s=a.rootEl,r=a.sortable,n=a.dragRect;ae.length>1&&(ae.forEach(function(d){r.addAnimationState({target:d,rect:We?xe(d):n}),Vs(d),d.fromRect=n,c.removeAnimationState(d)}),We=!1,nm(!this.options.removeCloneOnHide,s))},dragOverCompleted:function(a){var c=a.sortable,s=a.isOwner,r=a.insertion,n=a.activeSortable,d=a.parentEl,i=a.putSortable,l=this.options;if(r){if(s&&n._hideClone(),Zt=!1,l.animation&&ae.length>1&&(We||!s&&!n.options.sort&&!i)){var m=xe(_e,!1,!0,!0);ae.forEach(function(h){h!==_e&&(So(h,m),d.appendChild(h))}),We=!0}if(!s)if(We||Ss(),ae.length>1){var f=Ds;n._showClone(c),n.options.animation&&!Ds&&f&&Qe.forEach(function(h){n.addAnimationState({target:h,rect:qt}),h.fromRect=qt,h.thisAnimationDuration=null})}else n._showClone(c)}},dragOverAnimationCapture:function(a){var c=a.dragRect,s=a.isOwner,r=a.activeSortable;if(ae.forEach(function(d){d.thisAnimationDuration=null}),r.options.animation&&!s&&r.multiDrag.isMultiDrag){qt=nt({},c);var n=kt(_e,!0);qt.top-=n.f,qt.left-=n.e}},dragOverAnimationComplete:function(){We&&(We=!1,Ss())},drop:function(a){var c=a.originalEvent,s=a.rootEl,r=a.parentEl,n=a.sortable,d=a.dispatchSortableEvent,i=a.oldIndex,l=a.putSortable,m=l||this.sortable;if(c){var f=this.options,h=r.children;if(!Lt)if(f.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),we(_e,f.selectedClass,!~ae.indexOf(_e)),~ae.indexOf(_e))ae.splice(ae.indexOf(_e),1),Qt=null,ts({sortable:n,rootEl:s,name:"deselect",targetEl:_e,originalEvt:c});else{if(ae.push(_e),ts({sortable:n,rootEl:s,name:"select",targetEl:_e,originalEvt:c}),c.shiftKey&&Qt&&n.el.contains(Qt)){var g=Ie(Qt),v=Ie(_e);if(~g&&~v&&g!==v){var y,_;for(v>g?(_=g,y=v):(_=v,y=g+1);_<y;_++)~ae.indexOf(h[_])||(we(h[_],f.selectedClass,!0),ae.push(h[_]),ts({sortable:n,rootEl:s,name:"select",targetEl:h[_],originalEvt:c}))}}else Qt=_e;ct=m}if(Lt&&this.isMultiDrag){if(We=!1,(r[Be].options.sort||r!==s)&&ae.length>1){var S=xe(_e),w=Ie(_e,":not(."+this.options.selectedClass+")");if(!Zt&&f.animation&&(_e.thisAnimationDuration=null),m.captureAnimationState(),!Zt&&(f.animation&&(_e.fromRect=S,ae.forEach(function(C){if(C.thisAnimationDuration=null,C!==_e){var I=We?xe(C):S;C.fromRect=I,m.addAnimationState({target:C,rect:I})}})),Ss(),ae.forEach(function(C){h[w]?r.insertBefore(C,h[w]):r.appendChild(C),w++}),i===Ie(_e))){var $=!1;ae.forEach(function(C){if(C.sortableIndex!==Ie(C)){$=!0;return}}),$&&d("update")}ae.forEach(function(C){Vs(C)}),m.animateAll()}ct=m}(s===r||l&&l.lastPutMode!=="clone")&&Qe.forEach(function(C){C.parentNode&&C.parentNode.removeChild(C)})}},nullingGlobal:function(){this.isMultiDrag=Lt=!1,Qe.length=0},destroyGlobal:function(){this._deselectMultiDrag(),ue(document,"pointerup",this._deselectMultiDrag),ue(document,"mouseup",this._deselectMultiDrag),ue(document,"touchend",this._deselectMultiDrag),ue(document,"keydown",this._checkKeyDown),ue(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(a){if(!(typeof Lt<"u"&&Lt)&&ct===this.sortable&&!(a&&dt(a.target,this.options.draggable,this.sortable.el,!1))&&!(a&&a.button!==0))for(;ae.length;){var c=ae[0];we(c,this.options.selectedClass,!1),ae.shift(),ts({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:c,originalEvt:a})}},_checkKeyDown:function(a){a.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(a){a.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},nt(t,{pluginName:"multiDrag",utils:{select:function(a){var c=a.parentNode[Be];!c||!c.options.multiDrag||~ae.indexOf(a)||(ct&&ct!==c&&(ct.multiDrag._deselectMultiDrag(),ct=c),we(a,c.options.selectedClass,!0),ae.push(a))},deselect:function(a){var c=a.parentNode[Be],s=ae.indexOf(a);!c||!c.options.multiDrag||!~s||(we(a,c.options.selectedClass,!1),ae.splice(s,1))}},eventProperties:function(){var a=this,c=[],s=[];return ae.forEach(function(r){c.push({multiDragElement:r,index:r.sortableIndex});var n;We&&r!==_e?n=-1:We?n=Ie(r,":not(."+a.options.selectedClass+")"):n=Ie(r),s.push({multiDragElement:r,index:n})}),{items:Pu(ae),clones:[].concat(Qe),oldIndicies:c,newIndicies:s}},optionListeners:{multiDragKey:function(a){return a=a.toLowerCase(),a==="ctrl"?a="Control":a.length>1&&(a=a.charAt(0).toUpperCase()+a.substr(1)),a}}})}function nm(t,e){ae.forEach(function(a,c){var s=e.children[a.sortableIndex+(t?Number(c):0)];s?e.insertBefore(a,s):e.appendChild(a)})}function Ro(t,e){Qe.forEach(function(a,c){var s=e.children[a.sortableIndex+(t?Number(c):0)];s?e.insertBefore(a,s):e.appendChild(a)})}function Ss(){ae.forEach(function(t){t!==_e&&t.parentNode&&t.parentNode.removeChild(t)})}q.mount(new em);q.mount(fo,ho);const rm=Object.freeze(Object.defineProperty({__proto__:null,MultiDrag:om,Sortable:q,Swap:tm,default:q},Symbol.toStringTag,{value:"Module"})),am=$o(rm);(function(t,e){(function(c,s){t.exports=s(Su,am)})(typeof self<"u"?self:fa,function(a,c){return function(s){var r={};function n(d){if(r[d])return r[d].exports;var i=r[d]={i:d,l:!1,exports:{}};return s[d].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=s,n.c=r,n.d=function(d,i,l){n.o(d,i)||Object.defineProperty(d,i,{enumerable:!0,get:l})},n.r=function(d){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(d,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(d,"__esModule",{value:!0})},n.t=function(d,i){if(i&1&&(d=n(d)),i&8||i&4&&typeof d=="object"&&d&&d.__esModule)return d;var l=Object.create(null);if(n.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:d}),i&2&&typeof d!="string")for(var m in d)n.d(l,m,(function(f){return d[f]}).bind(null,m));return l},n.n=function(d){var i=d&&d.__esModule?function(){return d.default}:function(){return d};return n.d(i,"a",i),i},n.o=function(d,i){return Object.prototype.hasOwnProperty.call(d,i)},n.p="",n(n.s="fb15")}({"00ee":function(s,r,n){var d=n("b622"),i=d("toStringTag"),l={};l[i]="z",s.exports=String(l)==="[object z]"},"0366":function(s,r,n){var d=n("1c0b");s.exports=function(i,l,m){if(d(i),l===void 0)return i;switch(m){case 0:return function(){return i.call(l)};case 1:return function(f){return i.call(l,f)};case 2:return function(f,h){return i.call(l,f,h)};case 3:return function(f,h,g){return i.call(l,f,h,g)}}return function(){return i.apply(l,arguments)}}},"057f":function(s,r,n){var d=n("fc6a"),i=n("241c").f,l={}.toString,m=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],f=function(h){try{return i(h)}catch{return m.slice()}};s.exports.f=function(g){return m&&l.call(g)=="[object Window]"?f(g):i(d(g))}},"06cf":function(s,r,n){var d=n("83ab"),i=n("d1e7"),l=n("5c6c"),m=n("fc6a"),f=n("c04e"),h=n("5135"),g=n("0cfb"),v=Object.getOwnPropertyDescriptor;r.f=d?v:function(_,S){if(_=m(_),S=f(S,!0),g)try{return v(_,S)}catch{}if(h(_,S))return l(!i.f.call(_,S),_[S])}},"0cfb":function(s,r,n){var d=n("83ab"),i=n("d039"),l=n("cc12");s.exports=!d&&!i(function(){return Object.defineProperty(l("div"),"a",{get:function(){return 7}}).a!=7})},"13d5":function(s,r,n){var d=n("23e7"),i=n("d58f").left,l=n("a640"),m=n("ae40"),f=l("reduce"),h=m("reduce",{1:0});d({target:"Array",proto:!0,forced:!f||!h},{reduce:function(v){return i(this,v,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"14c3":function(s,r,n){var d=n("c6b6"),i=n("9263");s.exports=function(l,m){var f=l.exec;if(typeof f=="function"){var h=f.call(l,m);if(typeof h!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return h}if(d(l)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return i.call(l,m)}},"159b":function(s,r,n){var d=n("da84"),i=n("fdbc"),l=n("17c2"),m=n("9112");for(var f in i){var h=d[f],g=h&&h.prototype;if(g&&g.forEach!==l)try{m(g,"forEach",l)}catch{g.forEach=l}}},"17c2":function(s,r,n){var d=n("b727").forEach,i=n("a640"),l=n("ae40"),m=i("forEach"),f=l("forEach");s.exports=!m||!f?function(g){return d(this,g,arguments.length>1?arguments[1]:void 0)}:[].forEach},"1be4":function(s,r,n){var d=n("d066");s.exports=d("document","documentElement")},"1c0b":function(s,r){s.exports=function(n){if(typeof n!="function")throw TypeError(String(n)+" is not a function");return n}},"1c7e":function(s,r,n){var d=n("b622"),i=d("iterator"),l=!1;try{var m=0,f={next:function(){return{done:!!m++}},return:function(){l=!0}};f[i]=function(){return this},Array.from(f,function(){throw 2})}catch{}s.exports=function(h,g){if(!g&&!l)return!1;var v=!1;try{var y={};y[i]=function(){return{next:function(){return{done:v=!0}}}},h(y)}catch{}return v}},"1d80":function(s,r){s.exports=function(n){if(n==null)throw TypeError("Can't call method on "+n);return n}},"1dde":function(s,r,n){var d=n("d039"),i=n("b622"),l=n("2d00"),m=i("species");s.exports=function(f){return l>=51||!d(function(){var h=[],g=h.constructor={};return g[m]=function(){return{foo:1}},h[f](Boolean).foo!==1})}},"23cb":function(s,r,n){var d=n("a691"),i=Math.max,l=Math.min;s.exports=function(m,f){var h=d(m);return h<0?i(h+f,0):l(h,f)}},"23e7":function(s,r,n){var d=n("da84"),i=n("06cf").f,l=n("9112"),m=n("6eeb"),f=n("ce4e"),h=n("e893"),g=n("94ca");s.exports=function(v,y){var _=v.target,S=v.global,w=v.stat,$,C,I,O,H,G;if(S?C=d:w?C=d[_]||f(_,{}):C=(d[_]||{}).prototype,C)for(I in y){if(H=y[I],v.noTargetGet?(G=i(C,I),O=G&&G.value):O=C[I],$=g(S?I:_+(w?".":"#")+I,v.forced),!$&&O!==void 0){if(typeof H==typeof O)continue;h(H,O)}(v.sham||O&&O.sham)&&l(H,"sham",!0),m(C,I,H,v)}}},"241c":function(s,r,n){var d=n("ca84"),i=n("7839"),l=i.concat("length","prototype");r.f=Object.getOwnPropertyNames||function(f){return d(f,l)}},"25f0":function(s,r,n){var d=n("6eeb"),i=n("825a"),l=n("d039"),m=n("ad6d"),f="toString",h=RegExp.prototype,g=h[f],v=l(function(){return g.call({source:"a",flags:"b"})!="/a/b"}),y=g.name!=f;(v||y)&&d(RegExp.prototype,f,function(){var S=i(this),w=String(S.source),$=S.flags,C=String($===void 0&&S instanceof RegExp&&!("flags"in h)?m.call(S):$);return"/"+w+"/"+C},{unsafe:!0})},"2ca0":function(s,r,n){var d=n("23e7"),i=n("06cf").f,l=n("50c4"),m=n("5a34"),f=n("1d80"),h=n("ab13"),g=n("c430"),v="".startsWith,y=Math.min,_=h("startsWith"),S=!g&&!_&&!!function(){var w=i(String.prototype,"startsWith");return w&&!w.writable}();d({target:"String",proto:!0,forced:!S&&!_},{startsWith:function($){var C=String(f(this));m($);var I=l(y(arguments.length>1?arguments[1]:void 0,C.length)),O=String($);return v?v.call(C,O,I):C.slice(I,I+O.length)===O}})},"2d00":function(s,r,n){var d=n("da84"),i=n("342f"),l=d.process,m=l&&l.versions,f=m&&m.v8,h,g;f?(h=f.split("."),g=h[0]+h[1]):i&&(h=i.match(/Edge\/(\d+)/),(!h||h[1]>=74)&&(h=i.match(/Chrome\/(\d+)/),h&&(g=h[1]))),s.exports=g&&+g},"342f":function(s,r,n){var d=n("d066");s.exports=d("navigator","userAgent")||""},"35a1":function(s,r,n){var d=n("f5df"),i=n("3f8c"),l=n("b622"),m=l("iterator");s.exports=function(f){if(f!=null)return f[m]||f["@@iterator"]||i[d(f)]}},"37e8":function(s,r,n){var d=n("83ab"),i=n("9bf2"),l=n("825a"),m=n("df75");s.exports=d?Object.defineProperties:function(h,g){l(h);for(var v=m(g),y=v.length,_=0,S;y>_;)i.f(h,S=v[_++],g[S]);return h}},"3bbe":function(s,r,n){var d=n("861d");s.exports=function(i){if(!d(i)&&i!==null)throw TypeError("Can't set "+String(i)+" as a prototype");return i}},"3ca3":function(s,r,n){var d=n("6547").charAt,i=n("69f3"),l=n("7dd0"),m="String Iterator",f=i.set,h=i.getterFor(m);l(String,"String",function(g){f(this,{type:m,string:String(g),index:0})},function(){var v=h(this),y=v.string,_=v.index,S;return _>=y.length?{value:void 0,done:!0}:(S=d(y,_),v.index+=S.length,{value:S,done:!1})})},"3f8c":function(s,r){s.exports={}},4160:function(s,r,n){var d=n("23e7"),i=n("17c2");d({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},"428f":function(s,r,n){var d=n("da84");s.exports=d},"44ad":function(s,r,n){var d=n("d039"),i=n("c6b6"),l="".split;s.exports=d(function(){return!Object("z").propertyIsEnumerable(0)})?function(m){return i(m)=="String"?l.call(m,""):Object(m)}:Object},"44d2":function(s,r,n){var d=n("b622"),i=n("7c73"),l=n("9bf2"),m=d("unscopables"),f=Array.prototype;f[m]==null&&l.f(f,m,{configurable:!0,value:i(null)}),s.exports=function(h){f[m][h]=!0}},"44e7":function(s,r,n){var d=n("861d"),i=n("c6b6"),l=n("b622"),m=l("match");s.exports=function(f){var h;return d(f)&&((h=f[m])!==void 0?!!h:i(f)=="RegExp")}},4930:function(s,r,n){var d=n("d039");s.exports=!!Object.getOwnPropertySymbols&&!d(function(){return!String(Symbol())})},"4d64":function(s,r,n){var d=n("fc6a"),i=n("50c4"),l=n("23cb"),m=function(f){return function(h,g,v){var y=d(h),_=i(y.length),S=l(v,_),w;if(f&&g!=g){for(;_>S;)if(w=y[S++],w!=w)return!0}else for(;_>S;S++)if((f||S in y)&&y[S]===g)return f||S||0;return!f&&-1}};s.exports={includes:m(!0),indexOf:m(!1)}},"4de4":function(s,r,n){var d=n("23e7"),i=n("b727").filter,l=n("1dde"),m=n("ae40"),f=l("filter"),h=m("filter");d({target:"Array",proto:!0,forced:!f||!h},{filter:function(v){return i(this,v,arguments.length>1?arguments[1]:void 0)}})},"4df4":function(s,r,n){var d=n("0366"),i=n("7b0b"),l=n("9bdd"),m=n("e95a"),f=n("50c4"),h=n("8418"),g=n("35a1");s.exports=function(y){var _=i(y),S=typeof this=="function"?this:Array,w=arguments.length,$=w>1?arguments[1]:void 0,C=$!==void 0,I=g(_),O=0,H,G,k,L,B,re;if(C&&($=d($,w>2?arguments[2]:void 0,2)),I!=null&&!(S==Array&&m(I)))for(L=I.call(_),B=L.next,G=new S;!(k=B.call(L)).done;O++)re=C?l(L,$,[k.value,O],!0):k.value,h(G,O,re);else for(H=f(_.length),G=new S(H);H>O;O++)re=C?$(_[O],O):_[O],h(G,O,re);return G.length=O,G}},"4fad":function(s,r,n){var d=n("23e7"),i=n("6f53").entries;d({target:"Object",stat:!0},{entries:function(m){return i(m)}})},"50c4":function(s,r,n){var d=n("a691"),i=Math.min;s.exports=function(l){return l>0?i(d(l),9007199254740991):0}},5135:function(s,r){var n={}.hasOwnProperty;s.exports=function(d,i){return n.call(d,i)}},5319:function(s,r,n){var d=n("d784"),i=n("825a"),l=n("7b0b"),m=n("50c4"),f=n("a691"),h=n("1d80"),g=n("8aa5"),v=n("14c3"),y=Math.max,_=Math.min,S=Math.floor,w=/\$([$&'`]|\d\d?|<[^>]*>)/g,$=/\$([$&'`]|\d\d?)/g,C=function(I){return I===void 0?I:String(I)};d("replace",2,function(I,O,H,G){var k=G.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,L=G.REPLACE_KEEPS_$0,B=k?"$":"$0";return[function(U,oe){var j=h(this),X=U==null?void 0:U[I];return X!==void 0?X.call(U,j,oe):O.call(String(j),U,oe)},function(F,U){if(!k&&L||typeof U=="string"&&U.indexOf(B)===-1){var oe=H(O,F,this,U);if(oe.done)return oe.value}var j=i(F),X=String(this),ye=typeof U=="function";ye||(U=String(U));var Ce=j.global;if(Ce){var Ne=j.unicode;j.lastIndex=0}for(var Pe=[];;){var Re=v(j,X);if(Re===null||(Pe.push(Re),!Ce))break;var Me=String(Re[0]);Me===""&&(j.lastIndex=g(X,m(j.lastIndex),Ne))}for(var Fe="",$e=0,De=0;De<Pe.length;De++){Re=Pe[De];for(var Ee=String(Re[0]),Je=y(_(f(Re.index),X.length),0),Ge=[],gt=1;gt<Re.length;gt++)Ge.push(C(Re[gt]));var Pt=Re.groups;if(ye){var bt=[Ee].concat(Ge,Je,X);Pt!==void 0&&bt.push(Pt);var Le=String(U.apply(void 0,bt))}else Le=re(Ee,X,Je,Ge,Pt,U);Je>=$e&&(Fe+=X.slice($e,Je)+Le,$e=Je+Ee.length)}return Fe+X.slice($e)}];function re(F,U,oe,j,X,ye){var Ce=oe+F.length,Ne=j.length,Pe=$;return X!==void 0&&(X=l(X),Pe=w),O.call(ye,Pe,function(Re,Me){var Fe;switch(Me.charAt(0)){case"$":return"$";case"&":return F;case"`":return U.slice(0,oe);case"'":return U.slice(Ce);case"<":Fe=X[Me.slice(1,-1)];break;default:var $e=+Me;if($e===0)return Re;if($e>Ne){var De=S($e/10);return De===0?Re:De<=Ne?j[De-1]===void 0?Me.charAt(1):j[De-1]+Me.charAt(1):Re}Fe=j[$e-1]}return Fe===void 0?"":Fe})}})},5692:function(s,r,n){var d=n("c430"),i=n("c6cd");(s.exports=function(l,m){return i[l]||(i[l]=m!==void 0?m:{})})("versions",[]).push({version:"3.6.5",mode:d?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},"56ef":function(s,r,n){var d=n("d066"),i=n("241c"),l=n("7418"),m=n("825a");s.exports=d("Reflect","ownKeys")||function(h){var g=i.f(m(h)),v=l.f;return v?g.concat(v(h)):g}},"5a34":function(s,r,n){var d=n("44e7");s.exports=function(i){if(d(i))throw TypeError("The method doesn't accept regular expressions");return i}},"5c6c":function(s,r){s.exports=function(n,d){return{enumerable:!(n&1),configurable:!(n&2),writable:!(n&4),value:d}}},"5db7":function(s,r,n){var d=n("23e7"),i=n("a2bf"),l=n("7b0b"),m=n("50c4"),f=n("1c0b"),h=n("65f0");d({target:"Array",proto:!0},{flatMap:function(v){var y=l(this),_=m(y.length),S;return f(v),S=h(y,0),S.length=i(S,y,y,_,0,1,v,arguments.length>1?arguments[1]:void 0),S}})},6547:function(s,r,n){var d=n("a691"),i=n("1d80"),l=function(m){return function(f,h){var g=String(i(f)),v=d(h),y=g.length,_,S;return v<0||v>=y?m?"":void 0:(_=g.charCodeAt(v),_<55296||_>56319||v+1===y||(S=g.charCodeAt(v+1))<56320||S>57343?m?g.charAt(v):_:m?g.slice(v,v+2):(_-55296<<10)+(S-56320)+65536)}};s.exports={codeAt:l(!1),charAt:l(!0)}},"65f0":function(s,r,n){var d=n("861d"),i=n("e8b5"),l=n("b622"),m=l("species");s.exports=function(f,h){var g;return i(f)&&(g=f.constructor,typeof g=="function"&&(g===Array||i(g.prototype))?g=void 0:d(g)&&(g=g[m],g===null&&(g=void 0))),new(g===void 0?Array:g)(h===0?0:h)}},"69f3":function(s,r,n){var d=n("7f9a"),i=n("da84"),l=n("861d"),m=n("9112"),f=n("5135"),h=n("f772"),g=n("d012"),v=i.WeakMap,y,_,S,w=function(k){return S(k)?_(k):y(k,{})},$=function(k){return function(L){var B;if(!l(L)||(B=_(L)).type!==k)throw TypeError("Incompatible receiver, "+k+" required");return B}};if(d){var C=new v,I=C.get,O=C.has,H=C.set;y=function(k,L){return H.call(C,k,L),L},_=function(k){return I.call(C,k)||{}},S=function(k){return O.call(C,k)}}else{var G=h("state");g[G]=!0,y=function(k,L){return m(k,G,L),L},_=function(k){return f(k,G)?k[G]:{}},S=function(k){return f(k,G)}}s.exports={set:y,get:_,has:S,enforce:w,getterFor:$}},"6eeb":function(s,r,n){var d=n("da84"),i=n("9112"),l=n("5135"),m=n("ce4e"),f=n("8925"),h=n("69f3"),g=h.get,v=h.enforce,y=String(String).split("String");(s.exports=function(_,S,w,$){var C=$?!!$.unsafe:!1,I=$?!!$.enumerable:!1,O=$?!!$.noTargetGet:!1;if(typeof w=="function"&&(typeof S=="string"&&!l(w,"name")&&i(w,"name",S),v(w).source=y.join(typeof S=="string"?S:"")),_===d){I?_[S]=w:m(S,w);return}else C?!O&&_[S]&&(I=!0):delete _[S];I?_[S]=w:i(_,S,w)})(Function.prototype,"toString",function(){return typeof this=="function"&&g(this).source||f(this)})},"6f53":function(s,r,n){var d=n("83ab"),i=n("df75"),l=n("fc6a"),m=n("d1e7").f,f=function(h){return function(g){for(var v=l(g),y=i(v),_=y.length,S=0,w=[],$;_>S;)$=y[S++],(!d||m.call(v,$))&&w.push(h?[$,v[$]]:v[$]);return w}};s.exports={entries:f(!0),values:f(!1)}},"73d9":function(s,r,n){var d=n("44d2");d("flatMap")},7418:function(s,r){r.f=Object.getOwnPropertySymbols},"746f":function(s,r,n){var d=n("428f"),i=n("5135"),l=n("e538"),m=n("9bf2").f;s.exports=function(f){var h=d.Symbol||(d.Symbol={});i(h,f)||m(h,f,{value:l.f(f)})}},7839:function(s,r){s.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"7b0b":function(s,r,n){var d=n("1d80");s.exports=function(i){return Object(d(i))}},"7c73":function(s,r,n){var d=n("825a"),i=n("37e8"),l=n("7839"),m=n("d012"),f=n("1be4"),h=n("cc12"),g=n("f772"),v=">",y="<",_="prototype",S="script",w=g("IE_PROTO"),$=function(){},C=function(k){return y+S+v+k+y+"/"+S+v},I=function(k){k.write(C("")),k.close();var L=k.parentWindow.Object;return k=null,L},O=function(){var k=h("iframe"),L="java"+S+":",B;return k.style.display="none",f.appendChild(k),k.src=String(L),B=k.contentWindow.document,B.open(),B.write(C("document.F=Object")),B.close(),B.F},H,G=function(){try{H=document.domain&&new ActiveXObject("htmlfile")}catch{}G=H?I(H):O();for(var k=l.length;k--;)delete G[_][l[k]];return G()};m[w]=!0,s.exports=Object.create||function(L,B){var re;return L!==null?($[_]=d(L),re=new $,$[_]=null,re[w]=L):re=G(),B===void 0?re:i(re,B)}},"7dd0":function(s,r,n){var d=n("23e7"),i=n("9ed3"),l=n("e163"),m=n("d2bb"),f=n("d44e"),h=n("9112"),g=n("6eeb"),v=n("b622"),y=n("c430"),_=n("3f8c"),S=n("ae93"),w=S.IteratorPrototype,$=S.BUGGY_SAFARI_ITERATORS,C=v("iterator"),I="keys",O="values",H="entries",G=function(){return this};s.exports=function(k,L,B,re,F,U,oe){i(B,L,re);var j=function(De){if(De===F&&Pe)return Pe;if(!$&&De in Ce)return Ce[De];switch(De){case I:return function(){return new B(this,De)};case O:return function(){return new B(this,De)};case H:return function(){return new B(this,De)}}return function(){return new B(this)}},X=L+" Iterator",ye=!1,Ce=k.prototype,Ne=Ce[C]||Ce["@@iterator"]||F&&Ce[F],Pe=!$&&Ne||j(F),Re=L=="Array"&&Ce.entries||Ne,Me,Fe,$e;if(Re&&(Me=l(Re.call(new k)),w!==Object.prototype&&Me.next&&(!y&&l(Me)!==w&&(m?m(Me,w):typeof Me[C]!="function"&&h(Me,C,G)),f(Me,X,!0,!0),y&&(_[X]=G))),F==O&&Ne&&Ne.name!==O&&(ye=!0,Pe=function(){return Ne.call(this)}),(!y||oe)&&Ce[C]!==Pe&&h(Ce,C,Pe),_[L]=Pe,F)if(Fe={values:j(O),keys:U?Pe:j(I),entries:j(H)},oe)for($e in Fe)($||ye||!($e in Ce))&&g(Ce,$e,Fe[$e]);else d({target:L,proto:!0,forced:$||ye},Fe);return Fe}},"7f9a":function(s,r,n){var d=n("da84"),i=n("8925"),l=d.WeakMap;s.exports=typeof l=="function"&&/native code/.test(i(l))},"825a":function(s,r,n){var d=n("861d");s.exports=function(i){if(!d(i))throw TypeError(String(i)+" is not an object");return i}},"83ab":function(s,r,n){var d=n("d039");s.exports=!d(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},8418:function(s,r,n){var d=n("c04e"),i=n("9bf2"),l=n("5c6c");s.exports=function(m,f,h){var g=d(f);g in m?i.f(m,g,l(0,h)):m[g]=h}},"861d":function(s,r){s.exports=function(n){return typeof n=="object"?n!==null:typeof n=="function"}},8875:function(s,r,n){var d,i,l;(function(m,f){i=[],d=f,l=typeof d=="function"?d.apply(r,i):d,l!==void 0&&(s.exports=l)})(typeof self<"u"?self:this,function(){function m(){var f=Object.getOwnPropertyDescriptor(document,"currentScript");if(!f&&"currentScript"in document&&document.currentScript||f&&f.get!==m&&document.currentScript)return document.currentScript;try{throw new Error}catch(H){var h=/.*at [^(]*\((.*):(.+):(.+)\)$/ig,g=/@([^@]*):(\d+):(\d+)\s*$/ig,v=h.exec(H.stack)||g.exec(H.stack),y=v&&v[1]||!1,_=v&&v[2]||!1,S=document.location.href.replace(document.location.hash,""),w,$,C,I=document.getElementsByTagName("script");y===S&&(w=document.documentElement.outerHTML,$=new RegExp("(?:[^\\n]+?\\n){0,"+(_-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),C=w.replace($,"$1").trim());for(var O=0;O<I.length;O++)if(I[O].readyState==="interactive"||I[O].src===y||y===S&&I[O].innerHTML&&I[O].innerHTML.trim()===C)return I[O];return null}}return m})},8925:function(s,r,n){var d=n("c6cd"),i=Function.toString;typeof d.inspectSource!="function"&&(d.inspectSource=function(l){return i.call(l)}),s.exports=d.inspectSource},"8aa5":function(s,r,n){var d=n("6547").charAt;s.exports=function(i,l,m){return l+(m?d(i,l).length:1)}},"8bbf":function(s,r){s.exports=a},"90e3":function(s,r){var n=0,d=Math.random();s.exports=function(i){return"Symbol("+String(i===void 0?"":i)+")_"+(++n+d).toString(36)}},9112:function(s,r,n){var d=n("83ab"),i=n("9bf2"),l=n("5c6c");s.exports=d?function(m,f,h){return i.f(m,f,l(1,h))}:function(m,f,h){return m[f]=h,m}},9263:function(s,r,n){var d=n("ad6d"),i=n("9f7f"),l=RegExp.prototype.exec,m=String.prototype.replace,f=l,h=function(){var _=/a/,S=/b*/g;return l.call(_,"a"),l.call(S,"a"),_.lastIndex!==0||S.lastIndex!==0}(),g=i.UNSUPPORTED_Y||i.BROKEN_CARET,v=/()??/.exec("")[1]!==void 0,y=h||v||g;y&&(f=function(S){var w=this,$,C,I,O,H=g&&w.sticky,G=d.call(w),k=w.source,L=0,B=S;return H&&(G=G.replace("y",""),G.indexOf("g")===-1&&(G+="g"),B=String(S).slice(w.lastIndex),w.lastIndex>0&&(!w.multiline||w.multiline&&S[w.lastIndex-1]!==`
`)&&(k="(?: "+k+")",B=" "+B,L++),C=new RegExp("^(?:"+k+")",G)),v&&(C=new RegExp("^"+k+"$(?!\\s)",G)),h&&($=w.lastIndex),I=l.call(H?C:w,B),H?I?(I.input=I.input.slice(L),I[0]=I[0].slice(L),I.index=w.lastIndex,w.lastIndex+=I[0].length):w.lastIndex=0:h&&I&&(w.lastIndex=w.global?I.index+I[0].length:$),v&&I&&I.length>1&&m.call(I[0],C,function(){for(O=1;O<arguments.length-2;O++)arguments[O]===void 0&&(I[O]=void 0)}),I}),s.exports=f},"94ca":function(s,r,n){var d=n("d039"),i=/#|\.prototype\./,l=function(v,y){var _=f[m(v)];return _==g?!0:_==h?!1:typeof y=="function"?d(y):!!y},m=l.normalize=function(v){return String(v).replace(i,".").toLowerCase()},f=l.data={},h=l.NATIVE="N",g=l.POLYFILL="P";s.exports=l},"99af":function(s,r,n){var d=n("23e7"),i=n("d039"),l=n("e8b5"),m=n("861d"),f=n("7b0b"),h=n("50c4"),g=n("8418"),v=n("65f0"),y=n("1dde"),_=n("b622"),S=n("2d00"),w=_("isConcatSpreadable"),$=9007199254740991,C="Maximum allowed index exceeded",I=S>=51||!i(function(){var k=[];return k[w]=!1,k.concat()[0]!==k}),O=y("concat"),H=function(k){if(!m(k))return!1;var L=k[w];return L!==void 0?!!L:l(k)},G=!I||!O;d({target:"Array",proto:!0,forced:G},{concat:function(L){var B=f(this),re=v(B,0),F=0,U,oe,j,X,ye;for(U=-1,j=arguments.length;U<j;U++)if(ye=U===-1?B:arguments[U],H(ye)){if(X=h(ye.length),F+X>$)throw TypeError(C);for(oe=0;oe<X;oe++,F++)oe in ye&&g(re,F,ye[oe])}else{if(F>=$)throw TypeError(C);g(re,F++,ye)}return re.length=F,re}})},"9bdd":function(s,r,n){var d=n("825a");s.exports=function(i,l,m,f){try{return f?l(d(m)[0],m[1]):l(m)}catch(g){var h=i.return;throw h!==void 0&&d(h.call(i)),g}}},"9bf2":function(s,r,n){var d=n("83ab"),i=n("0cfb"),l=n("825a"),m=n("c04e"),f=Object.defineProperty;r.f=d?f:function(g,v,y){if(l(g),v=m(v,!0),l(y),i)try{return f(g,v,y)}catch{}if("get"in y||"set"in y)throw TypeError("Accessors not supported");return"value"in y&&(g[v]=y.value),g}},"9ed3":function(s,r,n){var d=n("ae93").IteratorPrototype,i=n("7c73"),l=n("5c6c"),m=n("d44e"),f=n("3f8c"),h=function(){return this};s.exports=function(g,v,y){var _=v+" Iterator";return g.prototype=i(d,{next:l(1,y)}),m(g,_,!1,!0),f[_]=h,g}},"9f7f":function(s,r,n){var d=n("d039");function i(l,m){return RegExp(l,m)}r.UNSUPPORTED_Y=d(function(){var l=i("a","y");return l.lastIndex=2,l.exec("abcd")!=null}),r.BROKEN_CARET=d(function(){var l=i("^r","gy");return l.lastIndex=2,l.exec("str")!=null})},a2bf:function(s,r,n){var d=n("e8b5"),i=n("50c4"),l=n("0366"),m=function(f,h,g,v,y,_,S,w){for(var $=y,C=0,I=S?l(S,w,3):!1,O;C<v;){if(C in g){if(O=I?I(g[C],C,h):g[C],_>0&&d(O))$=m(f,h,O,i(O.length),$,_-1)-1;else{if($>=9007199254740991)throw TypeError("Exceed the acceptable array length");f[$]=O}$++}C++}return $};s.exports=m},a352:function(s,r){s.exports=c},a434:function(s,r,n){var d=n("23e7"),i=n("23cb"),l=n("a691"),m=n("50c4"),f=n("7b0b"),h=n("65f0"),g=n("8418"),v=n("1dde"),y=n("ae40"),_=v("splice"),S=y("splice",{ACCESSORS:!0,0:0,1:2}),w=Math.max,$=Math.min,C=9007199254740991,I="Maximum allowed length exceeded";d({target:"Array",proto:!0,forced:!_||!S},{splice:function(H,G){var k=f(this),L=m(k.length),B=i(H,L),re=arguments.length,F,U,oe,j,X,ye;if(re===0?F=U=0:re===1?(F=0,U=L-B):(F=re-2,U=$(w(l(G),0),L-B)),L+F-U>C)throw TypeError(I);for(oe=h(k,U),j=0;j<U;j++)X=B+j,X in k&&g(oe,j,k[X]);if(oe.length=U,F<U){for(j=B;j<L-U;j++)X=j+U,ye=j+F,X in k?k[ye]=k[X]:delete k[ye];for(j=L;j>L-U+F;j--)delete k[j-1]}else if(F>U)for(j=L-U;j>B;j--)X=j+U-1,ye=j+F-1,X in k?k[ye]=k[X]:delete k[ye];for(j=0;j<F;j++)k[j+B]=arguments[j+2];return k.length=L-U+F,oe}})},a4d3:function(s,r,n){var d=n("23e7"),i=n("da84"),l=n("d066"),m=n("c430"),f=n("83ab"),h=n("4930"),g=n("fdbf"),v=n("d039"),y=n("5135"),_=n("e8b5"),S=n("861d"),w=n("825a"),$=n("7b0b"),C=n("fc6a"),I=n("c04e"),O=n("5c6c"),H=n("7c73"),G=n("df75"),k=n("241c"),L=n("057f"),B=n("7418"),re=n("06cf"),F=n("9bf2"),U=n("d1e7"),oe=n("9112"),j=n("6eeb"),X=n("5692"),ye=n("f772"),Ce=n("d012"),Ne=n("90e3"),Pe=n("b622"),Re=n("e538"),Me=n("746f"),Fe=n("d44e"),$e=n("69f3"),De=n("b727").forEach,Ee=ye("hidden"),Je="Symbol",Ge="prototype",gt=Pe("toPrimitive"),Pt=$e.set,bt=$e.getterFor(Je),Le=Object[Ge],Ue=i.Symbol,Rt=l("JSON","stringify"),ut=re.f,mt=F.f,ps=L.f,Ls=U.f,it=X("symbols"),_t=X("op-symbols"),Mt=X("string-to-symbol-registry"),Kt=X("symbol-to-string-registry"),zt=X("wks"),Yt=i.QObject,Wt=!Yt||!Yt[Ge]||!Yt[Ge].findChild,Xt=f&&v(function(){return H(mt({},"a",{get:function(){return mt(this,"a",{value:7}).a}})).a!=7})?function(se,Y,Z){var fe=ut(Le,Y);fe&&delete Le[Y],mt(se,Y,Z),fe&&se!==Le&&mt(Le,Y,fe)}:mt,Jt=function(se,Y){var Z=it[se]=H(Ue[Ge]);return Pt(Z,{type:Je,tag:se,description:Y}),f||(Z.description=Y),Z},E=g?function(se){return typeof se=="symbol"}:function(se){return Object(se)instanceof Ue},x=function(Y,Z,fe){Y===Le&&x(_t,Z,fe),w(Y);var pe=I(Z,!0);return w(fe),y(it,pe)?(fe.enumerable?(y(Y,Ee)&&Y[Ee][pe]&&(Y[Ee][pe]=!1),fe=H(fe,{enumerable:O(0,!1)})):(y(Y,Ee)||mt(Y,Ee,O(1,{})),Y[Ee][pe]=!0),Xt(Y,pe,fe)):mt(Y,pe,fe)},R=function(Y,Z){w(Y);var fe=C(Z),pe=G(fe).concat(be(fe));return De(pe,function(ze){(!f||K.call(fe,ze))&&x(Y,ze,fe[ze])}),Y},M=function(Y,Z){return Z===void 0?H(Y):R(H(Y),Z)},K=function(Y){var Z=I(Y,!0),fe=Ls.call(this,Z);return this===Le&&y(it,Z)&&!y(_t,Z)?!1:fe||!y(this,Z)||!y(it,Z)||y(this,Ee)&&this[Ee][Z]?fe:!0},te=function(Y,Z){var fe=C(Y),pe=I(Z,!0);if(!(fe===Le&&y(it,pe)&&!y(_t,pe))){var ze=ut(fe,pe);return ze&&y(it,pe)&&!(y(fe,Ee)&&fe[Ee][pe])&&(ze.enumerable=!0),ze}},de=function(Y){var Z=ps(C(Y)),fe=[];return De(Z,function(pe){!y(it,pe)&&!y(Ce,pe)&&fe.push(pe)}),fe},be=function(Y){var Z=Y===Le,fe=ps(Z?_t:C(Y)),pe=[];return De(fe,function(ze){y(it,ze)&&(!Z||y(Le,ze))&&pe.push(it[ze])}),pe};if(h||(Ue=function(){if(this instanceof Ue)throw TypeError("Symbol is not a constructor");var Y=!arguments.length||arguments[0]===void 0?void 0:String(arguments[0]),Z=Ne(Y),fe=function(pe){this===Le&&fe.call(_t,pe),y(this,Ee)&&y(this[Ee],Z)&&(this[Ee][Z]=!1),Xt(this,Z,O(1,pe))};return f&&Wt&&Xt(Le,Z,{configurable:!0,set:fe}),Jt(Z,Y)},j(Ue[Ge],"toString",function(){return bt(this).tag}),j(Ue,"withoutSetter",function(se){return Jt(Ne(se),se)}),U.f=K,F.f=x,re.f=te,k.f=L.f=de,B.f=be,Re.f=function(se){return Jt(Pe(se),se)},f&&(mt(Ue[Ge],"description",{configurable:!0,get:function(){return bt(this).description}}),m||j(Le,"propertyIsEnumerable",K,{unsafe:!0}))),d({global:!0,wrap:!0,forced:!h,sham:!h},{Symbol:Ue}),De(G(zt),function(se){Me(se)}),d({target:Je,stat:!0,forced:!h},{for:function(se){var Y=String(se);if(y(Mt,Y))return Mt[Y];var Z=Ue(Y);return Mt[Y]=Z,Kt[Z]=Y,Z},keyFor:function(Y){if(!E(Y))throw TypeError(Y+" is not a symbol");if(y(Kt,Y))return Kt[Y]},useSetter:function(){Wt=!0},useSimple:function(){Wt=!1}}),d({target:"Object",stat:!0,forced:!h,sham:!f},{create:M,defineProperty:x,defineProperties:R,getOwnPropertyDescriptor:te}),d({target:"Object",stat:!0,forced:!h},{getOwnPropertyNames:de,getOwnPropertySymbols:be}),d({target:"Object",stat:!0,forced:v(function(){B.f(1)})},{getOwnPropertySymbols:function(Y){return B.f($(Y))}}),Rt){var ke=!h||v(function(){var se=Ue();return Rt([se])!="[null]"||Rt({a:se})!="{}"||Rt(Object(se))!="{}"});d({target:"JSON",stat:!0,forced:ke},{stringify:function(Y,Z,fe){for(var pe=[Y],ze=1,Us;arguments.length>ze;)pe.push(arguments[ze++]);if(Us=Z,!(!S(Z)&&Y===void 0||E(Y)))return _(Z)||(Z=function(Jo,gs){if(typeof Us=="function"&&(gs=Us.call(this,Jo,gs)),!E(gs))return gs}),pe[1]=Z,Rt.apply(null,pe)}})}Ue[Ge][gt]||oe(Ue[Ge],gt,Ue[Ge].valueOf),Fe(Ue,Je),Ce[Ee]=!0},a630:function(s,r,n){var d=n("23e7"),i=n("4df4"),l=n("1c7e"),m=!l(function(f){Array.from(f)});d({target:"Array",stat:!0,forced:m},{from:i})},a640:function(s,r,n){var d=n("d039");s.exports=function(i,l){var m=[][i];return!!m&&d(function(){m.call(null,l||function(){throw 1},1)})}},a691:function(s,r){var n=Math.ceil,d=Math.floor;s.exports=function(i){return isNaN(i=+i)?0:(i>0?d:n)(i)}},ab13:function(s,r,n){var d=n("b622"),i=d("match");s.exports=function(l){var m=/./;try{"/./"[l](m)}catch{try{return m[i]=!1,"/./"[l](m)}catch{}}return!1}},ac1f:function(s,r,n){var d=n("23e7"),i=n("9263");d({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},ad6d:function(s,r,n){var d=n("825a");s.exports=function(){var i=d(this),l="";return i.global&&(l+="g"),i.ignoreCase&&(l+="i"),i.multiline&&(l+="m"),i.dotAll&&(l+="s"),i.unicode&&(l+="u"),i.sticky&&(l+="y"),l}},ae40:function(s,r,n){var d=n("83ab"),i=n("d039"),l=n("5135"),m=Object.defineProperty,f={},h=function(g){throw g};s.exports=function(g,v){if(l(f,g))return f[g];v||(v={});var y=[][g],_=l(v,"ACCESSORS")?v.ACCESSORS:!1,S=l(v,0)?v[0]:h,w=l(v,1)?v[1]:void 0;return f[g]=!!y&&!i(function(){if(_&&!d)return!0;var $={length:-1};_?m($,1,{enumerable:!0,get:h}):$[1]=1,y.call($,S,w)})}},ae93:function(s,r,n){var d=n("e163"),i=n("9112"),l=n("5135"),m=n("b622"),f=n("c430"),h=m("iterator"),g=!1,v=function(){return this},y,_,S;[].keys&&(S=[].keys(),"next"in S?(_=d(d(S)),_!==Object.prototype&&(y=_)):g=!0),y==null&&(y={}),!f&&!l(y,h)&&i(y,h,v),s.exports={IteratorPrototype:y,BUGGY_SAFARI_ITERATORS:g}},b041:function(s,r,n){var d=n("00ee"),i=n("f5df");s.exports=d?{}.toString:function(){return"[object "+i(this)+"]"}},b0c0:function(s,r,n){var d=n("83ab"),i=n("9bf2").f,l=Function.prototype,m=l.toString,f=/^\s*function ([^ (]*)/,h="name";d&&!(h in l)&&i(l,h,{configurable:!0,get:function(){try{return m.call(this).match(f)[1]}catch{return""}}})},b622:function(s,r,n){var d=n("da84"),i=n("5692"),l=n("5135"),m=n("90e3"),f=n("4930"),h=n("fdbf"),g=i("wks"),v=d.Symbol,y=h?v:v&&v.withoutSetter||m;s.exports=function(_){return l(g,_)||(f&&l(v,_)?g[_]=v[_]:g[_]=y("Symbol."+_)),g[_]}},b64b:function(s,r,n){var d=n("23e7"),i=n("7b0b"),l=n("df75"),m=n("d039"),f=m(function(){l(1)});d({target:"Object",stat:!0,forced:f},{keys:function(g){return l(i(g))}})},b727:function(s,r,n){var d=n("0366"),i=n("44ad"),l=n("7b0b"),m=n("50c4"),f=n("65f0"),h=[].push,g=function(v){var y=v==1,_=v==2,S=v==3,w=v==4,$=v==6,C=v==5||$;return function(I,O,H,G){for(var k=l(I),L=i(k),B=d(O,H,3),re=m(L.length),F=0,U=G||f,oe=y?U(I,re):_?U(I,0):void 0,j,X;re>F;F++)if((C||F in L)&&(j=L[F],X=B(j,F,k),v)){if(y)oe[F]=X;else if(X)switch(v){case 3:return!0;case 5:return j;case 6:return F;case 2:h.call(oe,j)}else if(w)return!1}return $?-1:S||w?w:oe}};s.exports={forEach:g(0),map:g(1),filter:g(2),some:g(3),every:g(4),find:g(5),findIndex:g(6)}},c04e:function(s,r,n){var d=n("861d");s.exports=function(i,l){if(!d(i))return i;var m,f;if(l&&typeof(m=i.toString)=="function"&&!d(f=m.call(i))||typeof(m=i.valueOf)=="function"&&!d(f=m.call(i))||!l&&typeof(m=i.toString)=="function"&&!d(f=m.call(i)))return f;throw TypeError("Can't convert object to primitive value")}},c430:function(s,r){s.exports=!1},c6b6:function(s,r){var n={}.toString;s.exports=function(d){return n.call(d).slice(8,-1)}},c6cd:function(s,r,n){var d=n("da84"),i=n("ce4e"),l="__core-js_shared__",m=d[l]||i(l,{});s.exports=m},c740:function(s,r,n){var d=n("23e7"),i=n("b727").findIndex,l=n("44d2"),m=n("ae40"),f="findIndex",h=!0,g=m(f);f in[]&&Array(1)[f](function(){h=!1}),d({target:"Array",proto:!0,forced:h||!g},{findIndex:function(y){return i(this,y,arguments.length>1?arguments[1]:void 0)}}),l(f)},c8ba:function(s,r){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch{typeof window=="object"&&(n=window)}s.exports=n},c975:function(s,r,n){var d=n("23e7"),i=n("4d64").indexOf,l=n("a640"),m=n("ae40"),f=[].indexOf,h=!!f&&1/[1].indexOf(1,-0)<0,g=l("indexOf"),v=m("indexOf",{ACCESSORS:!0,1:0});d({target:"Array",proto:!0,forced:h||!g||!v},{indexOf:function(_){return h?f.apply(this,arguments)||0:i(this,_,arguments.length>1?arguments[1]:void 0)}})},ca84:function(s,r,n){var d=n("5135"),i=n("fc6a"),l=n("4d64").indexOf,m=n("d012");s.exports=function(f,h){var g=i(f),v=0,y=[],_;for(_ in g)!d(m,_)&&d(g,_)&&y.push(_);for(;h.length>v;)d(g,_=h[v++])&&(~l(y,_)||y.push(_));return y}},caad:function(s,r,n){var d=n("23e7"),i=n("4d64").includes,l=n("44d2"),m=n("ae40"),f=m("indexOf",{ACCESSORS:!0,1:0});d({target:"Array",proto:!0,forced:!f},{includes:function(g){return i(this,g,arguments.length>1?arguments[1]:void 0)}}),l("includes")},cc12:function(s,r,n){var d=n("da84"),i=n("861d"),l=d.document,m=i(l)&&i(l.createElement);s.exports=function(f){return m?l.createElement(f):{}}},ce4e:function(s,r,n){var d=n("da84"),i=n("9112");s.exports=function(l,m){try{i(d,l,m)}catch{d[l]=m}return m}},d012:function(s,r){s.exports={}},d039:function(s,r){s.exports=function(n){try{return!!n()}catch{return!0}}},d066:function(s,r,n){var d=n("428f"),i=n("da84"),l=function(m){return typeof m=="function"?m:void 0};s.exports=function(m,f){return arguments.length<2?l(d[m])||l(i[m]):d[m]&&d[m][f]||i[m]&&i[m][f]}},d1e7:function(s,r,n){var d={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,l=i&&!d.call({1:2},1);r.f=l?function(f){var h=i(this,f);return!!h&&h.enumerable}:d},d28b:function(s,r,n){var d=n("746f");d("iterator")},d2bb:function(s,r,n){var d=n("825a"),i=n("3bbe");s.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var l=!1,m={},f;try{f=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,f.call(m,[]),l=m instanceof Array}catch{}return function(g,v){return d(g),i(v),l?f.call(g,v):g.__proto__=v,g}}():void 0)},d3b7:function(s,r,n){var d=n("00ee"),i=n("6eeb"),l=n("b041");d||i(Object.prototype,"toString",l,{unsafe:!0})},d44e:function(s,r,n){var d=n("9bf2").f,i=n("5135"),l=n("b622"),m=l("toStringTag");s.exports=function(f,h,g){f&&!i(f=g?f:f.prototype,m)&&d(f,m,{configurable:!0,value:h})}},d58f:function(s,r,n){var d=n("1c0b"),i=n("7b0b"),l=n("44ad"),m=n("50c4"),f=function(h){return function(g,v,y,_){d(v);var S=i(g),w=l(S),$=m(S.length),C=h?$-1:0,I=h?-1:1;if(y<2)for(;;){if(C in w){_=w[C],C+=I;break}if(C+=I,h?C<0:$<=C)throw TypeError("Reduce of empty array with no initial value")}for(;h?C>=0:$>C;C+=I)C in w&&(_=v(_,w[C],C,S));return _}};s.exports={left:f(!1),right:f(!0)}},d784:function(s,r,n){n("ac1f");var d=n("6eeb"),i=n("d039"),l=n("b622"),m=n("9263"),f=n("9112"),h=l("species"),g=!i(function(){var w=/./;return w.exec=function(){var $=[];return $.groups={a:"7"},$},"".replace(w,"$<a>")!=="7"}),v=function(){return"a".replace(/./,"$0")==="$0"}(),y=l("replace"),_=function(){return/./[y]?/./[y]("a","$0")==="":!1}(),S=!i(function(){var w=/(?:)/,$=w.exec;w.exec=function(){return $.apply(this,arguments)};var C="ab".split(w);return C.length!==2||C[0]!=="a"||C[1]!=="b"});s.exports=function(w,$,C,I){var O=l(w),H=!i(function(){var F={};return F[O]=function(){return 7},""[w](F)!=7}),G=H&&!i(function(){var F=!1,U=/a/;return w==="split"&&(U={},U.constructor={},U.constructor[h]=function(){return U},U.flags="",U[O]=/./[O]),U.exec=function(){return F=!0,null},U[O](""),!F});if(!H||!G||w==="replace"&&!(g&&v&&!_)||w==="split"&&!S){var k=/./[O],L=C(O,""[w],function(F,U,oe,j,X){return U.exec===m?H&&!X?{done:!0,value:k.call(U,oe,j)}:{done:!0,value:F.call(oe,U,j)}:{done:!1}},{REPLACE_KEEPS_$0:v,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:_}),B=L[0],re=L[1];d(String.prototype,w,B),d(RegExp.prototype,O,$==2?function(F,U){return re.call(F,this,U)}:function(F){return re.call(F,this)})}I&&f(RegExp.prototype[O],"sham",!0)}},d81d:function(s,r,n){var d=n("23e7"),i=n("b727").map,l=n("1dde"),m=n("ae40"),f=l("map"),h=m("map");d({target:"Array",proto:!0,forced:!f||!h},{map:function(v){return i(this,v,arguments.length>1?arguments[1]:void 0)}})},da84:function(s,r,n){(function(d){var i=function(l){return l&&l.Math==Math&&l};s.exports=i(typeof globalThis=="object"&&globalThis)||i(typeof window=="object"&&window)||i(typeof self=="object"&&self)||i(typeof d=="object"&&d)||Function("return this")()}).call(this,n("c8ba"))},dbb4:function(s,r,n){var d=n("23e7"),i=n("83ab"),l=n("56ef"),m=n("fc6a"),f=n("06cf"),h=n("8418");d({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(v){for(var y=m(v),_=f.f,S=l(y),w={},$=0,C,I;S.length>$;)I=_(y,C=S[$++]),I!==void 0&&h(w,C,I);return w}})},dbf1:function(s,r,n){(function(d){n.d(r,"a",function(){return l});function i(){return typeof window<"u"?window.console:d.console}var l=i()}).call(this,n("c8ba"))},ddb0:function(s,r,n){var d=n("da84"),i=n("fdbc"),l=n("e260"),m=n("9112"),f=n("b622"),h=f("iterator"),g=f("toStringTag"),v=l.values;for(var y in i){var _=d[y],S=_&&_.prototype;if(S){if(S[h]!==v)try{m(S,h,v)}catch{S[h]=v}if(S[g]||m(S,g,y),i[y]){for(var w in l)if(S[w]!==l[w])try{m(S,w,l[w])}catch{S[w]=l[w]}}}}},df75:function(s,r,n){var d=n("ca84"),i=n("7839");s.exports=Object.keys||function(m){return d(m,i)}},e01a:function(s,r,n){var d=n("23e7"),i=n("83ab"),l=n("da84"),m=n("5135"),f=n("861d"),h=n("9bf2").f,g=n("e893"),v=l.Symbol;if(i&&typeof v=="function"&&(!("description"in v.prototype)||v().description!==void 0)){var y={},_=function(){var O=arguments.length<1||arguments[0]===void 0?void 0:String(arguments[0]),H=this instanceof _?new v(O):O===void 0?v():v(O);return O===""&&(y[H]=!0),H};g(_,v);var S=_.prototype=v.prototype;S.constructor=_;var w=S.toString,$=String(v("test"))=="Symbol(test)",C=/^Symbol\((.*)\)[^)]+$/;h(S,"description",{configurable:!0,get:function(){var O=f(this)?this.valueOf():this,H=w.call(O);if(m(y,O))return"";var G=$?H.slice(7,-1):H.replace(C,"$1");return G===""?void 0:G}}),d({global:!0,forced:!0},{Symbol:_})}},e163:function(s,r,n){var d=n("5135"),i=n("7b0b"),l=n("f772"),m=n("e177"),f=l("IE_PROTO"),h=Object.prototype;s.exports=m?Object.getPrototypeOf:function(g){return g=i(g),d(g,f)?g[f]:typeof g.constructor=="function"&&g instanceof g.constructor?g.constructor.prototype:g instanceof Object?h:null}},e177:function(s,r,n){var d=n("d039");s.exports=!d(function(){function i(){}return i.prototype.constructor=null,Object.getPrototypeOf(new i)!==i.prototype})},e260:function(s,r,n){var d=n("fc6a"),i=n("44d2"),l=n("3f8c"),m=n("69f3"),f=n("7dd0"),h="Array Iterator",g=m.set,v=m.getterFor(h);s.exports=f(Array,"Array",function(y,_){g(this,{type:h,target:d(y),index:0,kind:_})},function(){var y=v(this),_=y.target,S=y.kind,w=y.index++;return!_||w>=_.length?(y.target=void 0,{value:void 0,done:!0}):S=="keys"?{value:w,done:!1}:S=="values"?{value:_[w],done:!1}:{value:[w,_[w]],done:!1}},"values"),l.Arguments=l.Array,i("keys"),i("values"),i("entries")},e439:function(s,r,n){var d=n("23e7"),i=n("d039"),l=n("fc6a"),m=n("06cf").f,f=n("83ab"),h=i(function(){m(1)}),g=!f||h;d({target:"Object",stat:!0,forced:g,sham:!f},{getOwnPropertyDescriptor:function(y,_){return m(l(y),_)}})},e538:function(s,r,n){var d=n("b622");r.f=d},e893:function(s,r,n){var d=n("5135"),i=n("56ef"),l=n("06cf"),m=n("9bf2");s.exports=function(f,h){for(var g=i(h),v=m.f,y=l.f,_=0;_<g.length;_++){var S=g[_];d(f,S)||v(f,S,y(h,S))}}},e8b5:function(s,r,n){var d=n("c6b6");s.exports=Array.isArray||function(l){return d(l)=="Array"}},e95a:function(s,r,n){var d=n("b622"),i=n("3f8c"),l=d("iterator"),m=Array.prototype;s.exports=function(f){return f!==void 0&&(i.Array===f||m[l]===f)}},f5df:function(s,r,n){var d=n("00ee"),i=n("c6b6"),l=n("b622"),m=l("toStringTag"),f=i(function(){return arguments}())=="Arguments",h=function(g,v){try{return g[v]}catch{}};s.exports=d?i:function(g){var v,y,_;return g===void 0?"Undefined":g===null?"Null":typeof(y=h(v=Object(g),m))=="string"?y:f?i(v):(_=i(v))=="Object"&&typeof v.callee=="function"?"Arguments":_}},f772:function(s,r,n){var d=n("5692"),i=n("90e3"),l=d("keys");s.exports=function(m){return l[m]||(l[m]=i(m))}},fb15:function(s,r,n){if(n.r(r),typeof window<"u"){var d=window.document.currentScript;{var i=n("8875");d=i(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:i})}var l=d&&d.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);l&&(n.p=l[1])}n("99af"),n("4de4"),n("4160"),n("c975"),n("d81d"),n("a434"),n("159b"),n("a4d3"),n("e439"),n("dbb4"),n("b64b");function m(E,x,R){return x in E?Object.defineProperty(E,x,{value:R,enumerable:!0,configurable:!0,writable:!0}):E[x]=R,E}function f(E,x){var R=Object.keys(E);if(Object.getOwnPropertySymbols){var M=Object.getOwnPropertySymbols(E);x&&(M=M.filter(function(K){return Object.getOwnPropertyDescriptor(E,K).enumerable})),R.push.apply(R,M)}return R}function h(E){for(var x=1;x<arguments.length;x++){var R=arguments[x]!=null?arguments[x]:{};x%2?f(Object(R),!0).forEach(function(M){m(E,M,R[M])}):Object.getOwnPropertyDescriptors?Object.defineProperties(E,Object.getOwnPropertyDescriptors(R)):f(Object(R)).forEach(function(M){Object.defineProperty(E,M,Object.getOwnPropertyDescriptor(R,M))})}return E}function g(E){if(Array.isArray(E))return E}n("e01a"),n("d28b"),n("e260"),n("d3b7"),n("3ca3"),n("ddb0");function v(E,x){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(E)))){var R=[],M=!0,K=!1,te=void 0;try{for(var de=E[Symbol.iterator](),be;!(M=(be=de.next()).done)&&(R.push(be.value),!(x&&R.length===x));M=!0);}catch(ke){K=!0,te=ke}finally{try{!M&&de.return!=null&&de.return()}finally{if(K)throw te}}return R}}n("a630"),n("fb6a"),n("b0c0"),n("25f0");function y(E,x){(x==null||x>E.length)&&(x=E.length);for(var R=0,M=new Array(x);R<x;R++)M[R]=E[R];return M}function _(E,x){if(E){if(typeof E=="string")return y(E,x);var R=Object.prototype.toString.call(E).slice(8,-1);if(R==="Object"&&E.constructor&&(R=E.constructor.name),R==="Map"||R==="Set")return Array.from(E);if(R==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(R))return y(E,x)}}function S(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function w(E,x){return g(E)||v(E,x)||_(E,x)||S()}function $(E){if(Array.isArray(E))return y(E)}function C(E){if(typeof Symbol<"u"&&Symbol.iterator in Object(E))return Array.from(E)}function I(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function O(E){return $(E)||C(E)||_(E)||I()}var H=n("a352"),G=n.n(H);function k(E){E.parentElement!==null&&E.parentElement.removeChild(E)}function L(E,x,R){var M=R===0?E.children[0]:E.children[R-1].nextSibling;E.insertBefore(x,M)}var B=n("dbf1");n("13d5"),n("4fad"),n("ac1f"),n("5319");function re(E){var x=Object.create(null);return function(M){var K=x[M];return K||(x[M]=E(M))}}var F=/-(\w)/g,U=re(function(E){return E.replace(F,function(x,R){return R.toUpperCase()})});n("5db7"),n("73d9");var oe=["Start","Add","Remove","Update","End"],j=["Choose","Unchoose","Sort","Filter","Clone"],X=["Move"],ye=[X,oe,j].flatMap(function(E){return E}).map(function(E){return"on".concat(E)}),Ce={manage:X,manageAndEmit:oe,emit:j};function Ne(E){return ye.indexOf(E)!==-1}n("caad"),n("2ca0");var Pe=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"];function Re(E){return Pe.includes(E)}function Me(E){return["transition-group","TransitionGroup"].includes(E)}function Fe(E){return["id","class","role","style"].includes(E)||E.startsWith("data-")||E.startsWith("aria-")||E.startsWith("on")}function $e(E){return E.reduce(function(x,R){var M=w(R,2),K=M[0],te=M[1];return x[K]=te,x},{})}function De(E){var x=E.$attrs,R=E.componentData,M=R===void 0?{}:R,K=$e(Object.entries(x).filter(function(te){var de=w(te,2),be=de[0];return de[1],Fe(be)}));return h(h({},K),M)}function Ee(E){var x=E.$attrs,R=E.callBackBuilder,M=$e(Je(x));Object.entries(R).forEach(function(te){var de=w(te,2),be=de[0],ke=de[1];Ce[be].forEach(function(se){M["on".concat(se)]=ke(se)})});var K="[data-draggable]".concat(M.draggable||"");return h(h({},M),{},{draggable:K})}function Je(E){return Object.entries(E).filter(function(x){var R=w(x,2),M=R[0];return R[1],!Fe(M)}).map(function(x){var R=w(x,2),M=R[0],K=R[1];return[U(M),K]}).filter(function(x){var R=w(x,2),M=R[0];return R[1],!Ne(M)})}n("c740");function Ge(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function gt(E,x){for(var R=0;R<x.length;R++){var M=x[R];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(E,M.key,M)}}function Pt(E,x,R){return x&&gt(E.prototype,x),R&&gt(E,R),E}var bt=function(x){var R=x.el;return R},Le=function(x,R){return x.__draggable_context=R},Ue=function(x){return x.__draggable_context},Rt=function(){function E(x){var R=x.nodes,M=R.header,K=R.default,te=R.footer,de=x.root,be=x.realList;Ge(this,E),this.defaultNodes=K,this.children=[].concat(O(M),O(K),O(te)),this.externalComponent=de.externalComponent,this.rootTransition=de.transition,this.tag=de.tag,this.realList=be}return Pt(E,[{key:"render",value:function(R,M){var K=this.tag,te=this.children,de=this._isRootComponent,be=de?{default:function(){return te}}:te;return R(K,M,be)}},{key:"updated",value:function(){var R=this.defaultNodes,M=this.realList;R.forEach(function(K,te){Le(bt(K),{element:M[te],index:te})})}},{key:"getUnderlyingVm",value:function(R){return Ue(R)}},{key:"getVmIndexFromDomIndex",value:function(R,M){var K=this.defaultNodes,te=K.length,de=M.children,be=de.item(R);if(be===null)return te;var ke=Ue(be);if(ke)return ke.index;if(te===0)return 0;var se=bt(K[0]),Y=O(de).findIndex(function(Z){return Z===se});return R<Y?0:te}},{key:"_isRootComponent",get:function(){return this.externalComponent||this.rootTransition}}]),E}(),ut=n("8bbf");function mt(E,x){var R=E[x];return R?R():[]}function ps(E){var x=E.$slots,R=E.realList,M=E.getKey,K=R||[],te=["header","footer"].map(function(Z){return mt(x,Z)}),de=w(te,2),be=de[0],ke=de[1],se=x.item;if(!se)throw new Error("draggable element must have an item slot");var Y=K.flatMap(function(Z,fe){return se({element:Z,index:fe}).map(function(pe){return pe.key=M(Z),pe.props=h(h({},pe.props||{}),{},{"data-draggable":!0}),pe})});if(Y.length!==K.length)throw new Error("Item slot must have only one child");return{header:be,footer:ke,default:Y}}function Ls(E){var x=Me(E),R=!Re(E)&&!x;return{transition:x,externalComponent:R,tag:R?Object(ut.resolveComponent)(E):x?ut.TransitionGroup:E}}function it(E){var x=E.$slots,R=E.tag,M=E.realList,K=E.getKey,te=ps({$slots:x,realList:M,getKey:K}),de=Ls(R);return new Rt({nodes:te,root:de,realList:M})}function _t(E,x){var R=this;Object(ut.nextTick)(function(){return R.$emit(E.toLowerCase(),x)})}function Mt(E){var x=this;return function(R,M){if(x.realList!==null)return x["onDrag".concat(E)](R,M)}}function Kt(E){var x=this,R=Mt.call(this,E);return function(M,K){R.call(x,M,K),_t.call(x,E,M)}}var zt=null,Yt={list:{type:Array,required:!1,default:null},modelValue:{type:Array,required:!1,default:null},itemKey:{type:[String,Function],required:!0},clone:{type:Function,default:function(x){return x}},tag:{type:String,default:"div"},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},Wt=["update:modelValue","change"].concat(O([].concat(O(Ce.manageAndEmit),O(Ce.emit)).map(function(E){return E.toLowerCase()}))),Xt=Object(ut.defineComponent)({name:"draggable",inheritAttrs:!1,props:Yt,emits:Wt,data:function(){return{error:!1}},render:function(){try{this.error=!1;var x=this.$slots,R=this.$attrs,M=this.tag,K=this.componentData,te=this.realList,de=this.getKey,be=it({$slots:x,tag:M,realList:te,getKey:de});this.componentStructure=be;var ke=De({$attrs:R,componentData:K});return be.render(ut.h,ke)}catch(se){return this.error=!0,Object(ut.h)("pre",{style:{color:"red"}},se.stack)}},created:function(){this.list!==null&&this.modelValue!==null&&B.a.error("modelValue and list props are mutually exclusive! Please set one or another.")},mounted:function(){var x=this;if(!this.error){var R=this.$attrs,M=this.$el,K=this.componentStructure;K.updated();var te=Ee({$attrs:R,callBackBuilder:{manageAndEmit:function(ke){return Kt.call(x,ke)},emit:function(ke){return _t.bind(x,ke)},manage:function(ke){return Mt.call(x,ke)}}}),de=M.nodeType===1?M:M.parentElement;this._sortable=new G.a(de,te),this.targetDomElement=de,de.__draggable_component__=this}},updated:function(){this.componentStructure.updated()},beforeUnmount:function(){this._sortable!==void 0&&this._sortable.destroy()},computed:{realList:function(){var x=this.list;return x||this.modelValue},getKey:function(){var x=this.itemKey;return typeof x=="function"?x:function(R){return R[x]}}},watch:{$attrs:{handler:function(x){var R=this._sortable;R&&Je(x).forEach(function(M){var K=w(M,2),te=K[0],de=K[1];R.option(te,de)})},deep:!0}},methods:{getUnderlyingVm:function(x){return this.componentStructure.getUnderlyingVm(x)||null},getUnderlyingPotencialDraggableComponent:function(x){return x.__draggable_component__},emitChanges:function(x){var R=this;Object(ut.nextTick)(function(){return R.$emit("change",x)})},alterList:function(x){if(this.list){x(this.list);return}var R=O(this.modelValue);x(R),this.$emit("update:modelValue",R)},spliceList:function(){var x=arguments,R=function(K){return K.splice.apply(K,O(x))};this.alterList(R)},updatePosition:function(x,R){var M=function(te){return te.splice(R,0,te.splice(x,1)[0])};this.alterList(M)},getRelatedContextFromMoveEvent:function(x){var R=x.to,M=x.related,K=this.getUnderlyingPotencialDraggableComponent(R);if(!K)return{component:K};var te=K.realList,de={list:te,component:K};if(R!==M&&te){var be=K.getUnderlyingVm(M)||{};return h(h({},be),de)}return de},getVmIndexFromDomIndex:function(x){return this.componentStructure.getVmIndexFromDomIndex(x,this.targetDomElement)},onDragStart:function(x){this.context=this.getUnderlyingVm(x.item),x.item._underlying_vm_=this.clone(this.context.element),zt=x.item},onDragAdd:function(x){var R=x.item._underlying_vm_;if(R!==void 0){k(x.item);var M=this.getVmIndexFromDomIndex(x.newIndex);this.spliceList(M,0,R);var K={element:R,newIndex:M};this.emitChanges({added:K})}},onDragRemove:function(x){if(L(this.$el,x.item,x.oldIndex),x.pullMode==="clone"){k(x.clone);return}var R=this.context,M=R.index,K=R.element;this.spliceList(M,1);var te={element:K,oldIndex:M};this.emitChanges({removed:te})},onDragUpdate:function(x){k(x.item),L(x.from,x.item,x.oldIndex);var R=this.context.index,M=this.getVmIndexFromDomIndex(x.newIndex);this.updatePosition(R,M);var K={element:this.context.element,oldIndex:R,newIndex:M};this.emitChanges({moved:K})},computeFutureIndex:function(x,R){if(!x.element)return 0;var M=O(R.to.children).filter(function(be){return be.style.display!=="none"}),K=M.indexOf(R.related),te=x.component.getVmIndexFromDomIndex(K),de=M.indexOf(zt)!==-1;return de||!R.willInsertAfter?te:te+1},onDragMove:function(x,R){var M=this.move,K=this.realList;if(!M||!K)return!0;var te=this.getRelatedContextFromMoveEvent(x),de=this.computeFutureIndex(te,x),be=h(h({},this.context),{},{futureIndex:de}),ke=h(h({},x),{},{relatedContext:te,draggedContext:be});return M(ke,R)},onDragEnd:function(){zt=null}}}),Jt=Xt;r.default=Jt},fb6a:function(s,r,n){var d=n("23e7"),i=n("861d"),l=n("e8b5"),m=n("23cb"),f=n("50c4"),h=n("fc6a"),g=n("8418"),v=n("b622"),y=n("1dde"),_=n("ae40"),S=y("slice"),w=_("slice",{ACCESSORS:!0,0:0,1:2}),$=v("species"),C=[].slice,I=Math.max;d({target:"Array",proto:!0,forced:!S||!w},{slice:function(H,G){var k=h(this),L=f(k.length),B=m(H,L),re=m(G===void 0?L:G,L),F,U,oe;if(l(k)&&(F=k.constructor,typeof F=="function"&&(F===Array||l(F.prototype))?F=void 0:i(F)&&(F=F[$],F===null&&(F=void 0)),F===Array||F===void 0))return C.call(k,B,re);for(U=new(F===void 0?Array:F)(I(re-B,0)),oe=0;B<re;B++,oe++)B in k&&g(U,oe,k[B]);return U.length=oe,U}})},fc6a:function(s,r,n){var d=n("44ad"),i=n("1d80");s.exports=function(l){return d(i(l))}},fdbc:function(s,r){s.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},fdbf:function(s,r,n){var d=n("4930");s.exports=d&&!Symbol.sham&&typeof Symbol.iterator=="symbol"}}).default})})(Lo);var im=Lo.exports;const Fs=pa(im);const lm={components:{draggable:Fs,ModalComponent:Xe,Pencil:$t,Copy:ms,Trash2:Bt,Link:lo,Lock:Ud,Edit3:io},props:["categories","payTypes","seriesId"],emits:["save","show","close"],data(){return{formError:[],formInputData:{},formCats:[],editCatId:null,show:!1,editFormData:{},seriesCategories:[],seriesPaymentGroups:[],loadingSeriesData:!1}},async mounted(){this.formCats=this.categories.map(t=>Object.assign({},t,{isExisting:!0})),this.seriesId&&await this.fetchSeriesData()},watch:{categories:{handler(t){this.resetFormData()},deep:!0},async seriesId(t){t?await this.fetchSeriesData():(this.seriesCategories=[],this.seriesPaymentGroups=[])}},computed:{payTypeOptions(){const t={};for(const[e,a]of Object.entries(this.payTypes))e!=="season"&&e!=="cash"&&(t[e]=a);return{null:"Not required",...t}},categoriesBySource(){const t=new Set(this.seriesCategories.map(e=>e.id));return{series:this.formCats.filter(e=>t.has(e.id)&&!e.isRaceOverride),raceOverrides:this.formCats.filter(e=>e.isRaceOverride),raceSpecific:this.formCats.filter(e=>!t.has(e.id)&&!e.isRaceOverride)}}},methods:{async fetchSeriesData(){if(this.seriesId){this.loadingSeriesData=!0;try{const t=await W(`/api/series/${this.seriesId}`);if(t.data){this.seriesCategories=t.data.regCategories||[],this.seriesPaymentGroups=t.data.categoryGroups||[];const e=new Set(this.seriesCategories.map(a=>a.id));this.formCats=this.formCats.map(a=>({...a,isFromSeries:e.has(a.id)&&!a._isRaceOverride,isRaceOverride:a._isRaceOverride===!0}))}}catch(t){console.error("Error fetching series data:",t)}finally{this.loadingSeriesData=!1}}},resetFormData(){this.formCats=this.categories.map(t=>{const e=this.seriesCategories.some(a=>a.id===t.id)&&!t._isRaceOverride;return Object.assign({},t,{isExisting:!0,isFromSeries:e,isRaceOverride:t._isRaceOverride===!0})}),this.editCatId=null},getCategoryPaymentInfo(t){var e;if(t.paytype)return{type:"forced",label:this.payTypeOptions[t.paytype]||t.paytype};if(t.isFromSeries&&this.seriesPaymentGroups.length>0){for(const a of this.seriesPaymentGroups)if(a.categories&&a.categories.includes(t.id)){const c=((e=a.paymentOptions)==null?void 0:e.map(s=>s.name).join(", "))||"No payments";return{type:"series-group",label:a.name,payments:c}}}return{type:"any",label:"Any payment type"}},async submitHandler(){let t=this.formCats.filter(e=>!e.isFromSeries).map((e,a)=>{let c=Object.assign({},e);return c.paytype=="null"&&delete c.paytype,c.disporder=a+1,delete c.isExisting,delete c.isFromSeries,delete c.isRaceOverride,c});console.log("Saving categories to database:",t),await W.patch(`/api/races/${this.$route.params.raceid}`,{regCategories:t}).then(e=>{e.data&&this.$emit("save",t)}).catch(e=>{this.formError=["Error submitting request"],console.log(e)})},submitForm(t){t.stopPropagation(),this.$formkit.submit("editingCategoryForm")},saveCategory(t){let e=this.formCats[this.editCatId];!e.isExisting&&e.catdispname!==t.catdispname?e.id=this.formatNameToId(t.catdispname):e.id||(e.id=this.formatNameToId(t.catdispname)),Object.assign(e,t),e.paytype===null&&delete e.paytype,e.sponsored?delete e.paytype:delete e.sponsorName,console.log("update: ",e),this.formCats.splice(this.editCatId,1,e),this.editCatId=null,this.editFormData={}},formatNameToId(t){return t.replace(/\s+/g,"_").toLowerCase().replace("+","_plus_").replace("-","_minus_").replace(/\W/g,"")},onDragStart(t){},onDragEnd(){},editCategoryData(t){this.editCatId===null&&(this.editCatId=t,this.editFormData={...this.formCats[t]})},cancelEdit(t){t.stopPropagation(),this.editCatId=null,this.editFormData={}},addRaceSpecificCategory(){const t={id:"race_category_"+Date.now(),catdispname:"New Race Category",laps:1,isExisting:!1,isFromSeries:!1};this.formCats.push(t),this.editCatId=this.formCats.length-1,this.editFormData={...t}},removeAllRaceSpecificCategories(){const t=this.categoriesBySource.raceSpecific.length,e=`Remove all ${t} race-specific ${t===1?"category":"categories"}?

This will keep only the ${this.categoriesBySource.series.length} series-inherited ${this.categoriesBySource.series.length===1?"category":"categories"}.

This action cannot be undone.`;confirm(e)&&(this.formCats=this.formCats.filter(a=>a.isFromSeries),this.emitUpdate(),alert(`Removed ${t} race-specific ${t===1?"category":"categories"}.`))},overrideAllSeriesCategories(){const t=this.categoriesBySource.series.length;if(t===0){alert("No series categories to override.");return}const e=`Override all ${t} series ${t===1?"category":"categories"}?

This will create race-specific copies that you can customize (laps, age restrictions, payment types, etc.).

The categories will no longer automatically sync with series changes.`;confirm(e)&&(this.formCats=this.formCats.map(a=>a.isFromSeries?{...a,isFromSeries:!1,isRaceOverride:!0,isExisting:!1}:a),alert(`Overridden ${t} series ${t===1?"category":"categories"}.

You can now customize them for this race.`))},copyCategory(t,e){t.stopPropagation();const a=this.formCats[e];if(a.isFromSeries){const c={...a};c.catdispname=c.catdispname+" (override)",c.isFromSeries=!1,c.isRaceOverride=!0,c.isExisting=!1,this.formCats.splice(e,1,c)}else{const c={...a};c.catdispname=c.catdispname+" (copy)",c.id=this.formatNameToId(c.catdispname),c.isExisting=!1,c.isFromSeries=!1,c.isRaceOverride=!1,this.formCats.splice(e+1,0,c)}},deleteCategory(t,e){t.stopPropagation();const a=this.formCats[e];if(a.isFromSeries){alert(`Cannot delete series categories. They are inherited from the series and will reappear on reload.

To customize a series category for this race, use the "Override" button instead.`);return}if(a.isRaceOverride){if(!confirm(`Delete this race override?

This will remove the race-specific customization for "${a.catdispname}".
The original series category will be restored immediately.`))return;const c=this.seriesCategories.find(s=>s.id===a.id);if(c){const s={...c,disporder:a.disporder,isFromSeries:!0,isRaceOverride:!1,isExisting:!0};this.formCats.splice(e,1,s);return}}this.formCats.splice(e,1)},cancelModal(){this.resetFormData(),this.$emit("close")},checkMove:function(t){return this.editCatId===null}}},cm=o("h5",null," Edit Race Categories ",-1),dm={class:"edit-categories-form"},um={key:0,class:"series-info-banner mb-3"},mm={class:"series-info-text flex-grow-1"},hm=o("strong",null,"Series Integration:",-1),fm={key:0},pm={key:1},gm={class:"d-flex gap-2"},vm=["disabled","title"],ym=["disabled","title"],bm=["onClick"],_m={key:0,class:"alert alert-info d-flex align-items-start gap-2 py-2 px-3 mb-3"},Cm=o("div",{class:"d-flex align-items-center gap-1"},[o("strong",null,"Series Category")],-1),Dm={class:"d-block mt-1"},Sm=o("strong",null,"Locked:",-1),xm=o("br",null,null,-1),Em=o("strong",null,"Editable:",-1),wm={key:1,class:"alert alert-warning d-flex align-items-start gap-2 py-2 px-3 mb-3"},Pm=o("div",null,[o("div",{class:"d-flex align-items-center gap-1"},[o("strong",null,"Race Override")]),o("small",{class:"d-block mt-1"}," This category overrides the series category with the same ID. All fields are editable for this race only. ")],-1),Rm={class:"double"},Tm={class:"formkit-outer",style:{width:"calc(50% - 0.5em)"}},Om={class:"form-label small fw-bold d-flex align-items-center"},Im={key:0,class:"text-muted ms-2 d-flex align-items-center"},km=["disabled"],$m={key:0,class:"text-muted"},Am={key:1,class:"text-muted"},Mm={key:2,class:"text-muted"},Fm={class:"formkit-outer",style:{width:"calc(50% - 0.5em)"}},Nm={class:"form-label small fw-bold d-flex align-items-center"},Lm={key:0,class:"text-success ms-2 d-flex align-items-center"},Um={key:0,class:"text-muted"},jm={key:1,class:"text-muted"},Vm={class:"double"},Hm={class:"formkit-outer",style:{width:"calc(50% - 0.5em)"}},Bm={class:"form-label small fw-bold d-flex align-items-center"},Gm={key:0,class:"text-success ms-2 d-flex align-items-center"},Km={class:"text-muted"},zm={class:"formkit-outer",style:{width:"calc(50% - 0.5em)"}},Ym={class:"form-label small fw-bold d-flex align-items-center"},Wm={key:0,class:"text-success ms-2 d-flex align-items-center"},Xm={class:"text-muted"},Jm={class:"double"},Qm={key:1,class:"formkit-outer",style:{width:"calc(50% - 0.5em)"}},Zm={class:"form-label small fw-bold d-flex align-items-center"},qm={class:"text-muted ms-2 d-flex align-items-center"},eh=["value"],th=o("small",{class:"text-muted"}," Payment options defined in series category groups ",-1),sh={class:"cat-name"},oh={class:"cat-badges"},nh={key:0,class:"sponsored-badge"},rh=["title"],ah={key:2,class:"paytype-badge"},ih={class:"cat-actions"},lh={class:"cat-position"},ch={class:"modal-footer-buttons mt-3"},dh=o("div",null,null,-1);function uh(t,e,a,c,s,r){const n=A("Link"),d=A("Lock"),i=A("Edit3"),l=A("FormKit"),m=A("Copy"),f=A("Trash2"),h=A("draggable"),g=A("modal-component");return u(),ee(g,{show:s.show,onClose:r.cancelModal},{header:V(()=>[cm,T(" Click to Edit, Drag to reorder categories ")]),body:V(()=>[o("div",dm,[a.seriesId&&s.seriesCategories.length>0?(u(),p("div",um,[D(n,{size:20,class:"series-icon"}),o("div",mm,[hm,T(" "+b(r.categoriesBySource.series.length)+" "+b(r.categoriesBySource.series.length===1?"category is":"categories are")+" inherited from the series. ",1),r.categoriesBySource.raceOverrides.length>0?(u(),p("span",fm,b(r.categoriesBySource.raceOverrides.length)+" race "+b(r.categoriesBySource.raceOverrides.length===1?"override":"overrides")+". ",1)):P("",!0),r.categoriesBySource.raceSpecific.length>0?(u(),p("span",pm,b(r.categoriesBySource.raceSpecific.length)+" race-specific "+b(r.categoriesBySource.raceSpecific.length===1?"category":"categories")+". ",1)):P("",!0)]),o("div",gm,[o("button",{class:"btn btn-sm btn-outline-primary",onClick:e[0]||(e[0]=(...v)=>r.addRaceSpecificCategory&&r.addRaceSpecificCategory(...v)),type:"button"}," + Add Race Category "),o("button",{class:"btn btn-sm btn-outline-warning",onClick:e[1]||(e[1]=(...v)=>r.overrideAllSeriesCategories&&r.overrideAllSeriesCategories(...v)),type:"button",disabled:r.categoriesBySource.series.length===0,title:r.categoriesBySource.series.length===0?"No series categories to override":"Override all series categories for race-specific customization"}," Override All Series Categories ",8,vm),o("button",{class:"btn btn-sm btn-outline-danger",onClick:e[2]||(e[2]=(...v)=>r.removeAllRaceSpecificCategories&&r.removeAllRaceSpecificCategories(...v)),type:"button",disabled:r.categoriesBySource.raceSpecific.length===0,title:r.categoriesBySource.raceSpecific.length===0?"No race-specific categories to remove":"Remove Non-Series categories"}," Remove Non-Series Categories ",8,ym)])])):P("",!0),D(h,{modelValue:s.formCats,"onUpdate:modelValue":e[10]||(e[10]=v=>s.formCats=v),onEnd:r.onDragEnd,onStart:r.onDragStart,"item-key":"id",move:r.checkMove},{item:V(({element:v,index:y})=>[o("div",{class:"cat-group",onClick:_=>r.editCategoryData(y)},[s.editCatId===y?(u(),ee(l,{key:0,type:"form",id:"editingCategoryForm",label:"Category Name",validation:"required",onSubmit:r.saveCategory,actions:!1,modelValue:s.editFormData,"onUpdate:modelValue":e[9]||(e[9]=_=>s.editFormData=_)},{default:V(()=>[s.editFormData.isFromSeries?(u(),p("div",_m,[D(n,{size:18,class:"mt-1 flex-shrink-0"}),o("div",null,[Cm,o("small",Dm,[D(d,{size:14,class:"me-1",style:{display:"inline-block","vertical-align":"middle"}}),Sm,T(" Category name & payment type (edit in series)"),xm,D(i,{size:14,class:"me-1",style:{display:"inline-block","vertical-align":"middle"}}),Em,T(" Laps, start time, and age restrictions (race-specific overrides) ")])])])):s.editFormData.isRaceOverride?(u(),p("div",wm,[D(i,{size:18,class:"mt-1 flex-shrink-0"}),Pm])):P("",!0),o("div",Rm,[o("div",Tm,[o("label",Om,[T(" Category Name "),s.editFormData.isFromSeries?(u(),p("span",Im,[D(d,{size:14,class:"me-1"}),T(" Locked ")])):P("",!0)]),le(o("input",{type:"text",class:ne(["form-control form-control-sm",{"bg-light":s.editFormData.isFromSeries}]),"onUpdate:modelValue":e[3]||(e[3]=_=>s.editFormData.catdispname=_),disabled:s.editFormData.isFromSeries,required:""},null,10,km),[[ge,s.editFormData.catdispname]]),s.editFormData.isFromSeries?(u(),p("small",$m," Edit in series settings ")):s.editFormData.isRaceOverride?(u(),p("small",Am," Race-specific override ")):(u(),p("small",Mm," Display name for this category "))]),o("div",Fm,[o("label",Nm,[T(" Laps "),s.editFormData.isFromSeries?(u(),p("span",Lm,[D(i,{size:14,class:"me-1"}),T(" Race Override ")])):P("",!0)]),le(o("input",{type:"number",class:"form-control form-control-sm","onUpdate:modelValue":e[4]||(e[4]=_=>s.editFormData.laps=_),min:"0"},null,512),[[ge,s.editFormData.laps,void 0,{number:!0}]]),s.editFormData.isFromSeries?(u(),p("small",Um," Customize for this race ")):(u(),p("small",jm," Number of laps "))])]),o("div",Vm,[o("div",Hm,[o("label",Bm,[T(" Minimum Age "),s.editFormData.isFromSeries?(u(),p("span",Gm,[D(i,{size:14,class:"me-1"}),T(" Race Override ")])):P("",!0)]),le(o("input",{type:"number",class:"form-control form-control-sm","onUpdate:modelValue":e[5]||(e[5]=_=>s.editFormData.minAge=_),min:"0",placeholder:"No minimum"},null,512),[[ge,s.editFormData.minAge,void 0,{number:!0}]]),o("small",Km,b(s.editFormData.isFromSeries?"Override series age restriction":"Enforces age restrictions"),1)]),o("div",zm,[o("label",Ym,[T(" Maximum Age "),s.editFormData.isFromSeries?(u(),p("span",Wm,[D(i,{size:14,class:"me-1"}),T(" Race Override ")])):P("",!0)]),le(o("input",{type:"number",class:"form-control form-control-sm","onUpdate:modelValue":e[6]||(e[6]=_=>s.editFormData.maxAge=_),min:"0",placeholder:"No maximum"},null,512),[[ge,s.editFormData.maxAge,void 0,{number:!0}]]),o("small",Xm,b(s.editFormData.isFromSeries?"Override series age restriction":"Category hidden if outside range"),1)])]),o("div",Jm,[D(l,{type:"checkbox",name:"sponsored",label:"Sponsored",disabled:s.editFormData.isFromSeries,help:s.editFormData.isFromSeries?"Managed at series level":"If checked, no entry fee will be charged"},null,8,["disabled","help"]),!s.editFormData.sponsored&&(!s.editFormData.isFromSeries||s.editFormData.isRaceOverride)?(u(),ee(l,{key:0,type:"select",name:"paytype",label:"Category Payment Type",help:s.editFormData.isRaceOverride?"Race-specific payment type override":"Force payment type when this category is selected",options:r.payTypeOptions},null,8,["help","options"])):s.editFormData.isFromSeries&&!s.editFormData.sponsored&&!s.editFormData.isRaceOverride?(u(),p("div",Qm,[o("label",Zm,[T(" Payment Type "),o("span",qm,[D(d,{size:14,class:"me-1"}),T(" From Series ")])]),o("input",{type:"text",class:"form-control form-control-sm bg-light",value:r.getCategoryPaymentInfo(s.editFormData).label,disabled:""},null,8,eh),th])):s.editFormData.sponsored?(u(),ee(l,{key:2,type:"text",name:"sponsorName",label:"Sponsor Name",validation:"required"})):P("",!0)]),o("button",{class:"btn btn-primary my-3 mx-2",type:"button",onClick:e[7]||(e[7]=(..._)=>r.submitForm&&r.submitForm(..._))},"Save"),o("button",{class:"btn btn-danger my-3 mx-2",type:"button",onClick:e[8]||(e[8]=(..._)=>r.cancelEdit&&r.cancelEdit(..._))},"Cancel")]),_:1},8,["onSubmit","modelValue"])):(u(),p("div",{key:1,class:ne(["cat-row",{"from-series":v.isFromSeries,"race-override":v.isRaceOverride}])},[o("div",sh,[v.isFromSeries?(u(),ee(n,{key:0,size:16,class:"series-icon me-1",title:"Inherited from series"})):v.isRaceOverride?(u(),ee(i,{key:1,size:16,class:"override-icon me-1",title:"Race override of series category"})):P("",!0),T(" "+b(v.catdispname),1)]),o("div",oh,[v.sponsored?(u(),p("strong",nh,"Sponsored")):v.isFromSeries&&r.getCategoryPaymentInfo(v).type==="series-group"?(u(),p("span",{key:1,class:"series-group-badge",title:r.getCategoryPaymentInfo(v).payments},b(r.getCategoryPaymentInfo(v).label),9,rh)):v.paytype&&!v.sponsored?(u(),p("span",ah,b(r.payTypeOptions[v.paytype]),1)):P("",!0)]),o("div",ih,[o("label",lh,b(y+1)+" of "+b(s.formCats.length),1),v.isFromSeries?(u(),ee(i,{key:1,class:"action-icon override-icon",color:"#1565c0",onClick:_=>r.copyCategory(_,y),title:"Override series category - customize for this race"},null,8,["onClick"])):(u(),ee(m,{key:0,class:"action-icon",color:"black",onClick:_=>r.copyCategory(_,y),title:"Duplicate this category"},null,8,["onClick"])),D(f,{class:ne(["action-icon",{"disabled-icon":v.isFromSeries}]),color:v.isFromSeries?"#ccc":"black",onClick:_=>r.deleteCategory(_,y),title:v.isFromSeries?"Cannot delete series categories":"Delete this category"},null,8,["class","color","onClick","title"])])],2))],8,bm)]),_:1},8,["modelValue","onEnd","onStart","move"])]),o("div",ch,[o("button",{class:"btn btn-sm btn-primary px-5 mx-3",onClick:e[11]||(e[11]=(...v)=>r.submitHandler&&r.submitHandler(...v))},"Save"),o("button",{class:"btn btn-sm btn-danger px-3 mx-3",onClick:e[12]||(e[12]=(...v)=>r.cancelModal&&r.cancelModal(...v))},"Cancel")])]),footer:V(()=>[dh]),_:1},8,["show","onClose"])}const mh=ve(lm,[["render",uh]]);const hh={components:{draggable:Fs,ModalComponent:Xe,Pencil:$t,FilePlus:No,Trash2:Bt},props:["coupons","show"],emits:["save","close"],data(){return{formError:[],formCoupons:[]}},mounted(){this.loadCoupons()},watch:{coupons:{handler(){this.loadCoupons()},immediate:!0}},methods:{loadCoupons(){if(console.log("Loading coupons:",this.coupons),this.formCoupons=[],!this.coupons||typeof this.coupons!="object"){console.log("No coupons to load");return}Object.keys(this.coupons).forEach(t=>{let e=this.coupons[t],a=0;e.fractionDiscount!==void 0&&e.fractionDiscount!==null?a=e.fractionDiscount*100:e.percentDiscount!==void 0&&e.percentDiscount!==null&&(a=e.percentDiscount),this.formCoupons.push({code:t,percentDiscount:a,singleUse:e.singleUse||!1})}),console.log("Loaded formCoupons:",this.formCoupons)},async submitHandler(){let t={};this.formCoupons.forEach(e=>{if(!t[e.code]){let a=parseFloat(e.percentDiscount)||0;t[e.code]={fractionDiscount:a/100,singleUse:e.singleUse||!1}}}),console.log("Saving coupons:",t),await W.patch(`/api/races/${this.$route.params.raceid}`,{couponCodes:t}).then(e=>{e.data&&(this.$emit("save",t),console.log(e.data))}).catch(e=>{this.formError=["Error submitting request"],console.log(e)})},createCoupon(){this.formCoupons.push({code:"NEWCODE",percentDiscount:10,singleUse:!1})},deleteCoupon(t){this.formCoupons.splice(t,1)}}},Ns=t=>(at("data-v-2eb1f802"),t=t(),rt(),t),fh={class:"d-flex justify-content-between align-items-center w-100"},ph=Ns(()=>o("h5",{class:"mb-0"},"Edit Discount Coupons",-1)),gh={class:"edit-coupons-form"},vh={key:0,class:"text-center text-muted py-4"},yh={class:"coupon-fields"},bh={class:"field-group"},_h=Ns(()=>o("label",{class:"field-label"},"Code",-1)),Ch=["onUpdate:modelValue"],Dh={class:"field-group"},Sh=Ns(()=>o("label",{class:"field-label"},"Discount %",-1)),xh=["onUpdate:modelValue"],Eh={class:"field-group checkbox-group"},wh={class:"form-check-label"},Ph=["onUpdate:modelValue"],Rh={class:"field-group"},Th=["onClick"],Oh={class:"modal-footer-buttons mt-3"},Ih=Ns(()=>o("div",null,null,-1));function kh(t,e,a,c,s,r){const n=A("FilePlus"),d=A("Trash2"),i=A("modal-component");return u(),ee(i,{show:a.show,onClose:e[3]||(e[3]=l=>t.$emit("close"))},{header:V(()=>[o("div",fh,[ph,o("button",{class:"btn btn-sm btn-success",onClick:e[0]||(e[0]=(...l)=>r.createCoupon&&r.createCoupon(...l))},[D(n,{size:16,class:"me-1"}),T(" Add Coupon ")])])]),body:V(()=>[o("div",gh,[s.formCoupons.length===0?(u(),p("div",vh,' No coupons yet. Click "Add Coupon" to create one. ')):P("",!0),(u(!0),p(Q,null,ie(s.formCoupons,(l,m)=>(u(),p("div",{key:m,class:"coupon-row"},[o("div",yh,[o("div",bh,[_h,le(o("input",{type:"text","onUpdate:modelValue":f=>l.code=f,class:"form-control form-control-sm",placeholder:"COUPON10"},null,8,Ch),[[ge,l.code]])]),o("div",Dh,[Sh,le(o("input",{type:"number","onUpdate:modelValue":f=>l.percentDiscount=f,class:"form-control form-control-sm",min:"0",max:"100",step:"0.01"},null,8,xh),[[ge,l.percentDiscount,void 0,{number:!0}]])]),o("div",Eh,[o("label",wh,[le(o("input",{type:"checkbox","onUpdate:modelValue":f=>l.singleUse=f,class:"form-check-input"},null,8,Ph),[[ds,l.singleUse]]),T(" Single Use ")])]),o("div",Rh,[o("button",{class:"btn btn-sm btn-danger",onClick:f=>r.deleteCoupon(m),title:"Delete coupon"},[D(d,{size:16})],8,Th)])])]))),128))]),o("div",Oh,[o("button",{class:"btn btn-sm btn-primary px-5 mx-3",onClick:e[1]||(e[1]=(...l)=>r.submitHandler&&r.submitHandler(...l))},"Save All"),o("button",{class:"btn btn-sm btn-secondary px-3 mx-3",onClick:e[2]||(e[2]=l=>t.$emit("close"))},"Cancel")])]),footer:V(()=>[Ih]),_:1},8,["show"])}const $h=ve(hh,[["render",kh],["__scopeId","data-v-2eb1f802"]]);const Ah={components:{ModalComponent:Xe,Pencil:$t,Copy:ms,Trash2:Bt},props:["paymentOptions"],emits:["save","show","close"],data(){return{formError:[],formInputData:{},formPayTypes:[],show:!1}},mounted(){this.formPayTypes=this.paymentOptions.map(t=>Object.assign({},t))},computed:{paymentTypeOptions(){return{season:"Pays for all races in the series",single:"Pays for only the current race",custom:"create a custom paytype category, single race only"}}},methods:{async submitHandler(){const t=this.formPayTypes.map(e=>({name:e.name,type:e.type,amount:e.amount}));console.log("Submitting payment options:",t),await W.patch(`/api/races/${this.$route.params.raceid}`,{paymentOptions:t}).then(e=>{e.data&&(this.$emit("save",t),this.$emit("close"))}).catch(e=>{this.formError=["Error submitting request"],console.log(e)})},addPaytype(){this.formPayTypes.push({name:"",type:"",amount:""})},addSpecialPaytype(t){if(this.formPayTypes.some(c=>c.type===t)){alert(`A ${t} payment type already exists`);return}const a={type:t,amount:t==="cash"?"0":""};t==="season"?a.name="Season Pass":t==="cash"&&(a.name="Cash Payment (at event)"),this.formPayTypes.push(a)},deletePaytype(t){confirm("Are you sure you want to delete this payment type?")&&this.formPayTypes.splice(t,1)},isSpecialType(t){return t==="season"||t==="cash"}}},Mh=o("h5",null," Edit Payments ",-1),Fh={class:"edit-categories-form"},Nh={class:"cat-group"},Lh={class:"payment-header"},Uh=["onClick"],jh={class:"triple"},Vh={class:"add-buttons mt-3"},Hh={class:"modal-footer-buttons mt-3"},Bh=o("div",null,null,-1);function Gh(t,e,a,c,s,r){const n=A("Trash2"),d=A("FormKit"),i=A("modal-component");return u(),ee(i,{show:s.show,onClose:e[5]||(e[5]=l=>t.emit("close"))},{header:V(()=>[Mh]),body:V(()=>[o("div",Fh,[(u(!0),p(Q,null,ie(s.formPayTypes,(l,m)=>(u(),p("div",{key:m,class:"cat-group-container"},[o("div",Nh,[o("div",Lh,[o("h6",null,"Payment Type "+b(m+1),1),o("button",{class:"btn btn-sm btn-danger",onClick:f=>r.deletePaytype(m)},[D(n,{size:16})],8,Uh)]),o("div",jh,[D(d,{type:"text",modelValue:l.name,"onUpdate:modelValue":f=>l.name=f,label:"Description",validation:"required"},null,8,["modelValue","onUpdate:modelValue"]),D(d,{type:"text",modelValue:l.type,"onUpdate:modelValue":f=>l.type=f,label:"Type ID",help:r.isSpecialType(l.type)?"Special type: "+l.type:"Maps to registration category",validation:"required",disabled:r.isSpecialType(l.type)},null,8,["modelValue","onUpdate:modelValue","help","disabled"]),D(d,{type:"number",modelValue:l.amount,"onUpdate:modelValue":f=>l.amount=f,label:"Amount ($)",number:"integer",validation:"required"},null,8,["modelValue","onUpdate:modelValue"])])])]))),128)),o("div",Vh,[o("button",{class:"btn btn-sm btn-success mx-2",onClick:e[0]||(e[0]=(...l)=>r.addPaytype&&r.addPaytype(...l))}," + Add Custom Payment Type "),o("button",{class:"btn btn-sm btn-info mx-2",onClick:e[1]||(e[1]=l=>r.addSpecialPaytype("season"))}," + Add Season Pass "),o("button",{class:"btn btn-sm btn-info mx-2",onClick:e[2]||(e[2]=l=>r.addSpecialPaytype("cash"))}," + Add Cash Payment ")])]),o("div",Hh,[o("button",{class:"btn btn-sm btn-primary px-5 mx-3",onClick:e[3]||(e[3]=(...l)=>r.submitHandler&&r.submitHandler(...l))},"Save"),o("button",{class:"btn btn-sm btn-danger px-3 mx-3",onClick:e[4]||(e[4]=l=>t.$emit("close"))},"Cancel")])]),footer:V(()=>[Bh]),_:1},8,["show"])}const Kh=ve(Ah,[["render",Gh]]);const zh={components:{ModalComponent:Xe,Trash2:Bt,FilePlus:No},props:["optionalPurchases","show"],emits:["save","close"],data(){return{formError:[],formPurchases:[],showHtmlHelp:{}}},mounted(){this.loadPurchases()},watch:{optionalPurchases:{handler(){this.loadPurchases()},immediate:!0}},methods:{loadPurchases(){if(console.log("Loading optional purchases:",this.optionalPurchases),!this.optionalPurchases||!Array.isArray(this.optionalPurchases)){this.formPurchases=[];return}this.formPurchases=this.optionalPurchases.map(t=>({id:t.id||this.generateId(),label:t.label||"",description:t.description||"",amount:t.amount||"0",optionsLabel:t.optionsLabel||"",options:t.options?[...t.options]:[]})),console.log("Loaded formPurchases:",this.formPurchases)},generateId(){return"opt_"+Math.random().toString(36).substr(2,9)},async submitHandler(){const t=this.formPurchases.map(e=>{const a={id:e.id,label:e.label,description:e.description,amount:e.amount};if(e.optionsLabel&&e.optionsLabel.trim()&&(a.optionsLabel=e.optionsLabel),e.options&&e.options.length>0){const c=e.options.filter(s=>s&&s.trim());c.length>0&&(a.options=c)}return a});console.log("Saving optional purchases:",t),await W.patch(`/api/races/${this.$route.params.raceid}`,{optionalPurchases:t}).then(e=>{e.data&&(this.$emit("save",t),console.log(e.data))}).catch(e=>{this.formError=["Error submitting request"],console.log(e)})},addPurchase(){this.formPurchases.push({id:this.generateId(),label:"",description:"",amount:"0",optionsLabel:"",options:[]})},deletePurchase(t){confirm("Are you sure you want to delete this optional purchase?")&&this.formPurchases.splice(t,1)},addOption(t){this.formPurchases[t].options||(this.formPurchases[t].options=[]),this.formPurchases[t].options.push("")},removeOption(t,e){this.formPurchases[t].options.splice(e,1)},toggleHtmlHelp(t){this.showHtmlHelp[t]=!this.showHtmlHelp[t]},insertHtmlTemplate(t,e){const a=this.formPurchases[t].description||"",c=a.trim()?" ":"";this.formPurchases[t].description=a+c+e}}},Et=t=>(at("data-v-43f3ae8c"),t=t(),rt(),t),Yh={class:"d-flex justify-content-between align-items-center w-100"},Wh=Et(()=>o("h5",{class:"mb-0"},"Edit Optional Purchases",-1)),Xh={class:"edit-purchases-form"},Jh={key:0,class:"text-center text-muted py-4"},Qh={class:"purchase-header"},Zh=["onClick"],qh={class:"purchase-fields"},ef={class:"description-field"},tf={class:"d-flex justify-content-between align-items-center mb-2"},sf=Et(()=>o("label",{class:"form-label mb-0"},"Description",-1)),of=["onClick"],nf={key:0,class:"html-help-panel mb-2"},rf=Et(()=>o("div",{class:"help-title"},"Quick Insert:",-1)),af={class:"help-buttons"},lf=["onClick"],cf=["onClick"],df=["onClick"],uf=["onClick"],mf=Et(()=>o("div",{class:"help-examples"},[o("small",{class:"text-muted"},[o("strong",null,"Examples:"),o("br"),T(" Link: "),o("code",null,"<a href='https://example.com' target='_blank'>Click here</a>"),o("br"),T(" Bold: "),o("code",null,"<strong>text</strong>"),T(" | Italic: "),o("code",null,"<em>text</em>"),T(" | Break: "),o("code",null,"<br>")])],-1)),hf={key:1,class:"description-preview"},ff=Et(()=>o("div",{class:"preview-label"},"Preview:",-1)),pf=["innerHTML"],gf={class:"options-section"},vf={class:"options-header"},yf=Et(()=>o("label",{class:"form-label"},"Options (Optional)",-1)),bf=["onClick"],_f={key:1,class:"options-list"},Cf=["onUpdate:modelValue","placeholder"],Df=["onClick"],Sf=Et(()=>o("small",{class:"text-muted"}," Options allow users to select variants (e.g., shirt sizes: S, M, L, XL) ",-1)),xf={class:"modal-footer-buttons mt-3"},Ef=Et(()=>o("div",null,null,-1));function wf(t,e,a,c,s,r){const n=A("FilePlus"),d=A("Trash2"),i=A("FormKit"),l=A("modal-component");return u(),ee(l,{show:a.show,onClose:e[3]||(e[3]=m=>t.$emit("close"))},{header:V(()=>[o("div",Yh,[Wh,o("button",{class:"btn btn-sm btn-success",onClick:e[0]||(e[0]=(...m)=>r.addPurchase&&r.addPurchase(...m))},[D(n,{size:16,class:"me-1"}),T(" Add Purchase ")])])]),body:V(()=>[o("div",Xh,[s.formPurchases.length===0?(u(),p("div",Jh,' No optional purchases yet. Click "Add Purchase" to create one. ')):P("",!0),(u(!0),p(Q,null,ie(s.formPurchases,(m,f)=>(u(),p("div",{key:m.id,class:"purchase-group"},[o("div",Qh,[o("h6",null,"Optional Purchase "+b(f+1),1),o("button",{class:"btn btn-sm btn-danger",onClick:h=>r.deletePurchase(f)},[D(d,{size:16})],8,Zh)]),o("div",qh,[D(i,{type:"text",modelValue:m.label,"onUpdate:modelValue":h=>m.label=h,label:"Label",help:"Short name shown to user (e.g., 'T-Shirt')",validation:"required"},null,8,["modelValue","onUpdate:modelValue"]),o("div",ef,[o("div",tf,[sf,o("button",{type:"button",class:"btn btn-sm btn-outline-info",onClick:h=>r.toggleHtmlHelp(f)},b(s.showHtmlHelp[f]?"Hide":"Show")+" HTML Help ",9,of)]),s.showHtmlHelp[f]?(u(),p("div",nf,[rf,o("div",af,[o("button",{type:"button",class:"btn btn-sm btn-outline-secondary",onClick:h=>r.insertHtmlTemplate(f,"<a href='https://example.com' target='_blank'>Link Text</a>"),title:"Insert link that opens in new tab"}," + Link ",8,lf),o("button",{type:"button",class:"btn btn-sm btn-outline-secondary",onClick:h=>r.insertHtmlTemplate(f,"<strong>bold text</strong>"),title:"Insert bold text"}," + Bold ",8,cf),o("button",{type:"button",class:"btn btn-sm btn-outline-secondary",onClick:h=>r.insertHtmlTemplate(f,"<em>italic text</em>"),title:"Insert italic text"}," + Italic ",8,df),o("button",{type:"button",class:"btn btn-sm btn-outline-secondary",onClick:h=>r.insertHtmlTemplate(f,"<br>"),title:"Insert line break"}," + Line Break ",8,uf)]),mf])):P("",!0),D(i,{type:"textarea",modelValue:m.description,"onUpdate:modelValue":h=>m.description=h,help:"HTML description shown above the checkbox",rows:"3"},null,8,["modelValue","onUpdate:modelValue"]),m.description&&m.description.trim()?(u(),p("div",hf,[ff,o("div",{class:"preview-content",innerHTML:m.description},null,8,pf)])):P("",!0)]),D(i,{type:"number",modelValue:m.amount,"onUpdate:modelValue":h=>m.amount=h,label:"Amount ($)",number:"float",step:"0.01",validation:"required"},null,8,["modelValue","onUpdate:modelValue"]),o("div",gf,[o("div",vf,[yf,o("button",{type:"button",class:"btn btn-sm btn-outline-primary",onClick:h=>r.addOption(f)}," + Add Option ",8,bf)]),m.options&&m.options.length>0?(u(),ee(i,{key:0,type:"text",modelValue:m.optionsLabel,"onUpdate:modelValue":h=>m.optionsLabel=h,label:"Options Label",help:"Label for the dropdown (e.g., 'Size', 'Color')"},null,8,["modelValue","onUpdate:modelValue"])):P("",!0),m.options&&m.options.length>0?(u(),p("div",_f,[(u(!0),p(Q,null,ie(m.options,(h,g)=>(u(),p("div",{key:g,class:"option-row"},[le(o("input",{type:"text","onUpdate:modelValue":v=>m.options[g]=v,class:"form-control form-control-sm",placeholder:`Option ${g+1}`},null,8,Cf),[[ge,m.options[g]]]),o("button",{type:"button",class:"btn btn-sm btn-outline-danger",onClick:v=>r.removeOption(f,g)},[D(d,{size:14})],8,Df)]))),128))])):P("",!0),Sf])])]))),128))]),o("div",xf,[o("button",{class:"btn btn-sm btn-primary px-5 mx-3",onClick:e[1]||(e[1]=(...m)=>r.submitHandler&&r.submitHandler(...m))},"Save All"),o("button",{class:"btn btn-sm btn-secondary px-3 mx-3",onClick:e[2]||(e[2]=m=>t.$emit("close"))},"Cancel")])]),footer:V(()=>[Ef]),_:1},8,["show"])}const Pf=ve(zh,[["render",wf],["__scopeId","data-v-43f3ae8c"]]);const Rf={components:{Eye:Md,Code:Rd},props:{modelValue:{type:String,default:""},placeholder:{type:String,default:"Enter text..."},showPreview:{type:Boolean,default:!1},minHeight:{type:String,default:"300px"},label:{type:String,default:"Content"}},emits:["update:modelValue"],data(){return{content:"",showHtmlSource:!1,showPreviewPanel:!1,isTyping:!1,colors:[{name:"Black",value:"#000000"},{name:"Dark Gray",value:"#666666"},{name:"Red",value:"#e74c3c"},{name:"Orange",value:"#e67e22"},{name:"Yellow",value:"#f39c12"},{name:"Green",value:"#27ae60"},{name:"Blue",value:"#3498db"},{name:"Purple",value:"#9b59b6"},{name:"Pink",value:"#e91e63"},{name:"Teal",value:"#1abc9c"}],showColorPicker:!1,colorPickerType:null}},mounted(){this.content=this.modelValue||"",this.$refs.editor&&(this.$refs.editor.innerHTML=this.content)},watch:{modelValue(t){t!==this.content&&!this.isTyping&&(this.content=t||"",this.$refs.editor&&document.activeElement!==this.$refs.editor&&(this.$refs.editor.innerHTML=this.content))}},methods:{execCommand(t,e=null){var a;document.execCommand(t,!1,e),(a=this.$refs.editor)==null||a.focus()},insertLink(){const t=prompt("Enter URL:","https://");t&&(this.execCommand("createLink",t),setTimeout(()=>{const e=window.getSelection();if(e.anchorNode){let a=e.anchorNode.parentElement;a.tagName==="A"&&a.setAttribute("target","_blank")}},10))},insertHeading(t){this.execCommand("formatBlock",`h${t}`)},insertList(t){t==="ul"?this.execCommand("insertUnorderedList"):this.execCommand("insertOrderedList")},applyColor(t,e){e==="text"?this.execCommand("foreColor",t):this.execCommand("backColor",t),this.showColorPicker=!1,this.colorPickerType=null},toggleColorPicker(t){this.colorPickerType===t&&this.showColorPicker?(this.showColorPicker=!1,this.colorPickerType=null):(this.showColorPicker=!0,this.colorPickerType=t)},onInput(t){this.isTyping=!0,this.content=t.target.innerHTML,this.$emit("update:modelValue",this.content),setTimeout(()=>{this.isTyping=!1},100)},updateFromSource(){this.$emit("update:modelValue",this.content),this.$nextTick(()=>{this.$refs.editor&&(this.$refs.editor.innerHTML=this.content)})},toggleHtmlSource(){this.showHtmlSource=!this.showHtmlSource,this.showHtmlSource||this.$nextTick(()=>{this.$refs.editor&&(this.$refs.editor.innerHTML=this.content)})},togglePreview(){this.showPreviewPanel=!this.showPreviewPanel}}},wt=t=>(at("data-v-b60f1e5a"),t=t(),rt(),t),Tf={class:"rich-text-editor"},Of={class:"editor-header"},If={key:0,class:"form-label mb-0"},kf={class:"header-buttons"},$f={key:0,class:"editor-section"},Af={class:"toolbar"},Mf={class:"toolbar-group"},Ff=wt(()=>o("strong",null,"B",-1)),Nf=[Ff],Lf=wt(()=>o("em",null,"I",-1)),Uf=[Lf],jf=wt(()=>o("u",null,"U",-1)),Vf=[jf],Hf=wt(()=>o("s",null,"S",-1)),Bf=[Hf],Gf={class:"toolbar-group"},Kf={class:"toolbar-group"},zf={class:"color-picker-wrapper"},Yf=wt(()=>o("span",{style:{position:"relative"}},[T(" A "),o("span",{style:{position:"absolute",bottom:"-2px",left:"0",right:"0",height:"3px",background:"currentColor"}})],-1)),Wf=[Yf],Xf={key:0,class:"color-picker-panel"},Jf={class:"color-grid"},Qf=["title","onClick"],Zf={class:"color-picker-wrapper"},qf=wt(()=>o("span",{style:{position:"relative",padding:"2px 4px",background:"#ffeb3b",color:"#000"}}," A ",-1)),ep=[qf],tp={key:0,class:"color-picker-panel"},sp={class:"color-grid"},op=["title","onClick"],np={class:"toolbar-group"},rp={class:"toolbar-group"},ap={class:"toolbar-group"},ip={class:"toolbar-group"},lp=["data-placeholder"],cp={key:1,class:"html-source-section"},dp=wt(()=>o("small",{class:"text-muted"}," Edit the raw HTML. Switch back to Visual Editor to see the formatted result. ",-1)),up={key:2,class:"preview-section mt-3"},mp={class:"preview-header"},hp=wt(()=>o("strong",null,"Preview",-1)),fp=["innerHTML"];function pp(t,e,a,c,s,r){const n=A("Eye"),d=A("Code");return u(),p("div",Tf,[o("div",Of,[a.label?(u(),p("label",If,b(a.label),1)):P("",!0),o("div",kf,[a.showPreview?(u(),p("button",{key:0,type:"button",class:ne(["btn btn-sm",s.showPreviewPanel?"btn-primary":"btn-outline-primary"]),onClick:e[0]||(e[0]=(...i)=>r.togglePreview&&r.togglePreview(...i))},[D(n,{size:16,class:"me-1"}),T(" "+b(s.showPreviewPanel?"Hide":"Show")+" Preview ",1)],2)):P("",!0),o("button",{type:"button",class:ne(["btn btn-sm btn-outline-secondary",{"ms-2":a.showPreview}]),onClick:e[1]||(e[1]=(...i)=>r.toggleHtmlSource&&r.toggleHtmlSource(...i))},[D(d,{size:16,class:"me-1"}),T(" "+b(s.showHtmlSource?"Visual Editor":"HTML Source"),1)],2)])]),s.showHtmlSource?(u(),p("div",cp,[le(o("textarea",{"onUpdate:modelValue":e[20]||(e[20]=i=>s.content=i),class:"form-control font-monospace",rows:"15",style:es({minHeight:a.minHeight}),onInput:e[21]||(e[21]=(...i)=>r.updateFromSource&&r.updateFromSource(...i))},null,36),[[ge,s.content]]),dp])):(u(),p("div",$f,[o("div",Af,[o("div",Mf,[o("button",{type:"button",onClick:e[2]||(e[2]=i=>r.execCommand("bold")),class:"toolbar-btn",title:"Bold"},Nf),o("button",{type:"button",onClick:e[3]||(e[3]=i=>r.execCommand("italic")),class:"toolbar-btn",title:"Italic"},Uf),o("button",{type:"button",onClick:e[4]||(e[4]=i=>r.execCommand("underline")),class:"toolbar-btn",title:"Underline"},Vf),o("button",{type:"button",onClick:e[5]||(e[5]=i=>r.execCommand("strikeThrough")),class:"toolbar-btn",title:"Strikethrough"},Bf)]),o("div",Gf,[o("button",{type:"button",onClick:e[6]||(e[6]=i=>r.insertHeading(1)),class:"toolbar-btn",title:"Heading 1"}," H1 "),o("button",{type:"button",onClick:e[7]||(e[7]=i=>r.insertHeading(2)),class:"toolbar-btn",title:"Heading 2"}," H2 "),o("button",{type:"button",onClick:e[8]||(e[8]=i=>r.insertHeading(3)),class:"toolbar-btn",title:"Heading 3"}," H3 "),o("button",{type:"button",onClick:e[9]||(e[9]=i=>r.execCommand("formatBlock","p")),class:"toolbar-btn",title:"Paragraph"}," P ")]),o("div",Kf,[o("div",zf,[o("button",{type:"button",onClick:e[10]||(e[10]=i=>r.toggleColorPicker("text")),class:ne(["toolbar-btn",{active:s.showColorPicker&&s.colorPickerType==="text"}]),title:"Text Color"},Wf,2),s.showColorPicker&&s.colorPickerType==="text"?(u(),p("div",Xf,[o("div",Jf,[(u(!0),p(Q,null,ie(s.colors,i=>(u(),p("button",{key:i.value,type:"button",class:"color-swatch",style:es({backgroundColor:i.value}),title:i.name,onClick:l=>r.applyColor(i.value,"text")},null,12,Qf))),128))])])):P("",!0)]),o("div",Zf,[o("button",{type:"button",onClick:e[11]||(e[11]=i=>r.toggleColorPicker("background")),class:ne(["toolbar-btn",{active:s.showColorPicker&&s.colorPickerType==="background"}]),title:"Background Color"},ep,2),s.showColorPicker&&s.colorPickerType==="background"?(u(),p("div",tp,[o("div",sp,[(u(!0),p(Q,null,ie(s.colors,i=>(u(),p("button",{key:i.value,type:"button",class:"color-swatch",style:es({backgroundColor:i.value}),title:i.name,onClick:l=>r.applyColor(i.value,"background")},null,12,op))),128))])])):P("",!0)])]),o("div",np,[o("button",{type:"button",onClick:e[12]||(e[12]=i=>r.insertList("ul")),class:"toolbar-btn",title:"Bullet List"}," • List "),o("button",{type:"button",onClick:e[13]||(e[13]=i=>r.insertList("ol")),class:"toolbar-btn",title:"Numbered List"}," 1. List ")]),o("div",rp,[o("button",{type:"button",onClick:e[14]||(e[14]=i=>r.execCommand("justifyLeft")),class:"toolbar-btn",title:"Align Left"}," ⬅ "),o("button",{type:"button",onClick:e[15]||(e[15]=i=>r.execCommand("justifyCenter")),class:"toolbar-btn",title:"Align Center"}," ↔ "),o("button",{type:"button",onClick:e[16]||(e[16]=i=>r.execCommand("justifyRight")),class:"toolbar-btn",title:"Align Right"}," ➡ ")]),o("div",ap,[o("button",{type:"button",onClick:e[17]||(e[17]=i=>r.insertLink()),class:"toolbar-btn",title:"Insert Link"}," 🔗 Link ")]),o("div",ip,[o("button",{type:"button",onClick:e[18]||(e[18]=i=>r.execCommand("removeFormat")),class:"toolbar-btn",title:"Clear Formatting"}," Clear ")])]),o("div",{ref:"editor",class:"rich-editor",style:es({minHeight:a.minHeight}),contenteditable:"true",onInput:e[19]||(e[19]=(...i)=>r.onInput&&r.onInput(...i)),"data-placeholder":a.placeholder},null,44,lp)])),s.showPreviewPanel&&a.showPreview?(u(),p("div",up,[o("div",mp,[D(n,{size:18,class:"me-2"}),hp]),o("div",{class:"preview-content",innerHTML:s.content},null,8,fp)])):P("",!0)])}const po=ve(Rf,[["render",pp],["__scopeId","data-v-b60f1e5a"]]);const gp={components:{ModalComponent:Xe,RichTextEditor:po},props:["waiver","show"],emits:["save","close"],data(){return{formError:[],waiverData:{format:"html",header:"",text:""},isEditing:!1}},mounted(){this.loadWaiver()},watch:{waiver:{handler(t,e){t!==e&&!this.isEditing&&this.loadWaiver()},immediate:!0},show(t){t&&(this.isEditing=!1,this.loadWaiver())},"waiverData.header"(){this.isEditing=!0},"waiverData.text"(){this.isEditing=!0},"waiverData.format"(){this.isEditing=!0}},methods:{loadWaiver(){if(console.log("Loading waiver:",this.waiver),!this.waiver){this.waiverData={format:"html",header:"",text:""};return}this.waiverData={...this.waiver,format:this.waiver.format||"html",header:this.waiver.header||"",text:this.waiver.text||""},console.log("Loaded waiverData:",this.waiverData)},async submitHandler(){console.log("Saving waiver:",this.waiverData),await W.patch(`/api/races/${this.$route.params.raceid}`,{waiver:this.waiverData}).then(t=>{t.data&&(this.$emit("save",this.waiverData),console.log(t.data))}).catch(t=>{this.formError=["Error submitting request"],console.log(t)})}}},go=t=>(at("data-v-925a1be2"),t=t(),rt(),t),vp=go(()=>o("h5",{class:"mb-0"},"Edit Waiver / Liability Release",-1)),yp={class:"edit-waiver-form"},bp=go(()=>o("div",{class:"alert alert-info py-2 mb-3"},[o("small",null,[o("strong",null,"Tip:"),T(" This waiver text will be shown to users during registration. They must check a box acknowledging they've read and accepted it. ")])],-1)),_p={class:"modal-footer-buttons mt-4"},Cp=go(()=>o("div",null,null,-1));function Dp(t,e,a,c,s,r){const n=A("FormKit"),d=A("RichTextEditor"),i=A("modal-component");return u(),ee(i,{show:a.show,onClose:e[6]||(e[6]=l=>t.$emit("close"))},{header:V(()=>[vp]),body:V(()=>[o("div",yp,[bp,D(n,{type:"select",modelValue:s.waiverData.format,"onUpdate:modelValue":e[0]||(e[0]=l=>s.waiverData.format=l),label:"Format",options:{html:"HTML (Rich Text)",text:"Plain Text"},help:"HTML format allows rich formatting. Plain text shows header and text separately."},null,8,["modelValue","options"]),s.waiverData.format!=="html"?(u(),ee(n,{key:0,type:"text",modelValue:s.waiverData.header,"onUpdate:modelValue":e[1]||(e[1]=l=>s.waiverData.header=l),label:"Header",help:"Header text (shown in plain text mode only)"},null,8,["modelValue"])):P("",!0),s.waiverData.format==="html"?(u(),ee(d,{key:1,modelValue:s.waiverData.text,"onUpdate:modelValue":e[2]||(e[2]=l=>s.waiverData.text=l),label:"Waiver Text",placeholder:"Enter your waiver/liability release text here...","show-preview":!0,"min-height":"400px"},null,8,["modelValue"])):(u(),ee(n,{key:2,type:"textarea",modelValue:s.waiverData.text,"onUpdate:modelValue":e[3]||(e[3]=l=>s.waiverData.text=l),label:"Waiver Text",rows:"10"},null,8,["modelValue"]))]),o("div",_p,[o("button",{class:"btn btn-sm btn-primary px-5 mx-3",onClick:e[4]||(e[4]=(...l)=>r.submitHandler&&r.submitHandler(...l))},"Save Waiver"),o("button",{class:"btn btn-sm btn-secondary px-3 mx-3",onClick:e[5]||(e[5]=l=>t.$emit("close"))},"Cancel")])]),footer:V(()=>[Cp]),_:1},8,["show"])}const Sp=ve(gp,[["render",Dp],["__scopeId","data-v-925a1be2"]]);const xp={components:{ModalComponent:Xe},props:["eventDetails","show"],emits:["save","close"],data(){return{formError:[],eventDetailsData:{name:"",formattedDates:"",tagline:"",logoUrl:"",headerPhoto:"",homepageUrl:"",regOpenDate:"",regCloseDate:"",facebookShare:{url:""}}}},mounted(){this.loadEventDetails()},watch:{eventDetails:{handler(){this.loadEventDetails()},immediate:!0}},methods:{loadEventDetails(){var t;if(console.log("Loading event details:",this.eventDetails),!this.eventDetails){this.eventDetailsData={name:"",formattedDates:"",tagline:"",logoUrl:"",headerPhoto:"",homepageUrl:"",regOpenDate:"",regCloseDate:"",facebookShare:{url:""}};return}this.eventDetailsData={...this.eventDetails,name:this.eventDetails.name||"",formattedDates:this.eventDetails.formattedDates||"",tagline:this.eventDetails.tagline||"",logoUrl:this.eventDetails.logoUrl||"",headerPhoto:this.eventDetails.headerPhoto||"",homepageUrl:this.eventDetails.homepageUrl||"",regOpenDate:this.eventDetails.regOpenDate||"",regCloseDate:this.eventDetails.regCloseDate||"",facebookShare:{...this.eventDetails.facebookShare||{},url:((t=this.eventDetails.facebookShare)==null?void 0:t.url)||""}},console.log("Loaded eventDetailsData:",this.eventDetailsData)},async submitHandler(){console.log("Saving event details:",this.eventDetailsData),await W.patch(`/api/races/${this.$route.params.raceid}`,{eventDetails:this.eventDetailsData}).then(t=>{t.data&&(this.$emit("save",this.eventDetailsData),console.log(t.data))}).catch(t=>{this.formError=["Error submitting request"],console.log(t)})}}},Gt=t=>(at("data-v-99524000"),t=t(),rt(),t),Ep=Gt(()=>o("h5",{class:"mb-0"},"Edit Registration Form Header",-1)),wp={class:"edit-event-details-form"},Pp=Gt(()=>o("div",{class:"alert alert-info py-2 mb-3"},[o("small",null,[o("strong",null,"Tip:"),T(" These details appear in the header of your registration form. Make sure to use clear, engaging text and high-quality images. ")])],-1)),Rp=Gt(()=>o("h6",{class:"mb-3"},"Event Information",-1)),Tp=Gt(()=>o("h6",{class:"mt-4 mb-3"},"Visual Assets",-1)),Op={key:0,class:"mb-3"},Ip={class:"image-preview"},kp=["src"],$p={key:1,class:"mb-3"},Ap={class:"image-preview"},Mp=["src"],Fp=Gt(()=>o("h6",{class:"mt-4 mb-3"},"Links",-1)),Np={class:"modal-footer-buttons mt-4"},Lp=Gt(()=>o("div",null,null,-1));function Up(t,e,a,c,s,r){const n=A("FormKit"),d=A("modal-component");return u(),ee(d,{show:a.show,onClose:e[8]||(e[8]=i=>t.$emit("close"))},{header:V(()=>[Ep]),body:V(()=>[o("div",wp,[Pp,Rp,D(n,{type:"text",modelValue:s.eventDetailsData.name,"onUpdate:modelValue":e[0]||(e[0]=i=>s.eventDetailsData.name=i),label:"Header Event Name",help:"The main event name displayed in the registration header"},null,8,["modelValue"]),D(n,{type:"text",modelValue:s.eventDetailsData.formattedDates,"onUpdate:modelValue":e[1]||(e[1]=i=>s.eventDetailsData.formattedDates=i),label:"Formatted Dates",help:"e.g., 'Sept 28th, Oct 5th, 12th, 19th, and 26th'"},null,8,["modelValue"]),D(n,{type:"text",modelValue:s.eventDetailsData.tagline,"onUpdate:modelValue":e[2]||(e[2]=i=>s.eventDetailsData.tagline=i),label:"Tagline",help:"A catchy tagline or subtitle for your event"},null,8,["modelValue"]),Tp,D(n,{type:"text",modelValue:s.eventDetailsData.logoUrl,"onUpdate:modelValue":e[3]||(e[3]=i=>s.eventDetailsData.logoUrl=i),label:"Logo URL",help:"URL to your event logo image"},null,8,["modelValue"]),s.eventDetailsData.logoUrl?(u(),p("div",Op,[o("div",Ip,[o("img",{src:s.eventDetailsData.logoUrl,alt:"Logo Preview",style:{"max-width":"150px","max-height":"150px"}},null,8,kp)])])):P("",!0),D(n,{type:"text",modelValue:s.eventDetailsData.headerPhoto,"onUpdate:modelValue":e[4]||(e[4]=i=>s.eventDetailsData.headerPhoto=i),label:"Header Photo URL",help:"URL to a banner/header photo displayed at the top"},null,8,["modelValue"]),s.eventDetailsData.headerPhoto?(u(),p("div",$p,[o("div",Ap,[o("img",{src:s.eventDetailsData.headerPhoto,alt:"Header Photo Preview",style:{"max-width":"100%","max-height":"200px"}},null,8,Mp)])])):P("",!0),Fp,D(n,{type:"text",modelValue:s.eventDetailsData.homepageUrl,"onUpdate:modelValue":e[5]||(e[5]=i=>s.eventDetailsData.homepageUrl=i),label:"Event Homepage URL",help:"Link to your event's main website"},null,8,["modelValue"])]),o("div",Np,[o("button",{class:"btn btn-sm btn-primary px-5 mx-3",onClick:e[6]||(e[6]=(...i)=>r.submitHandler&&r.submitHandler(...i))},"Save Header Details"),o("button",{class:"btn btn-sm btn-secondary px-3 mx-3",onClick:e[7]||(e[7]=i=>t.$emit("close"))},"Cancel")])]),footer:V(()=>[Lp]),_:1},8,["show"])}const jp=ve(xp,[["render",Up],["__scopeId","data-v-99524000"]]);const Vp={components:{ModalComponent:Xe,RichTextEditor:po},props:{emailTemplate:{type:[Object,String],default:null},show:{type:Boolean,default:!1},raceData:{type:Object,required:!0}},emits:["save","close"],data(){return{formError:[],templateData:{subject:"",body:""},showPreview:!1,previewHtml:"",previewSubject:"",isEditing:!1}},computed:{defaultTemplate(){return{subject:"{{eventName}} Registration",body:`<html><head></head><body>
<h1>Thank you for registering for {{eventName}}</h1>
<p>
Name: {{name}}<br>
Team/Sponsor: {{sponsor}}<br>
Race Category: {{category}}<br>
<p><a href="{{rosterLink}}">Go Here</a> to see who else is signed up<p>
<p>For information about the event, check out <a href="{{eventHomePageUrl}}">{{eventHomePageUrl}}</a></p>
<p>For issues with your registration information, <a href="mailto:{{eventContactEmail}}">email us!</a></p>
</body></html>`}},availableVariables(){var t,e,a,c,s,r,n,d,i;return[{name:"{{name}}",description:"Registrant full name",example:"John Doe"},{name:"{{sponsor}}",description:"Team/Sponsor name",example:"Sample Racing Team"},{name:"{{eventName}}",description:"Event name",example:((e=(t=this.raceData)==null?void 0:t.eventDetails)==null?void 0:e.name)||"Sample Race Event"},{name:"{{category}}",description:"Race category",example:((s=(c=(a=this.raceData)==null?void 0:a.regCategories)==null?void 0:c[0])==null?void 0:s.catdispname)||"Men's Cat 1"},{name:"{{rosterLink}}",description:"Link to race roster",example:`${window.location.origin}/#/roster/${((r=this.raceData)==null?void 0:r.raceid)||"raceid"}`},{name:"{{eventHomePageUrl}}",description:"Event homepage URL",example:((d=(n=this.raceData)==null?void 0:n.eventDetails)==null?void 0:d.homepageUrl)||"https://example.com"},{name:"{{eventContactEmail}}",description:"Event contact email",example:((i=this.raceData)==null?void 0:i.contactEmail)||"support@signup.bike"}]},sampleData(){var t,e,a,c,s,r,n,d,i;return{name:"John Doe",sponsor:"Sample Racing Team",eventName:((e=(t=this.raceData)==null?void 0:t.eventDetails)==null?void 0:e.name)||"Sample Race Event",category:((s=(c=(a=this.raceData)==null?void 0:a.regCategories)==null?void 0:c[0])==null?void 0:s.catdispname)||"Men's Cat 1",rosterLink:`${window.location.origin}/#/roster/${((r=this.raceData)==null?void 0:r.raceid)||"raceid"}`,eventHomePageUrl:((d=(n=this.raceData)==null?void 0:n.eventDetails)==null?void 0:d.homepageUrl)||"https://example.com",eventContactEmail:((i=this.raceData)==null?void 0:i.contactEmail)||"support@signup.bike"}}},mounted(){this.loadTemplate()},watch:{emailTemplate:{handler(t,e){t!==e&&!this.isEditing&&this.loadTemplate()},deep:!0},show(t){t&&(this.isEditing=!1,this.loadTemplate())},"templateData.subject"(){this.isEditing=!0},"templateData.body"(){this.isEditing=!0}},methods:{normalizeTemplate(t){return t?typeof t=="object"?{...t,subject:t.subject||this.defaultTemplate.subject,body:t.body||this.defaultTemplate.body}:typeof t=="string"?{subject:this.defaultTemplate.subject,body:t}:{...this.defaultTemplate}:{...this.defaultTemplate}},loadTemplate(){this.templateData=this.normalizeTemplate(this.emailTemplate)},resetToDefault(){confirm("Are you sure you want to reset to the default template? This will discard your current changes.")&&(this.templateData={...this.defaultTemplate})},copyVariable(t){navigator.clipboard.writeText(t).then(()=>{console.log("Copied:",t)})},renderPreview(){let t=this.templateData.subject,e=this.templateData.body;Object.keys(this.sampleData).forEach(a=>{const c=new RegExp(`{{${a}}}`,"g");t=t.replace(c,this.sampleData[a]),e=e.replace(c,this.sampleData[a])}),this.previewSubject=t,this.previewHtml=e,this.showPreview=!0},async submitHandler(){console.log("Saving email template:",this.templateData);try{await W.patch(`/api/races/${this.$route.params.raceid}`,{emailTemplate:this.templateData}),this.$emit("save",this.templateData)}catch(t){this.formError=["Error saving email template"],console.error(t)}}}},pt=t=>(at("data-v-972fa4db"),t=t(),rt(),t),Hp=pt(()=>o("h5",{class:"mb-0"},"Edit Registration Confirmation Email",-1)),Bp={class:"edit-email-form"},Gp=pt(()=>o("div",{class:"alert alert-info py-2 mb-3"},[o("small",null,[o("strong",null,"Tip:"),T(" This email is automatically sent when someone registers for your event. Use the template variables below to personalize the message with race and registrant information. ")])],-1)),Kp={class:"row mb-3"},zp={class:"col-md-8"},Yp={class:"mb-3"},Wp=pt(()=>o("label",{class:"form-label"},"Email Subject Line",-1)),Xp=pt(()=>o("small",{class:"text-muted"},"You can use template variables in the subject line too!",-1)),Jp={class:"mt-3 d-flex gap-2"},Qp={class:"col-md-4"},Zp={class:"template-variables p-3 bg-light border rounded"},qp=pt(()=>o("h6",{class:"mb-3"},"Available Variables",-1)),eg=pt(()=>o("small",{class:"text-muted mb-2 d-block"}," Click to copy, then paste into your template: ",-1)),tg={class:"variable-list"},sg=["onClick"],og={class:"variable-code"},ng={class:"variable-description text-muted small mt-1"},rg={class:"variable-example text-success small"},ag={key:0,class:"preview-section mt-4 p-3 border rounded bg-light"},ig={class:"d-flex justify-content-between align-items-center mb-3"},lg=pt(()=>o("h6",{class:"mb-0"},"Preview with Sample Data",-1)),cg={class:"preview-content bg-white p-3 border rounded"},dg={class:"mb-3 pb-2 border-bottom"},ug=pt(()=>o("strong",null,"Subject:",-1)),mg=["innerHTML"],hg=pt(()=>o("small",{class:"text-muted mt-2 d-block"}," This preview uses sample data. Actual emails will use real registrant information. ",-1)),fg={key:0,class:"alert alert-danger mt-3"},pg={class:"modal-footer-buttons mt-4"},gg=pt(()=>o("div",null,null,-1));function vg(t,e,a,c,s,r){const n=A("RichTextEditor"),d=A("modal-component");return u(),ee(d,{show:a.show,onClose:e[7]||(e[7]=i=>t.$emit("close")),size:"xl"},{header:V(()=>[Hp]),body:V(()=>[o("div",Bp,[Gp,o("div",Kp,[o("div",zp,[o("div",Yp,[Wp,le(o("input",{type:"text",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=i=>s.templateData.subject=i),placeholder:"Enter email subject..."},null,512),[[ge,s.templateData.subject]]),Xp]),D(n,{modelValue:s.templateData.body,"onUpdate:modelValue":e[1]||(e[1]=i=>s.templateData.body=i),label:"Email Body",placeholder:"Enter your email message here...","show-preview":!1,"min-height":"400px"},null,8,["modelValue"]),o("div",Jp,[o("button",{class:"btn btn-sm btn-outline-primary",onClick:e[2]||(e[2]=(...i)=>r.renderPreview&&r.renderPreview(...i))}," Preview with Sample Data "),o("button",{class:"btn btn-sm btn-outline-secondary",onClick:e[3]||(e[3]=(...i)=>r.resetToDefault&&r.resetToDefault(...i))}," Reset to Default Template ")])]),o("div",Qp,[o("div",Zp,[qp,eg,o("div",tg,[(u(!0),p(Q,null,ie(r.availableVariables,i=>(u(),p("div",{key:i.name,class:"variable-item mb-2 p-2 bg-white border rounded",onClick:l=>r.copyVariable(i.name),role:"button",tabindex:"0"},[o("code",og,b(i.name),1),o("div",ng,b(i.description),1),o("div",rg," Example: "+b(i.example),1)],8,sg))),128))])])])]),s.showPreview?(u(),p("div",ag,[o("div",ig,[lg,o("button",{class:"btn btn-sm btn-outline-secondary",onClick:e[4]||(e[4]=i=>s.showPreview=!1)}," Close Preview ")]),o("div",cg,[o("div",dg,[ug,T(" "+b(s.previewSubject),1)]),o("div",{innerHTML:s.previewHtml},null,8,mg)]),hg])):P("",!0)]),s.formError.length>0?(u(),p("div",fg,[(u(!0),p(Q,null,ie(s.formError,(i,l)=>(u(),p("div",{key:l},b(i),1))),128))])):P("",!0),o("div",pg,[o("button",{class:"btn btn-primary px-5 mx-2",onClick:e[5]||(e[5]=(...i)=>r.submitHandler&&r.submitHandler(...i))}," Save Email Template "),o("button",{class:"btn btn-secondary px-3 mx-2",onClick:e[6]||(e[6]=i=>t.$emit("close"))}," Cancel ")])]),footer:V(()=>[gg]),_:1},8,["show"])}const yg=ve(Vp,[["render",vg],["__scopeId","data-v-972fa4db"]]);const bg={components:{ModalComponent:Xe,EditRaceCategoriesComponent:mh,EditRaceCouponsComponent:$h,EditRacePaymentsComponent:Kh,EditRaceOptionalPurchasesComponent:Pf,EditRaceWaiverComponent:Sp,EditRaceEventDetailsComponent:jp,EditRaceEmailTemplateComponent:yg,RichTextEditor:po,Link:lo,Edit3:io},data(){return{categories:{},loading:!1,error:null,formError:[],formInputData:{},editedCategories:[],editedCoupons:{},editedPaymentOptions:[],editedOptionalPurchases:[],editedWaiver:null,editedEmailTemplate:null,editedHeaderContent:"",editedEventDetails:{},raceData:{},showModal:!1,modalMode:null,seriesData:null,activeTab:"settings",showHeaderContentEditor:!1}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{dollas(t){return typeof t=="string"&&(t=parseInt(t)),t.toLocaleString("en-US",{style:"currency",currency:"USD"})},async fetchData(){if(this.error=null,this.loading=!0,this.$route.params.raceid)try{const t=await W(`/api/races/${this.$route.params.raceid}`);this.raceData=t.data,this.editedHeaderContent=this.raceData.headerContent||"",this.showHeaderContentEditor=!!this.raceData.headerContent,this.raceData.series?await this.fetchSeriesData():this.seriesData=null,this.loading=!1}catch(t){this.loading=!1,this.error=t.toString(),console.error(t)}},async fetchSeriesData(){if(this.raceData.series)try{const t=await W(`/api/series/${this.raceData.series}`);this.seriesData=t.data}catch(t){console.error("Error fetching series data:",t),this.seriesData=null}},isSeriesCategory(t){return!this.seriesData||!this.seriesData.regCategories?!1:this.seriesData.regCategories.some(e=>e.id===t)},isRaceOverride(t){return t._isRaceOverride===!0},isPureSeriesCategory(t){return t._isSeriesCategory===!0},getCategoryPaymentInfo(t){var s,r,n,d,i;const e=this.isSeriesCategory(t.id),a={forcedPayment:null,group:null,fallback:null},c=this.raceData.paymentOptions&&this.raceData.paymentOptions.length>0&&!this.raceData._paymentOptionsFromSeries;if(e&&((s=this.seriesData)!=null&&s.categoryGroups)){for(const l of this.seriesData.categoryGroups)if(l.categories&&l.categories.includes(t.id)){const m=((r=l.paymentOptions)==null?void 0:r.map(f=>f.name).join(", "))||"No payments";a.group={type:"series-group",label:l.name,payments:m,source:"series-group"};break}}if(t.paytype){let l="race",m=this.paymentOptions[t.paytype]||t.paytype,f=!1;if(c&&this.paymentOptions[t.paytype])l="race",m=this.paymentOptions[t.paytype];else{if(a.group){const g=this.seriesData.categoryGroups.find(v=>v.categories&&v.categories.includes(t.id));if(g){const v=(n=g.paymentOptions)==null?void 0:n.find(y=>y.type===t.paytype);v&&(l="series-group",m=v.name,f=!0)}}if(!f&&e&&((d=this.seriesData)!=null&&d.defaultPaymentOptions)){const g=this.seriesData.defaultPaymentOptions.find(v=>v.type===t.paytype);g&&(l="series-default",m=g.name,f=!0)}}a.forcedPayment={type:"forced",label:m,source:l,paytype:t.paytype}}if(!a.forcedPayment&&e&&(i=this.seriesData)!=null&&i.defaultPaymentOptions&&this.seriesData.defaultPaymentOptions.length>0){const l=this.seriesData.defaultPaymentOptions.map(m=>m.name).join(", ");a.fallback={type:"series-default",label:"Series Defaults",payments:l,source:"series-default"}}return!a.forcedPayment&&!a.group&&!a.fallback&&(a.fallback={type:"any",label:"Any payment type",source:"race"}),a},editProperty(t,e,a){this.showModal=!0,this.modalMode=t,this[e]=a},setActiveTab(t){this.activeTab=t},editOptionalPurchases(){this.showModal=!0,this.modalMode="optionalpurchases"},closeModal(){this.showModal=!1},async saveProperty(t){console.log("Saved property data"),this.showModal=!1,this.modalMode=null,console.log(t),await this.fetchData()},async saveRaceData(t){const e={...this.formInputData};e.eventDetails&&this.raceData.eventDetails&&(e.eventDetails={...this.raceData.eventDetails,...e.eventDetails}),e.stripeMeta&&this.raceData.stripeMeta&&(e.stripeMeta={...this.raceData.stripeMeta,...e.stripeMeta}),await W.patch(`/api/races/${this.$route.params.raceid}`,e).then(a=>{if(a.data)return console.log(a.data),this.fetchData()}).catch(a=>{this.formError=["Error submitting request"],console.log(a)})},async saveHeaderContent(){try{await W.patch(`/api/races/${this.$route.params.raceid}`,{headerContent:this.editedHeaderContent}),await this.fetchData()}catch(t){console.error("Error saving header content:",t),alert("Error saving header content")}}},computed:{defaultEmailSubject(){return"{{eventName}} Registration"},emailPreviewData(){var t,e,a,c,s,r,n,d,i,l;return{name:"John Doe",sponsor:"Sample Racing Team",eventName:((e=(t=this.raceData)==null?void 0:t.eventDetails)==null?void 0:e.name)||((a=this.raceData)==null?void 0:a.displayName)||"Sample Race Event",category:((r=(s=(c=this.raceData)==null?void 0:c.regCategories)==null?void 0:s[0])==null?void 0:r.catdispname)||"Men's Cat 1",rosterLink:`${window.location.origin}/#/roster/${((n=this.raceData)==null?void 0:n.raceid)||"raceid"}`,eventHomePageUrl:((i=(d=this.raceData)==null?void 0:d.eventDetails)==null?void 0:i.homepageUrl)||"https://example.com",eventContactEmail:((l=this.raceData)==null?void 0:l.contactEmail)||"support@signup.bike"}},renderedEmailPreview(){let t=this.defaultEmailSubject,e=`<html><head></head><body>
<h1>Thank you for registering for {{eventName}}</h1>
<p>
Name: {{name}}<br>
Team/Sponsor: {{sponsor}}<br>
Race Category: {{category}}<br>
<p><a href="{{rosterLink}}">Go Here</a> to see who else is signed up<p>
<p>For information about the event, check out <a href="{{eventHomePageUrl}}">{{eventHomePageUrl}}</a></p>
<p>For issues with your registration information, <a href="mailto:{{eventContactEmail}}">email us!</a></p>
</body></html>`;this.raceData.emailTemplate&&(typeof this.raceData.emailTemplate=="object"?(t=this.raceData.emailTemplate.subject||t,e=this.raceData.emailTemplate.body||e):e=this.raceData.emailTemplate);const a=this.emailPreviewData;return Object.keys(a).forEach(c=>{const s=new RegExp(`{{${c}}}`,"g");t=t.replace(s,a[c]),e=e.replace(s,a[c])}),{subject:t,body:e.substring(0,500)+(e.length>500?"...":"")}},sortedCats(){return J.orderBy(this.raceData.regCategories,"disporder")},loaded(){return!!this.raceData},eventDate(){return ot(this.raceData.eventDate).format("YYYY-MM-DDTHH:mm")},regOpenDate(){return ot(this.raceData.regOpenDate).format("YYYY-MM-DDTHH:mm")},timeToOpen(){var t;return ot().to((t=this.raceData.eventDetails)==null?void 0:t.regOpenDate)},timeToClose(){var t;return ot().to((t=this.raceData.eventDetails)==null?void 0:t.regCloseDate)},paymentOptions(){let t={};return J.forEach(this.raceData.paymentOptions,e=>{t[e.type]=e.name}),t},allPaymentOptionsWithSource(){var c,s;const t=[],e=new Set;return this.raceData.paymentOptions&&this.raceData.paymentOptions.length>0&&!this.raceData._paymentOptionsFromSeries&&(this.raceData.paymentOptions||[]).forEach(r=>{t.push({...r,source:"race",sourceLabel:"Race-specific",usedBy:"Race Categories",key:`race-${r.type}`,priority:1}),e.add(r.type)}),(c=this.seriesData)!=null&&c.defaultPaymentOptions&&this.seriesData.defaultPaymentOptions.forEach(r=>{const n=e.has(r.type);t.push({...r,source:"series-default",sourceLabel:"Series Default",usedBy:"Series Categories (not in groups)",key:`series-default-${r.type}`,priority:3,isOverridden:n,overriddenBy:n?"race":null})}),(s=this.seriesData)!=null&&s.categoryGroups&&this.seriesData.categoryGroups.forEach(r=>{(r.paymentOptions||[]).forEach(n=>{const d=e.has(n.type);t.push({...n,source:"series-group",sourceLabel:`Series Group: ${r.name}`,seriesGroup:r.name,groupName:r.name,usedBy:`Series Categories in "${r.name}"`,key:`series-group-${r.name}-${n.type}`,priority:2,isOverridden:d,overriddenBy:d?"race":null})})}),t.sort((r,n)=>r.priority-n.priority)}}},_g={class:"container"},Cg={key:0,class:"loading"},Dg={key:1},Sg={key:0,class:"error"},xg={key:1},Eg={key:0,class:"series-banner alert alert-info d-flex align-items-center justify-content-between mb-3"},wg={class:"d-flex align-items-center"},Pg=o("strong",null,"Part of Series:",-1),Rg={key:0,class:"ms-2 text-muted"},Tg={class:"d-flex flex-row"},Og={class:"my-3 mx-5"},Ig=["href"],kg={class:"my-3"},$g=["href"],Ag={class:"row"},Mg={class:"col-md-12"},Fg={class:"nav nav-tabs mb-3",role:"tablist"},Ng={class:"nav-item",role:"presentation"},Lg={class:"nav-item",role:"presentation"},Ug={class:"nav-item",role:"presentation"},jg={class:"nav-item",role:"presentation"},Vg={class:"tab-content"},Hg=o("h6",{class:"mt-3 mb-2"},"Registration Dates",-1),Bg={class:"small text-muted"},Gg={class:"small text-muted"},Kg={key:0,class:"alert alert-warning mt-3 mb-0"},zg=o("small",null,[o("strong",null,"⚠️ Landing Page Visibility:"),T(' This race is part of a series and may be hidden on the main landing page. Only the first upcoming race in the series will be shown (unless "Disable Series Redirect" is enabled in Advanced settings). The race will still be visible when viewing the specific series page. ')],-1),Yg=[zg],Wg=o("h6",{class:"mt-3 mb-2"},"Registration Limits",-1),Xg={class:"small text-muted"},Jg={class:"registration-section"},Qg={class:"row"},Zg={class:"col-lg-6"},qg={class:"content-card mb-4"},ev={class:"d-flex justify-content-between align-items-center mb-3"},tv=o("h5",{class:"mb-0"},"Categories",-1),sv={key:0,class:"series-preview-info mb-2"},ov={class:"text-muted"},nv={class:"ms-2",style:{color:"#f57c00"}},rv={class:"category-preview"},av={class:"cat-preview-name"},iv={class:"cat-preview-badges"},lv={key:0,class:"sponsored-badge"},cv=["title"],dv=["title"],uv=["title"],mv={key:3,class:"text-muted small"},hv={class:"col-lg-6"},fv={class:"content-card mb-4"},pv={class:"d-flex justify-content-between align-items-center mb-3"},gv=o("h5",{class:"mb-0"},"Race Payment Options",-1),vv={key:0,class:"alert alert-info py-2 mb-3"},yv=Oo("<small><strong>Hybrid Payment Model - Priority Order:</strong><br> 1. <strong>Race Payment Options</strong> override series defaults/groups when payment type matches<br> 2. <strong>Series Category Groups</strong> define payment options for categories in that group<br> 3. <strong>Series Default Options</strong> apply to series categories not in any group<br> 4. <strong>Race-only Categories</strong> use race payment options<br><br> 💡 <em>Tip: Define a race payment option with the same &quot;type&quot; to override series amounts/names</em></small>",1),bv=[yv],_v={class:"table table-sm"},Cv=o("thead",null,[o("tr",null,[o("th",{scope:"col"},"Payment Option"),o("th",{scope:"col"},"Price"),o("th",{scope:"col"},"Used By")])],-1),Dv={key:1,class:"text-muted small"},Sv={key:2,class:"text-warning small"},xv={key:0,class:"badge bg-primary",title:"Race-specific payment option"},Ev=["title"],wv=["title"],Pv={class:"text-muted small mt-1"},Rv={key:1,class:"text-muted text-center py-3"},Tv={class:"row"},Ov={class:"col-lg-6"},Iv={class:"content-card mb-4"},kv={class:"d-flex justify-content-between align-items-center mb-3"},$v=o("h5",{class:"mb-0"},"Coupons",-1),Av={key:0},Mv={class:"table table-sm"},Fv=o("thead",null,[o("tr",null,[o("th",{scope:"col"},"Coupon Code"),o("th",{scope:"col"},"Discount"),o("th",{scope:"col"},"Type")])],-1),Nv={key:0,class:"badge bg-warning text-dark"},Lv={key:1,class:"badge bg-success"},Uv={key:1,class:"text-muted text-center py-3"},jv={class:"content-card mb-4"},Vv={class:"d-flex justify-content-between align-items-center mb-3"},Hv=o("h5",{class:"mb-0"},"Optional Purchases",-1),Bv={key:0},Gv={class:"table table-sm"},Kv=o("thead",null,[o("tr",null,[o("th",{scope:"col"},"Label"),o("th",{scope:"col"},"Description"),o("th",{scope:"col"},"Amount"),o("th",{scope:"col"},"Options")])],-1),zv=["innerHTML"],Yv={key:1,class:"text-muted"},Wv={key:0,class:"badge bg-info"},Xv={key:1,class:"text-muted"},Jv={key:1,class:"text-muted text-center py-3"},Qv={class:"content-section"},Zv={class:"content-card mb-4"},qv={class:"d-flex justify-content-between align-items-center mb-3"},ey=o("h5",{class:"mb-0"},"Registration Form Header",-1),ty={key:0,class:"preview-box"},sy={class:"event-header-preview"},oy={class:"row align-items-center"},ny={key:0,class:"col-md-3 text-center"},ry=["src"],ay={class:"col"},iy={class:"fw-bold mb-2"},ly={key:0,class:"lead mb-2"},cy={key:1,class:"mb-2"},dy={key:2,class:"mb-2"},uy=["href"],my={key:0,class:"mt-3"},hy=o("div",{class:"text-muted small mb-1"},"Header Photo:",-1),fy=["src"],py={key:1,class:"alert alert-warning mb-0"},gy=o("small",null,'⚠️ No header details configured. Click "Edit Header" to add them.',-1),vy=[gy],yy={class:"content-card mb-4"},by={key:0},_y=o("h5",{class:"mb-3"},"Extra Content Below Header",-1),Cy={key:1},Dy={class:"d-flex justify-content-between align-items-center mb-3"},Sy=o("h5",{class:"mb-0"},"Extra Content Below Header",-1),xy={key:0,class:"mt-3"},Ey={class:"preview-box"},wy=o("div",{class:"preview-label"},"Current Content Preview:",-1),Py=["innerHTML"],Ry={class:"content-card mb-4"},Ty={class:"d-flex justify-content-between align-items-center mb-3"},Oy=o("h5",{class:"mb-0"},"Waiver / Liability Release",-1),Iy={key:0},ky={class:"mb-2"},$y={class:"badge bg-info"},Ay={key:0,class:"ms-2 text-muted small"},My={class:"preview-box"},Fy=o("div",{class:"preview-label"},"Preview:",-1),Ny=["innerHTML"],Ly={key:1},Uy={key:1},jy=o("div",{class:"alert alert-warning mb-0"},[o("small",null,'⚠️ No waiver configured. Click "Edit Waiver" to add one.')],-1),Vy=[jy],Hy={class:"content-card"},By={class:"d-flex justify-content-between align-items-center mb-3"},Gy=o("h5",{class:"mb-0"},"Registration Confirmation Email",-1),Ky={key:0,class:"mb-2"},zy=o("span",{class:"badge bg-success"},"Custom Template Active",-1),Yy=o("span",{class:"ms-2 text-muted small"}," A custom email template is configured for this race. ",-1),Wy=[zy,Yy],Xy={key:1,class:"mb-2"},Jy=o("span",{class:"badge bg-secondary"},"Using Default Template",-1),Qy=o("span",{class:"ms-2 text-muted small"}," Using the standard registration confirmation email. ",-1),Zy=[Jy,Qy],qy=o("div",{class:"preview-label"},"Preview with Sample Data:",-1),eb={class:"preview-box"},tb={class:"email-preview"},sb={class:"mb-2 pb-2 border-bottom"},ob=o("strong",null,"Subject:",-1),nb=["innerHTML"],rb=o("div",{class:"mt-2"},[o("small",{class:"text-muted"}," Preview uses actual race data with sample registrant information (John Doe, Sample Racing Team). ")],-1),ab=o("div",{class:"alert alert-info mt-3 mb-0"},[o("small",null,[o("strong",null,"Tip:"),T(" This email is automatically sent to registrants after they complete their registration. You can customize the subject line and body, and use template variables to personalize the message. ")])],-1),ib=o("h6",{class:"mb-3"},"Display Options",-1),lb=o("h6",{class:"mt-4 mb-3"},"Feature Toggles",-1),cb={key:0,class:"mb-3"},db=o("div",{class:"alert alert-info mt-2 mb-0"},[o("small",null,[o("strong",null,"Series Redirect Behavior:"),o("br"),T(" When "),o("strong",null,"disabled"),T(" (checked): "),o("ul",{class:"mb-1 mt-1"},[o("li",null,"This race will appear on the main landing page"),o("li",null,"Users can register directly for this specific race"),o("li",null,"No automatic redirects occur")]),T(" When "),o("strong",null,"enabled"),T(" (unchecked - default): "),o("ul",{class:"mb-1 mt-1"},[o("li",null,"Only the first/next upcoming race in the series appears on the main landing page"),o("li",null,"Users visiting this race's registration page will be automatically redirected to the next upcoming race in the series"),o("li",null,"Helps prevent users from accidentally registering for the wrong race in a series")]),o("em",null,"💡 Tip: Enable this option if you want each race in the series to be independently accessible (e.g., for special events or makeup races).")])],-1),ub=o("h6",{class:"mt-4 mb-3"},"Payment Integration",-1),mb=o("h6",{class:"mt-4 mb-3"},"Race Status",-1);function hb(t,e,a,c,s,r){var w,$;const n=A("Link"),d=A("RouterLink"),i=A("FormKit"),l=A("Edit3"),m=A("RichTextEditor"),f=A("EditRaceCategoriesComponent"),h=A("EditRacePaymentsComponent"),g=A("EditRaceCouponsComponent"),v=A("EditRaceOptionalPurchasesComponent"),y=A("EditRaceWaiverComponent"),_=A("EditRaceEventDetailsComponent"),S=A("EditRaceEmailTemplateComponent");return u(),p("div",_g,[s.loading?(u(),p("div",Cg,"Loading...")):(u(),p("div",Dg,[s.error?(u(),p("div",Sg,b(s.error),1)):P("",!0),(u(),p("div",xg,[s.raceData.series&&s.seriesData?(u(),p("div",Eg,[o("div",wg,[D(n,{size:20,class:"me-2"}),o("div",null,[Pg,T(" "+b(s.seriesData.name)+" ",1),s.raceData.seriesRaceNumber?(u(),p("span",Rg," (Race #"+b(s.raceData.seriesRaceNumber)+") ",1)):P("",!0)])]),D(d,{to:{name:"edit-series",params:{seriesId:s.raceData.series}},class:"btn btn-sm btn-outline-primary"},{default:V(()=>[T(" Edit Series ")]),_:1},8,["to"])])):P("",!0),o("div",Tg,[o("div",Og,[o("a",{href:`/#/register/test/${s.raceData.raceid}`},"View Reg Form",8,Ig)]),o("div",kg,[o("a",{href:`/#/roster/${s.raceData.raceid}`},"View Roster",8,$g)])]),o("div",Ag,[o("div",Mg,[o("ul",Fg,[o("li",Ng,[o("button",{class:ne(["nav-link",{active:s.activeTab==="settings"}]),onClick:e[0]||(e[0]=C=>r.setActiveTab("settings")),type:"button"}," Settings ",2)]),o("li",Lg,[o("button",{class:ne(["nav-link",{active:s.activeTab==="registration"}]),onClick:e[1]||(e[1]=C=>r.setActiveTab("registration")),type:"button"}," Registration ",2)]),o("li",Ug,[o("button",{class:ne(["nav-link",{active:s.activeTab==="content"}]),onClick:e[2]||(e[2]=C=>r.setActiveTab("content")),type:"button"}," Content ",2)]),o("li",jg,[o("button",{class:ne(["nav-link",{active:s.activeTab==="advanced"}]),onClick:e[3]||(e[3]=C=>r.setActiveTab("advanced")),type:"button"}," Advanced ",2)])]),o("div",Vg,[le(o("div",{class:ne(["tab-pane",{active:s.activeTab==="settings",show:s.activeTab==="settings"}])},[D(i,{type:"form",errors:s.formError,id:"race-settings",onSubmit:r.saveRaceData,"submit-label":"Save Settings",modelValue:s.formInputData,"onUpdate:modelValue":e[4]||(e[4]=C=>s.formInputData=C)},{default:V(()=>{var C,I,O,H;return[D(i,{value:(C=s.raceData)==null?void 0:C.displayName,type:"text",name:"displayName",label:"Event Name"},null,8,["value"]),D(i,{value:(I=s.raceData)==null?void 0:I.contactEmail,type:"text",name:"contactEmail",label:"Contact Email"},null,8,["value"]),D(i,{value:r.eventDate,type:"datetime-local",name:"eventDate",label:"Date"},null,8,["value"]),D(i,{value:(O=s.raceData)==null?void 0:O.seriesRaceNumber,type:"number",name:"seriesRaceNumber",label:"Series Race Number"},null,8,["value"]),Hg,D(i,{type:"group",name:"eventDetails"},{default:V(()=>{var G,k,L,B;return[D(i,{value:(k=(G=s.raceData)==null?void 0:G.eventDetails)==null?void 0:k.regOpenDate,type:"datetime-local",name:"regOpenDate",label:"Registration Open Date"},null,8,["value"]),o("p",Bg,"Registration Opens "+b(r.timeToOpen),1),D(i,{value:(B=(L=s.raceData)==null?void 0:L.eventDetails)==null?void 0:B.regCloseDate,type:"datetime-local",name:"regCloseDate",label:"Registration Close Date"},null,8,["value"]),o("p",Gg,"Registration Closes "+b(r.timeToClose),1)]}),_:1}),s.raceData.series&&!s.raceData.disableSeriesRedirect?(u(),p("div",Kg,Yg)):P("",!0),Wg,D(i,{value:(H=s.raceData)==null?void 0:H.entryCountMax,type:"number",label:"Maximum Number of registrations",name:"entryCountMax"},null,8,["value"]),o("p",Xg,[o("strong",null,"Current Reg Count: "+b(s.raceData.entryCount),1)])]}),_:1},8,["errors","onSubmit","modelValue"])],2),[[jt,s.activeTab==="settings"]]),le(o("div",{class:ne(["tab-pane",{active:s.activeTab==="registration",show:s.activeTab==="registration"}])},[o("div",Jg,[o("div",Qg,[o("div",Zg,[o("div",qg,[o("div",ev,[tv,o("button",{type:"button",class:"btn btn-sm btn-primary",onClick:e[5]||(e[5]=C=>r.editProperty("categories","editedCategories",[...r.sortedCats]))}," Edit Categories ")]),s.raceData.series&&s.seriesData?(u(),p("div",sv,[o("small",ov,[D(n,{size:14,class:"me-1",style:{display:"inline-block","vertical-align":"middle"}}),T(" Link icon = inherited from series "),o("span",nv,[D(l,{size:14,class:"me-1",style:{display:"inline-block","vertical-align":"middle"}}),T(" Edit icon = race override ")])])])):P("",!0),o("div",rv,[(u(!0),p(Q,null,ie(r.sortedCats,C=>(u(),p("div",{key:C.id,class:ne(["cat-preview-row",{"from-series":r.isPureSeriesCategory(C),"race-override":r.isRaceOverride(C)}])},[o("div",av,[r.isPureSeriesCategory(C)?(u(),ee(n,{key:0,size:16,class:"series-icon me-1",title:"Inherited from series"})):r.isRaceOverride(C)?(u(),ee(l,{key:1,size:16,class:"override-icon me-1",title:"Race override of series category"})):P("",!0),T(" "+b(C.catdispname),1)]),o("div",iv,[C.sponsored?(u(),p("strong",lv,"Sponsored")):(u(),p(Q,{key:1},[r.getCategoryPaymentInfo(C).forcedPayment?(u(),p("span",{key:0,class:ne(["paytype-badge",{"badge-race":r.getCategoryPaymentInfo(C).forcedPayment.source==="race","badge-series-default":r.getCategoryPaymentInfo(C).forcedPayment.source==="series-default","badge-series-group":r.getCategoryPaymentInfo(C).forcedPayment.source==="series-group","badge-race-override":r.getCategoryPaymentInfo(C).forcedPayment.source==="race-override"}]),title:`Forced to: ${r.getCategoryPaymentInfo(C).forcedPayment.paytype}`},b(r.getCategoryPaymentInfo(C).forcedPayment.label),11,cv)):P("",!0),r.getCategoryPaymentInfo(C).group?(u(),p("span",{key:1,class:"paytype-badge badge-series-group",title:r.getCategoryPaymentInfo(C).group.payments},b(r.getCategoryPaymentInfo(C).group.label),9,dv)):P("",!0),r.getCategoryPaymentInfo(C).fallback?(u(),p("span",{key:2,class:ne(["paytype-badge",{"badge-series-default":r.getCategoryPaymentInfo(C).fallback.source==="series-default"}]),title:r.getCategoryPaymentInfo(C).fallback.payments},b(r.getCategoryPaymentInfo(C).fallback.label),11,uv)):P("",!0),!r.getCategoryPaymentInfo(C).forcedPayment&&!r.getCategoryPaymentInfo(C).group&&!r.getCategoryPaymentInfo(C).fallback?(u(),p("span",mv," Any payment ")):P("",!0)],64))])],2))),128))])])]),o("div",hv,[o("div",fv,[o("div",pv,[gv,o("button",{type:"button",class:"btn btn-sm btn-primary",onClick:e[6]||(e[6]=C=>r.editProperty("paymentOptions","editedPaymentOptions",[...s.raceData.paymentOptions]))}," Edit Race Payments ")]),s.seriesData&&(((w=s.seriesData.defaultPaymentOptions)==null?void 0:w.length)>0||(($=s.seriesData.categoryGroups)==null?void 0:$.length)>0)?(u(),p("div",vv,bv)):P("",!0),o("table",_v,[Cv,o("tbody",null,[(u(!0),p(Q,null,ie(r.allPaymentOptionsWithSource,C=>(u(),p("tr",{key:C.key,class:ne({"from-series":C.source!=="race","is-overridden":C.isOverridden})},[o("td",null,[C.source!=="race"?(u(),ee(n,{key:0,size:16,class:"series-icon me-1",title:`From ${C.sourceLabel}`},null,8,["title"])):P("",!0),o("strong",{class:ne({"text-decoration-line-through text-muted":C.isOverridden})},b(C.name),3),C.seriesGroup?(u(),p("div",Dv," Group: "+b(C.seriesGroup),1)):P("",!0),C.isOverridden?(u(),p("div",Sv," ⚠️ Overridden by race payment option ")):P("",!0)]),o("td",{class:ne({"text-decoration-line-through text-muted":C.isOverridden})},b(r.dollas(C.amount)),3),o("td",null,[C.source==="race"?(u(),p("span",xv," Race ")):C.source==="series-group"?(u(),p("span",{key:1,class:"badge bg-info",title:C.usedBy}," Series Group ",8,Ev)):C.source==="series-default"?(u(),p("span",{key:2,class:"badge bg-success",title:C.usedBy}," Series Default ",8,wv)):P("",!0),o("div",Pv,b(C.usedBy),1)])],2))),128))])]),r.allPaymentOptionsWithSource.length===0?(u(),p("div",Rv," No payment options configured ")):P("",!0)])])]),o("div",Tv,[o("div",Ov,[o("div",Iv,[o("div",kv,[$v,o("button",{type:"button",class:"btn btn-sm btn-primary",onClick:e[7]||(e[7]=C=>r.editProperty("coupons","editedCoupons",{...s.raceData.couponCodes}))}," Edit Coupons ")]),s.raceData.couponCodes&&Object.keys(s.raceData.couponCodes).length>0?(u(),p("div",Av,[o("table",Mv,[Fv,o("tbody",null,[(u(!0),p(Q,null,ie(s.raceData.couponCodes,(C,I)=>(u(),p("tr",{key:I},[o("td",null,[o("strong",null,b(I),1)]),o("td",null,b(((C.fractionDiscount||0)*100).toFixed(1))+"% off",1),o("td",null,[C.singleUse?(u(),p("span",Nv," Single Use ")):(u(),p("span",Lv," Multi-Use "))])]))),128))])])])):(u(),p("div",Uv," No coupons configured "))]),o("div",jv,[o("div",Vv,[Hv,o("button",{type:"button",class:"btn btn-sm btn-primary",onClick:e[8]||(e[8]=C=>r.editProperty("optionalpurchases","editedOptionalPurchases",s.raceData.optionalPurchases?[...s.raceData.optionalPurchases]:[]))}," Edit Optional Purchases ")]),s.raceData.optionalPurchases&&s.raceData.optionalPurchases.length>0?(u(),p("div",Bv,[o("table",Gv,[Kv,o("tbody",null,[(u(!0),p(Q,null,ie(s.raceData.optionalPurchases,(C,I)=>(u(),p("tr",{key:I},[o("td",null,[o("strong",null,b(C.label),1)]),o("td",null,[C.description?(u(),p("div",{key:0,innerHTML:C.description,class:"small text-muted"},null,8,zv)):(u(),p("span",Yv,"—"))]),o("td",null,b(r.dollas(parseFloat(C.amount))),1),o("td",null,[C.options&&C.options.length>0?(u(),p("span",Wv,b(C.optionsLabel||"Options")+": "+b(C.options.join(", ")),1)):(u(),p("span",Xv,"—"))])]))),128))])])])):(u(),p("div",Jv," No optional purchases configured "))])])])])],2),[[jt,s.activeTab==="registration"]]),le(o("div",{class:ne(["tab-pane",{active:s.activeTab==="content",show:s.activeTab==="content"}])},[o("div",Qv,[o("div",Zv,[o("div",qv,[ey,o("button",{type:"button",class:"btn btn-sm btn-primary",onClick:e[9]||(e[9]=C=>r.editProperty("eventDetails","editedEventDetails",s.raceData.eventDetails?{...s.raceData.eventDetails}:{}))}," Edit Header ")]),s.raceData.eventDetails&&Object.keys(s.raceData.eventDetails).length>0?(u(),p("div",ty,[o("div",sy,[o("div",oy,[s.raceData.eventDetails.logoUrl?(u(),p("div",ny,[o("img",{src:s.raceData.eventDetails.logoUrl,alt:"Event Logo",style:{"max-width":"150px","max-height":"150px"}},null,8,ry)])):P("",!0),o("div",ay,[o("h4",iy,b(s.raceData.eventDetails.name||"No name set"),1),s.raceData.eventDetails.tagline?(u(),p("p",ly,b(s.raceData.eventDetails.tagline),1)):P("",!0),s.raceData.eventDetails.formattedDates?(u(),p("p",cy,b(s.raceData.eventDetails.formattedDates),1)):P("",!0),s.raceData.eventDetails.homepageUrl?(u(),p("div",dy,[o("a",{href:s.raceData.eventDetails.homepageUrl,target:"_blank",class:"btn btn-sm btn-success"}," Event Homepage ",8,uy)])):P("",!0)])]),s.raceData.eventDetails.headerPhoto?(u(),p("div",my,[hy,o("img",{src:s.raceData.eventDetails.headerPhoto,alt:"Header Photo",style:{"max-width":"100%","max-height":"200px"}},null,8,fy)])):P("",!0)])])):(u(),p("div",py,vy))]),o("div",yy,[s.showHeaderContentEditor?(u(),p("div",Cy,[o("div",Dy,[Sy,o("button",{type:"button",class:"btn btn-sm btn-success",onClick:e[11]||(e[11]=(...C)=>r.saveHeaderContent&&r.saveHeaderContent(...C))}," Save Header Content ")]),D(m,{modelValue:s.editedHeaderContent,"onUpdate:modelValue":e[12]||(e[12]=C=>s.editedHeaderContent=C),label:"Header Content",placeholder:"Enter additional content to display below the registration form header...","min-height":"200px"},null,8,["modelValue"]),s.raceData.headerContent?(u(),p("div",xy,[o("div",Ey,[wy,o("div",{innerHTML:s.raceData.headerContent},null,8,Py)])])):P("",!0)])):(u(),p("div",by,[_y,o("button",{type:"button",class:"btn btn-sm btn-primary",onClick:e[10]||(e[10]=C=>s.showHeaderContentEditor=!0)},[D(l,{size:16,class:"me-1"}),T(" Add Header Content ")])]))]),o("div",Ry,[o("div",Ty,[Oy,o("button",{type:"button",class:"btn btn-sm btn-primary",onClick:e[13]||(e[13]=C=>r.editProperty("waiver","editedWaiver",s.raceData.waiver?{...s.raceData.waiver}:null))}," Edit Waiver ")]),s.raceData.waiver&&s.raceData.waiver.text?(u(),p("div",Iy,[o("div",ky,[o("span",$y,b(s.raceData.waiver.format==="html"?"HTML (Rich Text)":"Plain Text"),1),s.raceData.waiver.format!=="html"&&s.raceData.waiver.header?(u(),p("span",Ay," Header: "+b(s.raceData.waiver.header),1)):P("",!0)]),o("div",My,[Fy,s.raceData.waiver.format==="html"?(u(),p("div",{key:0,innerHTML:s.raceData.waiver.text.substring(0,300)+(s.raceData.waiver.text.length>300?"...":"")},null,8,Ny)):(u(),p("div",Ly,b(s.raceData.waiver.text.substring(0,300)+(s.raceData.waiver.text.length>300?"...":"")),1))])])):(u(),p("div",Uy,Vy))]),o("div",Hy,[o("div",By,[Gy,o("button",{type:"button",class:"btn btn-sm btn-primary",onClick:e[14]||(e[14]=C=>r.editProperty("emailTemplate","editedEmailTemplate",s.raceData.emailTemplate||null))}," Edit Email Template ")]),s.raceData.emailTemplate?(u(),p("div",Ky,Wy)):(u(),p("div",Xy,Zy)),qy,o("div",eb,[o("div",tb,[o("div",sb,[ob,T(" "+b(r.renderedEmailPreview.subject),1)]),o("div",{innerHTML:r.renderedEmailPreview.body,style:{"font-size":"0.875rem"}},null,8,nb)])]),rb,ab])])],2),[[jt,s.activeTab==="content"]]),le(o("div",{class:ne(["tab-pane",{active:s.activeTab==="advanced",show:s.activeTab==="advanced"}])},[D(i,{type:"form",errors:s.formError,id:"race-advanced",onSubmit:r.saveRaceData,"submit-label":"Save Advanced Settings",modelValue:s.formInputData,"onUpdate:modelValue":e[15]||(e[15]=C=>s.formInputData=C)},{default:V(()=>{var C,I,O;return[ib,D(i,{value:(C=s.raceData)==null?void 0:C.showPaytypeOnRoster,type:"checkbox",label:"Show Payment Type as stages on roster",name:"showPaytypeOnRoster"},null,8,["value"]),D(i,{value:(I=s.raceData)==null?void 0:I.hideRosterButton,type:"checkbox",label:"Hide Roster Button on Registration Page and race list",name:"hideRosterButton"},null,8,["value"]),lb,D(i,{value:s.raceData.couponsEnabled,type:"checkbox",label:"Enable Coupons",name:"couponsEnabled"},null,8,["value"]),D(i,{value:(O=s.raceData)==null?void 0:O.cashPaymentsEnabled,type:"checkbox",label:"Enable Cash payments on race day",name:"cashPaymentsEnabled"},null,8,["value"]),D(i,{value:s.raceData.disableAge,type:"checkbox",label:"Disable Birthdate requirement",name:"disableAge"},null,8,["value"]),s.raceData.series?(u(),p("div",cb,[D(i,{value:s.raceData.disableSeriesRedirect,type:"checkbox",label:"Disable Series Redirect",name:"disableSeriesRedirect"},null,8,["value"]),db])):(u(),ee(i,{key:1,value:s.raceData.disableSeriesRedirect,type:"checkbox",label:"Disable Series Redirect",name:"disableSeriesRedirect"},null,8,["value"])),ub,D(i,{value:s.raceData.isTestData,type:"checkbox",label:"Use Test payment integrations",name:"isTestData"},null,8,["value"]),D(i,{type:"group",name:"stripeMeta"},{default:V(()=>{var H,G;return[D(i,{value:(G=(H=s.raceData)==null?void 0:H.stripeMeta)==null?void 0:G.accountId,type:"text",name:"accountId",label:"Stripe Integration Account ID"},null,8,["value"])]}),_:1}),mb,D(i,{value:s.raceData.archived,type:"checkbox",label:"Archive Race (will not be visible in admin race list)",name:"archived"},null,8,["value"])]}),_:1},8,["errors","onSubmit","modelValue"])],2),[[jt,s.activeTab==="advanced"]])])])]),(u(),ee(xt,{to:"body"},[s.modalMode=="categories"?(u(),ee(f,{key:0,show:s.showModal,categories:s.editedCategories,payTypes:r.paymentOptions,seriesId:s.raceData.series,onClose:r.closeModal,onSave:r.saveProperty},null,8,["show","categories","payTypes","seriesId","onClose","onSave"])):P("",!0),s.modalMode=="paymentOptions"?(u(),ee(h,{key:1,paymentOptions:s.editedPaymentOptions,show:s.showModal,onClose:r.closeModal,onSave:r.saveProperty},null,8,["paymentOptions","show","onClose","onSave"])):P("",!0),s.modalMode=="coupons"?(u(),ee(g,{key:2,coupons:s.editedCoupons,show:s.showModal,onClose:r.closeModal,onSave:r.saveProperty},null,8,["coupons","show","onClose","onSave"])):P("",!0),s.modalMode=="optionalpurchases"?(u(),ee(v,{key:3,optionalPurchases:s.editedOptionalPurchases,show:s.showModal,onClose:r.closeModal,onSave:r.saveProperty},null,8,["optionalPurchases","show","onClose","onSave"])):P("",!0),s.modalMode=="waiver"?(u(),ee(y,{key:4,waiver:s.editedWaiver,show:s.showModal,onClose:r.closeModal,onSave:r.saveProperty},null,8,["waiver","show","onClose","onSave"])):P("",!0),s.modalMode=="eventDetails"?(u(),ee(_,{key:5,eventDetails:s.editedEventDetails,show:s.showModal,onClose:r.closeModal,onSave:r.saveProperty},null,8,["eventDetails","show","onClose","onSave"])):P("",!0),s.modalMode=="emailTemplate"?(u(),ee(S,{key:6,emailTemplate:s.editedEmailTemplate,raceData:s.raceData,show:s.showModal,onClose:r.closeModal,onSave:r.saveProperty},null,8,["emailTemplate","raceData","show","onClose","onSave"])):P("",!0)]))]))]))])}const fb=ve(bg,[["render",hb]]);const pb={components:{ModalComponent:Xe,RacerFormComponent:Mo,Grid:ro},data(){return{categories:{},loading:!1,error:null,formError:[],formInputData:{},data:{},racerToEdit:null,showModal:!1,filterKey:"",filterUnpaid:!1,filterNoBib:!1,filterCats:"all",filterSimilar:!0}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{dollas(t){return t.toLocaleString("en-US",{style:"currency",currency:"USD"})},fetchData(){this.error=null,this.loading=!0,this.$route.params.raceid&&this.$route.params.series&&W(`/api/racers/series/${this.$route.params.series}`).then(({data:t})=>{console.log(t),this.data={registeredRacers:t.racers,regCategories:t.regCategories,races:t.races},this.loading=!1,this.error=""}).catch(t=>{this.loading=!1,this.error=t.toString(),console.error(t)}),this.error="invalid URL"},catName(t){let e=J.find(this.data.regCategories,{id:t});return e?e.catdispname:""},createReg(){this.racerToEdit={paytype:"cash",status:"unpaid",raceid:this.$route.params.raceid},this.showModal=!0},editRacer(t){let e=J.clone(J.find(this.data.registeredRacers,{paymentId:t}));e?(this.racerToEdit=e,this.showModal=!0):alert("no payment id found for racer")},racerUpdated(){this.racerToEdit=null,this.showModal=!1,this.fetchData()},capitalize(t){return J.capitalize(t)},closeModal(){this.showModal=!1,J.defer(()=>{document.querySelector("#racerFilterTxtInput").focus()})},resetFilters(){this.filterKey="",this.filterUnpaid=!1,this.filterNoBib=!1,this.filterCats="all"}},computed:{loaded(){return!!this.data},sortedCats(){let t={all:"All Categories"};return J.forEach(J.orderBy(this.data.regCategories,"disporder"),e=>{t[e.id]=e.catdispname}),t},filteredRacers(){const t=this.filterKey&&this.filterKey.toLowerCase();let e=this.data.registeredRacers;if(this.filterSimilar){let a=[];return J.forEach(this.data.races,(c,s)=>{console.log(c);let r=J.filter(e,{raceid:c});J.forEach(r,(n,d)=>{J.forEach(J.filter(e,{raceid:this.data.races[s+1]}),i=>{(n.first_name.toLowerCase()===i.first_name.toLowerCase()||n.last_name.toLowerCase()===i.last_name.toLowerCase())&&(J.includes(a,n)||a.push(n),J.includes(a,i)||a.push(i))})})}),J.sortBy(a,[function(c){return c.last_name.toLowerCase()}])}return(t.length||this.filterUnpaid||this.filterCats!=="all"||this.filterNoBib)&&(e=e.filter(a=>this.filterUnpaid&&a.status!=="unpaid"||this.filterNoBib&&a.bibNumber||this.filterCats!="all"&&a.category!=this.filterCats?!1:["first_name","last_name","bibNumber"].some(c=>String(a[c]).toLowerCase().indexOf(t)>-1))),J.sortBy(e,[function(a){return a.last_name.toLowerCase()}])}}},gb={key:0,class:"loading"},vb={key:1},yb={key:0,class:"error"},bb={key:1,class:"container-fluid"},_b={class:"racer-controls d-flex flex-row justify-content-between flex-wrap align-items-top pt-3 pb-2 mb-3 p-2 border-bottom"},Cb={class:"p-2"},Db={class:"flex-grow-1 p-2"},Sb={class:"d-flex flex-row search-checks"},xb={class:"d-flex flex-grow-1 justify-content-between pt-4"},Eb={class:"table-responsive"},wb={class:"table table-striped table-sm"},Pb=o("th",{scope:"col"},"First Name",-1),Rb=o("th",{scope:"col"},"Last Name",-1),Tb=o("th",{scope:"col"},"Email",-1),Ob=o("th",{scope:"col"},"Category",-1),Ib=o("th",{scope:"col"},"Bib Number",-1),kb=o("th",{scope:"col"},"Paytype",-1),$b=o("th",{scope:"col"},"EventName",-1),Ab={scope:"col"},Mb=["onClick"],Fb={key:2},Nb=o("div",{class:"text-center"},[o("h2",{class:"mt-5"},"Race not available for registration...")],-1),Lb=[Nb];function Ub(t,e,a,c,s,r){const n=A("FormKit"),d=A("RacerFormComponent"),i=A("modal-component");return s.loading?(u(),p("div",gb,"Loading...")):(u(),p("div",vb,[s.error?(u(),p("div",yb,b(s.error),1)):P("",!0),r.loaded?(u(),p("div",bb,[o("div",_b,[o("div",Cb,[D(n,{id:"racerFilterTxtInput",type:"text",name:"search",label:"Search:",help:"search in first, last or bib number",delay:300,modelValue:s.filterKey,"onUpdate:modelValue":e[0]||(e[0]=l=>s.filterKey=l)},null,8,["modelValue"])]),o("div",Db,[D(n,{type:"select",name:"categories",label:"Filter by Category",options:r.sortedCats,modelValue:s.filterCats,"onUpdate:modelValue":e[1]||(e[1]=l=>s.filterCats=l)},null,8,["options","modelValue"]),o("div",Sb,[D(n,{type:"checkbox",name:"unpaid",label:"Unpaid Only",modelValue:s.filterUnpaid,"onUpdate:modelValue":e[2]||(e[2]=l=>s.filterUnpaid=l)},null,8,["modelValue"]),D(n,{type:"checkbox",name:"noBib",label:"No Bib Only",modelValue:s.filterNoBib,"onUpdate:modelValue":e[3]||(e[3]=l=>s.filterNoBib=l)},null,8,["modelValue"]),D(n,{type:"checkbox",name:"duplicates",label:"Duplicates",modelValue:s.filterSimilar,"onUpdate:modelValue":e[4]||(e[4]=l=>s.filterSimilar=l)},null,8,["modelValue"])])]),o("div",xb,[o("a",{class:"btn btn-primary align-self-start",onClick:e[5]||(e[5]=(...l)=>r.resetFilters&&r.resetFilters(...l))},"Reset Filters")])]),o("div",Eb,[o("table",wb,[o("thead",null,[o("tr",null,[Pb,Rb,Tb,Ob,Ib,kb,$b,o("th",Ab,[o("strong",null,b(r.filteredRacers.length)+" Found",1)])])]),o("tbody",null,[(u(!0),p(Q,null,ie(r.filteredRacers,(l,m)=>(u(),p("tr",{key:m},[o("td",null,b(l.first_name),1),o("td",null,b(l.last_name),1),o("td",null,b(l.email),1),o("td",null,b(r.catName(l.category)),1),o("td",null,b(l.bibNumber),1),o("td",null,b(l.paytype),1),o("td",null,b(l.eventDisplayName),1),o("td",null,[o("div",{class:"btn btn-sm btn-outline-secondary",onClick:f=>r.editRacer(l.paymentId)},b("edit"),8,Mb)])]))),128))])]),(u(),ee(xt,{to:"body"},[D(i,{show:s.showModal,onClose:r.closeModal},{body:V(()=>[D(d,{onSaved:r.racerUpdated,racerData:s.racerToEdit,categories:s.data.regCategories,payments:s.data.paymentOptions,formMode:"edit",series:s.data.series},null,8,["onSaved","racerData","categories","payments","series"])]),_:1},8,["show","onClose"])]))])])):(u(),p("div",Fb,Lb))]))}const jb=ve(pb,[["render",Ub]]);const Vb={components:{Grid:ro},data(){return{categories:{},loading:!1,error:null,data:{},showModal:!1,filterKey:"",filterUnpaid:!1,filterNoBib:!1,filterCats:"all"}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{fetchData(){this.error=null,this.loading=!0,this.$route.params.raceid&&W(`/api/racers/race/${this.$route.params.raceid}`).then(t=>{this.data=t.data,this.loading=!1}).catch(t=>{this.loading=!1,this.error=t.toString(),console.error(t)})},resetFilters(){this.filterKey="",this.filterUnpaid=!1,this.filterNoBib=!1,this.filterCats="all"},optionalPurchases(t){if(!t)return"";let e="",a=[],c=Object.keys(t).filter(s=>s.split("-").length==1);return c.length&&c.forEach(s=>{if(t[s+"-option"])return a.push(`${this.capitalize(s)}: ${t[s+"-option"]}`);a.push(this.capitalize(s))}),e=a.join(", "),e},capitalize(t){return J.capitalize(t)}},computed:{loaded(){return!!this.data},sortedCats(){let t={all:"All Categories"};return J.forEach(J.orderBy(this.data.regCategories,"disporder"),e=>{t[e.id]=e.catdispname}),t},filteredRacers(){const t=this.filterKey&&this.filterKey.toLowerCase();let e=this.data.registeredRacers.filter(a=>a.optionalPurchases&&Object.keys(a.optionalPurchases).length>0);return(t.length||this.filterUnpaid||this.filterCats!=="all"||this.filterNoBib)&&(e=e.filter(a=>this.filterUnpaid&&a.status!=="unpaid"||this.filterNoBib&&a.bibNumber||this.filterCats!="all"&&a.category!=this.filterCats?!1:["first_name","last_name","bibNumber"].some(c=>String(a[c]).toLowerCase().indexOf(t)>-1))),J.sortBy(e,[function(a){return a.last_name.toLowerCase()}])}}},Hb={key:0,class:"loading"},Bb={key:1},Gb={key:0,class:"error"},Kb={key:1,class:"container-fluid"},zb={class:"d-flex flex-row justify-content-center"},Yb={class:"p-2"},Wb={class:"racer-controls d-flex flex-row justify-content-between flex-wrap align-items-top pb-2 mb-3 border-bottom"},Xb={class:"p-2"},Jb={class:"flex-grow-1 p-2"},Qb={class:"d-flex flex-row search-checks"},Zb={class:"d-flex flex-grow-1 justify-content-between p-2 pt-4"},qb={class:"table-responsive"},e1={class:"table table-striped table-sm"},t1=o("th",{scope:"col"},"First Name",-1),s1=o("th",{scope:"col"},"Last Name",-1),o1=o("th",{scope:"col"},"Purchases",-1),n1={scope:"col"},r1={key:2},a1=o("div",{class:"text-center"},[o("h2",{class:"mt-5"},"Race not available for registration...")],-1),i1=[a1];function l1(t,e,a,c,s,r){const n=A("FormKit");return s.loading?(u(),p("div",Hb,"Loading...")):(u(),p("div",Bb,[s.error?(u(),p("div",Gb,b(s.error),1)):P("",!0),r.loaded?(u(),p("div",Kb,[o("div",zb,[o("div",Yb,[o("h3",null,b(s.data.displayName),1)])]),o("div",Wb,[o("div",Xb,[D(n,{id:"racerFilterTxtInput",type:"text",name:"search",label:"Search:",help:"search in first, last or bib number",delay:300,modelValue:s.filterKey,"onUpdate:modelValue":e[0]||(e[0]=d=>s.filterKey=d)},null,8,["modelValue"])]),o("div",Jb,[D(n,{type:"select",name:"categories",label:"Filter by Category",options:r.sortedCats,modelValue:s.filterCats,"onUpdate:modelValue":e[1]||(e[1]=d=>s.filterCats=d)},null,8,["options","modelValue"]),o("div",Qb,[D(n,{type:"checkbox",name:"unpaid",label:"Unpaid Only",modelValue:s.filterUnpaid,"onUpdate:modelValue":e[2]||(e[2]=d=>s.filterUnpaid=d)},null,8,["modelValue"]),D(n,{type:"checkbox",name:"noBib",label:"No Bib Only",modelValue:s.filterNoBib,"onUpdate:modelValue":e[3]||(e[3]=d=>s.filterNoBib=d)},null,8,["modelValue"])])]),o("div",Zb,[o("a",{class:"btn btn-primary align-self-start",onClick:e[4]||(e[4]=(...d)=>r.resetFilters&&r.resetFilters(...d))},"Reset Filters")])]),o("div",qb,[o("table",e1,[o("thead",null,[o("tr",null,[t1,s1,o1,o("th",n1,[o("strong",null,b(r.filteredRacers.length)+" Found",1)])])]),o("tbody",null,[(u(!0),p(Q,null,ie(r.filteredRacers,(d,i)=>(u(),p("tr",{key:i},[o("td",null,b(d.first_name),1),o("td",null,b(d.last_name),1),o("td",null,b(r.optionalPurchases(d.optionalPurchases)),1),o("td",null,b(d.paytype),1)]))),128))])])])])):(u(),p("div",r1,i1))]))}const c1=ve(Vb,[["render",l1]]),d1={props:["races"],components:{RouterView:no},data(){return{count:0}},computed:{}},u1={class:"container-fluid"},m1={class:"nav nav-tabs"},h1={class:"nav-item"},f1={class:"nav-item"},p1={class:"nav-item"};function g1(t,e,a,c,s,r){const n=A("RouterLink"),d=A("RouterView");return u(),p("div",u1,[o("ul",m1,[o("li",h1,[D(n,{class:ne(["nav-link",{active:t.$route.name=="edit-race"}]),to:{name:"edit-race"}},{default:V(()=>[T(" Event Settings ")]),_:1},8,["class"])]),o("li",f1,[D(n,{class:ne(["nav-link",{active:t.$route.name=="edit-racers"}]),to:{name:"edit-racers"}},{default:V(()=>[T(" Event Registrations ")]),_:1},8,["class"])]),o("li",p1,[D(n,{class:ne(["nav-link",{active:t.$route.name=="racer-purchases"}]),to:{name:"racer-purchases"}},{default:V(()=>[T(" Extra Purchases ")]),_:1},8,["class"])])]),D(d)])}const v1=ve(d1,[["render",g1]]);const y1={components:{},props:["raceData"],emits:["save","close"],data(){return{formError:[],formInputData:{}}},mounted(){},computed:{eventDate(){return ot(this.raceData.eventDate).format("YYYY-MM-DDTHH:mm")},regOpenDate(){return ot(this.raceData.regOpenDate).format("YYYY-MM-DDTHH:mm")},timeToOpen(){var t;return ot().to((t=this.formInputData.eventDetails)==null?void 0:t.regOpenDate)},timeToClose(){var t;return ot().to((t=this.formInputData.eventDetails)==null?void 0:t.regCloseDate)}},methods:{submitHandler(){this.formInputData.raceid=this.formatNameToId(this.formInputData.displayName),this.$emit("save",this.formInputData)},formatNameToId(t){return t.replace(/\s+/g,"_").toLowerCase().replace("+","_plus_").replace("-","_minus_").replace(/\W/g,"")}}},b1={class:"edit-categories-form"},_1={class:"modal-footer-buttons mt-3"};function C1(t,e,a,c,s,r){const n=A("FormKit");return u(),p(Q,null,[o("div",b1,[D(n,{type:"form",modelValue:s.formInputData,"onUpdate:modelValue":e[0]||(e[0]=d=>s.formInputData=d),id:"race-clone-form",label:"Race Information",validation:"required",actions:!1},{default:V(()=>{var d,i;return[D(n,{value:(d=a.raceData)==null?void 0:d.displayName,type:"text",name:"displayName",label:"Event Name"},null,8,["value"]),D(n,{value:(i=a.raceData)==null?void 0:i.contactEmail,type:"text",name:"contactEmail",label:"Contact Email"},null,8,["value"]),D(n,{value:r.eventDate,type:"datetime-local",name:"eventDate",label:"Date"},null,8,["value"]),D(n,{type:"group",name:"eventDetails"},{default:V(()=>{var l,m,f,h,g,v,y,_,S,w,$,C,I,O,H,G;return[D(n,{value:(m=(l=a.raceData)==null?void 0:l.eventDetails)==null?void 0:m.name,type:"text",name:"name",label:"Header Event Name"},null,8,["value"]),D(n,{value:(h=(f=a.raceData)==null?void 0:f.eventDetails)==null?void 0:h.formattedDates,type:"text",name:"formattedDates",label:"Header Formatted dates"},null,8,["value"]),D(n,{value:(v=(g=a.raceData)==null?void 0:g.eventDetails)==null?void 0:v.tagline,type:"text",name:"tagline",label:"Header tagline text"},null,8,["value"]),D(n,{value:(_=(y=a.raceData)==null?void 0:y.eventDetails)==null?void 0:_.regOpenDate,type:"datetime-local",name:"regOpenDate",label:"Registration Open Date"},null,8,["value"]),o("p",null,"Registration Opens "+b(r.timeToOpen),1),D(n,{value:(w=(S=a.raceData)==null?void 0:S.eventDetails)==null?void 0:w.regCloseDate,type:"datetime-local",name:"regCloseDate",label:"Registration Close Date"},null,8,["value"]),o("p",null,"Registration Closes "+b(r.timeToClose),1),D(n,{value:(C=($=a.raceData)==null?void 0:$.eventDetails)==null?void 0:C.logoUrl,type:"text",name:"logoUrl",label:"Logo URL"},null,8,["value"]),D(n,{value:(O=(I=a.raceData)==null?void 0:I.eventDetails)==null?void 0:O.headerPhoto,type:"text",name:"headerPhoto",label:"Header Photo URL"},null,8,["value"]),D(n,{value:(G=(H=a.raceData)==null?void 0:H.eventDetails)==null?void 0:G.homepageUrl,type:"text",name:"homepageUrl",label:"Home Page URL"},null,8,["value"]),D(n,{type:"group",name:"facebookShare"},{default:V(()=>{var k,L,B;return[D(n,{value:(B=(L=(k=a.raceData)==null?void 0:k.eventDetails)==null?void 0:L.facebookShare)==null?void 0:B.url,type:"text",name:"url",label:"FB Share URL"},null,8,["value"])]}),_:1})]}),_:1})]}),_:1},8,["modelValue"])]),o("div",_1,[o("button",{class:"btn btn-sm btn-primary px-5 mx-3",onClick:e[1]||(e[1]=(...d)=>r.submitHandler&&r.submitHandler(...d))},"Save"),o("button",{class:"btn btn-sm btn-danger px-3 mx-3",onClick:e[2]||(e[2]=d=>t.$emit("close"))},"Cancel")])],64)}const D1=ve(y1,[["render",C1]]);const S1={components:{RouterLink:us,Check:ao,Copy:ms,Pencil:$t,ModalComponent:Xe,CloneRaceComponent:D1},data(){return{loading:!1,modalMode:null,showModal:!1,raceToClone:{},error:null,seriesList:[]}},created(){this.fetchSeriesList(),this.$watch(()=>[this.$route.params,this.$route.query],()=>{this.fetchData()},{immediate:!0})},methods:{async fetchSeriesList(){try{const t=await W("/api/series/");this.seriesList=t.data}catch(t){console.error("Error fetching series list:",t)}},fetchData(){if(this.error=null,this.loading=!0,this.$route){let t={};const e={};return this.$route.query.archived=="true"&&(e.archived=!0),this.$route.query.startDate&&(e.startDate=this.$route.query.startDate),this.$route.query.endDate&&(e.endDate=this.$route.query.endDate),Object.keys(e).length>0&&(t.params=e),W("/api/races/",t).then(a=>{this.raceData=a.data,this.loading=!1}).catch(a=>{this.loading=!1,this.error=a.toString(),console.error(a)})}},createRaceClone(t){this.showModal=!0,this.modalMode="clone",this.raceToClone=J.omit(t,"series","seriesRaceNumber","archived")},async cloneRace(t){console.log("race to clone"),console.log(this.raceToClone.raceid),console.log(t.raceid),await W.post(`/api/races/clone/${this.raceToClone.raceid}`,t).then(e=>{if(e.data)return console.log(t),this.closeModal(),console.log(e.data),this.fetchData()}).catch(e=>{this.formError=["Error submitting request"],console.log(e)})},closeModal(){this.showModal=!1,this.modalMode=null},getSeriesName(t){if(!t)return"—";const e=this.seriesList.find(a=>a.seriesId===t||a.series===t);return e?e.displayName||e.name:t}},computed:{loaded(){return!!this.raceData},currentPeriod(){return this.$route.query.startDate&&this.$route.query.endDate?`${this.$route.query.startDate} to ${this.$route.query.endDate}`:"Recent & Upcoming"},filteredRaceData(){return this.raceData?this.$route.query.series?this.raceData.filter(t=>t.series===this.$route.query.series):this.raceData:[]},currentSeriesName(){if(!this.$route.query.series)return null;const t=this.seriesList.find(e=>e.seriesId===this.$route.query.series||e.series===this.$route.query.series);return t?t.displayName||t.name:this.$route.query.series},yearLinks(){const t=ot().year(),e=[];for(let a=0;a<4;a++){const c=t-a;e.push({year:c,label:c.toString(),startDate:`${c}-01-01`,endDate:`${c}-12-31`})}return e}}},x1={key:0,class:"loading"},E1={key:1},w1={key:0,class:"error"},P1={key:1},R1={class:"d-flex justify-content-between align-items-center mb-3"},T1={key:0,class:"badge bg-info ms-2"},O1={class:"mb-3"},I1={class:"row"},k1={class:"col-md-8"},$1={class:"btn-group",role:"group"},A1={class:"col-md-4"},M1=o("label",{for:"seriesFilter",class:"form-label small text-muted mb-1"},"Filter by Series:",-1),F1={class:"input-group input-group-sm"},N1=["value"],L1=o("option",{value:""},"All Races",-1),U1=["value"],j1={class:"table-responsive"},V1={class:"table table-striped table-hover table-sm"},H1=o("thead",null,[o("tr",null,[o("th",{scope:"col"},"Name"),o("th",{scope:"col"},"Series"),o("th",null,"Test Payments")])],-1),B1=["href"],G1=["href"],K1=["href"],z1=["href"],Y1=o("h5",null," Clone Race ",-1),W1=o("div",null,null,-1),X1={key:2},J1=o("div",{class:"text-center"},[o("h2",{class:"mt-5"},"Error loading races...")],-1),Q1=[J1];function Z1(t,e,a,c,s,r){const n=A("Pencil"),d=A("RouterLink"),i=A("Check"),l=A("Copy"),m=A("CloneRaceComponent"),f=A("modal-component");return s.loading?(u(),p("div",x1,"Loading...")):(u(),p("div",E1,[s.error?(u(),p("div",w1,b(s.error),1)):P("",!0),r.loaded?(u(),p("div",P1,[o("div",R1,[o("h2",null,[T(" Active Races - "+b(r.currentPeriod)+" ",1),r.currentSeriesName?(u(),p("span",T1,[T(b(r.currentSeriesName)+" ",1),D(d,{to:{name:"edit-series",params:{seriesId:t.$route.query.series}},class:"text-white text-decoration-none ms-2",title:"Edit series"},{default:V(()=>[D(n,{size:16})]),_:1},8,["to"])])):P("",!0)])]),o("div",O1,[o("div",I1,[o("div",k1,[o("div",$1,[D(d,{to:{name:t.$route.name,query:{}},class:ne(["btn btn-sm",t.$route.query.startDate?"btn-outline-primary":"btn-primary"])},{default:V(()=>[T(" Recent & Upcoming ")]),_:1},8,["to","class"]),(u(!0),p(Q,null,ie(r.yearLinks,h=>(u(),ee(d,{key:h.year,to:{name:t.$route.name,query:{startDate:h.startDate,endDate:h.endDate}},class:ne(["btn btn-sm",t.$route.query.startDate===h.startDate?"btn-primary":"btn-outline-primary"])},{default:V(()=>[T(b(h.label),1)]),_:2},1032,["to","class"]))),128))])]),o("div",A1,[M1,o("div",F1,[o("select",{id:"seriesFilter",class:"form-select form-select-sm",value:t.$route.query.series||"",onChange:e[0]||(e[0]=h=>t.$router.push({name:t.$route.name,query:{...t.$route.query,series:h.target.value||void 0}}))},[L1,(u(!0),p(Q,null,ie(s.seriesList,h=>(u(),p("option",{key:h.seriesId||h.series,value:h.seriesId||h.series},b(h.displayName||h.name)+" ("+b(h.year)+") ",9,U1))),128))],40,N1),t.$route.query.series?(u(),p("button",{key:0,class:"btn btn-outline-secondary",type:"button",onClick:e[1]||(e[1]=h=>t.$router.push({name:t.$route.name,query:{...t.$route.query,series:void 0}})),title:"Clear filter"}," ✕ ")):P("",!0)])])])]),o("div",j1,[o("table",V1,[H1,o("tbody",null,[(u(!0),p(Q,null,ie(r.filteredRaceData,(h,g)=>(u(),p("tr",{key:g},[o("td",null,[D(d,{to:{name:"edit-racers",params:{raceid:h.raceid}}},{default:V(()=>[T(b(h.displayName),1)]),_:2},1032,["to"])]),o("td",null,b(r.getSeriesName(h.series)),1),o("td",null,[h.isTestData?(u(),ee(i,{key:0,color:"orange"})):P("",!0)]),o("td",null,[o("a",{href:`/#/register/${h.raceid}`},"Goto Reg Form",8,B1)]),o("td",null,[D(l,{class:"mx-3",color:"black",onClick:v=>r.createRaceClone(h)},null,8,["onClick"]),o("a",{class:"btn btn-sm btn-secondary mx-1",href:`/api/racers/race/${h.raceid}/export-contact`},"Contact List",8,G1),o("a",{class:"btn btn-sm btn-secondary mx-1",href:`/api/racers/race/${h.raceid}/export`},"export",8,K1),o("a",{class:"btn btn-sm btn-secondary mx-1",href:`/api/racers/race/${h.raceid}/export?assignedBibsOnly=true`},"webscorer export",8,z1)])]))),128))])]),(u(),ee(xt,{to:"body"},[s.modalMode=="clone"?(u(),ee(f,{key:0,show:s.showModal,onClose:r.closeModal},{header:V(()=>[Y1]),body:V(()=>[D(m,{raceData:s.raceToClone,onClose:r.closeModal,onSave:r.cloneRace},null,8,["raceData","onClose","onSave"])]),footer:V(()=>[W1]),_:1},8,["show","onClose"])):P("",!0)]))])])):(u(),p("div",X1,Q1))]))}const q1=ve(S1,[["render",Z1]]),e_={components:{RouterView:no},data(){return{count:0}},computed:{}},t_={class:"container-fluid"},s_=o("ul",{class:"nav nav-tabs"},null,-1);function o_(t,e,a,c,s,r){const n=A("RouterView");return u(),p("div",t_,[s_,D(n)])}const n_=ve(e_,[["render",o_]]);const r_={components:{RouterLink:us,Check:ao},data(){return{loading:!1,error:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{fetchData(){if(this.error=null,this.loading=!0,this.$route)return W("/api/results/").then(t=>{this.results=t.data,this.loading=!1}).catch(t=>{this.loading=!1,this.error=t.toString(),console.error(t)})}},computed:{loaded(){return!!this.results}}},a_={key:0,class:"loading"},i_={key:1},l_={key:0,class:"error"},c_={key:1},d_=o("h2",null,"Race Result Uploads",-1),u_={class:"table-responsive"},m_={class:"table table-striped table-hover table-sm"},h_=o("thead",null,[o("tr",null,[o("th",{scope:"col"},"Event Name"),o("th",{scope:"col"},"Series Points Display Name"),o("th",{scope:"col"},"Formatted Date"),o("th",{scope:"col"},"series ID"),o("th",{scope:"col"},"Finalized")])],-1),f_=["href"],p_=o("td",null,null,-1),g_={key:2},v_=o("div",{class:"text-center"},[o("h2",{class:"mt-5"},"Error loading results...")],-1),y_=[v_];function b_(t,e,a,c,s,r){const n=A("Check"),d=A("RouterLink");return s.loading?(u(),p("div",a_,"Loading...")):(u(),p("div",i_,[s.error?(u(),p("div",l_,b(s.error),1)):P("",!0),r.loaded?(u(),p("div",c_,[d_,o("div",u_,[o("table",m_,[h_,o("tbody",null,[(u(!0),p(Q,null,ie(t.results,(i,l)=>(u(),p("tr",{key:l},[o("td",null,b(i.eventName),1),o("td",null,b(i.shortName),1),o("td",null,b(i.formattedStartDate),1),o("td",null,b(i.series),1),o("td",null,[i.final?(u(),ee(n,{key:0,color:"red"})):P("",!0)]),o("td",null,[D(d,{to:{name:"edit-result",params:{resultid:i.raceid}}},{default:V(()=>[T("Edit")]),_:2},1032,["to"])]),o("td",null,[o("a",{href:`/#/result/${i.raceid}`,target:"_blank"},"View Output",8,f_)]),p_]))),128))])])])])):(u(),p("div",g_,y_))]))}const __=ve(r_,[["render",b_]]);const C_={components:{},data(){return{categories:{},loading:!1,error:null,formError:[],formInputData:{},raceData:{}}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{dollas(t){return typeof t=="string"&&(t=parseInt(t)),t.toLocaleString("en-US",{style:"currency",currency:"USD"})},fetchData(){if(this.error=null,this.loading=!0,this.$route.params.resultid)return W(`/api/results/${this.$route.params.resultid}`).then(t=>{this.raceData=t.data,this.loading=!1}).catch(t=>{this.raceData={},this.loading=!1,this.error=t.toString(),console.error(t)})},editCategories(){},editPaytypes(){},async saveRaceData(t){await W.patch(`/api/results/${this.raceData._id}`,this.formInputData).then(e=>{if(e.data)return console.log(e.data),this.fetchData()}).catch(e=>{this.formError=["Error submitting request"],console.log(e)})}},computed:{loaded(){return!!this.raceData}}},D_={class:"container"},S_={key:0,class:"loading"},x_={key:1},E_={key:0,class:"error"},w_={key:1},P_={class:"my-3"},R_=["href"],T_={class:"row"},O_={class:"col-md-6"},I_={key:2},k_=o("div",{class:"text-center"},[o("h2",{class:"mt-5"},"Result upload not found...")],-1),$_=[k_];function A_(t,e,a,c,s,r){const n=A("FormKit");return u(),p("div",D_,[s.loading?(u(),p("div",S_,"Loading...")):(u(),p("div",x_,[s.error?(u(),p("div",E_,b(s.error),1)):P("",!0),s.raceData.raceid?(u(),p("div",w_,[o("div",P_,[o("a",{href:`/#/result/${s.raceData.raceid}`},"View Result",8,R_)]),o("div",T_,[o("div",O_,[D(n,{type:"form",errors:s.formError,id:"race-settings",onSubmit:r.saveRaceData,"submit-label":"Save",modelValue:s.formInputData,"onUpdate:modelValue":e[0]||(e[0]=d=>s.formInputData=d)},{default:V(()=>{var d,i,l,m,f,h;return[D(n,{value:(d=s.raceData)==null?void 0:d.eventName,type:"text",name:"eventName",label:"Event Name"},null,8,["value"]),D(n,{value:(i=s.raceData)==null?void 0:i.shortName,type:"text",name:"shortName",label:"Short Name for series points column header"},null,8,["value"]),D(n,{value:(l=s.raceData)==null?void 0:l.formattedStartDate,type:"text",name:"formattedStartDate",label:"Display Date"},null,8,["value"]),D(n,{value:(m=s.raceData)==null?void 0:m.series,type:"text",name:"series",label:"series"},null,8,["value"]),D(n,{value:(f=s.raceData)==null?void 0:f.showMillis,type:"checkbox",label:"Show milliseconds on times",name:"showMillis"},null,8,["value"]),D(n,{value:(h=s.raceData)==null?void 0:h.final,type:"checkbox",label:"Finalized - results cannot be updated via upload",name:"final"},null,8,["value"])]}),_:1},8,["errors","onSubmit","modelValue"])])])])):(u(),p("div",I_,$_))]))])}const M_=ve(C_,[["render",A_]]);const F_={components:{RouterLink:us,Check:ao},data(){return{seriesOptions:!1,loading:!1,error:null}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData()},{immediate:!0})},methods:{getSeriesResult(t){return J.find(this.results,{series:t})},fetchData(){if(this.error=null,this.loading=!0,this.$route)return W("/api/results/series/").then(t=>(this.results=t.data,this.loading=!1,this.getRaceResults())).catch(t=>{this.loading=!1,this.error=t.toString(),console.error(t)})},getRaceResults(){return W("/api/results/").then(t=>{let e={};t.data.forEach(a=>{a.series&&(this.getSeriesResult(a.series)||(e[a.series]?e[a.series]+=1:e[a.series]=1))}),this.seriesOptions=e}).catch(t=>{console.error(t)})},async generateSeriesPoints(t){await W.post(`/api/results/series/${t}/generate`).then(e=>{if(e.data)return console.log(e.data),this.fetchData()})}},computed:{loaded(){return!!this.seriesOptions}}},N_={key:0,class:"loading"},L_={key:1},U_={key:0,class:"error"},j_={key:1},V_=o("div",{class:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom"},[o("h2",null,"Series Points Listings"),o("div",{class:"btn-toolbar mb-2 mb-md-0"})],-1),H_={key:0,class:"table-responsive"},B_={class:"table table-striped table-hover table-sm"},G_=o("thead",null,[o("tr",null,[o("th",{scope:"col"},"series ID"),o("th",{scope:"col"},"Display Name"),o("th",{scope:"col"},"Published")])],-1),K_=["href"],z_=["onClick"],Y_={key:1},W_=o("h4",null,"No series points calculations found",-1),X_=[W_],J_=o("h4",null,"Races without points Listings",-1),Q_={key:2,class:"table-responsive"},Z_={class:"table table-striped table-hover table-sm"},q_=o("thead",null,[o("tr",null,[o("th",{scope:"col"},"series ID"),o("th",{scope:"col"},"number of results")])],-1),eC=["onClick"],tC={key:2},sC=o("div",{class:"text-center"},[o("h2",{class:"mt-5"},"Error loading results...")],-1),oC=[sC];function nC(t,e,a,c,s,r){const n=A("Check"),d=A("RouterLink");return s.loading?(u(),p("div",N_,"Loading...")):(u(),p("div",L_,[s.error?(u(),p("div",U_,b(s.error),1)):P("",!0),r.loaded?(u(),p("div",j_,[V_,Object.keys(t.results).length?(u(),p("div",H_,[o("table",B_,[G_,o("tbody",null,[(u(!0),p(Q,null,ie(t.results,(i,l)=>(u(),p("tr",null,[o("td",null,b(i.series),1),o("td",null,b(i.eventName),1),o("td",null,[i.published?(u(),ee(n,{key:0,color:"green"})):P("",!0)]),o("td",null,[D(d,{to:{name:"edit-series-result",params:{series:i._id}}},{default:V(()=>[T("Edit")]),_:2},1032,["to"])]),o("td",null,[o("a",{href:`/#/result/series/${i.series}`,target:"_blank"},"view series points",8,K_)]),o("td",null,[i.final?P("",!0):(u(),p("button",{key:0,type:"button",class:"btn btn-sm btn-primary",onClick:m=>r.generateSeriesPoints(i.series)}," Update Series Points ",8,z_))])]))),256))])])])):(u(),p("div",Y_,X_)),J_,Object.keys(s.seriesOptions).length?(u(),p("div",Q_,[o("table",Z_,[q_,o("tbody",null,[(u(!0),p(Q,null,ie(s.seriesOptions,(i,l)=>(u(),p("tr",null,[o("td",null,b(l),1),o("td",null,b(i),1),o("td",null,[o("button",{type:"button",class:"btn btn-sm btn-primary",onClick:m=>r.generateSeriesPoints(l)}," Create Series Points ",8,eC)])]))),256))])])])):P("",!0)])):(u(),p("div",tC,oC))]))}const rC=ve(F_,[["render",nC]]);const aC={props:["racerData","series"],emits:["saved"],data(){return{formError:[],submitted:!1,formInputData:{}}},mounted(){this.formInputData=this.racerData},computed:{},methods:{async submitHandler(t){console.log(t);let e;return e=W.post(`/api/team-comp/racers/?series=${this.series}`,t),await e.then(a=>{if(a.data)return this.submitted=!0,console.log("response data"),console.log(a.data),new Promise(c=>setTimeout(()=>{this.$emit("saved"),c()},100))}).catch(a=>{this.formError=["Error submitting request"],console.log(a)})}}},iC=o("div",{class:"modal-header"},[o("h5",null," Team Competition Info ")],-1),lC={class:"edit-racer-form"},cC={class:"double"};function dC(t,e,a,c,s,r){const n=A("FormKit");return u(),p(Q,null,[iC,o("div",lC,[D(n,{type:"form",id:"admin-registration",modelValue:s.formInputData,"onUpdate:modelValue":e[0]||(e[0]=d=>s.formInputData=d),"form-class":s.submitted?"hide":"show",errors:s.formError,"submit-label":"Save",onSubmit:r.submitHandler},{default:V(()=>[o("div",cC,[D(n,{type:"number",name:"Bib",label:"Bib Number"}),D(n,{type:"text",name:"Name",label:"Name",validation:"required"}),D(n,{type:"text",name:"Sponsor",label:"Team Name"}),D(n,{type:"text",name:"Cat",label:"Category"})])]),_:1},8,["modelValue","form-class","errors","onSubmit"])])],64)}const uC=ve(aC,[["render",dC]]);const mC={components:{ModalComponent:Xe,TeamRacerFormComponent:uC},data(){return{loading:!1,error:null,final:!1,filterKey:"",formError:[],formInputData:{},teamRacerToAdd:{},data:{},showModal:!1}},created(){this.$watch(()=>this.$route.params,()=>{this.fetchData(),this.fetchTeamCompRacers()},{immediate:!0})},methods:{dollas(t){return typeof t=="string"&&(t=parseInt(t)),t.toLocaleString("en-US",{style:"currency",currency:"USD"})},fetchData(){if(this.error=null,this.loading=!0,this.$route.params.series)return W(`/api/results/series/${this.$route.params.series}`).then(t=>{this.data=t.data,this.final=t.data.final,this.loading=!1}).catch(t=>{this.loading=!1,this.error=t.toString(),console.error(t)})},fetchTeamCompRacers(){return W(`/api/team-comp/racers/?series=${this.$route.params.series}`).then(t=>{this.teamRacers=t.data}).catch(t=>{this.loading=!1,this.error=t.toString(),console.error(t)})},async updateTeamCompRacer(t){console.log(t),this.teamRacerToAdd=t,this.showModal=!0},teamRacerUpdated(){this.teamRacerToAdd={},this.closeModal()},closeModal(){this.showModal=!1},async saveRaceData(t){await W.patch(`/api/results/series/${this.data._id}`,t).then(e=>{if(e.data)return console.log(e.data),this.fetchData()}).catch(e=>{this.formError=["Error submitting request"],console.log(e)})}},computed:{loaded(){return!!this.raceData},hasTeamComp(){var t,e;return((e=(t=this.data)==null?void 0:t.teamCompDates)==null?void 0:e.length)>1},teamCompRacers(){var t;if(this.hasTeamComp){let e=[];return Object.keys((t=this.data)==null?void 0:t.categories).forEach(a=>{let c=this.data.categories[a],s=c.catdispname;c.results.forEach(r=>{let n={Name:r.Name,Bib:r.Bib,Cat:s,Sponsor:r.Sponsor};e.push(n)})}),this.filterKey&&(e=e.filter(a=>a.Name.toLowerCase().indexOf(this.filterKey.toLowerCase())>-1||a.Bib==parseInt(this.filterKey))),e}}}},hC={class:"container"},fC={key:0,class:"loading"},pC={key:1},gC={key:0,class:"error"},vC={key:1},yC={class:"my-3"},bC=["href"],_C={class:"row"},CC={class:"col-md-6"},DC={key:0,class:"col-md-6"},SC=o("h5",null,"Racers",-1),xC={class:"btn-toolbar mb-2 mb-md-0"},EC={class:"row"},wC={class:"col"},PC=["onClick"],RC={class:"col"},TC={class:"col"},OC={class:"col"},IC={key:2},kC=o("div",{class:"text-center"},[o("h2",{class:"mt-5"},"Series Points record not found...")],-1),$C=[kC];function AC(t,e,a,c,s,r){var l;const n=A("FormKit"),d=A("TeamRacerFormComponent"),i=A("modal-component");return u(),p("div",hC,[s.loading?(u(),p("div",fC,"Loading...")):(u(),p("div",pC,[s.error?(u(),p("div",gC,b(s.error),1)):P("",!0),(l=this.data)!=null&&l.series?(u(),p("div",vC,[o("div",yC,[o("a",{href:`/#/result/series/${s.data.series}`,target:"_blank"},"view series points",8,bC)]),o("div",_C,[o("div",CC,[D(n,{type:"form",errors:s.formError,id:"season-pts-form",onSubmit:r.saveRaceData,"submit-label":"Save",modelValue:s.formInputData,"onUpdate:modelValue":e[0]||(e[0]=m=>s.formInputData=m)},{default:V(()=>{var m,f,h,g;return[D(n,{value:(m=s.data)==null?void 0:m.eventName,type:"text",name:"eventName",label:"Event Name"},null,8,["value"]),D(n,{value:(f=s.data)==null?void 0:f.gromRaceDates,type:"text",name:"gromRaceDates",label:"Grom Race Dates"},null,8,["value"]),D(n,{value:(h=s.data)==null?void 0:h.teamCompDates,type:"text",name:"teamCompDates",label:"Team Competition Race Dates"},null,8,["value"]),D(n,{value:s.final,type:"checkbox",label:"Finalized - don't allow updates",name:"final"},null,8,["value"]),D(n,{value:(g=s.data)==null?void 0:g.published,type:"checkbox",label:"Published - will show on main index",name:"published"},null,8,["value"])]}),_:1},8,["errors","onSubmit","modelValue"])]),r.hasTeamComp?(u(),p("div",DC,[SC,o("div",null,[o("div",xC,[D(n,{id:"racerFilterTxtInput",type:"text",name:"search",label:"Search:",help:"search in first, last, bib",delay:300,modelValue:s.filterKey,"onUpdate:modelValue":e[1]||(e[1]=m=>s.filterKey=m)},null,8,["modelValue"])])]),o("div",null,[(u(!0),p(Q,null,ie(r.teamCompRacers,m=>(u(),p("div",EC,[o("div",wC,[o("div",{class:"btn btn-sm btn-primary",onClick:f=>r.updateTeamCompRacer(m)},"Add",8,PC)]),o("div",RC,b(m.Name),1),o("div",TC,b(m.Bib),1),o("div",OC,b(m.Sponsor),1)]))),256))])])):P("",!0)]),(u(),ee(xt,{to:"body"},[D(i,{show:s.showModal,onClose:r.closeModal},{body:V(()=>[D(d,{onSaved:r.teamRacerUpdated,racerData:s.teamRacerToAdd,series:s.data.series},null,8,["onSaved","racerData","series"])]),_:1},8,["show","onClose"])]))])):(u(),p("div",IC,$C))]))])}const MC=ve(mC,[["render",AC]]);const FC={components:{RouterLink:us,Pencil:$t,Plus:co,ModalComponent:Xe},data(){return{loading:!1,seriesData:null,showModal:!1,modalMode:null,currentSeries:null,error:null}},created(){this.fetchData()},methods:{async fetchData(){this.error=null,this.loading=!0;try{const t=await W("/api/series/");this.seriesData=t.data,this.loading=!1}catch(t){this.loading=!1,this.error=t.toString(),console.error(t)}},createNewSeries(){this.currentSeries={seriesId:"",name:"",displayName:"",year:new Date().getFullYear(),active:!0,description:""},this.modalMode="create",this.showModal=!0},editSeries(t){this.currentSeries=J.cloneDeep(t),this.modalMode="edit",this.showModal=!0},async saveSeries(){var t,e;try{this.modalMode==="create"?await W.post("/api/series/",this.currentSeries):await W.patch(`/api/series/${this.currentSeries.seriesId||this.currentSeries.series}`,this.currentSeries),this.closeModal(),await this.fetchData()}catch(a){console.error("Error saving series:",a),alert("Error saving series: "+(((e=(t=a.response)==null?void 0:t.data)==null?void 0:e.message)||a.message))}},closeModal(){this.showModal=!1,this.modalMode=null,this.currentSeries=null},getRaceCount(t){return"—"}},computed:{loaded(){return!!this.seriesData}}},qe=t=>(at("data-v-22e12a9f"),t=t(),rt(),t),NC={key:0,class:"loading"},LC={key:1},UC={key:0,class:"error alert alert-danger"},jC={key:1},VC={class:"d-flex justify-content-between align-items-center mb-3"},HC=qe(()=>o("h2",null,"Series Management",-1)),BC={class:"table-responsive"},GC={class:"table table-striped table-hover table-sm"},KC=qe(()=>o("thead",null,[o("tr",null,[o("th",{scope:"col"},"Display Name"),o("th",{scope:"col"},"Year"),o("th",{scope:"col"},"Season Pass"),o("th",{scope:"col"},"Actions")])],-1)),zC={key:0,class:"badge bg-info"},YC={key:1,class:"text-muted"},WC={key:2},XC=qe(()=>o("div",{class:"text-center"},[o("h2",{class:"mt-5"},"Error loading series...")],-1)),JC=[XC],QC={class:"mb-3"},ZC=qe(()=>o("label",{for:"seriesId",class:"form-label"},"Series ID *",-1)),qC=["disabled"],eD=qe(()=>o("small",{class:"form-text text-muted"}," Unique identifier (lowercase, underscores only). Cannot be changed after creation. ",-1)),tD={class:"mb-3"},sD=qe(()=>o("label",{for:"name",class:"form-label"},"Name *",-1)),oD={class:"mb-3"},nD=qe(()=>o("label",{for:"displayName",class:"form-label"},"Display Name *",-1)),rD={class:"mb-3"},aD=qe(()=>o("label",{for:"year",class:"form-label"},"Year *",-1)),iD={class:"mb-3"},lD=qe(()=>o("label",{for:"description",class:"form-label"},"Description",-1)),cD={class:"mb-3 form-check"},dD=qe(()=>o("label",{class:"form-check-label",for:"active"}," Active (series is currently running) ",-1)),uD={key:0,class:"alert alert-info"},mD=qe(()=>o("strong",null,"Season Pass Pricing:",-1)),hD=qe(()=>o("br",null,null,-1)),fD=qe(()=>o("small",{class:"text-muted"}," Advanced pricing configuration coming soon. Use API for now. ",-1));function pD(t,e,a,c,s,r){const n=A("Plus"),d=A("Pencil"),i=A("RouterLink"),l=A("modal-component");return u(),p(Q,null,[s.loading?(u(),p("div",NC,"Loading...")):(u(),p("div",LC,[s.error?(u(),p("div",UC,b(s.error),1)):P("",!0),r.loaded?(u(),p("div",jC,[o("div",VC,[HC,o("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=(...m)=>r.createNewSeries&&r.createNewSeries(...m))},[D(n,{size:16,class:"me-1"}),T(" New Series ")])]),o("div",BC,[o("table",GC,[KC,o("tbody",null,[(u(!0),p(Q,null,ie(s.seriesData,m=>{var f;return u(),p("tr",{key:m.seriesId||m.series},[o("td",null,b(m.displayName||m.name),1),o("td",null,b(m.year),1),o("td",null,[m.seasonPassPricing?(u(),p("span",zC,b(((f=m.seasonPassPricing.categoryGroups)==null?void 0:f.length)||0)+" groups ",1)):(u(),p("span",YC,"—"))]),o("td",null,[D(i,{to:{name:"edit-series",params:{seriesId:m.seriesId||m.series}},class:"btn btn-sm btn-outline-primary me-2",title:"Edit series"},{default:V(()=>[D(d,{size:14})]),_:2},1032,["to"]),D(i,{to:{name:"races",query:{series:m.seriesId||m.series}},class:"btn btn-sm btn-outline-secondary"},{default:V(()=>[T(" View Races ")]),_:2},1032,["to"])])])}),128))])])])])):(u(),p("div",WC,JC))])),(u(),ee(xt,{to:"body"},[D(l,{show:s.showModal,onClose:r.closeModal},{header:V(()=>[o("h5",null,b(s.modalMode==="create"?"Create New Series":"Edit Series"),1)]),body:V(()=>{var m;return[s.currentSeries?(u(),p("form",{key:0,onSubmit:e[7]||(e[7]=st((...f)=>r.saveSeries&&r.saveSeries(...f),["prevent"]))},[o("div",QC,[ZC,le(o("input",{type:"text",class:"form-control",id:"seriesId","onUpdate:modelValue":e[1]||(e[1]=f=>s.currentSeries.seriesId=f),disabled:s.modalMode==="edit",required:"",placeholder:"e.g., bear_gravity_2026"},null,8,qC),[[ge,s.currentSeries.seriesId]]),eD]),o("div",tD,[sD,le(o("input",{type:"text",class:"form-control",id:"name","onUpdate:modelValue":e[2]||(e[2]=f=>s.currentSeries.name=f),required:"",placeholder:"e.g., Bear Gravity Series"},null,512),[[ge,s.currentSeries.name]])]),o("div",oD,[nD,le(o("input",{type:"text",class:"form-control",id:"displayName","onUpdate:modelValue":e[3]||(e[3]=f=>s.currentSeries.displayName=f),required:"",placeholder:"e.g., Bear Gravity Series 2026"},null,512),[[ge,s.currentSeries.displayName]])]),o("div",rD,[aD,le(o("input",{type:"number",class:"form-control",id:"year","onUpdate:modelValue":e[4]||(e[4]=f=>s.currentSeries.year=f),required:"",min:"2020",max:"2050"},null,512),[[ge,s.currentSeries.year,void 0,{number:!0}]])]),o("div",iD,[lD,le(o("textarea",{class:"form-control",id:"description","onUpdate:modelValue":e[5]||(e[5]=f=>s.currentSeries.description=f),rows:"3",placeholder:"Brief description of the series"},null,512),[[ge,s.currentSeries.description]])]),o("div",cD,[le(o("input",{type:"checkbox",class:"form-check-input",id:"active","onUpdate:modelValue":e[6]||(e[6]=f=>s.currentSeries.active=f)},null,512),[[ds,s.currentSeries.active]]),dD]),s.currentSeries.seasonPassPricing?(u(),p("div",uD,[mD,T(" "+b(((m=s.currentSeries.seasonPassPricing.categoryGroups)==null?void 0:m.length)||0)+" category groups configured ",1),hD,fD])):P("",!0)],32)):P("",!0)]}),footer:V(()=>[o("button",{type:"button",class:"btn btn-secondary",onClick:e[8]||(e[8]=(...m)=>r.closeModal&&r.closeModal(...m))},"Cancel"),o("button",{type:"button",class:"btn btn-primary",onClick:e[9]||(e[9]=(...m)=>r.saveSeries&&r.saveSeries(...m))},b(s.modalMode==="create"?"Create":"Save Changes"),1)]),_:1},8,["show","onClose"])]))],64)}const gD=ve(FC,[["render",pD],["__scopeId","data-v-22e12a9f"]]);const vD={components:{draggable:Fs,Pencil:$t,Copy:ms,Trash2:Bt,Plus:co,Edit:Fo},props:{categories:{type:Array,default:()=>[]},payTypes:{type:Object,default:()=>({})}},emits:["update:categories"],data(){return{formCats:[],editCatId:null,editFormData:{},editModeEnabled:!1}},mounted(){this.formCats=this.categories.map(t=>Object.assign({},t,{isExisting:!0}))},watch:{categories:{handler(t){this.formCats=t.map(e=>Object.assign({},e,{isExisting:!0}))},deep:!0}},methods:{emitUpdate(){const t=this.formCats.map((e,a)=>{let c=Object.assign({},e);return c.disporder=a+1,delete c.isExisting,c});this.$emit("update:categories",t)},editCategoryData(t){this.editCatId!==t&&(this.editCatId=t,this.editFormData=Object.assign({},this.formCats[t]))},saveCategory(t){let e=this.formCats[this.editCatId];!e.isExisting&&e.catdispname!==t.catdispname?t.id=t.catdispname.toLowerCase().replace(/[^a-z0-9]+/g,"_"):t.id=e.id,this.formCats[this.editCatId]=Object.assign({},t,{isExisting:e.isExisting}),this.editCatId=null,this.emitUpdate()},submitForm(t){if(t.preventDefault(),t.stopPropagation(),!this.editFormData.catdispname){alert("Category name is required");return}this.saveCategory(this.editFormData)},cancelEdit(){this.editCatId=null,this.editFormData={}},addCategory(){const t={id:"new_category_"+Date.now(),catdispname:"New Category",laps:1,startTime:"",minAge:null,maxAge:null,sponsored:!1,sponsorName:"",paytype:null,isExisting:!1};this.formCats.push(t),this.editCatId=this.formCats.length-1,this.editFormData=Object.assign({},t)},copyCategory(t,e){t.stopPropagation();let a=Object.assign({},this.formCats[e]);a.catdispname=a.catdispname+" (copy)",a.id=a.catdispname.toLowerCase().replace(/[^a-z0-9]+/g,"_"),a.isExisting=!1,this.formCats.splice(e+1,0,a),this.emitUpdate()},deleteCategory(t,e){t.stopPropagation(),confirm("Delete this category?")&&(this.formCats.splice(e,1),this.emitUpdate())},onDragEnd(){this.emitUpdate()},onDragStart(){this.editCatId!==null&&this.cancelEdit()},checkMove(){return this.editCatId===null}}},et=t=>(at("data-v-9abebc5a"),t=t(),rt(),t),yD={class:"edit-categories-form"},bD={class:"d-flex justify-content-between align-items-center mb-3"},_D={key:0,class:"text-muted ms-2 small"},CD=["onClick"],DD={class:"row mb-2"},SD={class:"col-md-6"},xD=et(()=>o("label",{class:"form-label small"},"Category Name *",-1)),ED={class:"col-md-2"},wD=et(()=>o("label",{class:"form-label small"},"Laps",-1)),PD={class:"col-md-4"},RD=et(()=>o("label",{class:"form-label small"},"Start Time",-1)),TD={class:"input-group input-group-sm"},OD={class:"row mb-2"},ID={class:"col-md-3"},kD=et(()=>o("label",{class:"form-label small"},"Minimum Age",-1)),$D={class:"col-md-3"},AD=et(()=>o("label",{class:"form-label small"},"Maximum Age",-1)),MD={class:"row mb-3"},FD={class:"col-md-6"},ND={class:"form-check"},LD=et(()=>o("label",{class:"form-check-label",for:"sponsored"}," Sponsored (no entry fee) ",-1)),UD={key:0,class:"col-md-6"},jD=et(()=>o("label",{class:"form-label small"},"Sponsor Name",-1)),VD={key:0,class:"row mb-3"},HD={class:"col-md-12"},BD=et(()=>o("label",{class:"form-label small"},"Force Payment Type (Optional)",-1)),GD=et(()=>o("option",{value:null},"No forced payment type",-1)),KD=["value"],zD=et(()=>o("small",{class:"text-muted"}," If set, this category will only be available with the selected payment type. ",-1)),YD={class:"d-flex gap-2"},WD=et(()=>o("button",{class:"btn btn-sm btn-primary",type:"submit"},"Save",-1)),XD={key:1,class:"cat-row p-2 border rounded bg-white d-flex align-items-center"},JD=et(()=>o("div",{class:"drag-handle me-2",style:{cursor:"move"}},[o("span",{class:"text-muted"},"⋮⋮")],-1)),QD={class:"cat-name flex-grow-1"},ZD={key:0,class:"text-muted ms-2 small"},qD={key:1,class:"text-muted ms-2 small"},e0={key:2,class:"text-muted ms-2 small"},t0={class:"cat-badges me-2"},s0={key:0,class:"badge bg-success"},o0={key:1,class:"badge bg-info"},n0={class:"cat-actions d-flex align-items-center gap-2"},r0={class:"badge bg-secondary"},a0=["onClick"],i0=["onClick"],l0={key:1,class:"compact-view"},c0={class:"table-responsive"},d0={class:"table table-sm table-hover table-bordered mb-0"},u0=et(()=>o("thead",{class:"table-light"},[o("tr",null,[o("th",{style:{width:"50px"}},"#"),o("th",null,"Category Name"),o("th",{style:{width:"100px"}},"Start Time"),o("th",{style:{width:"80px"}},"Laps"),o("th",{style:{width:"90px"}},"Min Age"),o("th",{style:{width:"90px"}},"Max Age"),o("th",{style:{width:"150px"}},"Sponsored"),o("th",{style:{width:"150px"}},"Payment Type")])],-1)),m0={class:"text-center text-muted"},h0={class:"text-center"},f0={key:0,class:"text-nowrap"},p0={key:1,class:"text-muted"},g0={class:"text-center"},v0={class:"text-center"},y0={class:"text-center"},b0={key:0,class:"badge bg-success"},_0={key:1,class:"text-muted"},C0={key:0,class:"badge bg-info"},D0={key:1,class:"text-muted"},S0={key:2,class:"text-center text-muted py-4 border rounded"};function x0(t,e,a,c,s,r){const n=A("Edit"),d=A("Plus"),i=A("Copy"),l=A("Trash2"),m=A("draggable");return u(),p("div",yD,[o("div",bD,[o("div",null,[o("button",{class:ne(["btn btn-sm",s.editModeEnabled?"btn-secondary":"btn-outline-secondary"]),onClick:e[0]||(e[0]=f=>s.editModeEnabled=!s.editModeEnabled)},[D(n,{size:16,class:"me-1"}),T(" "+b(s.editModeEnabled?"View Mode":"Enable Editing"),1)],2),s.editModeEnabled?(u(),p("span",_D,"Click to edit, drag to reorder")):P("",!0)]),s.editModeEnabled?(u(),p("button",{key:0,class:"btn btn-sm btn-primary",onClick:e[1]||(e[1]=(...f)=>r.addCategory&&r.addCategory(...f))},[D(d,{size:16,class:"me-1"}),T(" Add Category ")])):P("",!0)]),s.editModeEnabled?(u(),ee(m,{key:0,modelValue:s.formCats,"onUpdate:modelValue":e[13]||(e[13]=f=>s.formCats=f),onEnd:r.onDragEnd,onStart:r.onDragStart,"item-key":"id",move:r.checkMove,handle:".drag-handle"},{item:V(({element:f,index:h})=>[o("div",{class:"cat-group mb-2",onClick:g=>r.editCategoryData(h)},[s.editCatId===h?(u(),p("form",{key:0,onSubmit:e[12]||(e[12]=st((...g)=>r.submitForm&&r.submitForm(...g),["prevent"])),class:"p-3 border rounded bg-light"},[o("div",DD,[o("div",SD,[xD,le(o("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":e[2]||(e[2]=g=>s.editFormData.catdispname=g),required:"",style:{"min-width":"200px"}},null,512),[[ge,s.editFormData.catdispname]])]),o("div",ED,[wD,le(o("input",{type:"number",class:"form-control form-control-sm","onUpdate:modelValue":e[3]||(e[3]=g=>s.editFormData.laps=g),min:"0"},null,512),[[ge,s.editFormData.laps,void 0,{number:!0}]])]),o("div",PD,[RD,o("div",TD,[le(o("input",{type:"time",class:"form-control form-control-sm","onUpdate:modelValue":e[4]||(e[4]=g=>s.editFormData.startTime=g),placeholder:"HH:MM"},null,512),[[ge,s.editFormData.startTime]]),s.editFormData.startTime?(u(),p("button",{key:0,class:"btn btn-outline-secondary",type:"button",onClick:e[5]||(e[5]=g=>s.editFormData.startTime=""),title:"Clear start time"}," ✕ ")):P("",!0)])])]),o("div",OD,[o("div",ID,[kD,le(o("input",{type:"number",class:"form-control form-control-sm","onUpdate:modelValue":e[6]||(e[6]=g=>s.editFormData.minAge=g),min:"0",placeholder:"No minimum"},null,512),[[ge,s.editFormData.minAge,void 0,{number:!0}]])]),o("div",$D,[AD,le(o("input",{type:"number",class:"form-control form-control-sm","onUpdate:modelValue":e[7]||(e[7]=g=>s.editFormData.maxAge=g),min:"0",placeholder:"No maximum"},null,512),[[ge,s.editFormData.maxAge,void 0,{number:!0}]])])]),o("div",MD,[o("div",FD,[o("div",ND,[le(o("input",{type:"checkbox",class:"form-check-input",id:"sponsored","onUpdate:modelValue":e[8]||(e[8]=g=>s.editFormData.sponsored=g)},null,512),[[ds,s.editFormData.sponsored]]),LD])]),s.editFormData.sponsored?(u(),p("div",UD,[jD,le(o("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":e[9]||(e[9]=g=>s.editFormData.sponsorName=g)},null,512),[[ge,s.editFormData.sponsorName]])])):P("",!0)]),!s.editFormData.sponsored&&Object.keys(a.payTypes).length>0?(u(),p("div",VD,[o("div",HD,[BD,le(o("select",{class:"form-select form-select-sm","onUpdate:modelValue":e[10]||(e[10]=g=>s.editFormData.paytype=g)},[GD,(u(!0),p(Q,null,ie(a.payTypes,(g,v)=>(u(),p("option",{key:v,value:v},b(g)+" ("+b(v)+") ",9,KD))),128))],512),[[Io,s.editFormData.paytype]]),zD])])):P("",!0),o("div",YD,[WD,o("button",{class:"btn btn-sm btn-secondary",type:"button",onClick:e[11]||(e[11]=st((...g)=>r.cancelEdit&&r.cancelEdit(...g),["stop"]))},"Cancel")])],32)):(u(),p("div",XD,[JD,o("div",QD,[o("strong",null,b(f.catdispname),1),f.startTime?(u(),p("span",ZD,"🕐 "+b(f.startTime),1)):P("",!0),f.laps?(u(),p("span",qD,"("+b(f.laps)+" laps)",1)):P("",!0),f.minAge||f.maxAge?(u(),p("span",e0," Ages: "+b(f.minAge||"—")+" - "+b(f.maxAge||"—"),1)):P("",!0)]),o("div",t0,[f.sponsored?(u(),p("span",s0,"Sponsored")):f.paytype&&a.payTypes[f.paytype]?(u(),p("span",o0,b(a.payTypes[f.paytype]),1)):P("",!0)]),o("div",n0,[o("span",r0,b(h+1),1),o("button",{class:"btn btn-sm btn-outline-secondary",onClick:st(g=>r.copyCategory(g,h),["stop"]),title:"Copy"},[D(i,{size:14})],8,a0),o("button",{class:"btn btn-sm btn-outline-danger",onClick:st(g=>r.deleteCategory(g,h),["stop"]),title:"Delete"},[D(l,{size:14})],8,i0)])]))],8,CD)]),_:1},8,["modelValue","onEnd","onStart","move"])):(u(),p("div",l0,[o("div",c0,[o("table",d0,[u0,o("tbody",null,[(u(!0),p(Q,null,ie(s.formCats,(f,h)=>(u(),p("tr",{key:f.id},[o("td",m0,b(h+1),1),o("td",null,[o("strong",null,b(f.catdispname),1)]),o("td",h0,[f.startTime?(u(),p("span",f0,b(f.startTime),1)):(u(),p("span",p0,"—"))]),o("td",g0,b(f.laps||"—"),1),o("td",v0,b(f.minAge||"—"),1),o("td",y0,b(f.maxAge||"—"),1),o("td",null,[f.sponsored?(u(),p("span",b0,b(f.sponsorName||"Sponsored"),1)):(u(),p("span",_0,"—"))]),o("td",null,[f.paytype&&a.payTypes[f.paytype]?(u(),p("span",C0,b(a.payTypes[f.paytype]),1)):(u(),p("span",D0,"—"))])]))),128))])])])])),s.formCats.length===0?(u(),p("div",S0,' No categories defined. Click "Add Category" to create one. ')):P("",!0)])}const E0=ve(vD,[["render",x0],["__scopeId","data-v-9abebc5a"]]);const w0={components:{draggable:Fs,Pencil:$t,Copy:ms,Trash2:Bt,Plus:co,ChevronDown:xd,ChevronUp:wd,Edit:Fo},props:{categoryGroups:{type:Array,default:()=>[]},regCategories:{type:Array,default:()=>[]}},emits:["update:categoryGroups"],data(){return{formGroups:[],editGroupId:null,editFormData:{},expandedGroups:[],editModeEnabled:!1}},mounted(){this.formGroups=this.categoryGroups.map(t=>({...t,categories:[...t.categories||[]],paymentOptions:[...t.paymentOptions||[]],isExisting:!0}))},watch:{categoryGroups:{handler(t){this.formGroups=t.map(e=>({...e,categories:[...e.categories||[]],paymentOptions:[...e.paymentOptions||[]],isExisting:!0}))},deep:!0}},methods:{emitUpdate(){const t=this.formGroups.map(e=>{let a={...e};return delete a.isExisting,a});this.$emit("update:categoryGroups",t)},toggleExpand(t){const e=this.expandedGroups.indexOf(t);e>-1?this.expandedGroups.splice(e,1):this.expandedGroups.push(t)},isExpanded(t){return this.expandedGroups.includes(t)},editGroup(t){this.editGroupId!==t&&(this.editGroupId=t,this.editFormData={name:this.formGroups[t].name,categories:[...this.formGroups[t].categories],paymentOptions:this.formGroups[t].paymentOptions.map(e=>({...e}))})},saveGroup(){let t=this.formGroups[this.editGroupId];this.formGroups[this.editGroupId]={...this.editFormData,isExisting:t.isExisting},this.editGroupId=null,this.emitUpdate()},cancelEdit(){this.editGroupId=null,this.editFormData={}},addGroup(){const t={name:"New Category Group",categories:[],paymentOptions:[],isExisting:!1};this.formGroups.push(t),this.editGroupId=this.formGroups.length-1,this.editFormData={name:t.name,categories:[],paymentOptions:[]}},copyGroup(t,e){t.stopPropagation();let a={name:this.formGroups[e].name+" (copy)",categories:[...this.formGroups[e].categories],paymentOptions:this.formGroups[e].paymentOptions.map(c=>({...c})),isExisting:!1};this.formGroups.splice(e+1,0,a),this.emitUpdate()},deleteGroup(t,e){t.stopPropagation(),confirm("Delete this category group? Categories will become ungrouped.")&&(this.formGroups.splice(e,1),this.emitUpdate())},addPaymentOption(){this.editFormData.paymentOptions.push({name:"",type:"",amount:0})},removePaymentOption(t){this.editFormData.paymentOptions.splice(t,1)},addSpecialPaymentType(t){if(this.editFormData.paymentOptions.some(c=>c.type===t)){alert(`A ${t} payment type already exists in this group`);return}const a={type:t,amount:0};t==="season"?a.name="Season Pass":t==="cash"&&(a.name="Cash Payment (at event)"),this.editFormData.paymentOptions.push(a)},isSpecialPaymentType(t){return t==="season"||t==="cash"},getCategoryName(t){const e=this.regCategories.find(a=>a.id===t);return e?e.catdispname:t},getAvailableCategories(){const t=new Set;return this.formGroups.forEach((e,a)=>{a!==this.editGroupId&&e.categories.forEach(c=>t.add(c))}),this.regCategories.filter(e=>!t.has(e.id))},toggleCategory(t){const e=this.editFormData.categories.indexOf(t);e>-1?this.editFormData.categories.splice(e,1):this.editFormData.categories.push(t)},selectAllCategories(){const t=this.getAvailableCategories();this.editFormData.categories=t.map(e=>e.id)},clearAllCategories(){this.editFormData.categories=[]},submitForm(t){if(t.preventDefault(),t.stopPropagation(),!this.editFormData.name){alert("Group name is required");return}if(this.editFormData.categories.length===0){alert("Please select at least one category for this group");return}this.saveGroup()}}},At=t=>(at("data-v-0e788cd6"),t=t(),rt(),t),P0={class:"edit-category-groups"},R0={class:"d-flex justify-content-between align-items-center mb-3"},T0={key:0,class:"text-muted mb-0 mt-2 small"},O0={key:1,class:"text-muted mb-0 mt-2 small"},I0={key:0,class:"text-center text-muted py-4 border rounded"},k0={class:"mb-3"},$0=At(()=>o("label",{class:"form-label small fw-bold"},"Group Name *",-1)),A0={class:"mb-3"},M0={class:"d-flex justify-content-between align-items-center mb-2"},F0=At(()=>o("label",{class:"form-label small fw-bold mb-0"},"Categories in this Group *",-1)),N0={class:"btn-group btn-group-sm",role:"group"},L0=["disabled"],U0=["disabled"],j0={class:"category-selector border rounded p-2",style:{"max-height":"200px","overflow-y":"auto"}},V0={key:0,class:"text-muted small"},H0={key:1,class:"text-muted small"},B0={key:2},G0=["id","value","checked","onChange"],K0=["for"],z0={class:"text-muted"},Y0={key:0},W0={class:"mb-3"},X0=At(()=>o("label",{class:"form-label small fw-bold"},"Payment Options",-1)),J0={key:0,class:"text-center text-muted py-2 border rounded mb-2"},Q0={key:1,class:"payment-options-list mb-2"},Z0={class:"d-flex justify-content-between align-items-start mb-2"},q0={class:"text-muted"},eS=["onClick"],tS={class:"row g-2"},sS={class:"col-md-5"},oS=["onUpdate:modelValue"],nS={class:"col-md-4"},rS=["onUpdate:modelValue","disabled"],aS={class:"col-md-3"},iS=["onUpdate:modelValue"],lS={class:"d-flex gap-2 flex-wrap"},cS={class:"d-flex gap-2"},dS=At(()=>o("button",{class:"btn btn-sm btn-primary",type:"submit"},"Save Group",-1)),uS={key:1,class:"group-card border rounded bg-white"},mS=["onClick"],hS={class:"flex-grow-1"},fS={class:"text-muted small mt-1"},pS={class:"badge bg-secondary me-2"},gS={class:"badge bg-info"},vS={class:"group-actions d-flex align-items-center gap-2"},yS=["onClick"],bS=["onClick"],_S=["onClick"],CS={class:"btn btn-sm btn-link text-muted",type:"button"},DS={key:0,class:"group-details p-3 border-top bg-light"},SS={class:"mb-3"},xS=At(()=>o("h6",{class:"small fw-bold mb-2"},"Categories:",-1)),ES={class:"d-flex flex-wrap gap-1"},wS={key:0},PS=At(()=>o("h6",{class:"small fw-bold mb-2"},"Payment Options:",-1)),RS={class:"table-responsive"},TS={class:"table table-sm table-bordered mb-0"},OS=At(()=>o("thead",null,[o("tr",null,[o("th",null,"Name"),o("th",null,"Type"),o("th",{class:"text-end"},"Amount")])],-1)),IS={key:0,class:"badge bg-warning text-dark ms-1"},kS={class:"text-end"},$S={key:1,class:"text-muted small"};function AS(t,e,a,c,s,r){const n=A("Edit"),d=A("Plus"),i=A("Trash2"),l=A("Pencil"),m=A("Copy"),f=A("ChevronDown"),h=A("ChevronUp");return u(),p("div",P0,[o("div",R0,[o("div",null,[o("button",{class:ne(["btn btn-sm",s.editModeEnabled?"btn-secondary":"btn-outline-secondary"]),onClick:e[0]||(e[0]=g=>s.editModeEnabled=!s.editModeEnabled)},[D(n,{size:16,class:"me-1"}),T(" "+b(s.editModeEnabled?"View Mode":"Enable Editing"),1)],2),s.editModeEnabled?(u(),p("p",O0," Create groups of categories with their payment options. Each category can only belong to one group. ")):(u(),p("p",T0," Click group headers to expand/collapse details "))]),s.editModeEnabled?(u(),p("button",{key:0,class:"btn btn-sm btn-primary",onClick:e[1]||(e[1]=(...g)=>r.addGroup&&r.addGroup(...g))},[D(d,{size:16,class:"me-1"}),T(" Add Group ")])):P("",!0)]),s.formGroups.length===0?(u(),p("div",I0,' No category groups defined. Click "Add Group" to create one. ')):P("",!0),(u(!0),p(Q,null,ie(s.formGroups,(g,v)=>(u(),p("div",{key:v,class:"group-container mb-3"},[s.editGroupId===v?(u(),p("form",{key:0,onSubmit:e[9]||(e[9]=st((...y)=>r.submitForm&&r.submitForm(...y),["prevent"])),class:"p-3 border rounded bg-light"},[o("div",k0,[$0,le(o("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":e[2]||(e[2]=y=>s.editFormData.name=y),placeholder:"e.g., High School Categories",required:""},null,512),[[ge,s.editFormData.name]])]),o("div",A0,[o("div",M0,[F0,o("div",N0,[o("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:e[3]||(e[3]=(...y)=>r.selectAllCategories&&r.selectAllCategories(...y)),disabled:r.getAvailableCategories().length===0}," Select All ",8,L0),o("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:e[4]||(e[4]=(...y)=>r.clearAllCategories&&r.clearAllCategories(...y)),disabled:s.editFormData.categories.length===0}," Clear ",8,U0)])]),o("div",j0,[a.regCategories.length===0?(u(),p("div",V0," No categories defined yet. Please add categories first. ")):r.getAvailableCategories().length===0&&s.editFormData.categories.length===0?(u(),p("div",H0," All categories are already assigned to other groups. ")):(u(),p("div",B0,[(u(!0),p(Q,null,ie(a.regCategories,y=>le((u(),p("div",{key:y.id,class:"form-check"},[o("input",{class:"form-check-input",type:"checkbox",id:"cat-"+v+"-"+y.id,value:y.id,checked:s.editFormData.categories.includes(y.id),onChange:_=>r.toggleCategory(y.id)},null,40,G0),o("label",{class:"form-check-label",for:"cat-"+v+"-"+y.id},b(y.catdispname),9,K0)])),[[jt,s.editFormData.categories.includes(y.id)||r.getAvailableCategories().some(_=>_.id===y.id)]])),128))]))]),o("small",z0,[T(b(s.editFormData.categories.length)+" categories selected ",1),r.getAvailableCategories().length>0?(u(),p("span",Y0," ("+b(r.getAvailableCategories().length)+" available) ",1)):P("",!0)])]),o("div",W0,[X0,s.editFormData.paymentOptions.length===0?(u(),p("div",J0," No payment options defined for this group. ")):(u(),p("div",Q0,[(u(!0),p(Q,null,ie(s.editFormData.paymentOptions,(y,_)=>(u(),p("div",{key:_,class:"payment-option-item border rounded p-2 mb-2"},[o("div",Z0,[o("small",q0,"Payment Option "+b(_+1),1),o("button",{class:"btn btn-sm btn-outline-danger py-0 px-1",onClick:S=>r.removePaymentOption(_),type:"button"},[D(i,{size:12})],8,eS)]),o("div",tS,[o("div",sS,[le(o("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":S=>y.name=S,placeholder:"e.g., Early Bird",required:""},null,8,oS),[[ge,y.name]])]),o("div",nS,[le(o("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":S=>y.type=S,placeholder:"e.g., early_bird",disabled:r.isSpecialPaymentType(y.type),required:""},null,8,rS),[[ge,y.type]])]),o("div",aS,[le(o("input",{type:"number",class:"form-control form-control-sm","onUpdate:modelValue":S=>y.amount=S,placeholder:"Amount",min:"0",step:"1",required:""},null,8,iS),[[ge,y.amount,void 0,{number:!0}]])])])]))),128))])),o("div",lS,[o("button",{class:"btn btn-sm btn-success",onClick:e[5]||(e[5]=(...y)=>r.addPaymentOption&&r.addPaymentOption(...y)),type:"button"}," + Custom Payment "),o("button",{class:"btn btn-sm btn-info",onClick:e[6]||(e[6]=y=>r.addSpecialPaymentType("season")),type:"button"}," + Season Pass "),o("button",{class:"btn btn-sm btn-info",onClick:e[7]||(e[7]=y=>r.addSpecialPaymentType("cash")),type:"button"}," + Cash Payment ")])]),o("div",cS,[dS,o("button",{class:"btn btn-sm btn-secondary",type:"button",onClick:e[8]||(e[8]=st((...y)=>r.cancelEdit&&r.cancelEdit(...y),["stop"]))},"Cancel")])],32)):(u(),p("div",uS,[o("div",{class:"group-header p-3 d-flex align-items-center",onClick:y=>r.toggleExpand(v),style:{cursor:"pointer"}},[o("div",hS,[o("strong",null,b(g.name),1),o("div",fS,[o("span",pS,b(g.categories.length)+" categories",1),o("span",gS,b(g.paymentOptions.length)+" payment options",1)])]),o("div",vS,[s.editModeEnabled?(u(),p("button",{key:0,class:"btn btn-sm btn-outline-primary",onClick:st(y=>r.editGroup(v),["stop"]),title:"Edit"},[D(l,{size:14})],8,yS)):P("",!0),s.editModeEnabled?(u(),p("button",{key:1,class:"btn btn-sm btn-outline-secondary",onClick:st(y=>r.copyGroup(y,v),["stop"]),title:"Copy"},[D(m,{size:14})],8,bS)):P("",!0),s.editModeEnabled?(u(),p("button",{key:2,class:"btn btn-sm btn-outline-danger",onClick:st(y=>r.deleteGroup(y,v),["stop"]),title:"Delete"},[D(i,{size:14})],8,_S)):P("",!0),o("button",CS,[r.isExpanded(v)?(u(),ee(h,{key:1,size:16})):(u(),ee(f,{key:0,size:16}))])])],8,mS),r.isExpanded(v)?(u(),p("div",DS,[o("div",SS,[xS,o("div",ES,[(u(!0),p(Q,null,ie(g.categories,y=>(u(),p("span",{key:y,class:"badge bg-secondary"},b(r.getCategoryName(y)),1))),128))])]),g.paymentOptions.length>0?(u(),p("div",wS,[PS,o("div",RS,[o("table",TS,[OS,o("tbody",null,[(u(!0),p(Q,null,ie(g.paymentOptions,(y,_)=>(u(),p("tr",{key:_},[o("td",null,b(y.name),1),o("td",null,[o("code",null,b(y.type),1),r.isSpecialPaymentType(y.type)?(u(),p("span",IS," Special ")):P("",!0)]),o("td",kS,"$"+b(y.amount),1)]))),128))])])])])):(u(),p("div",$S," No payment options defined for this group. "))])):P("",!0)]))]))),128))])}const MS=ve(w0,[["render",AS],["__scopeId","data-v-0e788cd6"]]);const FS={components:{RouterLink:us,ArrowLeft:Cd,Save:Bd,Download:Id,EditSeriesCategoriesComponent:E0,EditCategoryGroupsComponent:MS},data(){return{loading:!1,saving:!1,error:null,saveError:null,saveSuccess:!1,seriesData:null,formData:{name:"",displayName:"",year:new Date().getFullYear(),active:!0,description:"",regCategories:[],categoryGroups:[],defaultPaymentOptions:[]},allRaces:[],racesInSeries:[],racesNotInSeries:[],selectedRacesInSeries:[],selectedRacesNotInSeries:[],loadingRaces:!1,racesError:null,updatingRaces:!1,raceSearchFilter:"",showAddRacesModal:!1,showStickySaveButton:!1,hasUnsavedChanges:!1,originalFormData:null,showImportCategoriesModal:!1,importRaces:[],loadingImportRaces:!1,selectedImportRaceId:null,selectedImportRaceCategories:null}},async created(){await this.fetchData(),this.fetchRaces(),window.addEventListener("scroll",this.handleScroll)},beforeUnmount(){window.removeEventListener("scroll",this.handleScroll)},watch:{"$route.params.seriesId":{async handler(){await this.fetchData(),await this.fetchRaces()}},formData:{handler(){this.checkForChanges()},deep:!0}},methods:{async fetchData(){var t,e;this.error=null,this.loading=!0;try{const a=await W(`/api/series/${this.$route.params.seriesId}`);this.seriesData=a.data,this.formData={name:this.seriesData.name||"",displayName:this.seriesData.displayName||"",year:this.seriesData.year||new Date().getFullYear(),active:this.seriesData.active!==void 0?this.seriesData.active:!0,description:this.seriesData.description||"",regCategories:this.seriesData.regCategories||[],categoryGroups:this.seriesData.categoryGroups||[],defaultPaymentOptions:this.seriesData.defaultPaymentOptions||[]},this.originalFormData=JSON.parse(JSON.stringify(this.formData)),this.hasUnsavedChanges=!1,this.loading=!1}catch(a){this.loading=!1,this.error=((e=(t=a.response)==null?void 0:t.data)==null?void 0:e.message)||a.message||a.toString(),console.error(a)}},async saveSeries(){var t,e;this.saveError=null,this.saveSuccess=!1,this.saving=!0;try{await W.patch(`/api/series/${this.$route.params.seriesId}`,this.formData),this.saveSuccess=!0,this.saving=!1,await this.fetchData(),setTimeout(()=>{this.saveSuccess=!1},3e3)}catch(a){this.saving=!1,this.saveError=((e=(t=a.response)==null?void 0:t.data)==null?void 0:e.message)||a.message||"Error saving series",console.error("Error saving series:",a)}},async fetchRaces(){var t,e,a,c;this.loadingRaces=!0,this.racesError=null;try{const s=new Date().toISOString().split("T")[0],r=await W(`/api/races?startDate=${s}`);this.allRaces=r.data;const n=((t=this.seriesData)==null?void 0:t.seriesId)||((e=this.seriesData)==null?void 0:e.series)||this.$route.params.seriesId;this.racesInSeries=this.allRaces.filter(d=>d.series===n),this.racesNotInSeries=this.allRaces.filter(d=>d.series!==n),this.loadingRaces=!1}catch(s){this.loadingRaces=!1,this.racesError=((c=(a=s.response)==null?void 0:a.data)==null?void 0:c.message)||s.message||"Error loading races",console.error("Error loading races:",s)}},toggleRaceSelection(t){const e=this.selectedRacesNotInSeries.indexOf(t);e>-1?this.selectedRacesNotInSeries.splice(e,1):this.selectedRacesNotInSeries.push(t)},async addRacesToSeries(){var t,e;if(this.selectedRacesNotInSeries.length!==0){this.updatingRaces=!0;try{await W.post(`/api/series/${this.$route.params.seriesId}/races`,{raceIds:this.selectedRacesNotInSeries,action:"add"}),await this.fetchRaces(),this.selectedRacesNotInSeries=[],this.showAddRacesModal=!1,this.raceSearchFilter=""}catch(a){this.racesError=((e=(t=a.response)==null?void 0:t.data)==null?void 0:e.message)||a.message||"Error adding races",console.error("Error adding races:",a)}finally{this.updatingRaces=!1}}},async removeRaceFromSeries(t){var e,a;if(confirm("Remove this race from the series?")){this.updatingRaces=!0;try{await W.post(`/api/series/${this.$route.params.seriesId}/races`,{raceIds:[t],action:"remove"}),await this.fetchRaces()}catch(c){this.racesError=((a=(e=c.response)==null?void 0:e.data)==null?void 0:a.message)||c.message||"Error removing race",console.error("Error removing race:",c)}finally{this.updatingRaces=!1}}},formatRaceDate(t){return t?new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):""},handleScroll(){this.showStickySaveButton=window.scrollY>300},checkForChanges(){if(!this.originalFormData)return;const t=JSON.stringify(this.formData),e=JSON.stringify(this.originalFormData);this.hasUnsavedChanges=t!==e},async openImportCategoriesModal(){this.showImportCategoriesModal=!0,this.selectedImportRaceId=null,this.selectedImportRaceCategories=null,await this.fetchImportRaces()},async fetchImportRaces(){this.loadingImportRaces=!0;try{const t=await W("/api/races?startDate=2020-01-01");this.importRaces=t.data.filter(e=>e.regCategories&&e.regCategories.length>0).sort((e,a)=>{const c=new Date(e.eventDate||0);return new Date(a.eventDate||0)-c}),this.loadingImportRaces=!1}catch(t){this.loadingImportRaces=!1,console.error("Error loading races for import:",t)}},async selectImportRace(t){this.selectedImportRaceId=t;const e=this.importRaces.find(a=>a.raceid===t);e&&e.regCategories&&(this.selectedImportRaceCategories=e.regCategories)},confirmImportCategories(){this.selectedImportRaceCategories&&(this.formData.regCategories=JSON.parse(JSON.stringify(this.selectedImportRaceCategories)),this.showImportCategoriesModal=!1,this.selectedImportRaceId=null,this.selectedImportRaceCategories=null)},closeImportCategoriesModal(){this.showImportCategoriesModal=!1,this.selectedImportRaceId=null,this.selectedImportRaceCategories=null},addDefaultPaymentOption(){this.formData.defaultPaymentOptions.push({name:"",type:"",amount:0})},removeDefaultPaymentOption(t){confirm("Remove this default payment option?")&&this.formData.defaultPaymentOptions.splice(t,1)},addDefaultSpecialPaymentType(t){if(this.formData.defaultPaymentOptions.some(c=>c.type===t)){alert(`A ${t} payment type already exists in default payment options`);return}const a={type:t,amount:0};t==="season"?a.name="Season Pass":t==="cash"&&(a.name="Cash Payment (at event)"),this.formData.defaultPaymentOptions.push(a)},isSpecialPaymentType(t){return t==="season"||t==="cash"}},computed:{loaded(){return!!this.seriesData},filteredRacesNotInSeries(){if(!this.raceSearchFilter)return this.racesNotInSeries;const t=this.raceSearchFilter.toLowerCase();return this.racesNotInSeries.filter(e=>{var c;return(((c=e.eventDetails)==null?void 0:c.name)||"").toLowerCase().includes(t)})},seriesDefaultPaymentTypesMap(){const t={};return(this.formData.defaultPaymentOptions||[]).forEach(e=>{t[e.type]=e.name}),t}}},me=t=>(at("data-v-57ff0ad8"),t=t(),rt(),t),NS={key:0,class:"loading"},LS={key:0,class:"alert alert-danger"},US={key:1},jS={class:"d-flex justify-content-between align-items-center mb-4"},VS={class:"d-flex gap-2"},HS=["disabled"],BS={key:0,class:"alert alert-success alert-dismissible fade show",role:"alert"},GS={key:1,class:"alert alert-danger alert-dismissible fade show",role:"alert"},KS={class:"row"},zS={class:"col-lg-9"},YS={class:"card mb-4"},WS=me(()=>o("div",{class:"card-header"},[o("h5",{class:"mb-0"},"Basic Information")],-1)),XS={class:"card-body"},JS={class:"mb-3"},QS=me(()=>o("label",{for:"seriesId",class:"form-label"},"Series ID",-1)),ZS=["value"],qS=me(()=>o("small",{class:"form-text text-muted"},"Cannot be changed",-1)),e2={class:"mb-3"},t2=me(()=>o("label",{for:"name",class:"form-label"},"Name *",-1)),s2={class:"mb-3"},o2=me(()=>o("label",{for:"displayName",class:"form-label"},"Display Name *",-1)),n2={class:"mb-3"},r2=me(()=>o("label",{for:"year",class:"form-label"},"Year *",-1)),a2={class:"mb-3"},i2=me(()=>o("label",{for:"description",class:"form-label"},"Description",-1)),l2={class:"mb-3 form-check"},c2=me(()=>o("label",{class:"form-check-label",for:"active"}," Active (series is currently running) ",-1)),d2={class:"card mb-4"},u2={class:"card-header d-flex justify-content-between align-items-center"},m2=me(()=>o("h5",{class:"mb-0"},"Races in Series",-1)),h2=["disabled"],f2={class:"card-body"},p2={key:0,class:"text-center py-3"},g2=me(()=>o("div",{class:"spinner-border spinner-border-sm",role:"status"},[o("span",{class:"visually-hidden"},"Loading races...")],-1)),v2={key:1,class:"alert alert-danger"},y2={key:2},b2={key:0,class:"text-center text-muted py-4"},_2=me(()=>o("p",null,"No races in this series yet.",-1)),C2={key:1,class:"table-responsive"},D2={class:"table table-hover table-sm"},S2=me(()=>o("thead",null,[o("tr",null,[o("th",null,"Date"),o("th",null,"Race Name"),o("th",{class:"text-center"},"Race #"),o("th",{class:"text-center"},"Series Redirect"),o("th",{class:"text-center"},"Actions")])],-1)),x2={class:"text-nowrap"},E2={class:"text-center"},w2={key:0,class:"badge bg-secondary"},P2={key:1,class:"text-muted small"},R2={class:"text-center"},T2={key:0,class:"badge bg-warning text-dark"},O2={key:1,class:"badge bg-success"},I2={class:"text-center"},k2=["onClick","disabled"],$2={class:"card mb-4"},A2={class:"card-header d-flex justify-content-between align-items-center"},M2=me(()=>o("h5",{class:"mb-0"},"Race Categories",-1)),F2={class:"card-body"},N2=me(()=>o("p",{class:"text-muted small mb-3"}," Define the default categories for all races in this series. Individual races can override these. ",-1)),L2={class:"card mb-4"},U2=me(()=>o("div",{class:"card-header"},[o("h5",{class:"mb-0"},"Default Payment Options")],-1)),j2={class:"card-body"},V2=me(()=>o("p",{class:"text-muted small mb-3"},[o("strong",null,"Series-wide default payment options"),T(" that apply to all series categories. These can be overridden by: "),o("br"),T("• Category Group payment options (if a category belongs to a group) "),o("br"),T("• Race-specific payment options (if a race defines a matching payment type) ")],-1)),H2={key:0,class:"text-center text-muted py-3 border rounded mb-3"},B2={key:1,class:"payment-options-list mb-3"},G2={class:"d-flex justify-content-between align-items-start mb-2"},K2={class:"mb-0"},z2=["onClick"],Y2={class:"row g-2"},W2={class:"col-md-5"},X2=me(()=>o("label",{class:"form-label small"},"Name *",-1)),J2=["onUpdate:modelValue"],Q2={class:"col-md-4"},Z2=me(()=>o("label",{class:"form-label small"},"Type ID *",-1)),q2=["onUpdate:modelValue","disabled"],ex={key:0,class:"text-muted"},tx={class:"col-md-3"},sx=me(()=>o("label",{class:"form-label small"},"Amount ($) *",-1)),ox=["onUpdate:modelValue"],nx={class:"d-flex gap-2 flex-wrap"},rx={class:"card mb-4"},ax=me(()=>o("div",{class:"card-header"},[o("h5",{class:"mb-0"},"Category Groups & Payment Options")],-1)),ix={class:"card-body"},lx=me(()=>o("p",{class:"text-muted small mb-3"},[o("strong",null,"Optional:"),T(" Group categories together and assign specific payment options to each group. Group payment options override the default payment options above for categories in that group. ")],-1)),cx={key:0,class:"modal show d-block",tabindex:"-1",style:{"background-color":"rgba(0,0,0,0.5)"}},dx={class:"modal-dialog modal-lg"},ux={class:"modal-content"},mx={class:"modal-header"},hx=me(()=>o("h5",{class:"modal-title"},"Add Races to Series",-1)),fx={class:"modal-body"},px={class:"mb-3"},gx={key:0,class:"text-center text-muted py-3"},vx={key:0},yx={key:1},bx={key:1,class:"race-selection-list"},_x=["onClick"],Cx={class:"form-check"},Dx=["checked","onClick"],Sx={class:"form-check-label"},xx={key:2,class:"mt-3 alert alert-info"},Ex={class:"modal-footer"},wx=["disabled"],Px={key:1,class:"modal show d-block",tabindex:"-1",style:{"background-color":"rgba(0,0,0,0.5)"}},Rx={class:"modal-dialog modal-xl"},Tx={class:"modal-content"},Ox={class:"modal-header"},Ix=me(()=>o("h5",{class:"modal-title"},"Import Categories from Race",-1)),kx={class:"modal-body"},$x={key:0,class:"text-center py-4"},Ax=me(()=>o("div",{class:"spinner-border",role:"status"},[o("span",{class:"visually-hidden"},"Loading races...")],-1)),Mx=me(()=>o("p",{class:"mt-2 text-muted"},"Loading races...",-1)),Fx=[Ax,Mx],Nx={key:1,class:"row"},Lx={class:"col-md-5"},Ux=me(()=>o("h6",{class:"mb-3"},"Select a Race",-1)),jx={key:0,class:"text-center text-muted py-4"},Vx=me(()=>o("p",null,"No races with categories found.",-1)),Hx=[Vx],Bx={key:1,class:"import-race-list"},Gx=["onClick"],Kx={class:"d-flex flex-column"},zx={class:"text-muted"},Yx={key:0,class:"ms-2"},Wx={class:"col-md-7"},Xx=me(()=>o("h6",{class:"mb-3"},"Category Preview",-1)),Jx={key:0,class:"text-center text-muted py-5"},Qx=me(()=>o("p",null,"← Select a race to preview its categories",-1)),Zx=[Qx],qx={key:1,class:"category-preview"},eE={class:"alert alert-info mb-3"},tE={class:"table-responsive"},sE={class:"table table-sm table-bordered"},oE=me(()=>o("thead",{class:"table-light"},[o("tr",null,[o("th",{style:{width:"40px"}},"#"),o("th",null,"Category Name"),o("th",{style:{width:"90px"}},"Start Time"),o("th",{style:{width:"60px"}},"Laps"),o("th",{style:{width:"100px"}},"Age Range")])],-1)),nE={class:"text-center text-muted"},rE={key:0,class:"badge bg-success ms-2"},aE={class:"text-center"},iE={key:0},lE={key:1,class:"text-muted"},cE={class:"text-center"},dE={class:"text-center text-nowrap"},uE={key:0},mE={key:1,class:"text-muted"},hE={class:"modal-footer"},fE=["disabled"],pE={class:"col-lg-3"},gE={class:"card mb-4"},vE=me(()=>o("div",{class:"card-header"},[o("h6",{class:"mb-0"},"Quick Info")],-1)),yE={class:"card-body"},bE={class:"mb-0"},_E=me(()=>o("dt",{class:"small text-muted"},"Series ID",-1)),CE=me(()=>o("dt",{class:"small text-muted"},"Year",-1)),DE=me(()=>o("dt",{class:"small text-muted"},"Status",-1)),SE={key:0,class:"badge bg-success"},xE={key:1,class:"badge bg-secondary"},EE=me(()=>o("dt",{class:"small text-muted"},"Categories",-1)),wE={key:0,class:"badge bg-primary"},PE={key:1,class:"text-muted"},RE=me(()=>o("dt",{class:"small text-muted"},"Category Groups",-1)),TE={key:0,class:"badge bg-info"},OE={key:1,class:"text-muted"},IE=me(()=>o("dt",{class:"small text-muted"},"Races",-1)),kE={key:0,class:"badge bg-success"},$E={key:1,class:"text-muted"},AE={key:2,class:"text-muted"},ME={key:2},FE=me(()=>o("div",{class:"text-center"},[o("h2",{class:"mt-5"},"Series not found")],-1)),NE=[FE],LE={class:"container"},UE={class:"d-flex justify-content-between align-items-center"},jE={class:"text-white"},VE={key:0,class:"ms-2 text-white-50"},HE={key:1,class:"ms-2 text-white-50"},BE=["disabled"];function GE(t,e,a,c,s,r){const n=A("ArrowLeft"),d=A("RouterLink"),i=A("Save"),l=A("Download"),m=A("EditSeriesCategoriesComponent"),f=A("EditCategoryGroupsComponent");return s.loading?(u(),p("div",NS,"Loading...")):(u(),p("div",{key:1,class:ne(["edit-series-wrapper",{"has-sticky-bar":s.showStickySaveButton}])},[s.error?(u(),p("div",LS,b(s.error),1)):P("",!0),r.loaded?(u(),p("div",US,[o("div",jS,[o("h2",null,[D(d,{to:{name:"series"},class:"text-decoration-none me-3"},{default:V(()=>[D(n,{size:24})]),_:1}),T(" Edit Series: "+b(s.seriesData.displayName||s.seriesData.name),1)]),o("div",VS,[D(d,{to:{name:"races",query:{series:s.seriesData.seriesId||s.seriesData.series}},class:"btn btn-outline-secondary"},{default:V(()=>[T(" View Races in Series ")]),_:1},8,["to"]),o("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=(...h)=>r.saveSeries&&r.saveSeries(...h)),disabled:s.saving},[D(i,{size:16,class:"me-1"}),T(" "+b(s.saving?"Saving...":"Save Changes"),1)],8,HS)])]),s.saveSuccess?(u(),p("div",BS,[T(" Series saved successfully! "),o("button",{type:"button",class:"btn-close",onClick:e[1]||(e[1]=h=>s.saveSuccess=!1)})])):P("",!0),s.saveError?(u(),p("div",GS,[T(b(s.saveError)+" ",1),o("button",{type:"button",class:"btn-close",onClick:e[2]||(e[2]=h=>s.saveError=null)})])):P("",!0),o("div",KS,[o("div",zS,[o("div",YS,[WS,o("div",XS,[o("div",JS,[QS,o("input",{type:"text",class:"form-control",id:"seriesId",value:s.seriesData.seriesId||s.seriesData.series,disabled:""},null,8,ZS),qS]),o("div",e2,[t2,le(o("input",{type:"text",class:"form-control",id:"name","onUpdate:modelValue":e[3]||(e[3]=h=>s.formData.name=h),required:""},null,512),[[ge,s.formData.name]])]),o("div",s2,[o2,le(o("input",{type:"text",class:"form-control",id:"displayName","onUpdate:modelValue":e[4]||(e[4]=h=>s.formData.displayName=h),required:""},null,512),[[ge,s.formData.displayName]])]),o("div",n2,[r2,le(o("input",{type:"number",class:"form-control",id:"year","onUpdate:modelValue":e[5]||(e[5]=h=>s.formData.year=h),required:"",min:"2020",max:"2050"},null,512),[[ge,s.formData.year,void 0,{number:!0}]])]),o("div",a2,[i2,le(o("textarea",{class:"form-control",id:"description","onUpdate:modelValue":e[6]||(e[6]=h=>s.formData.description=h),rows:"3"},null,512),[[ge,s.formData.description]])]),o("div",l2,[le(o("input",{type:"checkbox",class:"form-check-input",id:"active","onUpdate:modelValue":e[7]||(e[7]=h=>s.formData.active=h)},null,512),[[ds,s.formData.active]]),c2])])]),o("div",d2,[o("div",u2,[m2,o("button",{class:"btn btn-sm btn-primary",onClick:e[8]||(e[8]=h=>s.showAddRacesModal=!0),disabled:s.loadingRaces}," + Add Races ",8,h2)]),o("div",f2,[s.loadingRaces?(u(),p("div",p2,[g2,T(" Loading races... ")])):s.racesError?(u(),p("div",v2,b(s.racesError),1)):(u(),p("div",y2,[s.racesInSeries.length===0?(u(),p("div",b2,[_2,o("button",{class:"btn btn-sm btn-primary",onClick:e[9]||(e[9]=h=>s.showAddRacesModal=!0)}," Add Races to Series ")])):(u(),p("div",C2,[o("table",D2,[S2,o("tbody",null,[(u(!0),p(Q,null,ie(s.racesInSeries,h=>(u(),p("tr",{key:h.raceid},[o("td",x2,b(r.formatRaceDate(h.eventDate)),1),o("td",null,[D(d,{to:{name:"edit-race",params:{raceid:h.raceid}}},{default:V(()=>{var g;return[T(b(((g=h.eventDetails)==null?void 0:g.name)||h.displayName),1)]}),_:2},1032,["to"])]),o("td",E2,[h.seriesRaceNumber?(u(),p("span",w2," #"+b(h.seriesRaceNumber),1)):(u(),p("span",P2,"-"))]),o("td",R2,[h.disableSeriesRedirect?(u(),p("span",T2," Disabled ")):(u(),p("span",O2," Enabled "))]),o("td",I2,[o("button",{class:"btn btn-sm btn-outline-danger",onClick:g=>r.removeRaceFromSeries(h.raceid),disabled:s.updatingRaces,title:"Remove from series"}," Remove ",8,k2)])]))),128))])])]))]))])]),o("div",$2,[o("div",A2,[M2,o("button",{class:"btn btn-sm btn-outline-primary",onClick:e[10]||(e[10]=(...h)=>r.openImportCategoriesModal&&r.openImportCategoriesModal(...h)),title:"Import categories from an existing race"},[D(l,{size:16,class:"me-1"}),T(" Import from Race ")])]),o("div",F2,[N2,D(m,{categories:s.formData.regCategories,payTypes:r.seriesDefaultPaymentTypesMap,"onUpdate:categories":e[11]||(e[11]=h=>s.formData.regCategories=h)},null,8,["categories","payTypes"])])]),o("div",L2,[U2,o("div",j2,[V2,s.formData.defaultPaymentOptions.length===0?(u(),p("div",H2,' No default payment options defined. Click "Add Payment Option" to create one. ')):(u(),p("div",B2,[(u(!0),p(Q,null,ie(s.formData.defaultPaymentOptions,(h,g)=>(u(),p("div",{key:g,class:"payment-option-card border rounded p-3 mb-2"},[o("div",G2,[o("h6",K2,"Payment Option "+b(g+1),1),o("button",{class:"btn btn-sm btn-outline-danger",onClick:v=>r.removeDefaultPaymentOption(g),type:"button"}," Remove ",8,z2)]),o("div",Y2,[o("div",W2,[X2,le(o("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":v=>h.name=v,placeholder:"e.g., Early Bird Registration",required:""},null,8,J2),[[ge,h.name]])]),o("div",Q2,[Z2,le(o("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":v=>h.type=v,placeholder:"e.g., early_bird",disabled:r.isSpecialPaymentType(h.type),required:""},null,8,q2),[[ge,h.type]]),r.isSpecialPaymentType(h.type)?(u(),p("small",ex," Special type (cannot be changed) ")):P("",!0)]),o("div",tx,[sx,le(o("input",{type:"number",class:"form-control form-control-sm","onUpdate:modelValue":v=>h.amount=v,placeholder:"0",min:"0",step:"1",required:""},null,8,ox),[[ge,h.amount,void 0,{number:!0}]])])])]))),128))])),o("div",nx,[o("button",{class:"btn btn-sm btn-success",onClick:e[12]||(e[12]=(...h)=>r.addDefaultPaymentOption&&r.addDefaultPaymentOption(...h)),type:"button"}," + Add Custom Payment "),o("button",{class:"btn btn-sm btn-info",onClick:e[13]||(e[13]=h=>r.addDefaultSpecialPaymentType("season")),type:"button"}," + Season Pass "),o("button",{class:"btn btn-sm btn-info",onClick:e[14]||(e[14]=h=>r.addDefaultSpecialPaymentType("cash")),type:"button"}," + Cash Payment ")])])]),o("div",rx,[ax,o("div",ix,[lx,D(f,{categoryGroups:s.formData.categoryGroups,regCategories:s.formData.regCategories,"onUpdate:categoryGroups":e[15]||(e[15]=h=>s.formData.categoryGroups=h)},null,8,["categoryGroups","regCategories"])])]),s.showAddRacesModal?(u(),p("div",cx,[o("div",dx,[o("div",ux,[o("div",mx,[hx,o("button",{type:"button",class:"btn-close",onClick:e[16]||(e[16]=h=>s.showAddRacesModal=!1)})]),o("div",fx,[o("div",px,[le(o("input",{type:"text",class:"form-control","onUpdate:modelValue":e[17]||(e[17]=h=>s.raceSearchFilter=h),placeholder:"🔍 Filter races by name..."},null,512),[[ge,s.raceSearchFilter]])]),r.filteredRacesNotInSeries.length===0?(u(),p("div",gx,[s.raceSearchFilter?(u(),p("p",vx,"No races match your search.")):(u(),p("p",yx,"All upcoming races are already in this series."))])):(u(),p("div",bx,[(u(!0),p(Q,null,ie(r.filteredRacesNotInSeries,h=>{var g;return u(),p("div",{key:h.raceid,class:ne(["race-selection-item",{selected:s.selectedRacesNotInSeries.includes(h.raceid)}]),onClick:v=>r.toggleRaceSelection(h.raceid)},[o("div",Cx,[o("input",{class:"form-check-input",type:"checkbox",checked:s.selectedRacesNotInSeries.includes(h.raceid),onClick:st(v=>r.toggleRaceSelection(h.raceid),["stop"])},null,8,Dx),o("label",Sx,[o("strong",null,b(r.formatRaceDate(h.eventDate)),1),T(" - "+b(((g=h.eventDetails)==null?void 0:g.name)||h.displayName),1)])])],10,_x)}),128))])),s.selectedRacesNotInSeries.length>0?(u(),p("div",xx,b(s.selectedRacesNotInSeries.length)+" race(s) selected ",1)):P("",!0)]),o("div",Ex,[o("button",{type:"button",class:"btn btn-secondary",onClick:e[18]||(e[18]=h=>s.showAddRacesModal=!1)},"Cancel"),o("button",{type:"button",class:"btn btn-primary",onClick:e[19]||(e[19]=(...h)=>r.addRacesToSeries&&r.addRacesToSeries(...h)),disabled:s.selectedRacesNotInSeries.length===0||s.updatingRaces},b(s.updatingRaces?"Adding...":`Add ${s.selectedRacesNotInSeries.length} Race(s)`),9,wx)])])])])):P("",!0),s.showImportCategoriesModal?(u(),p("div",Px,[o("div",Rx,[o("div",Tx,[o("div",Ox,[Ix,o("button",{type:"button",class:"btn-close",onClick:e[20]||(e[20]=(...h)=>r.closeImportCategoriesModal&&r.closeImportCategoriesModal(...h))})]),o("div",kx,[s.loadingImportRaces?(u(),p("div",$x,Fx)):(u(),p("div",Nx,[o("div",Lx,[Ux,s.importRaces.length===0?(u(),p("div",jx,Hx)):(u(),p("div",Bx,[(u(!0),p(Q,null,ie(s.importRaces,h=>{var g;return u(),p("div",{key:h.raceid,class:ne(["import-race-item",{selected:s.selectedImportRaceId===h.raceid}]),onClick:v=>r.selectImportRace(h.raceid)},[o("div",Kx,[o("strong",null,b(((g=h.eventDetails)==null?void 0:g.name)||h.displayName),1),o("small",zx,[T(b(r.formatRaceDate(h.eventDate))+" ",1),h.regCategories?(u(),p("span",Yx," ("+b(h.regCategories.length)+" categories) ",1)):P("",!0)])])],10,Gx)}),128))]))]),o("div",Wx,[Xx,s.selectedImportRaceId?s.selectedImportRaceCategories?(u(),p("div",qx,[o("div",eE,[o("strong",null,b(s.selectedImportRaceCategories.length),1),T(" categories will be imported ")]),o("div",tE,[o("table",sE,[oE,o("tbody",null,[(u(!0),p(Q,null,ie(s.selectedImportRaceCategories,(h,g)=>(u(),p("tr",{key:h.id||g},[o("td",nE,b(g+1),1),o("td",null,[o("strong",null,b(h.catdispname),1),h.sponsored?(u(),p("span",rE,"Sponsored")):P("",!0)]),o("td",aE,[h.startTime?(u(),p("span",iE,b(h.startTime),1)):(u(),p("span",lE,"—"))]),o("td",cE,b(h.laps||"—"),1),o("td",dE,[h.minAge||h.maxAge?(u(),p("span",uE,b(h.minAge||"—")+" - "+b(h.maxAge||"—"),1)):(u(),p("span",mE,"—"))])]))),128))])])])])):P("",!0):(u(),p("div",Jx,Zx))])]))]),o("div",hE,[o("button",{type:"button",class:"btn btn-secondary",onClick:e[21]||(e[21]=(...h)=>r.closeImportCategoriesModal&&r.closeImportCategoriesModal(...h))},"Cancel"),o("button",{type:"button",class:"btn btn-primary",onClick:e[22]||(e[22]=(...h)=>r.confirmImportCategories&&r.confirmImportCategories(...h)),disabled:!s.selectedImportRaceId},[D(l,{size:16,class:"me-1"}),T(" Import Categories ")],8,fE)])])])])):P("",!0)]),o("div",pE,[o("div",gE,[vE,o("div",yE,[o("dl",bE,[_E,o("dd",null,[o("code",null,b(s.seriesData.seriesId||s.seriesData.series),1)]),CE,o("dd",null,b(s.formData.year),1),DE,o("dd",null,[s.formData.active?(u(),p("span",SE,"Active")):(u(),p("span",xE,"Inactive"))]),EE,o("dd",null,[s.formData.regCategories.length>0?(u(),p("span",wE,b(s.formData.regCategories.length)+" categories ",1)):(u(),p("span",PE,"None defined"))]),RE,o("dd",null,[s.formData.categoryGroups.length>0?(u(),p("span",TE,b(s.formData.categoryGroups.length)+" groups ",1)):(u(),p("span",OE,"None defined"))]),IE,o("dd",null,[!s.loadingRaces&&s.racesInSeries.length>0?(u(),p("span",kE,b(s.racesInSeries.length)+" races ",1)):s.loadingRaces?(u(),p("span",$E,"Loading...")):(u(),p("span",AE,"No races"))])])])])])])])):(u(),p("div",ME,NE)),D(oo,{name:"slide-up"},{default:V(()=>[r.loaded&&s.showStickySaveButton?(u(),p("div",{key:0,class:ne(["sticky-save-bar",{"has-changes":s.hasUnsavedChanges}])},[o("div",LE,[o("div",UE,[o("div",jE,[o("strong",null,b(s.seriesData.displayName||s.seriesData.name),1),s.hasUnsavedChanges?(u(),p("span",VE,"- Unsaved changes")):(u(),p("span",HE,"- All changes saved"))]),o("button",{class:"btn btn-light btn-lg",onClick:e[23]||(e[23]=(...h)=>r.saveSeries&&r.saveSeries(...h)),disabled:s.saving||!s.hasUnsavedChanges},[D(i,{size:18,class:"me-2"}),T(" "+b(s.saving?"Saving...":s.hasUnsavedChanges?"Save Changes":"Saved"),1)],8,BE)])])],2)):P("",!0)]),_:1})],2))}const KE=ve(FS,[["render",GE],["__scopeId","data-v-57ff0ad8"]]),zE=ga({history:va("/"),routes:[{path:"/payments/",component:Zc,name:"payments"},{path:"/races/",component:q1,name:"races"},{path:"/series/",component:gD,name:"series"},{path:"/series/:seriesId",component:KE,name:"edit-series"},{path:"/results/",component:__,name:"results"},{path:"/series-results/",component:rC,name:"series-results"},{path:"/edit-series-result/:series",component:MC,name:"edit-series-result"},{path:"/results/:resultid/",component:n_,name:"view-result",children:[{path:"",component:M_,name:"edit-result"}]},{path:"/race/:raceid/",component:v1,name:"view-race",children:[{path:"",component:fb,name:"edit-race"},{path:"racers/",component:Du,name:"edit-racers"},{path:"racers-purchases/",component:c1,name:"racer-purchases"},{path:"series/:series",component:jb,name:"edit-series-racers"}]}]});ya.init({clientToken:"pub5b9b0cfce30b3b609b588d9f3ac85ebb",site:"datadoghq.com",env:"production",service:"admin-site",version:"1.0.1",forwardErrorsToLogs:!0,sampleRate:100});const vo=To(Xa);vo.use(ba,_a);vo.use(zE);vo.mount("#app");
//# sourceMappingURL=admin-1ddc2f77.js.map
